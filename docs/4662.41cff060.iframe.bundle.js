(self.webpackChunkcomponents_angular=self.webpackChunkcomponents_angular||[]).push([[4662],{"./node_modules/@antv/x6-angular-shape/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{kz:()=>register});var es=__webpack_require__("./node_modules/@antv/x6/es/index.js");class AngularShape extends es.bP{}!function(AngularShape){function getMarkup(primer){const markup=[],content=es.VK.getForeignObjectMarkup();return primer?markup.push({tagName:primer,selector:"body"},content):markup.push(content),markup}AngularShape.config({view:"angular-shape-view",markup:getMarkup(),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}},propHooks(metadata){if(null==metadata.markup){const primer=metadata.primer;if(primer){metadata.markup=getMarkup(primer);let attrs={};switch(primer){case"circle":attrs={refCx:"50%",refCy:"50%",refR:"50%"};break;case"ellipse":attrs={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}metadata.attrs=es.D5.merge({},{body:Object.assign({refWidth:null,refHeight:null},attrs)},metadata.attrs||{})}}return metadata}}),es.bP.registry.register("angular-shape",AngularShape,!0)}(AngularShape||(AngularShape={}));var core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const registerInfo=new Map;function register(config){const{shape,injector,content}=config,others=__rest(config,["shape","injector","content"]);registerInfo.set(shape,{injector,content}),es.ke.registerNode(shape,Object.assign({inherit:"angular-shape"},others),!0)}class AngularShapeView extends es.Yv{getNodeContainer(){return this.selectors&&this.selectors.foContent}confirmUpdate(flag){const ret=super.confirmUpdate(flag);return this.handleAction(ret,AngularShapeView.action,(()=>this.renderAngularContent()))}getNgArguments(){var _a;return(null===(_a=this.cell.data)||void 0===_a?void 0:_a.ngArguments)||{}}setInstanceInput(content,ref){const ngArguments=this.getNgArguments();if(content instanceof core.TemplateRef){ref.context={ngArguments}}else{const componentRef=ref;Object.keys(ngArguments).forEach((v=>componentRef.setInput(v,ngArguments[v]))),componentRef.changeDetectorRef.detectChanges()}}renderAngularContent(){this.unmountAngularContent();const container=this.getNodeContainer();if(container){const node=this.cell,{injector,content}=registerInfo.get(node.shape),viewContainerRef=injector.get(core.ViewContainerRef);if(content instanceof core.TemplateRef){const ngArguments=this.getNgArguments(),embeddedViewRef=viewContainerRef.createEmbeddedView(content,{ngArguments});embeddedViewRef.rootNodes.forEach((node=>container.appendChild(node))),embeddedViewRef.detectChanges(),node.on("change:data",(()=>this.setInstanceInput(content,embeddedViewRef)))}else{const componentRef=viewContainerRef.createComponent(content),insertNode=componentRef.hostView.rootNodes[0];container.appendChild(insertNode),this.setInstanceInput(content,componentRef),node.on("change:data",(()=>this.setInstanceInput(content,componentRef))),node.on("removed",(()=>componentRef.destroy()))}}}unmountAngularContent(){const container=this.getNodeContainer();return container.innerHTML="",container}onMouseDown(e,x,y){const target=e.target;if("input"===target.tagName.toLowerCase()){const type=target.getAttribute("type");if(null==type||["text","password","number","email","search","tel","url"].includes(type))return}super.onMouseDown(e,x,y)}unmount(){return this.unmountAngularContent(),super.unmount(),this}}!function(AngularShapeView){AngularShapeView.action="angular",AngularShapeView.config({bootstrap:[AngularShapeView.action],actions:{component:AngularShapeView.action}}),es.Yv.registry.register("angular-shape-view",AngularShapeView,!0)}(AngularShapeView||(AngularShapeView={}))},"./node_modules/@antv/x6-common/es/polyfill/index.js":()=>{"object"==typeof window&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"undefined"!=typeof window&&[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((item=>{Object.prototype.hasOwnProperty.call(item,"append")||Object.defineProperty(item,"append",{configurable:!0,enumerable:!0,writable:!0,value(...args){const docFrag=document.createDocumentFragment();args.forEach((arg=>{const isNode=arg instanceof Node;docFrag.appendChild(isNode?arg:document.createTextNode(String(arg)))})),this.appendChild(docFrag)}})}))},"./node_modules/@antv/x6/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ke:()=>Graph,VK:()=>Markup,bP:()=>Node,Yv:()=>NodeView,D5:()=>object_namespaceObject});var object_namespaceObject={};__webpack_require__.r(object_namespaceObject),__webpack_require__.d(object_namespaceObject,{applyMixins:()=>applyMixins,clone:()=>lodash_es_clone,cloneDeep:()=>lodash_es_cloneDeep,createClass:()=>createClass,defaults:()=>lodash_es_defaults,defaultsDeep:()=>lodash_es_defaultsDeep,ensure:()=>ensure,flatten:()=>object_flatten,getBoolean:()=>getBoolean,getByPath:()=>getByPath,getNumber:()=>getNumber,getValue:()=>object_getValue,has:()=>lodash_es_has,inherit:()=>inherit,isEmpty:()=>lodash_es_isEmpty,isEqual:()=>lodash_es_isEqual,isMaliciousProp:()=>isMaliciousProp,isObject:()=>lodash_es_isObject,isPlainObject:()=>lodash_es_isPlainObject,merge:()=>lodash_es_merge,pick:()=>lodash_es_pick,setByPath:()=>setByPath,unsetByPath:()=>unsetByPath});var grid_main_namespaceObject={};__webpack_require__.r(grid_main_namespaceObject),__webpack_require__.d(grid_main_namespaceObject,{dot:()=>dot,doubleMesh:()=>doubleMesh,fixedDot:()=>fixedDot,mesh:()=>mesh});var background_main_namespaceObject={};__webpack_require__.r(background_main_namespaceObject),__webpack_require__.d(background_main_namespaceObject,{flipX:()=>flipX,flipXY:()=>flipXY,flipY:()=>flipY,watermark:()=>watermark});var filter_main_namespaceObject={};__webpack_require__.r(filter_main_namespaceObject),__webpack_require__.d(filter_main_namespaceObject,{blur:()=>blur_blur,brightness:()=>brightness,contrast:()=>contrast,dropShadow:()=>dropShadow,grayScale:()=>grayScale,highlight:()=>highlight,hueRotate:()=>hueRotate,invert:()=>invert,outline:()=>outline,saturate:()=>saturate,sepia:()=>sepia});var marker_main_namespaceObject={};__webpack_require__.r(marker_main_namespaceObject),__webpack_require__.d(marker_main_namespaceObject,{async:()=>async_async,block:()=>block,circle:()=>circle,circlePlus:()=>circlePlus,classic:()=>classic,cross:()=>cross,diamond:()=>diamond,ellipse:()=>ellipse,path:()=>path});var attr_main_namespaceObject={};__webpack_require__.r(attr_main_namespaceObject),__webpack_require__.d(attr_main_namespaceObject,{annotations:()=>annotations,atConnectionLength:()=>atConnectionLength,atConnectionLengthIgnoreGradient:()=>atConnectionLengthIgnoreGradient,atConnectionLengthKeepGradient:()=>atConnectionLengthKeepGradient,atConnectionRatio:()=>atConnectionRatio,atConnectionRatioIgnoreGradient:()=>atConnectionRatioIgnoreGradient,atConnectionRatioKeepGradient:()=>atConnectionRatioKeepGradient,connection:()=>connection,displayEmpty:()=>displayEmpty,eol:()=>eol,fill:()=>fill,filter:()=>filter,html:()=>html,lineHeight:()=>lineHeight,port:()=>port,ref:()=>ref,refCx:()=>refCx,refCy:()=>refCy,refD:()=>refD,refDKeepOffset:()=>refDKeepOffset,refDResetOffset:()=>refDResetOffset,refDx:()=>refDx,refDy:()=>refDy,refHeight:()=>refHeight,refHeight2:()=>refHeight2,refPoints:()=>refPoints,refPointsKeepOffset:()=>refPointsKeepOffset,refPointsResetOffset:()=>refPointsResetOffset,refR:()=>refR,refRCircumscribed:()=>refRCircumscribed,refRInscribed:()=>refRInscribed,refRx:()=>refRx,refRy:()=>refRy,refWidth:()=>refWidth,refWidth2:()=>refWidth2,refX:()=>refX,refX2:()=>refX2,refY:()=>refY,refY2:()=>refY2,resetOffset:()=>resetOffset,sourceMarker:()=>sourceMarker,stroke:()=>stroke,style:()=>style,targetMarker:()=>targetMarker,text:()=>attr_text_text,textPath:()=>textPath,textVerticalAnchor:()=>textVerticalAnchor,textWrap:()=>textWrap,title:()=>title,vertexMarker:()=>vertexMarker,xAlign:()=>xAlign,yAlign:()=>yAlign});var highlighter_main_namespaceObject={};__webpack_require__.r(highlighter_main_namespaceObject),__webpack_require__.d(highlighter_main_namespaceObject,{className:()=>className,opacity:()=>opacity,stroke:()=>stroke_stroke});var port_layout_main_namespaceObject={};__webpack_require__.r(port_layout_main_namespaceObject),__webpack_require__.d(port_layout_main_namespaceObject,{absolute:()=>absolute,bottom:()=>bottom,ellipse:()=>ellipse_ellipse,ellipseSpread:()=>ellipseSpread,left:()=>left,line:()=>line,right:()=>right,top:()=>line_top});var port_label_layout_main_namespaceObject={};__webpack_require__.r(port_label_layout_main_namespaceObject),__webpack_require__.d(port_label_layout_main_namespaceObject,{bottom:()=>side_bottom,inside:()=>inside,insideOriented:()=>insideOriented,left:()=>side_left,manual:()=>manual,outside:()=>outside,outsideOriented:()=>outsideOriented,radial:()=>radial,radialOriented:()=>radialOriented,right:()=>side_right,top:()=>side_top});var connection_strategy_main_namespaceObject={};__webpack_require__.r(connection_strategy_main_namespaceObject),__webpack_require__.d(connection_strategy_main_namespaceObject,{noop:()=>noop_noop,pinAbsolute:()=>pinAbsolute,pinRelative:()=>pinRelative});var node_anchor_main_namespaceObject={};__webpack_require__.r(node_anchor_main_namespaceObject),__webpack_require__.d(node_anchor_main_namespaceObject,{bottom:()=>bbox_bottom,bottomLeft:()=>bottomLeft,bottomRight:()=>bottomRight,center:()=>center,left:()=>bbox_left,midSide:()=>midSide,nodeCenter:()=>nodeCenter,orth:()=>orth,right:()=>bbox_right,top:()=>bbox_top,topLeft:()=>topLeft,topRight:()=>topRight});var edge_anchor_main_namespaceObject={};__webpack_require__.r(edge_anchor_main_namespaceObject),__webpack_require__.d(edge_anchor_main_namespaceObject,{closest:()=>closest,length:()=>length_length,orth:()=>orth_orth,ratio:()=>ratio});var connection_point_main_namespaceObject={};__webpack_require__.r(connection_point_main_namespaceObject),__webpack_require__.d(connection_point_main_namespaceObject,{anchor:()=>anchor_anchor,bbox:()=>bbox,boundary:()=>boundary,rect:()=>rect});var router_main_namespaceObject={};__webpack_require__.r(router_main_namespaceObject),__webpack_require__.d(router_main_namespaceObject,{er:()=>er,loop:()=>loop,manhattan:()=>manhattan,metro:()=>metro,normal:()=>normal,oneSide:()=>oneSide,orth:()=>router_orth_orth});var connector_main_namespaceObject={};__webpack_require__.r(connector_main_namespaceObject),__webpack_require__.d(connector_main_namespaceObject,{jumpover:()=>jumpover,loop:()=>loop_loop,normal:()=>normal_normal,rounded:()=>rounded,smooth:()=>smooth});__webpack_require__("./node_modules/@antv/x6-common/es/polyfill/index.js");class Disposable{get disposed(){return!0===this._disposed}dispose(){this._disposed=!0}}!function(Disposable){Disposable.dispose=function dispose(){return(target,methodName,descriptor)=>{const raw=descriptor.value,proto=target.__proto__;descriptor.value=function(...args){this.disposed||(raw.call(this,...args),proto.dispose.call(this))}}}}(Disposable||(Disposable={}));class DisposableSet{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach((item=>{item.dispose()})),this.items.clear())}contains(item){return this.items.has(item)}add(item){this.items.add(item)}remove(item){this.items.delete(item)}clear(){this.items.clear()}}!function(DisposableSet){DisposableSet.from=function from(items){const set=new DisposableSet;return items.forEach((item=>{set.add(item)})),set}}(DisposableSet||(DisposableSet={}));const lodash_es_isObject=function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)};var _root=__webpack_require__("./node_modules/lodash-es/_root.js");const lodash_es_now=function(){return _root.A.Date.now()};var reWhitespace=/\s/;const _trimmedEndIndex=function trimmedEndIndex(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index};var reTrimStart=/^\s+/;const _baseTrim=function baseTrim(string){return string?string.slice(0,_trimmedEndIndex(string)+1).replace(reTrimStart,""):string};const _Symbol=_root.A.Symbol;var objectProto=Object.prototype,_getRawTag_hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;const _getRawTag=function getRawTag(value){var isOwn=_getRawTag_hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result};var _objectToString_nativeObjectToString=Object.prototype.toString;const _objectToString=function objectToString(value){return _objectToString_nativeObjectToString.call(value)};var _baseGetTag_symToStringTag=_Symbol?_Symbol.toStringTag:void 0;const _baseGetTag=function baseGetTag(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":_baseGetTag_symToStringTag&&_baseGetTag_symToStringTag in Object(value)?_getRawTag(value):_objectToString(value)};const lodash_es_isObjectLike=function isObjectLike(value){return null!=value&&"object"==typeof value};const lodash_es_isSymbol=function isSymbol(value){return"symbol"==typeof value||lodash_es_isObjectLike(value)&&"[object Symbol]"==_baseGetTag(value)};var reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;const lodash_es_toNumber=function toNumber(value){if("number"==typeof value)return value;if(lodash_es_isSymbol(value))return NaN;if(lodash_es_isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=lodash_es_isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=_baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value};var nativeMax=Math.max,nativeMin=Math.min;const lodash_es_debounce=function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=lodash_es_now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function remainingWait(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=lodash_es_now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=lodash_es_toNumber(wait)||0,lodash_es_isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(lodash_es_toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function cancel(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function flush(){return void 0===timerId?result:trailingEdge(lodash_es_now())},debounced};const lodash_es_throttle=function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");return lodash_es_isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),lodash_es_debounce(func,wait,{leading,maxWait:wait,trailing})};function apply(fn,ctx,args){if(args)switch(args.length){case 0:return fn.call(ctx);case 1:return fn.call(ctx,args[0]);case 2:return fn.call(ctx,args[0],args[1]);case 3:return fn.call(ctx,args[0],args[1],args[2]);case 4:return fn.call(ctx,args[0],args[1],args[2],args[3]);case 5:return fn.call(ctx,args[0],args[1],args[2],args[3],args[4]);case 6:return fn.call(ctx,args[0],args[1],args[2],args[3],args[4],args[5]);default:return fn.apply(ctx,args)}return fn.call(ctx)}function call(fn,ctx,...args){return apply(fn,ctx,args)}function isAsync(obj){return null!=obj&&(obj instanceof Promise||function isAsyncLike(obj){return"object"==typeof obj&&obj.then&&"function"==typeof obj.then}(obj))}function toAsyncBoolean(...inputs){const results=[];inputs.forEach((arg=>{Array.isArray(arg)?results.push(...arg):results.push(arg)}));if(results.some((res=>isAsync(res)))){const deferres=results.map((res=>isAsync(res)?res:Promise.resolve(!1!==res)));return Promise.all(deferres).then((arr=>arr.reduce(((memo,item)=>!1!==item&&memo),!0)))}return results.every((res=>!1!==res))}function util_call(list,args){const results=[];for(let i=0;i<list.length;i+=2){const ret=apply(list[i],list[i+1],Array.isArray(args)?args:[args]);results.push(ret)}return toAsyncBoolean(results)}class Events{constructor(){this.listeners={}}on(name,handler,context){if(null==handler)return this;this.listeners[name]||(this.listeners[name]=[]);return this.listeners[name].push(handler,context),this}once(name,handler,context){const cb=(...args)=>(this.off(name,cb),util_call([handler,context],args));return this.on(name,cb,this)}off(name,handler,context){if(!(name||handler||context))return this.listeners={},this;const listeners=this.listeners;return(name?[name]:Object.keys(listeners)).forEach((n=>{const cache=listeners[n];if(cache)if(handler||context)for(let i=cache.length-2;i>=0;i-=2)handler&&cache[i]!==handler||context&&cache[i+1]!==context||cache.splice(i,2);else delete listeners[n]})),this}trigger(name,...args){let returned=!0;if("*"!==name){const list=this.listeners[name];null!=list&&(returned=util_call([...list],args))}const list=this.listeners["*"];return null!=list?toAsyncBoolean([returned,util_call([...list],[name,...args])]):returned}emit(name,...args){return this.trigger(name,...args)}}var _baseHas_hasOwnProperty=Object.prototype.hasOwnProperty;const _baseHas=function baseHas(object,key){return null!=object&&_baseHas_hasOwnProperty.call(object,key)};const lodash_es_isArray=Array.isArray;var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;const _isKey=function isKey(value,object){if(lodash_es_isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!lodash_es_isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))};const lodash_es_isFunction=function isFunction(value){if(!lodash_es_isObject(value))return!1;var tag=_baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag};const _coreJsData=_root.A["__core-js_shared__"];var uid,maskSrcKey=(uid=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";const _isMasked=function isMasked(func){return!!maskSrcKey&&maskSrcKey in func};var funcToString=Function.prototype.toString;const _toSource=function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""};var reIsHostCtor=/^\[object .+?Constructor\]$/,_baseIsNative_funcProto=Function.prototype,_baseIsNative_objectProto=Object.prototype,_baseIsNative_funcToString=_baseIsNative_funcProto.toString,_baseIsNative_hasOwnProperty=_baseIsNative_objectProto.hasOwnProperty,reIsNative=RegExp("^"+_baseIsNative_funcToString.call(_baseIsNative_hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const _baseIsNative=function baseIsNative(value){return!(!lodash_es_isObject(value)||_isMasked(value))&&(lodash_es_isFunction(value)?reIsNative:reIsHostCtor).test(_toSource(value))};const _getValue=function getValue(object,key){return null==object?void 0:object[key]};const _getNative=function getNative(object,key){var value=_getValue(object,key);return _baseIsNative(value)?value:void 0};const _nativeCreate=_getNative(Object,"create");const _hashClear=function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0};const _hashDelete=function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result};var _hashGet_hasOwnProperty=Object.prototype.hasOwnProperty;const _hashGet=function hashGet(key){var data=this.__data__;if(_nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return _hashGet_hasOwnProperty.call(data,key)?data[key]:void 0};var _hashHas_hasOwnProperty=Object.prototype.hasOwnProperty;const _hashHas=function hashHas(key){var data=this.__data__;return _nativeCreate?void 0!==data[key]:_hashHas_hasOwnProperty.call(data,key)};const _hashSet=function hashSet(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=_nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this};function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;const _Hash=Hash;const _listCacheClear=function listCacheClear(){this.__data__=[],this.size=0};const lodash_es_eq=function eq(value,other){return value===other||value!=value&&other!=other};const _assocIndexOf=function assocIndexOf(array,key){for(var length=array.length;length--;)if(lodash_es_eq(array[length][0],key))return length;return-1};var splice=Array.prototype.splice;const _listCacheDelete=function listCacheDelete(key){var data=this.__data__,index=_assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)};const _listCacheGet=function listCacheGet(key){var data=this.__data__,index=_assocIndexOf(data,key);return index<0?void 0:data[index][1]};const _listCacheHas=function listCacheHas(key){return _assocIndexOf(this.__data__,key)>-1};const _listCacheSet=function listCacheSet(key,value){var data=this.__data__,index=_assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this};function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;const _ListCache=ListCache;const _Map=_getNative(_root.A,"Map");const _mapCacheClear=function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}};const _isKeyable=function isKeyable(value){var type=typeof value;return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value};const _getMapData=function getMapData(map,key){var data=map.__data__;return _isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map};const _mapCacheDelete=function mapCacheDelete(key){var result=_getMapData(this,key).delete(key);return this.size-=result?1:0,result};const _mapCacheGet=function mapCacheGet(key){return _getMapData(this,key).get(key)};const _mapCacheHas=function mapCacheHas(key){return _getMapData(this,key).has(key)};const _mapCacheSet=function mapCacheSet(key,value){var data=_getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this};function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;const _MapCache=MapCache;function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError("Expected a function");var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||_MapCache),memoized}memoize.Cache=_MapCache;const lodash_es_memoize=memoize;var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g;const _stringToPath=function memoizeCapped(func){var result=lodash_es_memoize(func,(function(key){return 500===cache.size&&cache.clear(),key})),cache=result.cache;return result}((function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)})),result}));const _arrayMap=function arrayMap(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result};var symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;const _baseToString=function baseToString(value){if("string"==typeof value)return value;if(lodash_es_isArray(value))return _arrayMap(value,baseToString)+"";if(lodash_es_isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result};const lodash_es_toString=function toString_toString(value){return null==value?"":_baseToString(value)};const _castPath=function castPath(value,object){return lodash_es_isArray(value)?value:_isKey(value,object)?[value]:_stringToPath(lodash_es_toString(value))};const _baseIsArguments=function baseIsArguments(value){return lodash_es_isObjectLike(value)&&"[object Arguments]"==_baseGetTag(value)};var isArguments_objectProto=Object.prototype,isArguments_hasOwnProperty=isArguments_objectProto.hasOwnProperty,propertyIsEnumerable=isArguments_objectProto.propertyIsEnumerable;const lodash_es_isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(value){return lodash_es_isObjectLike(value)&&isArguments_hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};var reIsUint=/^(?:0|[1-9]\d*)$/;const _isIndex=function isIndex(value,length){var type=typeof value;return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length};const lodash_es_isLength=function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991};const _toKey=function toKey(value){if("string"==typeof value||lodash_es_isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result};const _hasPath=function hasPath(object,path,hasFunc){for(var index=-1,length=(path=_castPath(path,object)).length,result=!1;++index<length;){var key=_toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&lodash_es_isLength(length)&&_isIndex(key,length)&&(lodash_es_isArray(object)||lodash_es_isArguments(object))};const lodash_es_has=function has(object,path){return null!=object&&_hasPath(object,path,_baseHas)};const _baseGet=function baseGet(object,path){for(var index=0,length=(path=_castPath(path,object)).length;null!=object&&index<length;)object=object[_toKey(path[index++])];return index&&index==length?object:void 0};const _defineProperty=function(){try{var func=_getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();const _baseAssignValue=function baseAssignValue(object,key,value){"__proto__"==key&&_defineProperty?_defineProperty(object,key,{configurable:!0,enumerable:!0,value,writable:!0}):object[key]=value};var _assignValue_hasOwnProperty=Object.prototype.hasOwnProperty;const _assignValue=function assignValue(object,key,value){var objValue=object[key];_assignValue_hasOwnProperty.call(object,key)&&lodash_es_eq(objValue,value)&&(void 0!==value||key in object)||_baseAssignValue(object,key,value)};const _baseSet=function baseSet(object,path,value,customizer){if(!lodash_es_isObject(object))return object;for(var index=-1,length=(path=_castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=_toKey(path[index]),newValue=value;if("__proto__"===key||"constructor"===key||"prototype"===key)return object;if(index!=lastIndex){var objValue=nested[key];void 0===(newValue=customizer?customizer(objValue,key,nested):void 0)&&(newValue=lodash_es_isObject(objValue)?objValue:_isIndex(path[index+1])?[]:{})}_assignValue(nested,key,newValue),nested=nested[key]}return object};const _basePickBy=function basePickBy(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=_baseGet(object,path);predicate(value,path)&&_baseSet(result,_castPath(path,object),value)}return result};const _baseHasIn=function baseHasIn(object,key){return null!=object&&key in Object(object)};const lodash_es_hasIn=function hasIn(object,path){return null!=object&&_hasPath(object,path,_baseHasIn)};const _basePick=function basePick(object,paths){return _basePickBy(object,paths,(function(value,path){return lodash_es_hasIn(object,path)}))};const _arrayPush=function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array};var spreadableSymbol=_Symbol?_Symbol.isConcatSpreadable:void 0;const _isFlattenable=function isFlattenable(value){return lodash_es_isArray(value)||lodash_es_isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])};const _baseFlatten=function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=_isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):_arrayPush(result,value):isStrict||(result[result.length]=value)}return result};const lodash_es_flatten=function flatten(array){return(null==array?0:array.length)?_baseFlatten(array,1):[]};const _apply=function _apply_apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)};var _overRest_nativeMax=Math.max;const _overRest=function overRest(func,start,transform){return start=_overRest_nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=_overRest_nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),_apply(func,this,otherArgs)}};const lodash_es_constant=function constant(value){return function(){return value}};const lodash_es_identity=function identity(value){return value};const _baseSetToString=_defineProperty?function(func,string){return _defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:lodash_es_constant(string),writable:!0})}:lodash_es_identity;var nativeNow=Date.now;const _setToString=function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=800)return arguments[0]}else count=0;return func.apply(void 0,arguments)}}(_baseSetToString);const lodash_es_pick=function flatRest(func){return _setToString(_overRest(func,void 0,lodash_es_flatten),func+"")}((function(object,paths){return null==object?{}:_basePick(object,paths)}));const _stackClear=function stackClear(){this.__data__=new _ListCache,this.size=0};const _stackDelete=function stackDelete(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result};const _stackGet=function stackGet(key){return this.__data__.get(key)};const _stackHas=function stackHas(key){return this.__data__.has(key)};const _stackSet=function stackSet(key,value){var data=this.__data__;if(data instanceof _ListCache){var pairs=data.__data__;if(!_Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new _MapCache(pairs)}return data.set(key,value),this.size=data.size,this};function Stack(entries){var data=this.__data__=new _ListCache(entries);this.size=data.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;const _Stack=Stack;const _assignMergeValue=function assignMergeValue(object,key,value){(void 0!==value&&!lodash_es_eq(object[key],value)||void 0===value&&!(key in object))&&_baseAssignValue(object,key,value)};const _createBaseFor=function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}};const _baseFor=_createBaseFor();var _cloneBuffer=__webpack_require__("./node_modules/lodash-es/_cloneBuffer.js");const _Uint8Array=_root.A.Uint8Array;const _cloneArrayBuffer=function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new _Uint8Array(result).set(new _Uint8Array(arrayBuffer)),result};const _cloneTypedArray=function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?_cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)};const _copyArray=function copyArray(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array};var objectCreate=Object.create;const _baseCreate=function(){function object(){}return function(proto){if(!lodash_es_isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=void 0,result}}();const _overArg=function overArg(func,transform){return function(arg){return func(transform(arg))}};const _getPrototype=_overArg(Object.getPrototypeOf,Object);var _isPrototype_objectProto=Object.prototype;const _isPrototype=function isPrototype(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||_isPrototype_objectProto)};const _initCloneObject=function initCloneObject(object){return"function"!=typeof object.constructor||_isPrototype(object)?{}:_baseCreate(_getPrototype(object))};const lodash_es_isArrayLike=function isArrayLike(value){return null!=value&&lodash_es_isLength(value.length)&&!lodash_es_isFunction(value)};const lodash_es_isArrayLikeObject=function isArrayLikeObject(value){return lodash_es_isObjectLike(value)&&lodash_es_isArrayLike(value)};var isBuffer=__webpack_require__("./node_modules/lodash-es/isBuffer.js"),isPlainObject_funcProto=Function.prototype,isPlainObject_objectProto=Object.prototype,isPlainObject_funcToString=isPlainObject_funcProto.toString,isPlainObject_hasOwnProperty=isPlainObject_objectProto.hasOwnProperty,objectCtorString=isPlainObject_funcToString.call(Object);const lodash_es_isPlainObject=function isPlainObject(value){if(!lodash_es_isObjectLike(value)||"[object Object]"!=_baseGetTag(value))return!1;var proto=_getPrototype(value);if(null===proto)return!0;var Ctor=isPlainObject_hasOwnProperty.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&isPlainObject_funcToString.call(Ctor)==objectCtorString};var typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1;const _baseIsTypedArray=function baseIsTypedArray(value){return lodash_es_isObjectLike(value)&&lodash_es_isLength(value.length)&&!!typedArrayTags[_baseGetTag(value)]};const _baseUnary=function baseUnary(func){return function(value){return func(value)}};var _nodeUtil=__webpack_require__("./node_modules/lodash-es/_nodeUtil.js"),nodeIsTypedArray=_nodeUtil.A&&_nodeUtil.A.isTypedArray;const lodash_es_isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray;const _safeGet=function safeGet(object,key){if(("constructor"!==key||"function"!=typeof object[key])&&"__proto__"!=key)return object[key]};const _copyObject=function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;void 0===newValue&&(newValue=source[key]),isNew?_baseAssignValue(object,key,newValue):_assignValue(object,key,newValue)}return object};const _baseTimes=function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result};var _arrayLikeKeys_hasOwnProperty=Object.prototype.hasOwnProperty;const _arrayLikeKeys=function arrayLikeKeys(value,inherited){var isArr=lodash_es_isArray(value),isArg=!isArr&&lodash_es_isArguments(value),isBuff=!isArr&&!isArg&&(0,isBuffer.A)(value),isType=!isArr&&!isArg&&!isBuff&&lodash_es_isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?_baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!_arrayLikeKeys_hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||_isIndex(key,length))||result.push(key);return result};const _nativeKeysIn=function nativeKeysIn(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result};var _baseKeysIn_hasOwnProperty=Object.prototype.hasOwnProperty;const _baseKeysIn=function baseKeysIn(object){if(!lodash_es_isObject(object))return _nativeKeysIn(object);var isProto=_isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&_baseKeysIn_hasOwnProperty.call(object,key))&&result.push(key);return result};const lodash_es_keysIn=function keysIn(object){return lodash_es_isArrayLike(object)?_arrayLikeKeys(object,!0):_baseKeysIn(object)};const lodash_es_toPlainObject=function toPlainObject(value){return _copyObject(value,lodash_es_keysIn(value))};const _baseMergeDeep=function baseMergeDeep(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=_safeGet(object,key),srcValue=_safeGet(source,key),stacked=stack.get(srcValue);if(stacked)_assignMergeValue(object,key,stacked);else{var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):void 0,isCommon=void 0===newValue;if(isCommon){var isArr=lodash_es_isArray(srcValue),isBuff=!isArr&&(0,isBuffer.A)(srcValue),isTyped=!isArr&&!isBuff&&lodash_es_isTypedArray(srcValue);newValue=srcValue,isArr||isBuff||isTyped?lodash_es_isArray(objValue)?newValue=objValue:lodash_es_isArrayLikeObject(objValue)?newValue=_copyArray(objValue):isBuff?(isCommon=!1,newValue=(0,_cloneBuffer.A)(srcValue,!0)):isTyped?(isCommon=!1,newValue=_cloneTypedArray(srcValue,!0)):newValue=[]:lodash_es_isPlainObject(srcValue)||lodash_es_isArguments(srcValue)?(newValue=objValue,lodash_es_isArguments(objValue)?newValue=lodash_es_toPlainObject(objValue):lodash_es_isObject(objValue)&&!lodash_es_isFunction(objValue)||(newValue=_initCloneObject(srcValue))):isCommon=!1}isCommon&&(stack.set(srcValue,newValue),mergeFunc(newValue,srcValue,srcIndex,customizer,stack),stack.delete(srcValue)),_assignMergeValue(object,key,newValue)}};const _baseMerge=function baseMerge(object,source,srcIndex,customizer,stack){object!==source&&_baseFor(source,(function(srcValue,key){if(stack||(stack=new _Stack),lodash_es_isObject(srcValue))_baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);else{var newValue=customizer?customizer(_safeGet(object,key),srcValue,key+"",object,source,stack):void 0;void 0===newValue&&(newValue=srcValue),_assignMergeValue(object,key,newValue)}}),lodash_es_keysIn)};const _baseRest=function baseRest(func,start){return _setToString(_overRest(func,start,lodash_es_identity),func+"")};const _isIterateeCall=function isIterateeCall(value,index,object){if(!lodash_es_isObject(object))return!1;var type=typeof index;return!!("number"==type?lodash_es_isArrayLike(object)&&_isIndex(index,object.length):"string"==type&&index in object)&&lodash_es_eq(object[index],value)};const _createAssigner=function createAssigner(assigner){return _baseRest((function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:void 0,guard=length>2?sources[2]:void 0;for(customizer=assigner.length>3&&"function"==typeof customizer?(length--,customizer):void 0,guard&&_isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object}))};const lodash_es_merge=_createAssigner((function(object,source,srcIndex){_baseMerge(object,source,srcIndex)}));const _setCacheAdd=function setCacheAdd(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this};const _setCacheHas=function setCacheHas(value){return this.__data__.has(value)};function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new _MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd,SetCache.prototype.has=_setCacheHas;const _SetCache=SetCache;const _arraySome=function arraySome(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1};const _cacheHas=function cacheHas(cache,key){return cache.has(key)};const _equalArrays=function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new _SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!_arraySome(other,(function(othValue,othIndex){if(!_cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result};const _mapToArray=function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result};const _setToArray=function setToArray(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result};var _equalByTag_symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=_equalByTag_symbolProto?_equalByTag_symbolProto.valueOf:void 0;const _equalByTag=function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case"[object DataView]":if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case"[object ArrayBuffer]":return!(object.byteLength!=other.byteLength||!equalFunc(new _Uint8Array(object),new _Uint8Array(other)));case"[object Boolean]":case"[object Date]":case"[object Number]":return lodash_es_eq(+object,+other);case"[object Error]":return object.name==other.name&&object.message==other.message;case"[object RegExp]":case"[object String]":return object==other+"";case"[object Map]":var convert=_mapToArray;case"[object Set]":var isPartial=1&bitmask;if(convert||(convert=_setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=_equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case"[object Symbol]":if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1};const _baseGetAllKeys=function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return lodash_es_isArray(object)?result:_arrayPush(result,symbolsFunc(object))};const _arrayFilter=function arrayFilter(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result};const lodash_es_stubArray=function stubArray(){return[]};var _getSymbols_propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols;const _getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),_arrayFilter(nativeGetSymbols(object),(function(symbol){return _getSymbols_propertyIsEnumerable.call(object,symbol)})))}:lodash_es_stubArray;const _nativeKeys=_overArg(Object.keys,Object);var _baseKeys_hasOwnProperty=Object.prototype.hasOwnProperty;const _baseKeys=function baseKeys(object){if(!_isPrototype(object))return _nativeKeys(object);var result=[];for(var key in Object(object))_baseKeys_hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result};const lodash_es_keys=function keys(object){return lodash_es_isArrayLike(object)?_arrayLikeKeys(object):_baseKeys(object)};const _getAllKeys=function getAllKeys(object){return _baseGetAllKeys(object,lodash_es_keys,_getSymbols)};var _equalObjects_hasOwnProperty=Object.prototype.hasOwnProperty;const _equalObjects=function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=_getAllKeys(object),objLength=objProps.length;if(objLength!=_getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:_equalObjects_hasOwnProperty.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor==othCtor||!("constructor"in object)||!("constructor"in other)||"function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor||(result=!1)}return stack.delete(object),stack.delete(other),result};const _DataView=_getNative(_root.A,"DataView");const _Promise=_getNative(_root.A,"Promise");const _Set=_getNative(_root.A,"Set");const _WeakMap=_getNative(_root.A,"WeakMap");var dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag;(_DataView&&"[object DataView]"!=getTag(new _DataView(new ArrayBuffer(1)))||_Map&&"[object Map]"!=getTag(new _Map)||_Promise&&"[object Promise]"!=getTag(_Promise.resolve())||_Set&&"[object Set]"!=getTag(new _Set)||_WeakMap&&"[object WeakMap]"!=getTag(new _WeakMap))&&(getTag=function(value){var result=_baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?_toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result});const _getTag=getTag;var _baseIsEqualDeep_hasOwnProperty=Object.prototype.hasOwnProperty;const _baseIsEqualDeep=function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=lodash_es_isArray(object),othIsArr=lodash_es_isArray(other),objTag=objIsArr?"[object Array]":_getTag(object),othTag=othIsArr?"[object Array]":_getTag(other),objIsObj="[object Object]"==(objTag="[object Arguments]"==objTag?"[object Object]":objTag),othIsObj="[object Object]"==(othTag="[object Arguments]"==othTag?"[object Object]":othTag),isSameTag=objTag==othTag;if(isSameTag&&(0,isBuffer.A)(object)){if(!(0,isBuffer.A)(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new _Stack),objIsArr||lodash_es_isTypedArray(object)?_equalArrays(object,other,bitmask,customizer,equalFunc,stack):_equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&_baseIsEqualDeep_hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&_baseIsEqualDeep_hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new _Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new _Stack),_equalObjects(object,other,bitmask,customizer,equalFunc,stack))};const _baseIsEqual=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!lodash_es_isObjectLike(value)&&!lodash_es_isObjectLike(other)?value!=value&&other!=other:_baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))};const lodash_es_isEqual=function isEqual(value,other){return _baseIsEqual(value,other)};var isEmpty_hasOwnProperty=Object.prototype.hasOwnProperty;const lodash_es_isEmpty=function isEmpty(value){if(null==value)return!0;if(lodash_es_isArrayLike(value)&&(lodash_es_isArray(value)||"string"==typeof value||"function"==typeof value.splice||(0,isBuffer.A)(value)||lodash_es_isTypedArray(value)||lodash_es_isArguments(value)))return!value.length;var tag=_getTag(value);if("[object Map]"==tag||"[object Set]"==tag)return!value.size;if(_isPrototype(value))return!_baseKeys(value).length;for(var key in value)if(isEmpty_hasOwnProperty.call(value,key))return!1;return!0};const _arrayEach=function arrayEach(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array};const _baseAssign=function baseAssign(object,source){return object&&_copyObject(source,lodash_es_keys(source),object)};const _baseAssignIn=function baseAssignIn(object,source){return object&&_copyObject(source,lodash_es_keysIn(source),object)};const _copySymbols=function copySymbols(source,object){return _copyObject(source,_getSymbols(source),object)};const _getSymbolsIn=Object.getOwnPropertySymbols?function(object){for(var result=[];object;)_arrayPush(result,_getSymbols(object)),object=_getPrototype(object);return result}:lodash_es_stubArray;const _copySymbolsIn=function copySymbolsIn(source,object){return _copyObject(source,_getSymbolsIn(source),object)};const _getAllKeysIn=function getAllKeysIn(object){return _baseGetAllKeys(object,lodash_es_keysIn,_getSymbolsIn)};var _initCloneArray_hasOwnProperty=Object.prototype.hasOwnProperty;const _initCloneArray=function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&_initCloneArray_hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result};const _cloneDataView=function cloneDataView(dataView,isDeep){var buffer=isDeep?_cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)};var reFlags=/\w*$/;const _cloneRegExp=function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result};var _cloneSymbol_symbolProto=_Symbol?_Symbol.prototype:void 0,_cloneSymbol_symbolValueOf=_cloneSymbol_symbolProto?_cloneSymbol_symbolProto.valueOf:void 0;const _cloneSymbol=function cloneSymbol(symbol){return _cloneSymbol_symbolValueOf?Object(_cloneSymbol_symbolValueOf.call(symbol)):{}};const _initCloneByTag=function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case"[object ArrayBuffer]":return _cloneArrayBuffer(object);case"[object Boolean]":case"[object Date]":return new Ctor(+object);case"[object DataView]":return _cloneDataView(object,isDeep);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return _cloneTypedArray(object,isDeep);case"[object Map]":case"[object Set]":return new Ctor;case"[object Number]":case"[object String]":return new Ctor(object);case"[object RegExp]":return _cloneRegExp(object);case"[object Symbol]":return _cloneSymbol(object)}};const _baseIsMap=function baseIsMap(value){return lodash_es_isObjectLike(value)&&"[object Map]"==_getTag(value)};var nodeIsMap=_nodeUtil.A&&_nodeUtil.A.isMap;const lodash_es_isMap=nodeIsMap?_baseUnary(nodeIsMap):_baseIsMap;const _baseIsSet=function baseIsSet(value){return lodash_es_isObjectLike(value)&&"[object Set]"==_getTag(value)};var nodeIsSet=_nodeUtil.A&&_nodeUtil.A.isSet;const lodash_es_isSet=nodeIsSet?_baseUnary(nodeIsSet):_baseIsSet;var cloneableTags={};cloneableTags["[object Arguments]"]=cloneableTags["[object Array]"]=cloneableTags["[object ArrayBuffer]"]=cloneableTags["[object DataView]"]=cloneableTags["[object Boolean]"]=cloneableTags["[object Date]"]=cloneableTags["[object Float32Array]"]=cloneableTags["[object Float64Array]"]=cloneableTags["[object Int8Array]"]=cloneableTags["[object Int16Array]"]=cloneableTags["[object Int32Array]"]=cloneableTags["[object Map]"]=cloneableTags["[object Number]"]=cloneableTags["[object Object]"]=cloneableTags["[object RegExp]"]=cloneableTags["[object Set]"]=cloneableTags["[object String]"]=cloneableTags["[object Symbol]"]=cloneableTags["[object Uint8Array]"]=cloneableTags["[object Uint8ClampedArray]"]=cloneableTags["[object Uint16Array]"]=cloneableTags["[object Uint32Array]"]=!0,cloneableTags["[object Error]"]=cloneableTags["[object Function]"]=cloneableTags["[object WeakMap]"]=!1;const _baseClone=function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=1&bitmask,isFlat=2&bitmask,isFull=4&bitmask;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),void 0!==result)return result;if(!lodash_es_isObject(value))return value;var isArr=lodash_es_isArray(value);if(isArr){if(result=_initCloneArray(value),!isDeep)return _copyArray(value,result)}else{var tag=_getTag(value),isFunc="[object Function]"==tag||"[object GeneratorFunction]"==tag;if((0,isBuffer.A)(value))return(0,_cloneBuffer.A)(value,isDeep);if("[object Object]"==tag||"[object Arguments]"==tag||isFunc&&!object){if(result=isFlat||isFunc?{}:_initCloneObject(value),!isDeep)return isFlat?_copySymbolsIn(value,_baseAssignIn(result,value)):_copySymbols(value,_baseAssign(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=_initCloneByTag(value,tag,isDeep)}}stack||(stack=new _Stack);var stacked=stack.get(value);if(stacked)return stacked;stack.set(value,result),lodash_es_isSet(value)?value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))})):lodash_es_isMap(value)&&value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}));var props=isArr?void 0:(isFull?isFlat?_getAllKeysIn:_getAllKeys:isFlat?lodash_es_keysIn:lodash_es_keys)(value);return _arrayEach(props||value,(function(subValue,key){props&&(subValue=value[key=subValue]),_assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))})),result};const lodash_es_clone=function clone(value){return _baseClone(value,4)};const lodash_es_cloneDeep=function cloneDeep(value){return _baseClone(value,5)};var defaults_objectProto=Object.prototype,defaults_hasOwnProperty=defaults_objectProto.hasOwnProperty,defaults=_baseRest((function(object,sources){object=Object(object);var index=-1,length=sources.length,guard=length>2?sources[2]:void 0;for(guard&&_isIterateeCall(sources[0],sources[1],guard)&&(length=1);++index<length;)for(var source=sources[index],props=lodash_es_keysIn(source),propsIndex=-1,propsLength=props.length;++propsIndex<propsLength;){var key=props[propsIndex],value=object[key];(void 0===value||lodash_es_eq(value,defaults_objectProto[key])&&!defaults_hasOwnProperty.call(object,key))&&(object[key]=source[key])}return object}));const lodash_es_defaults=defaults;const _customDefaultsMerge=function customDefaultsMerge(objValue,srcValue,key,object,source,stack){return lodash_es_isObject(objValue)&&lodash_es_isObject(srcValue)&&(stack.set(srcValue,objValue),_baseMerge(objValue,srcValue,void 0,customDefaultsMerge,stack),stack.delete(srcValue)),objValue};const lodash_es_mergeWith=_createAssigner((function(object,source,srcIndex,customizer){_baseMerge(object,source,srcIndex,customizer)}));const lodash_es_defaultsDeep=_baseRest((function(args){return args.push(void 0,_customDefaultsMerge),_apply(lodash_es_mergeWith,void 0,args)}));function applyMixins(derivedCtor,...baseCtors){baseCtors.forEach((baseCtor=>{Object.getOwnPropertyNames(baseCtor.prototype).forEach((name=>{"constructor"!==name&&Object.defineProperty(derivedCtor.prototype,name,Object.getOwnPropertyDescriptor(baseCtor.prototype,name))}))}))}const extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(const p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])};function inherit(cls,base){function tmp(){this.constructor=cls}extendStatics(cls,base),cls.prototype=null===base?Object.create(base):(tmp.prototype=base.prototype,new tmp)}const isNativeClass=/^\s*class\s+/.test(`${class A{}}`)||/^\s*class\s*\{/.test(`${class{}}`);function createClass(className,base){let cls;return isNativeClass?cls=class extends base{}:(cls=function(){return base.apply(this,arguments)},inherit(cls,base)),Object.defineProperty(cls,"name",{value:className}),cls}function ensure(value,defaultValue){return null!=value?value:defaultValue}function object_getValue(obj,key,defaultValue){const value=null!=obj?obj[key]:null;return void 0!==defaultValue?ensure(value,defaultValue):value}function getNumber(obj,key,defaultValue){let value=null!=obj?obj[key]:null;return null==value?defaultValue:(value=+value,Number.isNaN(value)||!Number.isFinite(value)?defaultValue:value)}function getBoolean(obj,key,defaultValue){const value=null!=obj?obj[key]:null;return null==value?defaultValue:!!value}function isMaliciousProp(prop){return"__proto__"===prop}function getByPath(obj,path,delimiter="/"){let ret;const keys=Array.isArray(path)?path:path.split(delimiter);if(keys.length)for(ret=obj;keys.length;){const key=keys.shift();if(Object(ret)!==ret||!key||!(key in ret))return;ret=ret[key]}return ret}function setByPath(obj,path,value,delimiter="/"){const keys=Array.isArray(path)?path:path.split(delimiter),lastKey=keys.pop();if(lastKey&&!isMaliciousProp(lastKey)){let diver=obj;keys.forEach((key=>{isMaliciousProp(key)||(null==diver[key]&&(diver[key]={}),diver=diver[key])})),diver[lastKey]=value}return obj}function unsetByPath(obj,path,delimiter="/"){const keys=Array.isArray(path)?path.slice():path.split(delimiter),propertyToRemove=keys.pop();if(propertyToRemove)if(keys.length>0){const parent=getByPath(obj,keys);parent&&delete parent[propertyToRemove]}else delete obj[propertyToRemove];return obj}function object_flatten(obj,delim="/",stop){const ret={};Object.keys(obj).forEach((key=>{const val=obj[key];let deep="object"==typeof val||Array.isArray(val);if(deep&&stop&&stop(val)&&(deep=!1),deep){const flatObject=object_flatten(val,delim,stop);Object.keys(flatObject).forEach((flatKey=>{ret[key+delim+flatKey]=flatObject[flatKey]}))}else ret[key]=val}));for(const key in obj)Object.prototype.hasOwnProperty.call(obj,key);return ret}var __decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class basecoat_Basecoat extends Events{dispose(){this.off()}}__decorate([Disposable.dispose()],basecoat_Basecoat.prototype,"dispose",null),function(Basecoat){Basecoat.dispose=Disposable.dispose}(basecoat_Basecoat||(basecoat_Basecoat={})),applyMixins(basecoat_Basecoat,Disposable);const _baseFindIndex=function baseFindIndex(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1};const _baseIsNaN=function baseIsNaN(value){return value!=value};const _strictIndexOf=function strictIndexOf(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1};const _baseIndexOf=function baseIndexOf(array,value,fromIndex){return value==value?_strictIndexOf(array,value,fromIndex):_baseFindIndex(array,_baseIsNaN,fromIndex)};const _arrayIncludes=function arrayIncludes(array,value){return!!(null==array?0:array.length)&&_baseIndexOf(array,value,0)>-1};const _arrayIncludesWith=function arrayIncludesWith(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1};const lodash_es_noop=function noop(){};const _createSet=_Set&&1/_setToArray(new _Set([,-0]))[1]==1/0?function(values){return new _Set(values)}:lodash_es_noop;const _baseUniq=function baseUniq(array,iteratee,comparator){var index=-1,includes=_arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=_arrayIncludesWith;else if(length>=200){var set=iteratee?null:_createSet(array);if(set)return _setToArray(set);isCommon=!1,includes=_cacheHas,seen=new _SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result};const lodash_es_uniq=function uniq(array){return array&&array.length?_baseUniq(array):[]};const lodash_es_union=_baseRest((function(arrays){return _baseUniq(_baseFlatten(arrays,1,lodash_es_isArrayLikeObject,!0))}));var nativeFloor=Math.floor,_baseSortedIndexBy_nativeMin=Math.min;const _baseSortedIndexBy=function baseSortedIndexBy(array,value,iteratee,retHighest){var low=0,high=null==array?0:array.length;if(0===high)return 0;for(var valIsNaN=(value=iteratee(value))!=value,valIsNull=null===value,valIsSymbol=lodash_es_isSymbol(value),valIsUndefined=void 0===value;low<high;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),othIsDefined=void 0!==computed,othIsNull=null===computed,othIsReflexive=computed==computed,othIsSymbol=lodash_es_isSymbol(computed);if(valIsNaN)var setLow=retHighest||othIsReflexive;else setLow=valIsUndefined?othIsReflexive&&(retHighest||othIsDefined):valIsNull?othIsReflexive&&othIsDefined&&(retHighest||!othIsNull):valIsSymbol?othIsReflexive&&othIsDefined&&!othIsNull&&(retHighest||!othIsSymbol):!othIsNull&&!othIsSymbol&&(retHighest?computed<=value:computed<value);setLow?low=mid+1:high=mid}return _baseSortedIndexBy_nativeMin(high,4294967294)};const _baseSortedIndex=function baseSortedIndex(array,value,retHighest){var low=0,high=null==array?low:array.length;if("number"==typeof value&&value==value&&high<=2147483647){for(;low<high;){var mid=low+high>>>1,computed=array[mid];null!==computed&&!lodash_es_isSymbol(computed)&&(retHighest?computed<=value:computed<value)?low=mid+1:high=mid}return high}return _baseSortedIndexBy(array,value,lodash_es_identity,retHighest)};const lodash_es_sortedIndex=function sortedIndex(array,value){return _baseSortedIndex(array,value)};const _baseIsMatch=function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new _Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?_baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0};const _isStrictComparable=function isStrictComparable(value){return value==value&&!lodash_es_isObject(value)};const _getMatchData=function getMatchData(object){for(var result=lodash_es_keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,_isStrictComparable(value)]}return result};const _matchesStrictComparable=function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(void 0!==srcValue||key in Object(object)))}};const _baseMatches=function baseMatches(source){var matchData=_getMatchData(source);return 1==matchData.length&&matchData[0][2]?_matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||_baseIsMatch(object,source,matchData)}};const lodash_es_get=function get(object,path,defaultValue){var result=null==object?void 0:_baseGet(object,path);return void 0===result?defaultValue:result};const _baseMatchesProperty=function baseMatchesProperty(path,srcValue){return _isKey(path)&&_isStrictComparable(srcValue)?_matchesStrictComparable(_toKey(path),srcValue):function(object){var objValue=lodash_es_get(object,path);return void 0===objValue&&objValue===srcValue?lodash_es_hasIn(object,path):_baseIsEqual(srcValue,objValue,3)}};const _baseProperty=function baseProperty(key){return function(object){return null==object?void 0:object[key]}};const _basePropertyDeep=function basePropertyDeep(path){return function(object){return _baseGet(object,path)}};const lodash_es_property=function property(path){return _isKey(path)?_baseProperty(_toKey(path)):_basePropertyDeep(path)};const _baseIteratee=function baseIteratee(value){return"function"==typeof value?value:null==value?lodash_es_identity:"object"==typeof value?lodash_es_isArray(value)?_baseMatchesProperty(value[0],value[1]):_baseMatches(value):lodash_es_property(value)};const lodash_es_sortedIndexBy=function sortedIndexBy(array,value,iteratee){return _baseSortedIndexBy(array,value,_baseIteratee(iteratee,2))};const _createBaseEach=function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!lodash_es_isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}};const _baseEach=_createBaseEach((function baseForOwn(object,iteratee){return object&&_baseFor(object,iteratee,lodash_es_keys)}));const _baseMap=function baseMap(collection,iteratee){var index=-1,result=lodash_es_isArrayLike(collection)?Array(collection.length):[];return _baseEach(collection,(function(value,key,collection){result[++index]=iteratee(value,key,collection)})),result};const _baseSortBy=function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array};const _compareAscending=function compareAscending(value,other){if(value!==other){var valIsDefined=void 0!==value,valIsNull=null===value,valIsReflexive=value==value,valIsSymbol=lodash_es_isSymbol(value),othIsDefined=void 0!==other,othIsNull=null===other,othIsReflexive=other==other,othIsSymbol=lodash_es_isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0};const _compareMultiple=function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=_compareAscending(objCriteria[index],othCriteria[index]);if(result)return index>=ordersLength?result:result*("desc"==orders[index]?-1:1)}return object.index-other.index};const _baseOrderBy=function baseOrderBy(collection,iteratees,orders){iteratees=iteratees.length?_arrayMap(iteratees,(function(iteratee){return lodash_es_isArray(iteratee)?function(value){return _baseGet(value,1===iteratee.length?iteratee[0]:iteratee)}:iteratee})):[lodash_es_identity];var index=-1;iteratees=_arrayMap(iteratees,_baseUnary(_baseIteratee));var result=_baseMap(collection,(function(value,key,collection){return{criteria:_arrayMap(iteratees,(function(iteratee){return iteratee(value)})),index:++index,value}}));return _baseSortBy(result,(function(object,other){return _compareMultiple(object,other,orders)}))};const lodash_es_sortBy=_baseRest((function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&_isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&_isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),_baseOrderBy(collection,_baseFlatten(iteratees,1),[])}));const _arrayAggregator=function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator};const _baseAggregator=function baseAggregator(collection,setter,iteratee,accumulator){return _baseEach(collection,(function(value,key,collection){setter(accumulator,value,iteratee(value),collection)})),accumulator};const _createAggregator=function createAggregator(setter,initializer){return function(collection,iteratee){var func=lodash_es_isArray(collection)?_arrayAggregator:_baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,_baseIteratee(iteratee,2),accumulator)}};var groupBy_hasOwnProperty=Object.prototype.hasOwnProperty;const lodash_es_groupBy=_createAggregator((function(result,value,key){groupBy_hasOwnProperty.call(result,key)?result[key].push(value):_baseAssignValue(result,key,[value])}));const _baseDifference=function baseDifference(array,values,iteratee,comparator){var index=-1,includes=_arrayIncludes,isCommon=!0,length=array.length,result=[],valuesLength=values.length;if(!length)return result;iteratee&&(values=_arrayMap(values,_baseUnary(iteratee))),comparator?(includes=_arrayIncludesWith,isCommon=!1):values.length>=200&&(includes=_cacheHas,isCommon=!1,values=new _SetCache(values));outer:for(;++index<length;){var value=array[index],computed=null==iteratee?value:iteratee(value);if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===computed)continue outer;result.push(value)}else includes(values,computed,comparator)||result.push(value)}return result};const lodash_es_difference=_baseRest((function(array,values){return lodash_es_isArrayLikeObject(array)?_baseDifference(array,_baseFlatten(values,1,lodash_es_isArrayLikeObject,!0)):[]}));const _baseExtremum=function baseExtremum(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var value=array[index],current=iteratee(value);if(null!=current&&(void 0===computed?current==current&&!lodash_es_isSymbol(current):comparator(current,computed)))var computed=current,result=value}return result};const _baseGt=function baseGt(value,other){return value>other};const lodash_es_max=function max(array){return array&&array.length?_baseExtremum(array,lodash_es_identity,_baseGt):void 0};const _arrayReduce=function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator};const _deburrLetter=function basePropertyOf(object){return function(key){return null==object?void 0:object[key]}}({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"});var reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,reComboMark=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");const lodash_es_deburr=function deburr(string){return(string=lodash_es_toString(string))&&string.replace(reLatin,_deburrLetter).replace(reComboMark,"")};var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;const _asciiWords=function asciiWords(string){return string.match(reAsciiWord)||[]};var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;const _hasUnicodeWord=function hasUnicodeWord(string){return reHasUnicodeWord.test(string)};var rsBreakRange="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsBreak="["+rsBreakRange+"]",rsDigits="\\d+",rsDingbat="[\\u2700-\\u27bf]",rsLower="[a-z\\xdf-\\xf6\\xf8-\\xff]",rsMisc="[^\\ud800-\\udfff"+rsBreakRange+rsDigits+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",reOptMod="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",rsSeq="[\\ufe0e\\ufe0f]?"+reOptMod+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*"),rsEmoji="(?:"+[rsDingbat,rsRegional,rsSurrPair].join("|")+")"+rsSeq,reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+(?:['](?:d|ll|m|re|s|t|ve))?",rsUpper+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsDigits,rsEmoji].join("|"),"g");const _unicodeWords=function unicodeWords(string){return string.match(reUnicodeWord)||[]};const lodash_es_words=function words(string,pattern,guard){return string=lodash_es_toString(string),void 0===(pattern=guard?void 0:pattern)?_hasUnicodeWord(string)?_unicodeWords(string):_asciiWords(string):string.match(pattern)||[]};var reApos=RegExp("[']","g");const _createCompounder=function createCompounder(callback){return function(string){return _arrayReduce(lodash_es_words(lodash_es_deburr(string).replace(reApos,"")),callback,"")}};const _baseSlice=function baseSlice(array,start,end){var index=-1,length=array.length;start<0&&(start=-start>length?0:length+start),(end=end>length?length:end)<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result};const _castSlice=function castSlice(array,start,end){var length=array.length;return end=void 0===end?length:end,!start&&end>=length?array:_baseSlice(array,start,end)};var reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");const _hasUnicode=function hasUnicode(string){return reHasUnicode.test(string)};const _asciiToArray=function asciiToArray(string){return string.split("")};var rsAstral="[\\ud800-\\udfff]",_unicodeToArray_rsCombo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",_unicodeToArray_rsNonAstral="[^\\ud800-\\udfff]",_unicodeToArray_rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",_unicodeToArray_rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",_unicodeToArray_reOptMod="(?:"+_unicodeToArray_rsCombo+"|\\ud83c[\\udffb-\\udfff])"+"?",_unicodeToArray_rsSeq="[\\ufe0e\\ufe0f]?"+_unicodeToArray_reOptMod+("(?:\\u200d(?:"+[_unicodeToArray_rsNonAstral,_unicodeToArray_rsRegional,_unicodeToArray_rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+_unicodeToArray_reOptMod+")*"),rsSymbol="(?:"+[_unicodeToArray_rsNonAstral+_unicodeToArray_rsCombo+"?",_unicodeToArray_rsCombo,_unicodeToArray_rsRegional,_unicodeToArray_rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+rsSymbol+_unicodeToArray_rsSeq,"g");const _unicodeToArray=function unicodeToArray(string){return string.match(reUnicode)||[]};const _stringToArray=function stringToArray(string){return _hasUnicode(string)?_unicodeToArray(string):_asciiToArray(string)};const _createCaseFirst=function createCaseFirst(methodName){return function(string){string=lodash_es_toString(string);var strSymbols=_hasUnicode(string)?_stringToArray(string):void 0,chr=strSymbols?strSymbols[0]:string.charAt(0),trailing=strSymbols?_castSlice(strSymbols,1).join(""):string.slice(1);return chr[methodName]()+trailing}};const lodash_es_upperFirst=_createCaseFirst("toUpperCase");var startCase=_createCompounder((function(result,word,index){return result+(index?" ":"")+lodash_es_upperFirst(word)}));const lodash_es_startCase=startCase;const lodash_es_capitalize=function capitalize(string){return lodash_es_upperFirst(lodash_es_toString(string).toLowerCase())};var camelCase=_createCompounder((function(result,word,index){return word=word.toLowerCase(),result+(index?lodash_es_capitalize(word):word)}));const lodash_es_camelCase=camelCase;var upperCase=_createCompounder((function(result,word,index){return result+(index?" ":"")+word.toUpperCase()}));const lodash_es_upperCase=upperCase;var lowerCase=_createCompounder((function(result,word,index){return result+(index?" ":"")+word.toLowerCase()}));const lodash_es_lowerCase=lowerCase;const lodash_es_lowerFirst=_createCaseFirst("toLowerCase"),cacheStringFunction=fn=>{const cache=Object.create(null);return str=>cache[str]||(cache[str]=fn(str))},kebabCase=cacheStringFunction((s=>s.replace(/\B([A-Z])/g,"-$1").toLowerCase())),pascalCase=cacheStringFunction((s=>lodash_es_startCase(lodash_es_camelCase(s)).replace(/ /g,"")));cacheStringFunction((s=>lodash_es_upperCase(s).replace(/ /g,"_"))),cacheStringFunction((s=>lodash_es_lowerCase(s).replace(/ /g,"."))),cacheStringFunction((s=>lodash_es_lowerCase(s).replace(/ /g,"/"))),cacheStringFunction((s=>lodash_es_upperFirst(lodash_es_lowerCase(s)))),cacheStringFunction((s=>lodash_es_startCase(lodash_es_camelCase(s))));function hashcode(str){let hash=2166136261,isUnicoded=!1,string=str;for(let i=0,ii=string.length;i<ii;i+=1){let characterCode=string.charCodeAt(i);characterCode>127&&!isUnicoded&&(string=unescape(encodeURIComponent(string)),characterCode=string.charCodeAt(i),isUnicoded=!0),hash^=characterCode,hash+=(hash<<1)+(hash<<4)+(hash<<7)+(hash<<8)+(hash<<24)}return hash>>>0}function uuid(){let res="";const template="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let i=0,len=36;i<len;i+=1){const s=template[i],r=16*Math.random()|0;res+=("x"===s?r:"y"===s?3&r|8:s).toString(16)}return res}function levenshteinWithMax(s1,s2,max){let previous=new Array(s2.length+1),current=new Array(s2.length+1);const big=max+1;for(let i=0;i<=s2.length;i+=1)previous[i]=i;for(let i=1;i<=s1.length;i+=1){const c1=s1.charCodeAt(i-1),minJ=i>max?i-max:1,maxJ=s2.length>max+i?max+i:s2.length;current[0]=i;let colMin=i;for(let j=1;j<minJ;j+=1)current[j]=big;for(let j=minJ;j<=maxJ;j+=1){const dist=c1===s2.charCodeAt(j-1)?previous[j-1]:Math.min(previous[j]+1,current[j-1]+1,previous[j-1]+2);current[j]=dist,colMin=Math.min(colMin,dist)}for(let j=maxJ+1;j<=s2.length;j+=1)current[j]=big;if(colMin>max)return;const temp=previous;previous=current,current=temp}const res=previous[s2.length];return res>max?void 0:res}const lodash_es_isNumber=function isNumber(value){return"number"==typeof value||lodash_es_isObjectLike(value)&&"[object Number]"==_baseGetTag(value)};const _baseClamp=function baseClamp(number,lower,upper){return number==number&&(void 0!==upper&&(number=number<=upper?number:upper),void 0!==lower&&(number=number>=lower?number:lower)),number};const lodash_es_clamp=function clamp(number,lower,upper){return void 0===upper&&(upper=lower,lower=void 0),void 0!==upper&&(upper=(upper=lodash_es_toNumber(upper))==upper?upper:0),void 0!==lower&&(lower=(lower=lodash_es_toNumber(lower))==lower?lower:0),_baseClamp(lodash_es_toNumber(number),lower,upper)};function number_isPercentage(val){return"string"==typeof val&&"%"===val.slice(-1)}function normalizePercentage(num,ref){if(null==num)return 0;let raw;if("string"==typeof num){if(raw=parseFloat(num),number_isPercentage(num)&&(raw/=100,Number.isFinite(raw)))return raw*ref}else raw=num;return Number.isFinite(raw)?raw>0&&raw<1?raw*ref:raw:0}function normalizeSides(box){if("object"==typeof box){let left=0,top=0,right=0,bottom=0;return null!=box.vertical&&Number.isFinite(box.vertical)&&(top=bottom=box.vertical),null!=box.horizontal&&Number.isFinite(box.horizontal)&&(right=left=box.horizontal),null!=box.left&&Number.isFinite(box.left)&&(left=box.left),null!=box.top&&Number.isFinite(box.top)&&(top=box.top),null!=box.right&&Number.isFinite(box.right)&&(right=box.right),null!=box.bottom&&Number.isFinite(box.bottom)&&(bottom=box.bottom),{top,right,bottom,left}}let val=0;return null!=box&&Number.isFinite(box)&&(val=box),{top:val,right:val,bottom:val,left:val}}let _IS_MAC=!1,_IS_IOS=!1,_IS_WINDOWS=!1,_IS_IE=!1,_IS_IE11=!1,_IS_EDGE=!1,_IS_NETSCAPE=!1,_IS_CHROME_APP=!1,_IS_CHROME=!1,_IS_OPERA=!1,_IS_FIREFOX=!1,_IS_SAFARI=!1,_SUPPORT_TOUCH=!1,_SUPPORT_POINTER=!1,_SUPPORT_PASSIVE=!1,_NO_FOREIGNOBJECT=!1;if("object"==typeof navigator){const ua=navigator.userAgent;_IS_MAC=ua.indexOf("Macintosh")>=0,_IS_IOS=!!ua.match(/(iPad|iPhone|iPod)/g),_IS_WINDOWS=ua.indexOf("Windows")>=0,_IS_IE=ua.indexOf("MSIE")>=0,_IS_IE11=!!ua.match(/Trident\/7\./),_IS_EDGE=!!ua.match(/Edge\//),_IS_NETSCAPE=ua.indexOf("Mozilla/")>=0&&ua.indexOf("MSIE")<0&&ua.indexOf("Edge/")<0,_IS_CHROME=ua.indexOf("Chrome/")>=0&&ua.indexOf("Edge/")<0,_IS_OPERA=ua.indexOf("Opera/")>=0||ua.indexOf("OPR/")>=0,_IS_FIREFOX=ua.indexOf("Firefox/")>=0,_IS_SAFARI=ua.indexOf("AppleWebKit/")>=0&&ua.indexOf("Chrome/")<0&&ua.indexOf("Edge/")<0,"object"==typeof document&&(_NO_FOREIGNOBJECT=!document.createElementNS||"[object SVGForeignObjectElement]"!=`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`||ua.indexOf("Opera/")>=0)}if("object"==typeof window&&(_IS_CHROME_APP=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,_SUPPORT_POINTER=null!=window.PointerEvent&&!_IS_MAC),"object"==typeof document){_SUPPORT_TOUCH="ontouchstart"in document.documentElement;try{const options=Object.defineProperty({},"passive",{get(){_SUPPORT_PASSIVE=!0}}),div=document.createElement("div");div.addEventListener&&div.addEventListener("click",(()=>{}),options)}catch(err){}}var Platform;!function(Platform){Platform.IS_MAC=_IS_MAC,Platform.IS_IOS=_IS_IOS,Platform.IS_WINDOWS=_IS_WINDOWS,Platform.IS_IE=_IS_IE,Platform.IS_IE11=_IS_IE11,Platform.IS_EDGE=_IS_EDGE,Platform.IS_NETSCAPE=_IS_NETSCAPE,Platform.IS_CHROME_APP=_IS_CHROME_APP,Platform.IS_CHROME=_IS_CHROME,Platform.IS_OPERA=_IS_OPERA,Platform.IS_FIREFOX=_IS_FIREFOX,Platform.IS_SAFARI=_IS_SAFARI,Platform.SUPPORT_TOUCH=_SUPPORT_TOUCH,Platform.SUPPORT_POINTER=_SUPPORT_POINTER,Platform.SUPPORT_PASSIVE=_SUPPORT_PASSIVE,Platform.NO_FOREIGNOBJECT=_NO_FOREIGNOBJECT,Platform.SUPPORT_FOREIGNOBJECT=!Platform.NO_FOREIGNOBJECT}(Platform||(Platform={})),function(Platform){function getHMRStatus(){const mod=window.module;return null!=mod&&null!=mod.hot&&null!=mod.hot.status?mod.hot.status():"unkonwn"}Platform.getHMRStatus=getHMRStatus,Platform.isApplyingHMR=function isApplyingHMR(){return"apply"===getHMRStatus()};const TAGNAMES={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};Platform.isEventSupported=function isEventSupported(event){const elem=document.createElement(TAGNAMES[event]||"div"),eventName=`on${event}`;let isSupported=eventName in elem;return isSupported||(elem.setAttribute(eventName,"return;"),isSupported="function"==typeof elem[eventName]),isSupported}}(Platform||(Platform={}));const rclass=/[\t\r\n\f]/g,rnotwhite=/\S+/g,fillSpaces=str=>` ${str} `;function getClass(elem){return elem&&elem.getAttribute&&elem.getAttribute("class")||""}function hasClass(elem,selector){if(null==elem||null==selector)return!1;const classNames=fillSpaces(getClass(elem)),className=fillSpaces(selector);return 1===elem.nodeType&&classNames.replace(rclass," ").includes(className)}function addClass(elem,selector){if(null!=elem&&null!=selector){if("function"==typeof selector)return addClass(elem,selector(getClass(elem)));if("string"==typeof selector&&1===elem.nodeType){const classes=selector.match(rnotwhite)||[],oldValue=fillSpaces(getClass(elem)).replace(rclass," ");let newValue=classes.reduce(((memo,cls)=>memo.indexOf(fillSpaces(cls))<0?`${memo}${cls} `:memo),oldValue);newValue=newValue.trim(),oldValue!==newValue&&elem.setAttribute("class",newValue)}}}function removeClass(elem,selector){if(null!=elem){if("function"==typeof selector)return removeClass(elem,selector(getClass(elem)));if((!selector||"string"==typeof selector)&&1===elem.nodeType){const classes=(selector||"").match(rnotwhite)||[],oldValue=fillSpaces(getClass(elem)).replace(rclass," ");let newValue=classes.reduce(((memo,cls)=>{const className=fillSpaces(cls);return memo.indexOf(className)>-1?memo.replace(className," "):memo}),oldValue);newValue=selector?newValue.trim():"",oldValue!==newValue&&elem.setAttribute("class",newValue)}}}function toggleClass(elem,selector,stateVal){if(null!=elem&&null!=selector)if(null==stateVal||"string"!=typeof selector){if("function"==typeof selector)return toggleClass(elem,selector(getClass(elem),stateVal),stateVal);if("string"==typeof selector){(selector.match(rnotwhite)||[]).forEach((cls=>{hasClass(elem,cls)?removeClass(elem,cls):addClass(elem,cls)}))}}else stateVal?addClass(elem,selector):removeClass(elem,selector)}let elem_idCounter=0;function ensureId(elem){return null!=elem.id&&""!==elem.id||(elem.id=function elem_uniqueId(){return elem_idCounter+=1,`v${elem_idCounter}`}()),elem.id}function isSVGGraphicsElement(elem){return null!=elem&&("function"==typeof elem.getScreenCTM&&elem instanceof SVGElement)}const elem_ns={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"};function createElement(tagName,doc=document){return doc.createElement(tagName)}function createElementNS(tagName,namespaceURI=elem_ns.xhtml,doc=document){return doc.createElementNS(namespaceURI,tagName)}function createSvgElement(tagName,doc=document){return createElementNS(tagName,elem_ns.svg,doc)}function createSvgDocument(content){if(content){const xml=`<svg xmlns="${elem_ns.svg}" xmlns:xlink="${elem_ns.xlink}" version="1.1">${content}</svg>`,{documentElement}=function parseXML(data,options={}){let xml;try{const parser=new DOMParser;if(null!=options.async){parser.async=options.async}xml=parser.parseFromString(data,options.mimeType||"text/xml")}catch(error){xml=void 0}if(!xml||xml.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${data}`);return xml}(xml,{async:!1});return documentElement}const svg=document.createElementNS(elem_ns.svg,"svg");return svg.setAttributeNS(elem_ns.xmlns,"xmlns:xlink",elem_ns.xlink),svg.setAttribute("version","1.1"),svg}function index(elem){let index=0,node=elem.previousSibling;for(;node;)1===node.nodeType&&(index+=1),node=node.previousSibling;return index}function findParentByClass(elem,className,terminator){const ownerSVGElement=elem.ownerSVGElement;let node=elem.parentNode;for(;node&&node!==terminator&&node!==ownerSVGElement;){if(hasClass(node,className))return node;node=node.parentNode}return null}function contains(parent,child){const bup=child&&child.parentNode;return parent===bup||!!(bup&&1===bup.nodeType&&16&parent.compareDocumentPosition(bup))}function remove(elem){if(elem){(Array.isArray(elem)?elem:[elem]).forEach((item=>{item.parentNode&&item.parentNode.removeChild(item)}))}}function empty(elem){for(;elem.firstChild;)elem.removeChild(elem.firstChild)}function append(elem,elems){(Array.isArray(elems)?elems:[elems]).forEach((child=>{null!=child&&elem.appendChild(child)}))}function before(elem,elems){const parent=elem.parentNode;if(parent){(Array.isArray(elems)?elems:[elems]).forEach((child=>{null!=child&&parent.insertBefore(child,elem)}))}}function isHTMLElement(elem){try{return elem instanceof HTMLElement}catch(e){return"object"==typeof elem&&1===elem.nodeType&&"object"==typeof elem.style&&"object"==typeof elem.ownerDocument}}const CASE_SENSITIVE_ATTR=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function removeAttribute(elem,name){const qualified=qualifyAttr(name);qualified.ns?elem.hasAttributeNS(qualified.ns,qualified.local)&&elem.removeAttributeNS(qualified.ns,qualified.local):elem.hasAttribute(name)&&elem.removeAttribute(name)}function setAttribute(elem,name,value){if(null==value)return removeAttribute(elem,name);const qualified=qualifyAttr(name);qualified.ns&&"string"==typeof value?elem.setAttributeNS(qualified.ns,name,value):"id"===name?elem.id=`${value}`:elem.setAttribute(name,`${value}`)}function setAttributes(elem,attrs){Object.keys(attrs).forEach((name=>{setAttribute(elem,name,attrs[name])}))}function attr(elem,name,value){if(null==name){const attrs=elem.attributes,ret={};for(let i=0;i<attrs.length;i+=1)ret[attrs[i].name]=attrs[i].value;return ret}if("string"==typeof name&&void 0===value)return elem.getAttribute(name);"object"==typeof name?setAttributes(elem,name):setAttribute(elem,name,value)}function qualifyAttr(name){if(-1!==name.indexOf(":")){const combinedKey=name.split(":");return{ns:elem_ns[combinedKey[0]],local:combinedKey[1]}}return{ns:null,local:name}}function kebablizeAttrs(attrs){const result={};return Object.keys(attrs).forEach((key=>{const name=CASE_SENSITIVE_ATTR.includes(key)?key:kebabCase(key);result[name]=attrs[key]})),result}function styleToObject(styleString){const ret={};return styleString.split(";").forEach((item=>{const section=item.trim();if(section){const pair=section.split("=");pair.length&&(ret[pair[0].trim()]=pair[1]?pair[1].trim():"")}})),ret}function mergeAttrs(target,source){return Object.keys(source).forEach((attr=>{if("class"===attr)target[attr]=target[attr]?`${target[attr]} ${source[attr]}`:source[attr];else if("style"===attr){const to="object"==typeof target[attr],so="object"==typeof source[attr];let tt,ss;to&&so?(tt=target[attr],ss=source[attr]):to?(tt=target[attr],ss=styleToObject(source[attr])):so?(tt=styleToObject(target[attr]),ss=source[attr]):(tt=styleToObject(target[attr]),ss=styleToObject(source[attr])),target[attr]=mergeAttrs(tt,ss)}else target[attr]=source[attr]})),target}function annotate(t,annotations,opt={}){const offset=opt.offset||0,compacted=[],ret=[];let curr,prev,batch=null;for(let i=0;i<t.length;i+=1){curr=ret[i]=t[i];for(let j=0,jj=annotations.length;j<jj;j+=1){const annotation=annotations[j],start=annotation.start+offset,end=annotation.end+offset;i>=start&&i<end&&("string"==typeof curr?curr=ret[i]={t:t[i],attrs:annotation.attrs}:curr.attrs=mergeAttrs(mergeAttrs({},curr.attrs),annotation.attrs),opt.includeAnnotationIndices&&(null==curr.annotations&&(curr.annotations=[]),curr.annotations.push(j)))}prev=ret[i-1],prev?lodash_es_isObject(curr)&&lodash_es_isObject(prev)?JSON.stringify(curr.attrs)===JSON.stringify(prev.attrs)?batch.t+=curr.t:(compacted.push(batch),batch=curr):lodash_es_isObject(curr)||lodash_es_isObject(prev)?(compacted.push(batch),batch=curr):batch=(batch||"")+curr:batch=curr}return null!=batch&&compacted.push(batch),compacted}var DataUri;let millimeterSize;!function(DataUri){function isDataUrl(url){return"data:"===url.substr(0,5)}function dataUriToBlob(dataUrl){let uri=dataUrl.replace(/\s/g,"");uri=decodeURIComponent(uri);const index=uri.indexOf(","),dataType=uri.slice(0,index),mime=dataType.split(":")[1].split(";")[0],data=uri.slice(index+1);let decodedString;decodedString=dataType.indexOf("base64")>=0?atob(data):unescape(encodeURIComponent(data));const ia=new Uint8Array(decodedString.length);for(let i=0;i<decodedString.length;i+=1)ia[i]=decodedString.charCodeAt(i);return new Blob([ia],{type:mime})}function downloadBlob(blob,fileName){const msSaveBlob=window.navigator.msSaveBlob;if(msSaveBlob)msSaveBlob(blob,fileName);else{const url=window.URL.createObjectURL(blob),link=document.createElement("a");link.href=url,link.download=fileName,document.body.appendChild(link),link.click(),document.body.removeChild(link),window.URL.revokeObjectURL(url)}}function getNumber(str){const ret=parseFloat(str);return Number.isNaN(ret)?null:ret}DataUri.isDataUrl=isDataUrl,DataUri.imageToDataUri=function imageToDataUri(url,callback){if(!url||isDataUrl(url))return void setTimeout((()=>callback(null,url)));const onError=()=>{callback(new Error(`Failed to load image: ${url}`))},onLoad=window.FileReader?xhr=>{if(200===xhr.status){const reader=new FileReader;reader.onload=evt=>{const dataUri=evt.target.result;callback(null,dataUri)},reader.onerror=onError,reader.readAsDataURL(xhr.response)}else onError()}:xhr=>{if(200===xhr.status){let suffix=url.split(".").pop()||"png";"svg"===suffix&&(suffix="svg+xml");const meta=`data:image/${suffix};base64,`,bytes=new Uint8Array(xhr.response),base64=meta+btoa((u8a=>{const c=[];for(let i=0;i<u8a.length;i+=32768)c.push(String.fromCharCode.apply(null,u8a.subarray(i,i+32768)));return c.join("")})(bytes));callback(null,base64)}else onError()},xhr=new XMLHttpRequest;xhr.responseType=window.FileReader?"blob":"arraybuffer",xhr.open("GET",url,!0),xhr.addEventListener("error",onError),xhr.addEventListener("load",(()=>onLoad(xhr))),xhr.send()},DataUri.dataUriToBlob=dataUriToBlob,DataUri.downloadBlob=downloadBlob,DataUri.downloadDataUri=function downloadDataUri(dataUrl,fileName){downloadBlob(dataUriToBlob(dataUrl),fileName)},DataUri.svgToDataUrl=function svgToDataUrl(svg,options={}){let viewBox=null;const getNumberFromViewBox=index=>(null==viewBox&&(viewBox=function parseViewBox(svg){const matches=svg.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return matches&&matches[2]?matches[2].replace(/\s+/," ").split(" "):null}(svg)),null!=viewBox?getNumber(viewBox[index]):null),getNumberFromMatches=reg=>{const matches=svg.match(reg);return matches&&matches[2]?getNumber(matches[2]):null};let w=options.width;if(null==w&&(w=getNumberFromMatches(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==w&&(w=getNumberFromViewBox(2)),null==w)throw new Error("Can not parse width from svg string");let h=options.height;if(null==h&&(h=getNumberFromMatches(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==h&&(h=getNumberFromViewBox(3)),null==h)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(svg).replace(/'/g,"%27").replace(/"/g,"%22")}`}}(DataUri||(DataUri={}));const supportedUnits={px:val=>val,mm:val=>millimeterSize*val,cm:val=>millimeterSize*val*10,in:val=>millimeterSize*val*25.4,pt:val=>millimeterSize*(25.4*val/72),pc:val=>millimeterSize*(25.4*val/6)};var Unit;!function(Unit){function measure(cssWidth,cssHeight,unit){const div=document.createElement("div"),style=div.style;style.display="inline-block",style.position="absolute",style.left="-15000px",style.top="-15000px",style.width=cssWidth+(unit||"px"),style.height=cssHeight+(unit||"px"),document.body.appendChild(div);const rect=div.getBoundingClientRect(),size={width:rect.width||0,height:rect.height||0};return document.body.removeChild(div),size}Unit.measure=measure,Unit.toPx=function toPx(val,unit){null==millimeterSize&&(millimeterSize=measure("1","1","mm").width);const convert=unit?supportedUnits[unit]:null;return convert?convert(val):val}}(Unit||(Unit={}));const hyphenPattern=/-(.)/g;const memoized={},prefixes=["webkit","ms","moz","o"],testStyle="undefined"!=typeof document?document.createElement("div").style:{};function getVendorPrefixedName(property){const name=function camelize(str){return str.replace(hyphenPattern,((_,char)=>char.toUpperCase()))}(property);if(null==memoized[name]){const capitalizedName=name.charAt(0).toUpperCase()+name.slice(1);memoized[name]=name in testStyle?name:function getWithPrefix(name){for(let i=0;i<prefixes.length;i+=1){const prefixedName=prefixes[i]+name;if(prefixedName in testStyle)return prefixedName}return null}(capitalizedName)}return memoized[name]}function style_getComputedStyle(elem,name){const computed=elem.ownerDocument&&elem.ownerDocument.defaultView&&elem.ownerDocument.defaultView.opener?elem.ownerDocument.defaultView.getComputedStyle(elem,null):window.getComputedStyle(elem,null);return computed&&name?computed.getPropertyValue(name)||computed[name]:computed}!function(){if("undefined"==typeof document)return function(){};const doc=document;doc.selection||window.getSelection}();const numericProps={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function computeStyle(elem,prop,isVariable){const style=window.getComputedStyle(elem,null);return isVariable?style.getPropertyValue(prop)||void 0:style[prop]||elem.style[prop]}function css(elem,prop,value){if("string"!=typeof prop)for(const key in prop)css(elem,key,prop[key]);else{const isVariable=function isCSSVariable(prop){return/^--/.test(prop)}(prop);if(isVariable||(prop=getVendorPrefixedName(prop)),void 0===value)return computeStyle(elem,prop,isVariable);isVariable||(value=function getSuffixedValue(prop,value){return numericProps[prop]||"number"!=typeof value?value:`${value}px`}(prop,value));const style=elem.style;isVariable?style.setProperty(prop,value):style[prop]=value}}const dataset=new WeakMap;function getData(elem,name){const key=lodash_es_camelCase(name),cache=dataset.get(elem);if(cache)return cache[key]}function data(elem,name,value){if(!name){const datas={};return Object.keys(dataset).forEach((key=>{datas[key]=getData(elem,key)})),datas}if("string"==typeof name)return void 0===value?getData(elem,name):void function setData(elem,name,value){const key=lodash_es_camelCase(name),cache=dataset.get(elem);cache?cache[key]=value:dataset.set(elem,{[key]:value})}(elem,name,value);for(const key in name)data(elem,key,name[key])}class Vector{get[Symbol.toStringTag](){return Vector.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(id){this.node.id=id}constructor(elem,attrs,children){if(!elem)throw new TypeError("Invalid element to create vector");let node;if(Vector.isVector(elem))node=elem.node;else if("string"==typeof elem)if("svg"===elem.toLowerCase())node=createSvgDocument();else if("<"===elem[0]){const doc=createSvgDocument(elem);node=document.importNode(doc.firstChild,!0)}else node=document.createElementNS(elem_ns.svg,elem);else node=elem;this.node=node,attrs&&this.setAttributes(attrs),children&&this.append(children)}transform(matrix,options){return null==matrix?transform(this.node):(transform(this.node,matrix,options),this)}translate(tx,ty=0,options={}){return null==tx?translate(this.node):(translate(this.node,tx,ty,options),this)}rotate(angle,cx,cy,options={}){return null==angle?transform_rotate(this.node):(transform_rotate(this.node,angle,cx,cy,options),this)}scale(sx,sy){return null==sx?scale(this.node):(scale(this.node,sx,sy),this)}getTransformToElement(target){const ref=Vector.toNode(target);return getTransformToElement(this.node,ref)}removeAttribute(name){return removeAttribute(this.node,name),this}getAttribute(name){return function getAttribute(elem,name){return elem.getAttribute(name)}(this.node,name)}setAttribute(name,value){return setAttribute(this.node,name,value),this}setAttributes(attrs){return setAttributes(this.node,attrs),this}attr(name,value){return null==name?attr(this.node):"string"==typeof name&&void 0===value?attr(this.node,name):("object"==typeof name?attr(this.node,name):attr(this.node,name,value),this)}svg(){return this.node instanceof SVGSVGElement?this:Vector.create(this.node.ownerSVGElement)}defs(){const context=this.svg()||this,defsNode=context.node.getElementsByTagName("defs")[0];return defsNode?Vector.create(defsNode):Vector.create("defs").appendTo(context)}text(content,options={}){return text_text(this.node,content,options),this}tagName(){return function tagName(node,lowercase=!0){const nodeName=node.nodeName;return lowercase?nodeName.toLowerCase():nodeName.toUpperCase()}(this.node)}clone(){return Vector.create(this.node.cloneNode(!0))}remove(){return remove(this.node),this}empty(){return empty(this.node),this}append(elems){return append(this.node,Vector.toNodes(elems)),this}appendTo(target){return function appendTo(elem,target){null!=target&&target.appendChild(elem)}(this.node,Vector.isVector(target)?target.node:target),this}prepend(elems){return function prepend(elem,elems){const child=elem.firstChild;return child?before(child,elems):append(elem,elems)}(this.node,Vector.toNodes(elems)),this}before(elems){return before(this.node,Vector.toNodes(elems)),this}replace(elem){return this.node.parentNode&&this.node.parentNode.replaceChild(Vector.toNode(elem),this.node),Vector.create(elem)}first(){return this.node.firstChild?Vector.create(this.node.firstChild):null}last(){return this.node.lastChild?Vector.create(this.node.lastChild):null}get(index){const child=this.node.childNodes[index];return child?Vector.create(child):null}indexOf(elem){return Array.prototype.slice.call(this.node.childNodes).indexOf(Vector.toNode(elem))}find(selector){const vels=[],nodes=function find(elem,selector){return elem.querySelectorAll(selector)}(this.node,selector);if(nodes)for(let i=0,ii=nodes.length;i<ii;i+=1)vels.push(Vector.create(nodes[i]));return vels}findOne(selector){const found=function findOne(elem,selector){return elem.querySelector(selector)}(this.node,selector);return found?Vector.create(found):null}findParentByClass(className,terminator){const node=findParentByClass(this.node,className,terminator);return node?Vector.create(node):null}matches(selector){const node=this.node,matcher=(this.node.matches,node.matches||node.matchesSelector||node.msMatchesSelector||node.mozMatchesSelector||node.webkitMatchesSelector||node.oMatchesSelector||null);return matcher&&matcher.call(node,selector)}contains(child){return contains(this.node,Vector.isVector(child)?child.node:child)}wrap(node){const vel=Vector.create(node),parentNode=this.node.parentNode;return null!=parentNode&&parentNode.insertBefore(vel.node,this.node),vel.append(this)}parent(type){let parent=this;if(null==parent.node.parentNode)return null;if(parent=Vector.create(parent.node.parentNode),null==type)return parent;do{if("string"==typeof type?parent.matches(type):parent instanceof type)return parent}while(parent=Vector.create(parent.node.parentNode));return parent}children(){const children=this.node.childNodes,vels=[];for(let i=0;i<children.length;i+=1){1===children[i].nodeType&&vels.push(Vector.create(children[i]))}return vels}eachChild(fn,deep){const children=this.children();for(let i=0,l=children.length;i<l;i+=1)fn.call(children[i],children[i],i,children),deep&&children[i].eachChild(fn,deep);return this}index(){return index(this.node)}hasClass(className){return hasClass(this.node,className)}addClass(className){return addClass(this.node,className),this}removeClass(className){return removeClass(this.node,className),this}toggleClass(className,stateVal){return toggleClass(this.node,className,stateVal),this}toLocalPoint(x,y){return function toLocalPoint(elem,x,y){const svg=elem instanceof SVGSVGElement?elem:elem.ownerSVGElement,p=svg.createSVGPoint();p.x=x,p.y=y;try{const ctm=svg.getScreenCTM(),globalPoint=p.matrixTransform(ctm.inverse()),globalToLocalMatrix=getTransformToElement(elem,svg).inverse();return globalPoint.matrixTransform(globalToLocalMatrix)}catch(e){return p}}(this.node,x,y)}sample(interval=1){return this.node instanceof SVGPathElement?function sample(elem,interval=1){const length=elem.getTotalLength(),samples=[];let sample,distance=0;for(;distance<length;)sample=elem.getPointAtLength(distance),samples.push({distance,x:sample.x,y:sample.y}),distance+=interval;return samples}(this.node,interval):[]}toPath(){return Vector.create(function toPath(elem){const path=createSvgElement("path");attr(path,attr(elem));const d=toPathData(elem);d&&path.setAttribute("d",d);return path}(this.node))}toPathData(){return toPathData(this.node)}}function annotateTextLine(lineNode,lineAnnotations,options){const eol=options.eol,baseSize=options.baseSize,lineHeight=options.lineHeight;let tspanNode,maxFontSize=0;const fontMetrics={},lastJ=lineAnnotations.length-1;for(let j=0;j<=lastJ;j+=1){let annotation=lineAnnotations[j],fontSize=null;if("object"==typeof annotation){const annotationAttrs=annotation.attrs,vTSpan=Vector.create("tspan",annotationAttrs);tspanNode=vTSpan.node;let t=annotation.t;eol&&j===lastJ&&(t+=eol),tspanNode.textContent=t;const annotationClass=annotationAttrs.class;annotationClass&&vTSpan.addClass(annotationClass),options.includeAnnotationIndices&&vTSpan.attr("annotations",annotation.annotations.join(",")),fontSize=parseFloat(annotationAttrs["font-size"]),void 0===fontSize&&(fontSize=baseSize),fontSize&&fontSize>maxFontSize&&(maxFontSize=fontSize)}else eol&&j===lastJ&&(annotation+=eol),tspanNode=document.createTextNode(annotation||" "),baseSize&&baseSize>maxFontSize&&(maxFontSize=baseSize);lineNode.appendChild(tspanNode)}return maxFontSize&&(fontMetrics.maxFontSize=maxFontSize),lineHeight?fontMetrics.lineHeight=lineHeight:maxFontSize&&(fontMetrics.lineHeight=1.2*maxFontSize),fontMetrics}!function(Vector){function isVector(instance){if(null==instance)return!1;if(instance instanceof Vector)return!0;const tag=instance[Symbol.toStringTag],vector=instance;return(null==tag||tag===Vector.toStringTag)&&vector.node instanceof SVGElement&&"function"==typeof vector.sample&&"function"==typeof vector.toPath}function create(elem,attrs,children){return new Vector(elem,attrs,children)}function toNode(elem){return isVector(elem)?elem.node:elem}Vector.toStringTag=`X6.${Vector.name}`,Vector.isVector=isVector,Vector.create=create,Vector.createVectors=function createVectors(markup){if("<"===markup[0]){const svgDoc=createSvgDocument(markup),vels=[];for(let i=0,ii=svgDoc.childNodes.length;i<ii;i+=1){const childNode=svgDoc.childNodes[i];vels.push(create(document.importNode(childNode,!0)))}return vels}return[create(markup)]},Vector.toNode=toNode,Vector.toNodes=function toNodes(elems){return Array.isArray(elems)?elems.map((elem=>toNode(elem))):[toNode(elems)]}}(Vector||(Vector={}));const emRegex=/em$/;function emToPx(em,fontSize){const numerical=parseFloat(em);return emRegex.test(em)?numerical*fontSize:numerical}function text_text(elem,content,options={}){content=function sanitize(text){return text.replace(/ /g,"")}(content);const eol=options.eol;let textPath=options.textPath;const verticalAnchor=options.textVerticalAnchor,namedVerticalAnchor="middle"===verticalAnchor||"bottom"===verticalAnchor||"top"===verticalAnchor;let x=options.x;void 0===x&&(x=elem.getAttribute("x")||0);const iai=options.includeAnnotationIndices;let annotations=options.annotations;annotations&&!Array.isArray(annotations)&&(annotations=[annotations]);const defaultLineHeight=options.lineHeight,autoLineHeight="auto"===defaultLineHeight,lineHeight=autoLineHeight?"1.5em":defaultLineHeight||"1em";let needEmpty=!0;const childNodes=elem.childNodes;if(1===childNodes.length){const node=childNodes[0];node&&"TITLE"===node.tagName.toUpperCase()&&(needEmpty=!1)}needEmpty&&empty(elem),attr(elem,{"xml:space":"preserve",display:content||options.displayEmpty?null:"none"});const strFontSize=attr(elem,"font-size");let containerNode,dy,fontSize=parseFloat(strFontSize);fontSize||(fontSize=16,!namedVerticalAnchor&&!annotations||strFontSize||attr(elem,"font-size",`${fontSize}`)),textPath?("string"==typeof textPath&&(textPath={d:textPath}),containerNode=function createTextPathNode(attrs,elem){const vel=Vector.create(elem),textPath=Vector.create("textPath"),d=attrs.d;if(d&&void 0===attrs["xlink:href"]){const path=Vector.create("path").attr("d",d).appendTo(vel.defs());textPath.attr("xlink:href",`#${path.id}`)}return"object"==typeof attrs&&textPath.attr(attrs),textPath.node}(textPath,elem)):containerNode=document.createDocumentFragment();let annotatedY,offset=0;const lines=content.split("\n"),linesMetrics=[],lastI=lines.length-1;for(let i=0;i<=lastI;i+=1){dy=lineHeight;let lineClassName="v-line";const lineNode=createSvgElement("tspan");let lineMetrics,line=lines[i];if(line)if(annotations){lineMetrics=annotateTextLine(lineNode,annotate(line,annotations,{offset:-offset,includeAnnotationIndices:iai}),{eol:i!==lastI&&eol,baseSize:fontSize,lineHeight:autoLineHeight?null:lineHeight,includeAnnotationIndices:iai});const iLineHeight=lineMetrics.lineHeight;iLineHeight&&autoLineHeight&&0!==i&&(dy=iLineHeight),0===i&&(annotatedY=.8*lineMetrics.maxFontSize)}else eol&&i!==lastI&&(line+=eol),lineNode.textContent=line;else{lineNode.textContent="-",lineClassName+=" v-empty-line";const lineNodeStyle=lineNode.style;lineNodeStyle.fillOpacity=0,lineNodeStyle.strokeOpacity=0,annotations&&(lineMetrics={})}lineMetrics&&linesMetrics.push(lineMetrics),i>0&&lineNode.setAttribute("dy",dy),(i>0||textPath)&&lineNode.setAttribute("x",x),lineNode.className.baseVal=lineClassName,containerNode.appendChild(lineNode),offset+=line.length+1}if(namedVerticalAnchor)if(annotations)dy=function calculateDY(alignment,linesMetrics,baseSizePx,lineHeight){if(!Array.isArray(linesMetrics))return 0;const n=linesMetrics.length;if(!n)return 0;let lineMetrics=linesMetrics[0];const flMaxFont=emToPx(lineMetrics.maxFontSize,baseSizePx)||baseSizePx;let rLineHeights=0;const lineHeightPx=emToPx(lineHeight,baseSizePx);for(let i=1;i<n;i+=1)lineMetrics=linesMetrics[i],rLineHeights+=emToPx(lineMetrics.lineHeight,baseSizePx)||lineHeightPx;const llMaxFont=emToPx(lineMetrics.maxFontSize,baseSizePx)||baseSizePx;let dy;switch(alignment){case"middle":dy=flMaxFont/2-.15*llMaxFont-rLineHeights/2;break;case"bottom":dy=-.25*llMaxFont-rLineHeights;break;default:dy=.8*flMaxFont}return dy}(verticalAnchor,linesMetrics,fontSize,lineHeight);else if("top"===verticalAnchor)dy="0.8em";else{let rh;switch(lastI>0?(rh=parseFloat(lineHeight)||1,rh*=lastI,emRegex.test(lineHeight)||(rh/=fontSize)):rh=0,verticalAnchor){case"middle":dy=.3-rh/2+"em";break;case"bottom":dy=-rh-.3+"em"}}else 0===verticalAnchor?dy="0em":verticalAnchor?dy=verticalAnchor:(dy=0,null==elem.getAttribute("y")&&elem.setAttribute("y",`${annotatedY||"0.8em"}`));containerNode.firstChild.setAttribute("dy",dy),elem.appendChild(containerNode)}function measureText(text,styles={}){const canvasContext=document.createElement("canvas").getContext("2d");if(!text)return{width:0};const font=[],fontSize=styles["font-size"]?`${parseFloat(styles["font-size"])}px`:"14px";return font.push(styles["font-style"]||"normal"),font.push(styles["font-variant"]||"normal"),font.push(styles["font-weight"]||400),font.push(fontSize),font.push(styles["font-family"]||"sans-serif"),canvasContext.font=font.join(" "),canvasContext.measureText(text)}function splitTextByLength(text,splitWidth,totalWidth,style={}){if(splitWidth>=totalWidth)return[text,""];const length=text.length,caches={};let index=Math.round(splitWidth/totalWidth*length-1);for(index<0&&(index=0);index>=0&&index<length;){const frontText=text.slice(0,index),frontWidth=caches[frontText]||measureText(frontText,style).width,behindText=text.slice(0,index+1),behindWidth=caches[behindText]||measureText(behindText,style).width;if(caches[frontText]=frontWidth,caches[behindText]=behindWidth,frontWidth>splitWidth)index-=1;else{if(!(behindWidth<=splitWidth))break;index+=1}}return[text.slice(0,index),text.slice(index)]}function breakText(text,size,styles={},options={}){const width=size.width,height=size.height,eol=options.eol||"\n",fontSize=styles.fontSize||14,lineHeight=styles.lineHeight?parseFloat(styles.lineHeight):Math.ceil(1.4*fontSize),maxLines=Math.floor(height/lineHeight);if(text.indexOf(eol)>-1){const delimiter=uuid(),splitText=[];return text.split(eol).map((line=>{const part=breakText(line,Object.assign(Object.assign({},size),{height:Number.MAX_SAFE_INTEGER}),styles,Object.assign(Object.assign({},options),{eol:delimiter}));part&&splitText.push(...part.split(delimiter))})),splitText.slice(0,maxLines).join(eol)}const{width:textWidth}=measureText(text,styles);if(textWidth<width)return text;const lines=[];let remainText=text,remainWidth=textWidth,ellipsis=options.ellipsis,ellipsisWidth=0;ellipsis&&("string"!=typeof ellipsis&&(ellipsis=""),ellipsisWidth=measureText(ellipsis,styles).width);for(let i=0;i<maxLines;i+=1){if(!(remainWidth>width)){lines.push(remainText);break}if(i===maxLines-1){const[front]=splitTextByLength(remainText,width-ellipsisWidth,remainWidth,styles);lines.push(ellipsis?`${front}${ellipsis}`:front)}else{const[front,behind]=splitTextByLength(remainText,width,remainWidth,styles);lines.push(front),remainText=behind,remainWidth=measureText(remainText,styles).width}}return lines.join(eol)}const KAPPA=.551784;function getNumbericAttribute(elem,attr,defaultValue=NaN){const v=elem.getAttribute(attr);if(null==v)return defaultValue;const n=parseFloat(v);return Number.isNaN(n)?defaultValue:n}function svgPointsToPath(points){return`M ${points.map((p=>`${p.x} ${p.y}`)).join(" L")}`}function getPointsFromSvgElement(elem){const points=[],nodePoints=elem.points;if(nodePoints)for(let i=0,ii=nodePoints.numberOfItems;i<ii;i+=1)points.push(nodePoints.getItem(i));return points}function rectToPathData(r){let d;const x=r.x,y=r.y,width=r.width,height=r.height,topRx=Math.min(r.rx||r["top-rx"]||0,width/2),bottomRx=Math.min(r.rx||r["bottom-rx"]||0,width/2),topRy=Math.min(r.ry||r["top-ry"]||0,height/2),bottomRy=Math.min(r.ry||r["bottom-ry"]||0,height/2);return d=topRx||bottomRx||topRy||bottomRy?["M",x,y+topRy,"v",height-topRy-bottomRy,"a",bottomRx,bottomRy,0,0,0,bottomRx,bottomRy,"h",width-2*bottomRx,"a",bottomRx,bottomRy,0,0,0,bottomRx,-bottomRy,"v",-(height-bottomRy-topRy),"a",topRx,topRy,0,0,0,-topRx,-topRy,"h",-(width-2*topRx),"a",topRx,topRy,0,0,0,-topRx,topRy,"Z"]:["M",x,y,"H",x+width,"V",y+height,"H",x,"V",y,"Z"],d.join(" ")}function toPathData(elem){const tagName=elem.tagName.toLowerCase();switch(tagName){case"path":return elem.getAttribute("d");case"line":return function lineToPathData(line){return["M",getNumbericAttribute(line,"x1"),getNumbericAttribute(line,"y1"),"L",getNumbericAttribute(line,"x2"),getNumbericAttribute(line,"y2")].join(" ")}(elem);case"polygon":return function polygonToPathData(polygon){const points=getPointsFromSvgElement(polygon);return 0===points.length?null:`${svgPointsToPath(points)} Z`}(elem);case"polyline":return function polylineToPathData(polyline){const points=getPointsFromSvgElement(polyline);return 0===points.length?null:svgPointsToPath(points)}(elem);case"ellipse":return function ellipseToPathData(ellipse){const cx=getNumbericAttribute(ellipse,"cx",0),cy=getNumbericAttribute(ellipse,"cy",0),rx=getNumbericAttribute(ellipse,"rx"),ry=getNumbericAttribute(ellipse,"ry")||rx,cdx=rx*KAPPA,cdy=ry*KAPPA;return["M",cx,cy-ry,"C",cx+cdx,cy-ry,cx+rx,cy-cdy,cx+rx,cy,"C",cx+rx,cy+cdy,cx+cdx,cy+ry,cx,cy+ry,"C",cx-cdx,cy+ry,cx-rx,cy+cdy,cx-rx,cy,"C",cx-rx,cy-cdy,cx-cdx,cy-ry,cx,cy-ry,"Z"].join(" ")}(elem);case"circle":return function circleToPathData(circle){const cx=getNumbericAttribute(circle,"cx",0),cy=getNumbericAttribute(circle,"cy",0),r=getNumbericAttribute(circle,"r"),cd=r*KAPPA;return["M",cx,cy-r,"C",cx+cd,cy-r,cx+r,cy-cd,cx+r,cy,"C",cx+r,cy+cd,cx+cd,cy+r,cx,cy+r,"C",cx-cd,cy+r,cx-r,cy+cd,cx-r,cy,"C",cx-r,cy-cd,cx-cd,cy-r,cx,cy-r,"Z"].join(" ")}(elem);case"rect":return function rectangleToPathData(rect){return rectToPathData({x:getNumbericAttribute(rect,"x",0),y:getNumbericAttribute(rect,"y",0),width:getNumbericAttribute(rect,"width",0),height:getNumbericAttribute(rect,"height",0),rx:getNumbericAttribute(rect,"rx",0),ry:getNumbericAttribute(rect,"ry",0)})}(elem)}throw new Error(`"${tagName}" cannot be converted to svg path element.`)}const transformRegex=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,transformSeparatorRegex=/[ ,]+/,transformationListRegex=/^(\w+)\((.*)\)/;function createSVGMatrix(matrix){const mat=createSvgElement("svg").createSVGMatrix();if(null!=matrix){const source=matrix,target=mat;for(const key in source)target[key]=source[key]}return mat}function createSVGTransform(matrix){const svgDocument=createSvgElement("svg");return null!=matrix?(matrix instanceof DOMMatrix||(matrix=createSVGMatrix(matrix)),svgDocument.createSVGTransformFromMatrix(matrix)):svgDocument.createSVGTransform()}function transformStringToMatrix(transform){let mat=createSVGMatrix();const matches=null!=transform&&transform.match(transformRegex);if(!matches)return mat;for(let i=0,n=matches.length;i<n;i+=1){const transformationMatch=matches[i].match(transformationListRegex);if(transformationMatch){let sx,sy,tx,ty,angle,ctm=createSVGMatrix();const args=transformationMatch[2].split(transformSeparatorRegex);switch(transformationMatch[1].toLowerCase()){case"scale":sx=parseFloat(args[0]),sy=void 0===args[1]?sx:parseFloat(args[1]),ctm=ctm.scaleNonUniform(sx,sy);break;case"translate":tx=parseFloat(args[0]),ty=parseFloat(args[1]),ctm=ctm.translate(tx,ty);break;case"rotate":angle=parseFloat(args[0]),tx=parseFloat(args[1])||0,ty=parseFloat(args[2])||0,ctm=0!==tx||0!==ty?ctm.translate(tx,ty).rotate(angle).translate(-tx,-ty):ctm.rotate(angle);break;case"skewx":angle=parseFloat(args[0]),ctm=ctm.skewX(angle);break;case"skewy":angle=parseFloat(args[0]),ctm=ctm.skewY(angle);break;case"matrix":ctm.a=parseFloat(args[0]),ctm.b=parseFloat(args[1]),ctm.c=parseFloat(args[2]),ctm.d=parseFloat(args[3]),ctm.e=parseFloat(args[4]),ctm.f=parseFloat(args[5]);break;default:continue}mat=mat.multiply(ctm)}}return mat}function matrixToTransformString(matrix){const m=matrix||{};return`matrix(${null!=m.a?m.a:1},${null!=m.b?m.b:0},${null!=m.c?m.c:0},${null!=m.d?m.d:1},${null!=m.e?m.e:0},${null!=m.f?m.f:0})`}function parseTransformString(transform){let translation,rotation,scale;if(transform){const separator=transformSeparatorRegex;if(transform.trim().indexOf("matrix")>=0){const decomposedMatrix=function decomposeMatrix(matrix){const px=deltaTransformPoint(matrix,{x:0,y:1}),py=deltaTransformPoint(matrix,{x:1,y:0}),skewX=180/Math.PI*Math.atan2(px.y,px.x)-90,skewY=180/Math.PI*Math.atan2(py.y,py.x);return{skewX,skewY,translateX:matrix.e,translateY:matrix.f,scaleX:Math.sqrt(matrix.a*matrix.a+matrix.b*matrix.b),scaleY:Math.sqrt(matrix.c*matrix.c+matrix.d*matrix.d),rotation:skewX}}(transformStringToMatrix(transform));translation=[decomposedMatrix.translateX,decomposedMatrix.translateY],rotation=[decomposedMatrix.rotation],scale=[decomposedMatrix.scaleX,decomposedMatrix.scaleY];const transformations=[];0===translation[0]&&0===translation[1]||transformations.push(`translate(${translation.join(",")})`),1===scale[0]&&1===scale[1]||transformations.push(`scale(${scale.join(",")})`),0!==rotation[0]&&transformations.push(`rotate(${rotation[0]})`),transform=transformations.join(" ")}else{const translateMatch=transform.match(/translate\((.*?)\)/);translateMatch&&(translation=translateMatch[1].split(separator));const rotateMatch=transform.match(/rotate\((.*?)\)/);rotateMatch&&(rotation=rotateMatch[1].split(separator));const scaleMatch=transform.match(/scale\((.*?)\)/);scaleMatch&&(scale=scaleMatch[1].split(separator))}}const sx=scale&&scale[0]?parseFloat(scale[0]):1;return{raw:transform||"",translation:{tx:translation&&translation[0]?parseInt(translation[0],10):0,ty:translation&&translation[1]?parseInt(translation[1],10):0},rotation:{angle:rotation&&rotation[0]?parseInt(rotation[0],10):0,cx:rotation&&rotation[1]?parseInt(rotation[1],10):void 0,cy:rotation&&rotation[2]?parseInt(rotation[2],10):void 0},scale:{sx,sy:scale&&scale[1]?parseFloat(scale[1]):sx}}}function deltaTransformPoint(matrix,point){return{x:point.x*matrix.a+point.y*matrix.c+0,y:point.x*matrix.b+point.y*matrix.d+0}}function transform(elem,matrix,options={}){if(null==matrix)return transformStringToMatrix(attr(elem,"transform"));if(options.absolute)return void elem.setAttribute("transform",matrixToTransformString(matrix));const transformList=elem.transform,svgTransform=createSVGTransform(matrix);transformList.baseVal.appendItem(svgTransform)}function translate(elem,tx,ty=0,options={}){let transformAttr=attr(elem,"transform");const transform=parseTransformString(transformAttr);if(null==tx)return transform.translation;transformAttr=transform.raw,transformAttr=transformAttr.replace(/translate\([^)]*\)/g,"").trim();const newTranslate=`translate(${options.absolute?tx:transform.translation.tx+tx},${options.absolute?ty:transform.translation.ty+ty})`;elem.setAttribute("transform",`${newTranslate} ${transformAttr}`.trim())}function transform_rotate(elem,angle,cx,cy,options={}){let transformAttr=attr(elem,"transform");const transform=parseTransformString(transformAttr);if(null==angle)return transform.rotation;transformAttr=transform.raw,transformAttr=transformAttr.replace(/rotate\([^)]*\)/g,"").trim(),angle%=360;const newRotate=`rotate(${options.absolute?angle:transform.rotation.angle+angle}${null!=cx&&null!=cy?`,${cx},${cy}`:""})`;elem.setAttribute("transform",`${transformAttr} ${newRotate}`.trim())}function scale(elem,sx,sy){let transformAttr=attr(elem,"transform");const transform=parseTransformString(transformAttr);if(null==sx)return transform.scale;sy=null==sy?sx:sy,transformAttr=transform.raw,transformAttr=transformAttr.replace(/scale\([^)]*\)/g,"").trim();const newScale=`scale(${sx},${sy})`;elem.setAttribute("transform",`${transformAttr} ${newScale}`.trim())}function getTransformToElement(elem,target){if(isSVGGraphicsElement(target)&&isSVGGraphicsElement(elem)){const targetCTM=target.getScreenCTM(),nodeCTM=elem.getScreenCTM();if(targetCTM&&nodeCTM)return targetCTM.inverse().multiply(nodeCTM)}return createSVGMatrix()}var EventHook,Store,Util,Special;!function(EventHook){const cache={};EventHook.get=function get(type){return cache[type]||{}},EventHook.register=function register(type,hook){cache[type]=hook},EventHook.unregister=function unregister(type){delete cache[type]}}(EventHook||(EventHook={})),function(Store){const cache=new WeakMap;Store.ensure=function ensure(target){return cache.has(target)||cache.set(target,{events:Object.create(null)}),cache.get(target)},Store.get=function get(target){return cache.get(target)},Store.remove=function remove(target){return cache.delete(target)}}(Store||(Store={})),function(Util){Util.returnTrue=()=>!0,Util.returnFalse=()=>!1,Util.stopPropagationCallback=function stopPropagationCallback(e){e.stopPropagation()},Util.addEventListener=function addEventListener(elem,type,handler){null!=elem.addEventListener&&elem.addEventListener(type,handler)},Util.removeEventListener=function removeEventListener(elem,type,handler){null!=elem.removeEventListener&&elem.removeEventListener(type,handler)}}(Util||(Util={})),function(Util){const rNotHTMLWhite=/[^\x20\t\r\n\f]+/g,rNamespace=/^([^.]*)(?:\.(.+)|)/;Util.splitType=function splitType(types){return(types||"").match(rNotHTMLWhite)||[""]},Util.normalizeType=function normalizeType(type){const parts=rNamespace.exec(type)||[];return{originType:parts[1]?parts[1].trim():parts[1],namespaces:parts[2]?parts[2].split(".").map((ns=>ns.trim())).sort():[]}},Util.isValidTarget=function isValidTarget(target){return 1===target.nodeType||9===target.nodeType||!+target.nodeType},Util.isValidSelector=function isValidSelector(elem,selector){if(selector){const node=elem;return null!=node.querySelector&&null!=node.querySelector(selector)}return!0}}(Util||(Util={})),function(Util){let seed=0;const cache=new WeakMap;Util.ensureHandlerId=function ensureHandlerId(handler){return cache.has(handler)||(cache.set(handler,seed),seed+=1),cache.get(handler)},Util.getHandlerId=function getHandlerId(handler){return cache.get(handler)},Util.removeHandlerId=function removeHandlerId(handler){return cache.delete(handler)},Util.setHandlerId=function setHandlerId(handler,id){return cache.set(handler,id)}}(Util||(Util={})),function(Util){Util.getHandlerQueue=function getHandlerQueue(elem,event){const queue=[],store=Store.get(elem),bag=store&&store.events&&store.events[event.type],handlers=bag&&bag.handlers||[],delegateCount=bag?bag.delegateCount:0;if(delegateCount>0&&!("click"===event.type&&"number"==typeof event.button&&event.button>=1))for(let curr=event.target;curr!==elem;curr=curr.parentNode||elem)if(1===curr.nodeType&&("click"!==event.type||!0!==curr.disabled)){const matchedHandlers=[],matchedSelectors={};for(let i=0;i<delegateCount;i+=1){const handleObj=handlers[i],selector=handleObj.selector;if(null!=selector&&null==matchedSelectors[selector]){const nodes=[];elem.querySelectorAll(selector).forEach((child=>{nodes.push(child)})),matchedSelectors[selector]=nodes.includes(curr)}matchedSelectors[selector]&&matchedHandlers.push(handleObj)}matchedHandlers.length&&queue.push({elem:curr,handlers:matchedHandlers})}return delegateCount<handlers.length&&queue.push({elem,handlers:handlers.slice(delegateCount)}),queue}}(Util||(Util={})),function(Util){Util.isWindow=function isWindow(obj){return null!=obj&&obj===obj.window}}(Util||(Util={})),function(Util){Util.contains=function contains(a,b){const adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}}(Util||(Util={}));class EventObject{constructor(e,props){this.isDefaultPrevented=Util.returnFalse,this.isPropagationStopped=Util.returnFalse,this.isImmediatePropagationStopped=Util.returnFalse,this.isSimulated=!1,this.preventDefault=()=>{const e=this.originalEvent;this.isDefaultPrevented=Util.returnTrue,e&&!this.isSimulated&&e.preventDefault()},this.stopPropagation=()=>{const e=this.originalEvent;this.isPropagationStopped=Util.returnTrue,e&&!this.isSimulated&&e.stopPropagation()},this.stopImmediatePropagation=()=>{const e=this.originalEvent;this.isImmediatePropagationStopped=Util.returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()},"string"==typeof e?this.type=e:e.type&&(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Util.returnTrue:Util.returnFalse,this.target=e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget,this.timeStamp=e.timeStamp),props&&Object.assign(this,props),this.timeStamp||(this.timeStamp=Date.now())}}!function(EventObject){EventObject.create=function create(originalEvent){return originalEvent instanceof EventObject?originalEvent:new EventObject(originalEvent)}}(EventObject||(EventObject={})),function(EventObject){EventObject.addProperty=function addProperty(name,hook){Object.defineProperty(EventObject.prototype,name,{enumerable:!0,configurable:!0,get:"function"==typeof hook?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value})}})}}(EventObject||(EventObject={})),function(EventObject){const commonProps={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(commonProps).forEach((name=>EventObject.addProperty(name,commonProps[name])))}(EventObject||(EventObject={})),Special||(Special={}),EventHook.register("load",{noBubble:!0}),Special||(Special={}),EventHook.register("beforeunload",{postDispatch(elem,event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}),Special||(Special={}),EventHook.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle(target,event){let ret;const related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||Util.contains(target,related))||(event.type=handleObj.originType,ret=handleObj.handler.call(target,event),event.type="mouseover"),ret}}),EventHook.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle(target,event){let ret;const related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||Util.contains(target,related))||(event.type=handleObj.originType,ret=handleObj.handler.call(target,event),event.type="mouseout"),ret}});var Core,Event,Private,__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};!function(Core){let triggered;function dispatch(elem,evt,...args){const event=EventObject.create(evt);event.delegateTarget=elem;const hook=EventHook.get(event.type);if(hook.preDispatch&&!1===hook.preDispatch(elem,event))return;const handlerQueue=Util.getHandlerQueue(elem,event);for(let i=0,l=handlerQueue.length;i<l&&!event.isPropagationStopped();i+=1){const matched=handlerQueue[i];event.currentTarget=matched.elem;for(let j=0,k=matched.handlers.length;j<k&&!event.isImmediatePropagationStopped();j+=1){const handleObj=matched.handlers[j];if(null==event.rnamespace||handleObj.namespace&&event.rnamespace.test(handleObj.namespace)){event.handleObj=handleObj,event.data=handleObj.data;const hookHandle=EventHook.get(handleObj.originType).handle,result=hookHandle?hookHandle(matched.elem,event,...args):handleObj.handler.call(matched.elem,event,...args);void 0!==result&&(event.result=result,!1===result&&(event.preventDefault(),event.stopPropagation()))}}}return hook.postDispatch&&hook.postDispatch(elem,event),event.result}Core.on=function on(elem,types,handler,data,selector){if(!Util.isValidTarget(elem))return;let handlerData;if("function"!=typeof handler){const{handler:h,selector:s}=handler,others=__rest(handler,["handler","selector"]);handler=h,selector=s,handlerData=others}const store=Store.ensure(elem);let mainHandler=store.handler;null==mainHandler&&(mainHandler=store.handler=function(e,...args){return triggered!==e.type?dispatch(elem,e,...args):void 0});const guid=Util.ensureHandlerId(handler);Util.splitType(types).forEach((item=>{const{originType,namespaces}=Util.normalizeType(item);if(!originType)return;let type=originType,hook=EventHook.get(type);type=(selector?hook.delegateType:hook.bindType)||type,hook=EventHook.get(type);const handleObj=Object.assign({type,originType,data,selector,guid,handler,namespace:namespaces.join(".")},handlerData),events=store.events;let bag=events[type];bag||(bag=events[type]={handlers:[],delegateCount:0},hook.setup&&!1!==hook.setup(elem,data,namespaces,mainHandler)||Util.addEventListener(elem,type,mainHandler)),hook.add&&(Util.removeHandlerId(handleObj.handler),hook.add(elem,handleObj),Util.setHandlerId(handleObj.handler,guid)),selector?(bag.handlers.splice(bag.delegateCount,0,handleObj),bag.delegateCount+=1):bag.handlers.push(handleObj)}))},Core.off=function off(elem,types,handler,selector,mappedTypes){const store=Store.get(elem);if(!store)return;const events=store.events;events&&(Util.splitType(types).forEach((item=>{const{originType,namespaces}=Util.normalizeType(item);if(!originType)return void Object.keys(events).forEach((key=>{off(elem,key+item,handler,selector,!0)}));let type=originType;const hook=EventHook.get(type);type=(selector?hook.delegateType:hook.bindType)||type;const bag=events[type];if(!bag)return;const rns=namespaces.length>0?new RegExp(`(^|\\.)${namespaces.join("\\.(?:.*\\.|)")}(\\.|$)`):null,originHandlerCount=bag.handlers.length;for(let i=bag.handlers.length-1;i>=0;i-=1){const handleObj=bag.handlers[i];!mappedTypes&&originType!==handleObj.originType||handler&&Util.getHandlerId(handler)!==handleObj.guid||!(null==rns||handleObj.namespace&&rns.test(handleObj.namespace))||!(null==selector||selector===handleObj.selector||"**"===selector&&handleObj.selector)||(bag.handlers.splice(i,1),handleObj.selector&&(bag.delegateCount-=1),hook.remove&&hook.remove(elem,handleObj))}originHandlerCount&&0===bag.handlers.length&&(hook.teardown&&!1!==hook.teardown(elem,namespaces,store.handler)||Util.removeEventListener(elem,type,store.handler),delete events[type])})),0===Object.keys(events).length&&Store.remove(elem))},Core.dispatch=dispatch,Core.trigger=function trigger(event,eventArgs,elem,onlyHandlers){let eventObj=event,type="string"==typeof event?event:event.type,namespaces="string"==typeof event||null==eventObj.namespace?[]:eventObj.namespace.split(".");const node=elem;if(3===node.nodeType||8===node.nodeType)return;type.indexOf(".")>-1&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort());const ontype=type.indexOf(":")<0&&`on${type}`;eventObj=event instanceof EventObject?event:new EventObject(type,"object"==typeof event?event:null),eventObj.namespace=namespaces.join("."),eventObj.rnamespace=eventObj.namespace?new RegExp(`(^|\\.)${namespaces.join("\\.(?:.*\\.|)")}(\\.|$)`):null,eventObj.result=void 0,eventObj.target||(eventObj.target=node);const args=[eventObj];Array.isArray(eventArgs)?args.push(...eventArgs):args.push(eventArgs);const hook=EventHook.get(type);if(!onlyHandlers&&hook.trigger&&!1===hook.trigger(node,eventObj,eventArgs))return;let bubbleType;const eventPath=[node];if(!onlyHandlers&&!hook.noBubble&&!Util.isWindow(node)){bubbleType=hook.delegateType||type;let last=node,curr=node.parentNode;for(;null!=curr;)eventPath.push(curr),last=curr,curr=curr.parentNode;if(last===(node.ownerDocument||document)){const win=last.defaultView||last.parentWindow||window;eventPath.push(win)}}let lastElement=node;for(let i=0,l=eventPath.length;i<l&&!eventObj.isPropagationStopped();i+=1){const currElement=eventPath[i];lastElement=currElement,eventObj.type=i>1?bubbleType:hook.bindType||type;const store=Store.get(currElement);store&&store.events[eventObj.type]&&store.handler&&store.handler.call(currElement,...args);const handle=ontype&&currElement[ontype]||null;handle&&Util.isValidTarget(currElement)&&(eventObj.result=handle.call(currElement,...args),!1===eventObj.result&&eventObj.preventDefault())}if(eventObj.type=type,!onlyHandlers&&!eventObj.isDefaultPrevented()){const preventDefault=hook.preventDefault;if((null==preventDefault||!1===preventDefault(eventPath.pop(),eventObj,eventArgs))&&Util.isValidTarget(node)&&ontype&&"function"==typeof node[type]&&!Util.isWindow(node)){const tmp=node[ontype];tmp&&(node[ontype]=null),triggered=type,eventObj.isPropagationStopped()&&lastElement.addEventListener(type,Util.stopPropagationCallback),node[type](),eventObj.isPropagationStopped()&&lastElement.removeEventListener(type,Util.stopPropagationCallback),triggered=void 0,tmp&&(node[ontype]=tmp)}}return eventObj.result}}(Core||(Core={})),function(Event){Event.on=function on(elem,events,selector,data,handler){return Private.on(elem,events,selector,data,handler),elem},Event.once=function once(elem,events,selector,data,handler){return Private.on(elem,events,selector,data,handler,!0),elem},Event.off=function off(elem,events,selector,handler){return Private.off(elem,events,selector,handler),elem},Event.trigger=function trigger(elem,event,args,onlyHandlers){return Core.trigger(event,args,elem,onlyHandlers),elem}}(Event||(Event={})),function(Private){Private.on=function on(elem,types,selector,data,fn,once){if("object"==typeof types)return"string"!=typeof selector&&(data=data||selector,selector=void 0),void Object.keys(types).forEach((type=>on(elem,type,selector,data,types[type],once)));if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=Util.returnFalse;else if(!fn)return;if(once){const originHandler=fn;fn=function(event,...args){return Private.off(elem,event),originHandler.call(this,event,...args)},Util.setHandlerId(fn,Util.ensureHandlerId(originHandler))}Core.on(elem,types,fn,data,selector)},Private.off=function off(elem,events,selector,fn){const evt=events;if(evt&&null!=evt.preventDefault&&null!=evt.handleObj){const obj=evt.handleObj;off(evt.delegateTarget,obj.namespace?`${obj.originType}.${obj.namespace}`:obj.originType,obj.selector,obj.handler)}else if("object"!=typeof events)!1!==selector&&"function"!=typeof selector||(fn=selector,selector=void 0),!1===fn&&(fn=Util.returnFalse),Core.off(elem,events,fn,selector);else{const types=events;Object.keys(types).forEach((type=>off(elem,type,selector,types[type])))}}}(Private||(Private={}));class MouseWheelHandle{constructor(target,onWheelCallback,onWheelGuard){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=Platform.isEventSupported("wheel")?"wheel":"mousewheel",this.target=target,this.onWheelCallback=onWheelCallback,this.onWheelGuard=onWheelGuard,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}disable(){this.target.removeEventListener(this.eventName,this.onWheel)}onWheel(e){if(null!=this.onWheelGuard&&!this.onWheelGuard(e))return;let changed;this.deltaX+=e.deltaX,this.deltaY+=e.deltaY,e.preventDefault(),0===this.deltaX&&0===this.deltaY||(e.stopPropagation(),changed=!0),!0===changed&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((()=>{this.didWheel(e)})))}didWheel(e){this.animationFrameId=0,this.onWheelCallback(e,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}function util_debounce(fn,delay=60){let timer=null;return(...args)=>{timer&&clearTimeout(timer),timer=window.setTimeout((()=>{fn.apply(this,args)}),delay)}}const sensors_createSensor="undefined"!=typeof ResizeObserver?function observer_createSensor(element){let sensor=null,listeners=[];const trigger=util_debounce((()=>{listeners.forEach((listener=>{listener(element)}))})),destroy=()=>{sensor&&(sensor.disconnect(),listeners=[],sensor=null)};return{element,bind:listener=>{sensor||(sensor=(()=>{const s=new ResizeObserver(trigger);return s.observe(element),trigger(),s})()),-1===listeners.indexOf(listener)&&listeners.push(listener)},destroy,unbind:listener=>{const idx=listeners.indexOf(listener);-1!==idx&&listeners.splice(idx,1),0===listeners.length&&sensor&&destroy()}}}:function createSensor(element){let sensor=null,listeners=[];const trigger=util_debounce((()=>{listeners.forEach((listener=>listener(element)))})),destroy=()=>{sensor&&sensor.parentNode&&(sensor.contentDocument&&sensor.contentDocument.defaultView.removeEventListener("resize",trigger),sensor.parentNode.removeChild(sensor),sensor=null,listeners=[])};return{element,bind:listener=>{sensor||(sensor=(()=>{"static"===getComputedStyle(element).position&&(element.style.position="relative");const obj=document.createElement("object");return obj.onload=()=>{obj.contentDocument.defaultView.addEventListener("resize",trigger),trigger()},obj.style.display="block",obj.style.position="absolute",obj.style.top="0",obj.style.left="0",obj.style.height="100%",obj.style.width="100%",obj.style.overflow="hidden",obj.style.pointerEvents="none",obj.style.zIndex="-1",obj.style.opacity="0",obj.setAttribute("tabindex","-1"),obj.type="text/html",element.appendChild(obj),obj.data="about:blank",obj})()),-1===listeners.indexOf(listener)&&listeners.push(listener)},destroy,unbind:listener=>{const idx=listeners.indexOf(listener);-1!==idx&&listeners.splice(idx,1),0===listeners.length&&sensor&&destroy()}}};var SizeSensor,Dijkstra,ModifierKey,Timing,Interp;!function(SizeSensor){const cache=new WeakMap;function get(element){let sensor=cache.get(element);return sensor||(sensor=sensors_createSensor(element),cache.set(element,sensor),sensor)}SizeSensor.bind=(element,cb)=>{const sensor=get(element);return sensor.bind(cb),()=>sensor.unbind(cb)},SizeSensor.clear=element=>{!function remove(sensor){sensor.destroy(),cache.delete(sensor.element)}(get(element))}}(SizeSensor||(SizeSensor={}));class PriorityQueue{constructor(options={}){this.comparator=options.comparator||PriorityQueue.defaultComparator,this.index={},this.data=options.data||[],this.heapify()}isEmpty(){return 0===this.data.length}insert(priority,value,id){const item={priority,value},index=this.data.length;return id&&(item.id=id,this.index[id]=index),this.data.push(item),this.bubbleUp(index),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(id,priority){const index=this.index[id];if(void 0===index)throw new Error(`Node with id '${id}' was not found in the heap.`);const data=this.data,oldPriority=data[index].priority,comp=this.comparator(priority,oldPriority);comp<0?(data[index].priority=priority,this.bubbleUp(index)):comp>0&&(data[index].priority=priority,this.bubbleDown(index))}remove(){const data=this.data,peek=data[0],last=data.pop();return peek.id&&delete this.index[peek.id],data.length>0&&(data[0]=last,last.id&&(this.index[last.id]=0),this.bubbleDown(0)),peek?peek.value:null}heapify(){for(let i=0;i<this.data.length;i+=1)this.bubbleUp(i)}bubbleUp(index){const data=this.data;let tmp,parent,current=index;for(;current>0&&(parent=current-1>>>1,this.comparator(data[current].priority,data[parent].priority)<0);){tmp=data[parent],data[parent]=data[current];let id=data[current].id;null!=id&&(this.index[id]=parent),data[current]=tmp,id=data[current].id,null!=id&&(this.index[id]=current),current=parent}}bubbleDown(index){const data=this.data,last=data.length-1;let current=index;for(;;){const left=1+(current<<1),right=left+1;let minIndex=current;if(left<=last&&this.comparator(data[left].priority,data[minIndex].priority)<0&&(minIndex=left),right<=last&&this.comparator(data[right].priority,data[minIndex].priority)<0&&(minIndex=right),minIndex===current)break;{const tmp=data[minIndex];data[minIndex]=data[current];let id=data[current].id;null!=id&&(this.index[id]=minIndex),data[current]=tmp,id=data[current].id,null!=id&&(this.index[id]=current),current=minIndex}}}}!function(PriorityQueue){PriorityQueue.defaultComparator=(a,b)=>a-b}(PriorityQueue||(PriorityQueue={})),function(Dijkstra){Dijkstra.run=function run(adjacencyList,source,weight=(u,v)=>1){const dist={},previous={},scanned={},queue=new PriorityQueue;for(dist[source]=0,Object.keys(adjacencyList).forEach((v=>{v!==source&&(dist[v]=1/0),queue.insert(dist[v],v,v)}));!queue.isEmpty();){const u=queue.remove();scanned[u]=!0;const neighbours=adjacencyList[u]||[];for(let i=0;i<neighbours.length;i+=1){const v=neighbours[i];if(!scanned[v]){const alt=dist[u]+weight(u,v);alt<dist[v]&&(dist[v]=alt,previous[v]=u,queue.updatePriority(v,alt))}}}return previous}}(Dijkstra||(Dijkstra={}));class Color{constructor(color,g,b,a){return null==color?this.set(255,255,255,1):"number"==typeof color?this.set(color,g,b,a):"string"==typeof color?Color.fromString(color)||this:Array.isArray(color)?this.set(color):void this.set(color.r,color.g,color.b,null==color.a?1:color.a)}blend(start,end,weight){this.set(start.r+(end.r-start.r)*weight,start.g+(end.g-start.g)*weight,start.b+(end.b-start.b)*weight,start.a+(end.a-start.a)*weight)}lighten(amount){const rgba=Color.lighten(this.toArray(),amount);this.r=rgba[0],this.g=rgba[1],this.b=rgba[2],this.a=rgba[3]}darken(amount){this.lighten(-amount)}set(arg0,arg1,arg2,arg3){const r=Array.isArray(arg0)?arg0[0]:arg0,g=Array.isArray(arg0)?arg0[1]:arg1,b=Array.isArray(arg0)?arg0[2]:arg2,a=Array.isArray(arg0)?arg0[3]:arg3;return this.r=Math.round(lodash_es_clamp(r,0,255)),this.g=Math.round(lodash_es_clamp(g,0,255)),this.b=Math.round(lodash_es_clamp(b,0,255)),this.a=null==a?1:lodash_es_clamp(a,0,1),this}toHex(){return`#${["r","g","b"].map((key=>{const str=this[key].toString(16);return str.length<2?`0${str}`:str})).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return Color.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(ignoreAlpha){const rgb=`${this.r},${this.g},${this.b},`;return ignoreAlpha?`rgb(${rgb})`:`rgba(${rgb},${this.a})`}toGrey(){return Color.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}!function(Color){function fromHex(color){return new Color([...hex2rgb(color),1])}function fromRGBA(color){const matches=color.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(matches){const arr=matches[1].split(/\s*,\s*/).map((v=>parseInt(v,10)));return new Color(arr)}return null}function hue2rgb(m1,m2,h){h<0&&++h,h>1&&--h;const h6=6*h;return h6<1?m1+(m2-m1)*h6:2*h<1?m2:3*h<2?m1+(m2-m1)*(2/3-h)*6:m1}function fromHSLA(color){const matches=color.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(matches){const arr=matches[2].split(/\s*,\s*/),h=(parseFloat(arr[0])%360+360)%360/360,s=parseFloat(arr[1])/100,l=parseFloat(arr[2])/100,a=null==arr[3]?1:parseInt(arr[3],10);return new Color(hsla2rgba(h,s,l,a))}return null}function hsla2rgba(arg0,arg1,arg2,arg3){const h=Array.isArray(arg0)?arg0[0]:arg0,s=Array.isArray(arg0)?arg0[1]:arg1,l=Array.isArray(arg0)?arg0[2]:arg2,a=Array.isArray(arg0)?arg0[3]:arg3,m2=l<=.5?l*(s+1):l+s-l*s,m1=2*l-m2;return[256*hue2rgb(m1,m2,h+1/3),256*hue2rgb(m1,m2,h),256*hue2rgb(m1,m2,h-1/3),null==a?1:a]}function random(ignoreAlpha){return new Color(Math.round(256*Math.random()),Math.round(256*Math.random()),Math.round(256*Math.random()),ignoreAlpha?void 0:parseFloat(Math.random().toFixed(2)))}function hex2rgb(hex){const color=0===hex.indexOf("#")?hex:`#${hex}`;let val=Number(`0x${color.substr(1)}`);if(4!==color.length&&7!==color.length||Number.isNaN(val))throw new Error("Invalid hex color.");const bits=4===color.length?4:8,mask=(1<<bits)-1,bgr=["b","g","r"].map((()=>{const c=val&mask;return val>>=bits,4===bits?17*c:c}));return[bgr[2],bgr[1],bgr[0]]}function rgb2hex(r,g,b){const pad=hex=>hex.length<2?`0${hex}`:hex;return`${pad(r.toString(16))}${pad(g.toString(16))}${pad(b.toString(16))}`}function lum(color,amt){if("string"==typeof color){const pound="#"===color[0],num=parseInt(pound?color.substr(1):color,16),r=lodash_es_clamp((num>>16)+amt,0,255),g=lodash_es_clamp((num>>8&255)+amt,0,255);return`${pound?"#":""}${(lodash_es_clamp((255&num)+amt,0,255)|g<<8|r<<16).toString(16)}`}const arr=hex2rgb(lum(rgb2hex(color[0],color[1],color[2]),amt));return[arr[0],arr[1],arr[2],color[3]]}Color.fromArray=function fromArray(arr){return new Color(arr)},Color.fromHex=fromHex,Color.fromRGBA=fromRGBA,Color.fromHSLA=fromHSLA,Color.fromString=function fromString(color){if(color.startsWith("#"))return fromHex(color);if(color.startsWith("rgb"))return fromRGBA(color);const preset=Color.named[color];return preset?fromHex(preset):fromHSLA(color)},Color.makeGrey=function makeGrey(g,a){return Color.fromArray([g,g,g,a])},Color.rgba2hsla=function rgba2hsla(arg0,arg1,arg2,arg3){const r=Array.isArray(arg0)?arg0[0]:arg0,g=Array.isArray(arg0)?arg0[1]:arg1,b=Array.isArray(arg0)?arg0[2]:arg2,a=Array.isArray(arg0)?arg0[3]:arg3,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2;let h=0,s=0;if(min!==max){const d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return[h,s,l,null==a?1:a]},Color.hsla2rgba=hsla2rgba,Color.random=random,Color.randomHex=function randomHex(){let color="#";for(let i=0;i<6;i+=1)color+="0123456789ABCDEF"[Math.floor(16*Math.random())];return color},Color.randomRGBA=function randomRGBA(ignoreAlpha){return random(ignoreAlpha).toString()},Color.invert=function invert(color,bw){if("string"==typeof color){const pound="#"===color[0],[r,g,b]=hex2rgb(color);return bw?.299*r+.587*g+.114*b>186?"#000000":"#ffffff":`${pound?"#":""}${rgb2hex(255-r,255-g,255-b)}`}const r=color[0],g=color[1],b=color[2],a=color[3];return bw?.299*r+.587*g+.114*b>186?[0,0,0,a]:[255,255,255,a]:[255-r,255-g,255-b,a]},Color.lighten=function lighten(color,amt){return lum(color,amt)},Color.darken=function darken(color,amt){return lum(color,-amt)}}(Color||(Color={})),function(Color){Color.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(Color||(Color={}));class Dictionary{constructor(){this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(key){return this.map.has(key)}get(key){return this.map.get(key)}set(key,value){this.map.set(key,value),this.arr.push(key)}delete(key){const index=this.arr.indexOf(key);index>=0&&this.arr.splice(index,1);const ret=this.map.get(key);return this.map.delete(key),ret}each(iterator){this.arr.forEach((key=>{const value=this.map.get(key);iterator(value,key)}))}dispose(){this.clear()}}!function(ModifierKey){function parse(modifiers){const or=[],and=[];return Array.isArray(modifiers)?or.push(...modifiers):modifiers.split("|").forEach((item=>{-1===item.indexOf("&")?or.push(item):and.push(...item.split("&"))})),{or,and}}ModifierKey.parse=parse,ModifierKey.equals=function equals(modifiers1,modifiers2){if(null!=modifiers1&&null!=modifiers2){const m1=parse(modifiers1),m2=parse(modifiers2),or1=m1.or.sort(),or2=m2.or.sort(),and1=m1.and.sort(),and2=m2.and.sort(),equal=(a1,a2)=>a1.length===a2.length&&(0===a1.length||a1.every(((a,i)=>a===a2[i])));return equal(or1,or2)&&equal(and1,and2)}return null==modifiers1&&null==modifiers2},ModifierKey.isMatch=function isMatch(e,modifiers,strict){if(null==modifiers||Array.isArray(modifiers)&&0===modifiers.length)return!strict||!0!==e.altKey&&!0!==e.ctrlKey&&!0!==e.metaKey&&!0!==e.shiftKey;const{or,and}=parse(modifiers),match=key=>{const name=`${key.toLowerCase()}Key`;return!0===e[name]};return or.some((key=>match(key)))&&and.every((key=>match(key)))}}(ModifierKey||(ModifierKey={})),function(Timing){Timing.linear=t=>t,Timing.quad=t=>t*t,Timing.cubic=t=>t*t*t,Timing.inout=t=>{if(t<=0)return 0;if(t>=1)return 1;const t2=t*t,t3=t2*t;return 4*(t<.5?t3:3*(t-t2)+t3-.75)},Timing.exponential=t=>Math.pow(2,10*(t-1)),Timing.bounce=t=>{for(let a=0,b=1;;a+=b,b/=2)if(t>=(7-4*a)/11){const q=(11-6*a-11*t)/4;return-q*q+b*b}}}(Timing||(Timing={})),function(Timing){Timing.decorators={reverse:f=>t=>1-f(1-t),reflect:f=>t=>.5*(t<.5?f(2*t):2-f(2-2*t)),clamp:(f,n=0,x=1)=>t=>{const r=f(t);return r<n?n:r>x?x:r},back:(s=1.70158)=>t=>t*t*((s+1)*t-s),elastic:(x=1.5)=>t=>Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*x/3*t)}}(Timing||(Timing={})),function(Timing){function easeOutBounce(t){const scaledTime=t/1;if(scaledTime<1/2.75)return 7.5625*scaledTime*scaledTime;if(scaledTime<2/2.75){const scaledTime2=scaledTime-1.5/2.75;return 7.5625*scaledTime2*scaledTime2+.75}if(scaledTime<2.5/2.75){const scaledTime2=scaledTime-2.25/2.75;return 7.5625*scaledTime2*scaledTime2+.9375}{const scaledTime2=scaledTime-2.625/2.75;return 7.5625*scaledTime2*scaledTime2+.984375}}function easeInBounce(t){return 1-easeOutBounce(1-t)}Timing.easeInSine=function easeInSine(t){return-1*Math.cos(t*(Math.PI/2))+1},Timing.easeOutSine=function easeOutSine(t){return Math.sin(t*(Math.PI/2))},Timing.easeInOutSine=function easeInOutSine(t){return-.5*(Math.cos(Math.PI*t)-1)},Timing.easeInQuad=function easeInQuad(t){return t*t},Timing.easeOutQuad=function easeOutQuad(t){return t*(2-t)},Timing.easeInOutQuad=function easeInOutQuad(t){return t<.5?2*t*t:(4-2*t)*t-1},Timing.easeInCubic=function easeInCubic(t){return t*t*t},Timing.easeOutCubic=function easeOutCubic(t){const t1=t-1;return t1*t1*t1+1},Timing.easeInOutCubic=function easeInOutCubic(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Timing.easeInQuart=function easeInQuart(t){return t*t*t*t},Timing.easeOutQuart=function easeOutQuart(t){const t1=t-1;return 1-t1*t1*t1*t1},Timing.easeInOutQuart=function easeInOutQuart(t){const t1=t-1;return t<.5?8*t*t*t*t:1-8*t1*t1*t1*t1},Timing.easeInQuint=function easeInQuint(t){return t*t*t*t*t},Timing.easeOutQuint=function easeOutQuint(t){const t1=t-1;return 1+t1*t1*t1*t1*t1},Timing.easeInOutQuint=function easeInOutQuint(t){const t1=t-1;return t<.5?16*t*t*t*t*t:1+16*t1*t1*t1*t1*t1},Timing.easeInExpo=function easeInExpo(t){return 0===t?0:Math.pow(2,10*(t-1))},Timing.easeOutExpo=function easeOutExpo(t){return 1===t?1:1-Math.pow(2,-10*t)},Timing.easeInOutExpo=function easeInOutExpo(t){if(0===t||1===t)return t;const scaledTime=2*t,scaledTime1=scaledTime-1;return scaledTime<1?.5*Math.pow(2,10*scaledTime1):.5*(2-Math.pow(2,-10*scaledTime1))},Timing.easeInCirc=function easeInCirc(t){const scaledTime=t/1;return-1*(Math.sqrt(1-scaledTime*t)-1)},Timing.easeOutCirc=function easeOutCirc(t){const t1=t-1;return Math.sqrt(1-t1*t1)},Timing.easeInOutCirc=function easeInOutCirc(t){const scaledTime=2*t,scaledTime1=scaledTime-2;return scaledTime<1?-.5*(Math.sqrt(1-scaledTime*scaledTime)-1):.5*(Math.sqrt(1-scaledTime1*scaledTime1)+1)},Timing.easeInBack=function easeInBack(t,magnitude=1.70158){return t*t*((magnitude+1)*t-magnitude)},Timing.easeOutBack=function easeOutBack(t,magnitude=1.70158){const scaledTime=t/1-1;return scaledTime*scaledTime*((magnitude+1)*scaledTime+magnitude)+1},Timing.easeInOutBack=function easeInOutBack(t,magnitude=1.70158){const scaledTime=2*t,scaledTime2=scaledTime-2,s=1.525*magnitude;return scaledTime<1?.5*scaledTime*scaledTime*((s+1)*scaledTime-s):.5*(scaledTime2*scaledTime2*((s+1)*scaledTime2+s)+2)},Timing.easeInElastic=function easeInElastic(t,magnitude=.7){if(0===t||1===t)return t;const scaledTime1=t/1-1,p=1-magnitude,s=p/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*scaledTime1)*Math.sin((scaledTime1-s)*(2*Math.PI)/p)},Timing.easeOutElastic=function easeOutElastic(t,magnitude=.7){const p=1-magnitude,scaledTime=2*t;if(0===t||1===t)return t;const s=p/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*scaledTime)*Math.sin((scaledTime-s)*(2*Math.PI)/p)+1},Timing.easeInOutElastic=function easeInOutElastic(t,magnitude=.65){const p=1-magnitude;if(0===t||1===t)return t;const scaledTime=2*t,scaledTime1=scaledTime-1,s=p/(2*Math.PI)*Math.asin(1);return scaledTime<1?Math.pow(2,10*scaledTime1)*Math.sin((scaledTime1-s)*(2*Math.PI)/p)*-.5:Math.pow(2,-10*scaledTime1)*Math.sin((scaledTime1-s)*(2*Math.PI)/p)*.5+1},Timing.easeOutBounce=easeOutBounce,Timing.easeInBounce=easeInBounce,Timing.easeInOutBounce=function easeInOutBounce(t){return t<.5?.5*easeInBounce(2*t):.5*easeOutBounce(2*t-1)+.5}}(Timing||(Timing={})),function(Interp){Interp.number=(a,b)=>{const d=b-a;return t=>a+d*t},Interp.object=(a,b)=>{const keys=Object.keys(a);return t=>{const ret={};for(let i=keys.length-1;-1!==i;i-=1){const key=keys[i];ret[key]=a[key]+(b[key]-a[key])*t}return ret}},Interp.unit=(a,b)=>{const reg=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,ma=reg.exec(a),mb=reg.exec(b),pb=mb?mb[1]:"",aa=ma?+ma[1]:0,bb=mb?+mb[1]:0,index=pb.indexOf("."),precision=index>0?pb[1].length-index-1:0,d=bb-aa,u=ma?ma[2]:"";return t=>(aa+d*t).toFixed(precision)+u},Interp.color=(a,b)=>{const ca=parseInt(a.slice(1),16),cb=parseInt(b.slice(1),16),ra=255&ca,rd=(255&cb)-ra,ga=65280&ca,gd=(65280&cb)-ga,ba=16711680&ca,bd=(16711680&cb)-ba;return t=>`#${(1<<24|ra+rd*t&255|ga+gd*t&65280|ba+bd*t&16711680).toString(16).slice(1)}`}}(Interp||(Interp={}));const cssModules=[];var Angle,GeometryUtil;!function(Angle){Angle.toDeg=function toDeg(rad){return 180*rad/Math.PI%360},Angle.toRad=function(deg,over360=!1){return(over360?deg:deg%360)*Math.PI/180},Angle.normalize=function normalize(angle){return angle%360+(angle<0?360:0)}}(Angle||(Angle={})),function(GeometryUtil){GeometryUtil.round=function round(num,precision=0){return Number.isInteger(num)?num:+num.toFixed(precision)},GeometryUtil.random=function random(min,max){let mmin,mmax;if(null==max?(mmax=null==min?1:min,mmin=0):(mmax=max,mmin=null==min?0:min),mmax<mmin){const temp=mmin;mmin=mmax,mmax=temp}return Math.floor(Math.random()*(mmax-mmin+1)+mmin)},GeometryUtil.clamp=function clamp(value,min,max){return Number.isNaN(value)?NaN:Number.isNaN(min)||Number.isNaN(max)?0:min<max?value<min?min:value>max?max:value:value<max?max:value>min?min:value},GeometryUtil.snapToGrid=function snapToGrid(value,gridSize){return gridSize*Math.round(value/gridSize)},GeometryUtil.containsPoint=function containsPoint(rect,point){return null!=point&&null!=rect&&point.x>=rect.x&&point.x<=rect.x+rect.width&&point.y>=rect.y&&point.y<=rect.y+rect.height},GeometryUtil.squaredLength=function squaredLength(p1,p2){const dx=p1.x-p2.x,dy=p1.y-p2.y;return dx*dx+dy*dy}}(GeometryUtil||(GeometryUtil={}));class Geometry{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class Point extends Geometry{constructor(x,y){super(),this.x=null==x?0:x,this.y=null==y?0:y}round(precision=0){return this.x=GeometryUtil.round(this.x,precision),this.y=GeometryUtil.round(this.y,precision),this}add(x,y){const p=Point.create(x,y);return this.x+=p.x,this.y+=p.y,this}update(x,y){const p=Point.create(x,y);return this.x=p.x,this.y=p.y,this}translate(dx,dy){const t=Point.create(dx,dy);return this.x+=t.x,this.y+=t.y,this}rotate(degree,center){const p=Point.rotate(this,degree,center);return this.x=p.x,this.y=p.y,this}scale(sx,sy,origin=new Point){const ref=Point.create(origin);return this.x=ref.x+sx*(this.x-ref.x),this.y=ref.y+sy*(this.y-ref.y),this}closest(points){if(1===points.length)return Point.create(points[0]);let ret=null,min=1/0;return points.forEach((p=>{const dist=this.squaredDistance(p);dist<min&&(ret=p,min=dist)})),ret?Point.create(ret):null}distance(p){return Math.sqrt(this.squaredDistance(p))}squaredDistance(p){const ref=Point.create(p),dx=this.x-ref.x,dy=this.y-ref.y;return dx*dx+dy*dy}manhattanDistance(p){const ref=Point.create(p);return Math.abs(ref.x-this.x)+Math.abs(ref.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(p=new Point){const ref=Point.create(p),y=-(ref.y-this.y),x=ref.x-this.x;let rad=Math.atan2(y,x);return rad<0&&(rad=2*Math.PI+rad),180*rad/Math.PI}angleBetween(p1,p2){if(this.equals(p1)||this.equals(p2))return NaN;let angle=this.theta(p2)-this.theta(p1);return angle<0&&(angle+=360),angle}vectorAngle(p){return new Point(0,0).angleBetween(this,p)}toPolar(origin){return this.update(Point.toPolar(this,origin)),this}changeInAngle(dx,dy,ref=new Point){return this.clone().translate(-dx,-dy).theta(ref)-this.theta(ref)}adhereToRect(rect){return GeometryUtil.containsPoint(rect,this)||(this.x=Math.min(Math.max(this.x,rect.x),rect.x+rect.width),this.y=Math.min(Math.max(this.y,rect.y),rect.y+rect.height)),this}bearing(p){const ref=Point.create(p),lat1=Angle.toRad(this.y),lat2=Angle.toRad(ref.y),lon1=this.x,lon2=ref.x,dLon=Angle.toRad(lon2-lon1),y=Math.sin(dLon)*Math.cos(lat2),x=Math.cos(lat1)*Math.sin(lat2)-Math.sin(lat1)*Math.cos(lat2)*Math.cos(dLon);let index=Angle.toDeg(Math.atan2(y,x))-22.5;return index<0&&(index+=360),index=parseInt(index/45,10),["NE","E","SE","S","SW","W","NW","N"][index]}cross(p1,p2){if(null!=p1&&null!=p2){const a=Point.create(p1),b=Point.create(p2);return(b.x-this.x)*(a.y-this.y)-(b.y-this.y)*(a.x-this.x)}return NaN}dot(p){const ref=Point.create(p);return this.x*ref.x+this.y*ref.y}diff(dx,dy){if("number"==typeof dx)return new Point(this.x-dx,this.y-dy);const p=Point.create(dx);return new Point(this.x-p.x,this.y-p.y)}lerp(p,t){const ref=Point.create(p);return new Point((1-t)*this.x+t*ref.x,(1-t)*this.y+t*ref.y)}normalize(length=1){const scale=length/this.magnitude();return this.scale(scale,scale)}move(ref,distance){const p=Point.create(ref),rad=Angle.toRad(p.theta(this));return this.translate(Math.cos(rad)*distance,-Math.sin(rad)*distance)}reflection(ref){return Point.create(ref).move(this,this.distance(ref))}snapToGrid(gx,gy){return this.x=GeometryUtil.snapToGrid(this.x,gx),this.y=GeometryUtil.snapToGrid(this.y,null==gy?gx:gy),this}equals(p){const ref=Point.create(p);return null!=ref&&ref.x===this.x&&ref.y===this.y}clone(){return Point.clone(this)}toJSON(){return Point.toJSON(this)}serialize(){return`${this.x} ${this.y}`}}!function(Point){Point.isPoint=function isPoint(instance){return null!=instance&&instance instanceof Point}}(Point||(Point={})),function(Point){Point.isPointLike=function isPointLike(p){return null!=p&&"object"==typeof p&&"number"==typeof p.x&&"number"==typeof p.y},Point.isPointData=function isPointData(p){return null!=p&&Array.isArray(p)&&2===p.length&&"number"==typeof p[0]&&"number"==typeof p[1]}}(Point||(Point={})),function(Point){function clone(p){return Point.isPoint(p)?new Point(p.x,p.y):Array.isArray(p)?new Point(p[0],p[1]):new Point(p.x,p.y)}function equals(p1,p2){return p1===p2||null!=p1&&null!=p2&&(p1.x===p2.x&&p1.y===p2.y)}function rotateEx(point,cos,sin,center=new Point){const source=clone(point),origin=clone(center),dx=source.x-origin.x,dy=source.y-origin.y,y1=dy*cos+dx*sin;return new Point(dx*cos-dy*sin+origin.x,y1+origin.y)}Point.create=function create(x,y){return null==x||"number"==typeof x?new Point(x,y):clone(x)},Point.clone=clone,Point.toJSON=function toJSON(p){return Point.isPoint(p)?{x:p.x,y:p.y}:Array.isArray(p)?{x:p[0],y:p[1]}:{x:p.x,y:p.y}},Point.fromPolar=function fromPolar(r,rad,origin=new Point){let x=Math.abs(r*Math.cos(rad)),y=Math.abs(r*Math.sin(rad));const org=clone(origin),deg=Angle.normalize(Angle.toDeg(rad));return deg<90?y=-y:deg<180?(x=-x,y=-y):deg<270&&(x=-x),new Point(org.x+x,org.y+y)},Point.toPolar=function toPolar(point,origin=new Point){const p=clone(point),o=clone(origin),dx=p.x-o.x,dy=p.y-o.y;return new Point(Math.sqrt(dx*dx+dy*dy),Angle.toRad(o.theta(p)))},Point.equals=equals,Point.equalPoints=function equalPoints(p1,p2){if(null==p1&&null!=p2||null!=p1&&null==p2||null!=p1&&null!=p2&&p1.length!==p2.length)return!1;if(null!=p1&&null!=p2)for(let i=0,ii=p1.length;i<ii;i+=1)if(!equals(p1[i],p2[i]))return!1;return!0},Point.random=function random(x1,x2,y1,y2){return new Point(GeometryUtil.random(x1,x2),GeometryUtil.random(y1,y2))},Point.rotate=function rotate(point,angle,center){const rad=Angle.toRad(Angle.normalize(-angle)),sin=Math.sin(rad);return rotateEx(point,Math.cos(rad),sin,center)},Point.rotateEx=rotateEx}(Point||(Point={}));class Rectangle extends Geometry{get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new Point(this.x,this.y)}get topLeft(){return new Point(this.x,this.y)}get topCenter(){return new Point(this.x+this.width/2,this.y)}get topRight(){return new Point(this.x+this.width,this.y)}get center(){return new Point(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new Point(this.x,this.y+this.height)}get bottomCenter(){return new Point(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new Point(this.x+this.width,this.y+this.height)}get corner(){return new Point(this.x+this.width,this.y+this.height)}get rightMiddle(){return new Point(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new Point(this.x,this.y+this.height/2)}get topLine(){return new Line(this.topLeft,this.topRight)}get rightLine(){return new Line(this.topRight,this.bottomRight)}get bottomLine(){return new Line(this.bottomLeft,this.bottomRight)}get leftLine(){return new Line(this.topLeft,this.bottomLeft)}constructor(x,y,width,height){super(),this.x=null==x?0:x,this.y=null==y?0:y,this.width=null==width?0:width,this.height=null==height?0:height}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(angle){if(!angle)return this.clone();const rad=Angle.toRad(angle),st=Math.abs(Math.sin(rad)),ct=Math.abs(Math.cos(rad)),w=this.width*ct+this.height*st,h=this.width*st+this.height*ct;return new Rectangle(this.x+(this.width-w)/2,this.y+(this.height-h)/2,w,h)}round(precision=0){return this.x=GeometryUtil.round(this.x,precision),this.y=GeometryUtil.round(this.y,precision),this.width=GeometryUtil.round(this.width,precision),this.height=GeometryUtil.round(this.height,precision),this}add(x,y,width,height){const rect=Rectangle.create(x,y,width,height),minX=Math.min(this.x,rect.x),minY=Math.min(this.y,rect.y),maxX=Math.max(this.x+this.width,rect.x+rect.width),maxY=Math.max(this.y+this.height,rect.y+rect.height);return this.x=minX,this.y=minY,this.width=maxX-minX,this.height=maxY-minY,this}update(x,y,width,height){const rect=Rectangle.create(x,y,width,height);return this.x=rect.x,this.y=rect.y,this.width=rect.width,this.height=rect.height,this}inflate(dx,dy){const w=dx,h=null!=dy?dy:dx;return this.x-=w,this.y-=h,this.width+=2*w,this.height+=2*h,this}snapToGrid(gx,gy){const origin=this.origin.snapToGrid(gx,gy),corner=this.corner.snapToGrid(gx,gy);return this.x=origin.x,this.y=origin.y,this.width=corner.x-origin.x,this.height=corner.y-origin.y,this}translate(tx,ty){const p=Point.create(tx,ty);return this.x+=p.x,this.y+=p.y,this}scale(sx,sy,origin=new Point){const pos=this.origin.scale(sx,sy,origin);return this.x=pos.x,this.y=pos.y,this.width*=sx,this.height*=sy,this}rotate(degree,center=this.getCenter()){if(0!==degree){const rad=Angle.toRad(degree),cos=Math.cos(rad),sin=Math.sin(rad);let p1=this.getOrigin(),p2=this.getTopRight(),p3=this.getBottomRight(),p4=this.getBottomLeft();p1=Point.rotateEx(p1,cos,sin,center),p2=Point.rotateEx(p2,cos,sin,center),p3=Point.rotateEx(p3,cos,sin,center),p4=Point.rotateEx(p4,cos,sin,center);const rect=new Rectangle(p1.x,p1.y,0,0);rect.add(p2.x,p2.y,0,0),rect.add(p3.x,p3.y,0,0),rect.add(p4.x,p4.y,0,0),this.update(rect)}return this}rotate90(){const t=(this.width-this.height)/2;this.x+=t,this.y-=t;const tmp=this.width;return this.width=this.height,this.height=tmp,this}moveAndExpand(rect){const ref=Rectangle.clone(rect);return this.x+=ref.x||0,this.y+=ref.y||0,this.width+=ref.width||0,this.height+=ref.height||0,this}getMaxScaleToFit(limit,origin=this.center){const rect=Rectangle.clone(limit),ox=origin.x,oy=origin.y;let sx1=1/0,sx2=1/0,sx3=1/0,sx4=1/0,sy1=1/0,sy2=1/0,sy3=1/0,sy4=1/0;const p1=rect.topLeft;p1.x<ox&&(sx1=(this.x-ox)/(p1.x-ox)),p1.y<oy&&(sy1=(this.y-oy)/(p1.y-oy));const p2=rect.bottomRight;p2.x>ox&&(sx2=(this.x+this.width-ox)/(p2.x-ox)),p2.y>oy&&(sy2=(this.y+this.height-oy)/(p2.y-oy));const p3=rect.topRight;p3.x>ox&&(sx3=(this.x+this.width-ox)/(p3.x-ox)),p3.y<oy&&(sy3=(this.y-oy)/(p3.y-oy));const p4=rect.bottomLeft;return p4.x<ox&&(sx4=(this.x-ox)/(p4.x-ox)),p4.y>oy&&(sy4=(this.y+this.height-oy)/(p4.y-oy)),{sx:Math.min(sx1,sx2,sx3,sx4),sy:Math.min(sy1,sy2,sy3,sy4)}}getMaxUniformScaleToFit(limit,origin=this.center){const scale=this.getMaxScaleToFit(limit,origin);return Math.min(scale.sx,scale.sy)}containsPoint(x,y){return GeometryUtil.containsPoint(this,Point.create(x,y))}containsRect(x,y,width,height){const b=Rectangle.create(x,y,width,height),x1=this.x,y1=this.y,w1=this.width,h1=this.height,x2=b.x,y2=b.y,w2=b.width,h2=b.height;return 0!==w1&&0!==h1&&0!==w2&&0!==h2&&(x2>=x1&&y2>=y1&&x2+w2<=x1+w1&&y2+h2<=y1+h1)}intersectsWithLine(line){const rectLines=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],points=[],dedupeArr=[];return rectLines.forEach((l=>{const p=line.intersectsWithLine(l);null!==p&&dedupeArr.indexOf(p.toString())<0&&(points.push(p),dedupeArr.push(p.toString()))})),points.length>0?points:null}intersectsWithLineFromCenterToPoint(p,angle){const ref=Point.clone(p),center=this.center;let result=null;null!=angle&&0!==angle&&ref.rotate(angle,center);const sides=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],connector=new Line(center,ref);for(let i=sides.length-1;i>=0;i-=1){const intersection=sides[i].intersectsWithLine(connector);if(null!==intersection){result=intersection;break}}return result&&null!=angle&&0!==angle&&result.rotate(-angle,center),result}intersectsWithRect(x,y,width,height){const ref=Rectangle.create(x,y,width,height);if(!this.isIntersectWithRect(ref))return null;const myOrigin=this.origin,myCorner=this.corner,rOrigin=ref.origin,rCorner=ref.corner,xx=Math.max(myOrigin.x,rOrigin.x),yy=Math.max(myOrigin.y,rOrigin.y);return new Rectangle(xx,yy,Math.min(myCorner.x,rCorner.x)-xx,Math.min(myCorner.y,rCorner.y)-yy)}isIntersectWithRect(x,y,width,height){const ref=Rectangle.create(x,y,width,height),myOrigin=this.origin,myCorner=this.corner,rOrigin=ref.origin,rCorner=ref.corner;return!(rCorner.x<=myOrigin.x||rCorner.y<=myOrigin.y||rOrigin.x>=myCorner.x||rOrigin.y>=myCorner.y)}normalize(){let newx=this.x,newy=this.y,newwidth=this.width,newheight=this.height;return this.width<0&&(newx=this.x+this.width,newwidth=-this.width),this.height<0&&(newy=this.y+this.height,newheight=-this.height),this.x=newx,this.y=newy,this.width=newwidth,this.height=newheight,this}union(rect){const ref=Rectangle.clone(rect),myOrigin=this.origin,myCorner=this.corner,rOrigin=ref.origin,rCorner=ref.corner,originX=Math.min(myOrigin.x,rOrigin.x),originY=Math.min(myOrigin.y,rOrigin.y),cornerX=Math.max(myCorner.x,rCorner.x),cornerY=Math.max(myCorner.y,rCorner.y);return new Rectangle(originX,originY,cornerX-originX,cornerY-originY)}getNearestSideToPoint(p){const ref=Point.clone(p),distLeft=ref.x-this.x,distRight=this.x+this.width-ref.x,distTop=ref.y-this.y;let closest=distLeft,side="left";return distRight<closest&&(closest=distRight,side="right"),distTop<closest&&(closest=distTop,side="top"),this.y+this.height-ref.y<closest&&(side="bottom"),side}getNearestPointToPoint(p){const ref=Point.clone(p);if(this.containsPoint(ref)){const side=this.getNearestSideToPoint(ref);if("left"===side)return new Point(this.x,ref.y);if("top"===side)return new Point(ref.x,this.y);if("right"===side)return new Point(this.x+this.width,ref.y);if("bottom"===side)return new Point(ref.x,this.y+this.height)}return ref.adhereToRect(this)}equals(rect){return null!=rect&&rect.x===this.x&&rect.y===this.y&&rect.width===this.width&&rect.height===this.height}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}!function(Rectangle){Rectangle.isRectangle=function isRectangle(instance){return null!=instance&&instance instanceof Rectangle}}(Rectangle||(Rectangle={})),function(Rectangle){Rectangle.isRectangleLike=function isRectangleLike(o){return null!=o&&"object"==typeof o&&"number"==typeof o.x&&"number"==typeof o.y&&"number"==typeof o.width&&"number"==typeof o.height}}(Rectangle||(Rectangle={})),function(Rectangle){function clone(rect){return Rectangle.isRectangle(rect)?rect.clone():Array.isArray(rect)?new Rectangle(rect[0],rect[1],rect[2],rect[3]):new Rectangle(rect.x,rect.y,rect.width,rect.height)}Rectangle.create=function create(x,y,width,height){return null==x||"number"==typeof x?new Rectangle(x,y,width,height):clone(x)},Rectangle.clone=clone,Rectangle.fromEllipse=function fromEllipse(ellipse){return new Rectangle(ellipse.x-ellipse.a,ellipse.y-ellipse.b,2*ellipse.a,2*ellipse.b)},Rectangle.fromSize=function fromSize(size){return new Rectangle(0,0,size.width,size.height)},Rectangle.fromPositionAndSize=function fromPositionAndSize(pos,size){return new Rectangle(pos.x,pos.y,size.width,size.height)}}(Rectangle||(Rectangle={}));class Line extends Geometry{get center(){return new Point((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}constructor(x1,y1,x2,y2){super(),"number"==typeof x1&&"number"==typeof y1?(this.start=new Point(x1,y1),this.end=new Point(x2,y2)):(this.start=Point.create(x1),this.end=Point.create(y1))}getCenter(){return this.center}round(precision=0){return this.start.round(precision),this.end.round(precision),this}translate(tx,ty){return"number"==typeof tx?(this.start.translate(tx,ty),this.end.translate(tx,ty)):(this.start.translate(tx),this.end.translate(tx)),this}rotate(angle,origin){return this.start.rotate(angle,origin),this.end.rotate(angle,origin),this}scale(sx,sy,origin){return this.start.scale(sx,sy,origin),this.end.scale(sx,sy,origin),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const dx=this.start.x-this.end.x,dy=this.start.y-this.end.y;return dx*dx+dy*dy}setLength(length){const total=this.length();if(!total)return this;const scale=length/total;return this.scale(scale,scale,this.start)}parallel(distance){const line=this.clone();if(!line.isDifferentiable())return line;const{start,end}=line,eRef=start.clone().rotate(270,end),sRef=end.clone().rotate(90,start);return start.move(sRef,distance),end.move(eRef,distance),line}vector(){return new Point(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const ref=new Point(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,ref)}bbox(){const left=Math.min(this.start.x,this.end.x),top=Math.min(this.start.y,this.end.y),right=Math.max(this.start.x,this.end.x),bottom=Math.max(this.start.y,this.end.y);return new Rectangle(left,top,right-left,bottom-top)}bearing(){return this.start.bearing(this.end)}closestPoint(p){return this.pointAt(this.closestPointNormalizedLength(p))}closestPointLength(p){return this.closestPointNormalizedLength(p)*this.length()}closestPointTangent(p){return this.tangentAt(this.closestPointNormalizedLength(p))}closestPointNormalizedLength(p){const product=this.vector().dot(new Line(this.start,p).vector()),normalized=Math.min(1,Math.max(0,product/this.squaredLength()));return Number.isNaN(normalized)?0:normalized}pointAt(ratio){const start=this.start,end=this.end;return ratio<=0?start.clone():ratio>=1?end.clone():start.lerp(end,ratio)}pointAtLength(length){const start=this.start,end=this.end;let fromStart=!0;length<0&&(fromStart=!1,length=-length);const total=this.length();if(length>=total)return fromStart?end.clone():start.clone();const rate=(fromStart?length:total-length)/total;return this.pointAt(rate)}divideAt(ratio){const dividerPoint=this.pointAt(ratio);return[new Line(this.start,dividerPoint),new Line(dividerPoint,this.end)]}divideAtLength(length){const dividerPoint=this.pointAtLength(length);return[new Line(this.start,dividerPoint),new Line(dividerPoint,this.end)]}containsPoint(p){const start=this.start,end=this.end;if(0!==start.cross(p,end))return!1;const length=this.length();return!(new Line(start,p).length()>length)&&!(new Line(p,end).length()>length)}intersect(shape,options){const ret=shape.intersectsWithLine(this,options);return ret?Array.isArray(ret)?ret:[ret]:null}intersectsWithLine(line){const pt1Dir=new Point(this.end.x-this.start.x,this.end.y-this.start.y),pt2Dir=new Point(line.end.x-line.start.x,line.end.y-line.start.y),det=pt1Dir.x*pt2Dir.y-pt1Dir.y*pt2Dir.x,deltaPt=new Point(line.start.x-this.start.x,line.start.y-this.start.y),alpha=deltaPt.x*pt2Dir.y-deltaPt.y*pt2Dir.x,beta=deltaPt.x*pt1Dir.y-deltaPt.y*pt1Dir.x;if(0===det||alpha*det<0||beta*det<0)return null;if(det>0){if(alpha>det||beta>det)return null}else if(alpha<det||beta<det)return null;return new Point(this.start.x+alpha*pt1Dir.x/det,this.start.y+alpha*pt1Dir.y/det)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(p){const ref=Point.clone(p),start=this.start,end=this.end;return((end.x-start.x)*(ref.y-start.y)-(end.y-start.y)*(ref.x-start.x))/this.length()}pointSquaredDistance(x,y){const p=Point.create(x,y);return this.closestPoint(p).squaredDistance(p)}pointDistance(x,y){const p=Point.create(x,y);return this.closestPoint(p).distance(p)}tangentAt(ratio){if(!this.isDifferentiable())return null;const start=this.start,end=this.end,tangentStart=this.pointAt(ratio),tangentLine=new Line(start,end);return tangentLine.translate(tangentStart.x-start.x,tangentStart.y-start.y),tangentLine}tangentAtLength(length){if(!this.isDifferentiable())return null;const start=this.start,end=this.end,tangentStart=this.pointAtLength(length),tangentLine=new Line(start,end);return tangentLine.translate(tangentStart.x-start.x,tangentStart.y-start.y),tangentLine}relativeCcw(x,y){const ref=Point.create(x,y);let dx1=ref.x-this.start.x,dy1=ref.y-this.start.y;const dx2=this.end.x-this.start.x,dy2=this.end.y-this.start.y;let ccw=dx1*dy2-dy1*dx2;return 0===ccw&&(ccw=dx1*dx2+dy1*dy2,ccw>0&&(dx1-=dx2,dy1-=dy2,ccw=dx1*dx2+dy1*dy2,ccw<0&&(ccw=0))),ccw<0?-1:ccw>0?1:0}equals(l){return null!=l&&this.start.x===l.start.x&&this.start.y===l.start.y&&this.end.x===l.end.x&&this.end.y===l.end.y}clone(){return new Line(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}!function(Line){Line.isLine=function isLine(instance){return null!=instance&&instance instanceof Line}}(Line||(Line={}));class Ellipse extends Geometry{get center(){return new Point(this.x,this.y)}constructor(x,y,a,b){super(),this.x=null==x?0:x,this.y=null==y?0:y,this.a=null==a?0:a,this.b=null==b?0:b}bbox(){return Rectangle.fromEllipse(this)}getCenter(){return this.center}inflate(dx,dy){const w=dx,h=null!=dy?dy:dx;return this.a+=2*w,this.b+=2*h,this}normalizedDistance(x,y){const ref=Point.create(x,y),dx=ref.x-this.x,dy=ref.y-this.y,a=this.a,b=this.b;return dx*dx/(a*a)+dy*dy/(b*b)}containsPoint(x,y){return this.normalizedDistance(x,y)<=1}intersectsWithLine(line){const intersections=[],rx=this.a,ry=this.b,a1=line.start,a2=line.end,dir=line.vector(),diff=a1.diff(new Point(this.x,this.y)),mDir=new Point(dir.x/(rx*rx),dir.y/(ry*ry)),mDiff=new Point(diff.x/(rx*rx),diff.y/(ry*ry)),a=dir.dot(mDir),b=dir.dot(mDiff),d=b*b-a*(diff.dot(mDiff)-1);if(d<0)return null;if(d>0){const root=Math.sqrt(d),ta=(-b-root)/a,tb=(-b+root)/a;if((ta<0||ta>1)&&(tb<0||tb>1))return null;ta>=0&&ta<=1&&intersections.push(a1.lerp(a2,ta)),tb>=0&&tb<=1&&intersections.push(a1.lerp(a2,tb))}else{const t=-b/a;if(!(t>=0&&t<=1))return null;intersections.push(a1.lerp(a2,t))}return intersections}intersectsWithLineFromCenterToPoint(p,angle=0){const ref=Point.clone(p);angle&&ref.rotate(angle,this.getCenter());const dx=ref.x-this.x,dy=ref.y-this.y;let result;if(0===dx)return result=this.bbox().getNearestPointToPoint(ref),angle?result.rotate(-angle,this.getCenter()):result;const m=dy/dx,mSquared=m*m,aSquared=this.a*this.a,bSquared=this.b*this.b;let x=Math.sqrt(1/(1/aSquared+mSquared/bSquared));x=dx<0?-x:x;const y=m*x;return result=new Point(this.x+x,this.y+y),angle?result.rotate(-angle,this.getCenter()):result}tangentTheta(p){const ref=Point.clone(p),x0=ref.x,y0=ref.y,a=this.a,b=this.b,center=this.bbox().center,cx=center.x,cy=center.y,q1=x0>center.x+a/2,q3=x0<center.x-a/2;let x,y;return q1||q3?(y=x0>center.x?y0-30:y0+30,x=a*a/(x0-cx)-a*a*(y0-cy)*(y-cy)/(b*b*(x0-cx))+cx):(x=y0>center.y?x0+30:x0-30,y=b*b/(y0-cy)-b*b*(x0-cx)*(x-cx)/(a*a*(y0-cy))+cy),new Point(x,y).theta(ref)}scale(sx,sy){return this.a*=sx,this.b*=sy,this}rotate(angle,origin){const rect=Rectangle.fromEllipse(this);rect.rotate(angle,origin);const ellipse=Ellipse.fromRect(rect);return this.a=ellipse.a,this.b=ellipse.b,this.x=ellipse.x,this.y=ellipse.y,this}translate(dx,dy){const p=Point.create(dx,dy);return this.x+=p.x,this.y+=p.y,this}equals(ellipse){return null!=ellipse&&ellipse.x===this.x&&ellipse.y===this.y&&ellipse.a===this.a&&ellipse.b===this.b}clone(){return new Ellipse(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}!function(Ellipse){Ellipse.isEllipse=function isEllipse(instance){return null!=instance&&instance instanceof Ellipse}}(Ellipse||(Ellipse={})),function(Ellipse){function parse(e){return Ellipse.isEllipse(e)?e.clone():Array.isArray(e)?new Ellipse(e[0],e[1],e[2],e[3]):new Ellipse(e.x,e.y,e.a,e.b)}Ellipse.create=function create(x,y,a,b){return null==x||"number"==typeof x?new Ellipse(x,y,a,b):parse(x)},Ellipse.parse=parse,Ellipse.fromRect=function fromRect(rect){const center=rect.center;return new Ellipse(center.x,center.y,rect.width/2,rect.height/2)}}(Ellipse||(Ellipse={}));const regexSupportedData=new RegExp("^[\\s\\dLMCZz,.]*$");function isValid(data){return"string"==typeof data&&regexSupportedData.test(data)}function util_mod(n,m){return(n%m+m)%m}function drawPoints(points,options={}){const pts=[];return points&&points.length&&points.forEach((p=>{Array.isArray(p)?pts.push({x:p[0],y:p[1]}):pts.push({x:p.x,y:p.y})})),function draw(points,round,initialMove,close,exclude){const data=[],end=points[points.length-1],rounded=null!=round&&round>0,arcSize=round||0;if(close&&rounded){const p0=(points=points.slice())[0],wp=new Point(end.x+(p0.x-end.x)/2,end.y+(p0.y-end.y)/2);points.splice(0,0,wp)}let pt=points[0],i=1;for(initialMove?data.push("M",pt.x,pt.y):data.push("L",pt.x,pt.y);i<(close?points.length:points.length-1);){let tmp=points[util_mod(i,points.length)],dx=pt.x-tmp.x,dy=pt.y-tmp.y;if(rounded&&(0!==dx||0!==dy)&&(null==exclude||exclude.indexOf(i-1)<0)){let dist=Math.sqrt(dx*dx+dy*dy);const nx1=dx*Math.min(arcSize,dist/2)/dist,ny1=dy*Math.min(arcSize,dist/2)/dist,x1=tmp.x+nx1,y1=tmp.y+ny1;data.push("L",x1,y1);let next=points[util_mod(i+1,points.length)];for(;i<points.length-2&&0===Math.round(next.x-tmp.x)&&0===Math.round(next.y-tmp.y);)next=points[util_mod(i+2,points.length)],i+=1;dx=next.x-tmp.x,dy=next.y-tmp.y,dist=Math.max(1,Math.sqrt(dx*dx+dy*dy));const nx2=dx*Math.min(arcSize,dist/2)/dist,ny2=dy*Math.min(arcSize,dist/2)/dist,x2=tmp.x+nx2,y2=tmp.y+ny2;data.push("Q",tmp.x,tmp.y,x2,y2),tmp=new Point(x2,y2)}else data.push("L",tmp.x,tmp.y);pt=tmp,i+=1}return close?data.push("Z"):data.push("L",end.x,end.y),data.map((v=>"string"==typeof v?v:+v.toFixed(3))).join(" ")}(pts,options.round,null==options.initialMove||options.initialMove,options.close,options.exclude)}function arcToCurves(x0,y0,r1,r2,angle=0,largeArcFlag=0,sweepFlag=0,x,y){if(0===r1||0===r2)return[];x-=x0,y-=y0,r1=Math.abs(r1),r2=Math.abs(r2);const ctx=-x/2,cty=-y/2,cpsi=Math.cos(angle*Math.PI/180),spsi=Math.sin(angle*Math.PI/180),rxd=cpsi*ctx+spsi*cty,ryd=-1*spsi*ctx+cpsi*cty,rxdd=rxd*rxd,rydd=ryd*ryd,r1x=r1*r1,r2y=r2*r2,lamda=rxdd/r1x+rydd/r2y;let sds;if(lamda>1)r1=Math.sqrt(lamda)*r1,r2=Math.sqrt(lamda)*r2,sds=0;else{let seif=1;largeArcFlag===sweepFlag&&(seif=-1),sds=seif*Math.sqrt((r1x*r2y-r1x*rydd-r2y*rxdd)/(r1x*rydd+r2y*rxdd))}const txd=sds*r1*ryd/r2,tyd=-1*sds*r2*rxd/r1,tx=cpsi*txd-spsi*tyd+x/2,ty=spsi*txd+cpsi*tyd+y/2;let rad=Math.atan2((ryd-tyd)/r2,(rxd-txd)/r1)-Math.atan2(0,1),s1=rad>=0?rad:2*Math.PI+rad;rad=Math.atan2((-ryd-tyd)/r2,(-rxd-txd)/r1)-Math.atan2((ryd-tyd)/r2,(rxd-txd)/r1);let dr=rad>=0?rad:2*Math.PI+rad;0===sweepFlag&&dr>0?dr-=2*Math.PI:0!==sweepFlag&&dr<0&&(dr+=2*Math.PI);const sse=2*dr/Math.PI,seg=Math.ceil(sse<0?-1*sse:sse),segr=dr/seg,t=8/3*Math.sin(segr/4)*Math.sin(segr/4)/Math.sin(segr/2),cpsir1=cpsi*r1,cpsir2=cpsi*r2,spsir1=spsi*r1,spsir2=spsi*r2;let mc=Math.cos(s1),ms=Math.sin(s1),x2=-t*(cpsir1*ms+spsir2*mc),y2=-t*(spsir1*ms-cpsir2*mc),x3=0,y3=0;const result=[];for(let n=0;n<seg;n+=1){s1+=segr,mc=Math.cos(s1),ms=Math.sin(s1),x3=cpsir1*mc-spsir2*ms+tx,y3=spsir1*mc+cpsir2*ms+ty;const dx=-t*(cpsir1*ms+spsir2*mc),dy=-t*(spsir1*ms-cpsir2*mc),index=6*n;result[index]=Number(x2+x0),result[index+1]=Number(y2+y0),result[index+2]=Number(x3-dx+x0),result[index+3]=Number(y3-dy+y0),result[index+4]=Number(x3+x0),result[index+5]=Number(y3+y0),x2=x3+dx,y2=y3+dy}return result.map((num=>+num.toFixed(2)))}function drawArc(startX,startY,rx,ry,xAxisRotation=0,largeArcFlag=0,sweepFlag=0,stopX,stopY){const data=[],points=arcToCurves(startX,startY,rx,ry,xAxisRotation,largeArcFlag,sweepFlag,stopX,stopY);if(null!=points)for(let i=0,ii=points.length;i<ii;i+=6)data.push("C",points[i],points[i+1],points[i+2],points[i+3],points[i+4],points[i+5]);return data.join(" ")}class Polyline extends Geometry{get start(){return this.points[0]||null}get end(){return this.points[this.points.length-1]||null}constructor(points){if(super(),null!=points){if("string"==typeof points)return Polyline.parse(points);this.points=points.map((p=>Point.create(p)))}else this.points=[]}scale(sx,sy,origin=new Point){return this.points.forEach((p=>p.scale(sx,sy,origin))),this}rotate(angle,origin){return this.points.forEach((p=>p.rotate(angle,origin))),this}translate(dx,dy){const t=Point.create(dx,dy);return this.points.forEach((p=>p.translate(t.x,t.y))),this}round(precision=0){return this.points.forEach((p=>p.round(precision))),this}bbox(){if(0===this.points.length)return new Rectangle;let x1=1/0,x2=-1/0,y1=1/0,y2=-1/0;const points=this.points;for(let i=0,ii=points.length;i<ii;i+=1){const point=points[i],x=point.x,y=point.y;x<x1&&(x1=x),x>x2&&(x2=x),y<y1&&(y1=y),y>y2&&(y2=y)}return new Rectangle(x1,y1,x2-x1,y2-y1)}closestPoint(p){const cpLength=this.closestPointLength(p);return this.pointAtLength(cpLength)}closestPointLength(p){const points=this.points,count=points.length;if(0===count||1===count)return 0;let length=0,cpLength=0,minSqrDistance=1/0;for(let i=0,ii=count-1;i<ii;i+=1){const line=new Line(points[i],points[i+1]),lineLength=line.length(),cpNormalizedLength=line.closestPointNormalizedLength(p),sqrDistance=line.pointAt(cpNormalizedLength).squaredDistance(p);sqrDistance<minSqrDistance&&(minSqrDistance=sqrDistance,cpLength=length+cpNormalizedLength*lineLength),length+=lineLength}return cpLength}closestPointNormalizedLength(p){const length=this.length();if(0===length)return 0;return this.closestPointLength(p)/length}closestPointTangent(p){const cpLength=this.closestPointLength(p);return this.tangentAtLength(cpLength)}containsPoint(p){if(0===this.points.length)return!1;const ref=Point.clone(p),x=ref.x,y=ref.y,points=this.points,count=points.length;let startIndex=count-1,intersectionCount=0;for(let endIndex=0;endIndex<count;endIndex+=1){const start=points[startIndex],end=points[endIndex];if(ref.equals(start))return!0;const segment=new Line(start,end);if(segment.containsPoint(p))return!0;if(y<=start.y&&y>end.y||y>start.y&&y<=end.y){const xDifference=start.x-x>end.x-x?start.x-x:end.x-x;if(xDifference>=0){const rayEnd=new Point(x+xDifference,y),ray=new Line(p,rayEnd);segment.intersectsWithLine(ray)&&(intersectionCount+=1)}}startIndex=endIndex}return intersectionCount%2==1}intersectsWithLine(line){const intersections=[];for(let i=0,n=this.points.length-1;i<n;i+=1){const a=this.points[i],b=this.points[i+1],int=line.intersectsWithLine(new Line(a,b));int&&intersections.push(int)}return intersections.length>0?intersections:null}isDifferentiable(){for(let i=0,ii=this.points.length-1;i<ii;i+=1){const a=this.points[i],b=this.points[i+1];if(new Line(a,b).isDifferentiable())return!0}return!1}length(){let len=0;for(let i=0,ii=this.points.length-1;i<ii;i+=1){const a=this.points[i],b=this.points[i+1];len+=a.distance(b)}return len}pointAt(ratio){const points=this.points,count=points.length;if(0===count)return null;if(1===count)return points[0].clone();if(ratio<=0)return points[0].clone();if(ratio>=1)return points[count-1].clone();const length=this.length()*ratio;return this.pointAtLength(length)}pointAtLength(length){const points=this.points,count=points.length;if(0===count)return null;if(1===count)return points[0].clone();let fromStart=!0;length<0&&(fromStart=!1,length=-length);let tmp=0;for(let i=0,ii=count-1;i<ii;i+=1){const index=fromStart?i:ii-1-i,a=points[index],b=points[index+1],l=new Line(a,b),d=a.distance(b);if(length<=tmp+d)return l.pointAtLength((fromStart?1:-1)*(length-tmp));tmp+=d}return(fromStart?points[count-1]:points[0]).clone()}tangentAt(ratio){const count=this.points.length;if(0===count||1===count)return null;ratio<0&&(ratio=0),ratio>1&&(ratio=1);const length=this.length()*ratio;return this.tangentAtLength(length)}tangentAtLength(length){const points=this.points,count=points.length;if(0===count||1===count)return null;let lastValidLine,fromStart=!0;length<0&&(fromStart=!1,length=-length);let tmp=0;for(let i=0,ii=count-1;i<ii;i+=1){const index=fromStart?i:ii-1-i,a=points[index],b=points[index+1],l=new Line(a,b),d=a.distance(b);if(l.isDifferentiable()){if(length<=tmp+d)return l.tangentAtLength((fromStart?1:-1)*(length-tmp));lastValidLine=l}tmp+=d}if(lastValidLine){const ratio=fromStart?1:0;return lastValidLine.tangentAt(ratio)}return null}simplify(options={}){const points=this.points;if(points.length<3)return this;const threshold=options.threshold||0;let currentIndex=0;for(;points[currentIndex+2];){const middleIndex=currentIndex+1,lastIndex=currentIndex+2,firstPoint=points[currentIndex],middlePoint=points[middleIndex],lastPoint=points[lastIndex];new Line(firstPoint,lastPoint).closestPoint(middlePoint).distance(middlePoint)<=threshold?points.splice(middleIndex,1):currentIndex+=1}return this}toHull(){const points=this.points,count=points.length;if(0===count)return new Polyline;let startPoint=points[0];for(let i=1;i<count;i+=1)(points[i].y<startPoint.y||points[i].y===startPoint.y&&points[i].x>startPoint.x)&&(startPoint=points[i]);const sortedRecords=[];for(let i=0;i<count;i+=1){let angle=startPoint.theta(points[i]);0===angle&&(angle=360),sortedRecords.push([points[i],i,angle])}if(sortedRecords.sort(((record1,record2)=>{let ret=record1[2]-record2[2];return 0===ret&&(ret=record2[1]-record1[1]),ret})),sortedRecords.length>2){const startPoint=sortedRecords[sortedRecords.length-1];sortedRecords.unshift(startPoint)}const insidePoints={},hullRecords=[],getKey=record=>`${record[0].toString()}@${record[1]}`;for(;0!==sortedRecords.length;){const currentRecord=sortedRecords.pop(),currentPoint=currentRecord[0];if(insidePoints[getKey(currentRecord)])continue;let correctTurnFound=!1;for(;!correctTurnFound;)if(hullRecords.length<2)hullRecords.push(currentRecord),correctTurnFound=!0;else{const lastHullRecord=hullRecords.pop(),lastHullPoint=lastHullRecord[0],secondLastHullRecord=hullRecords.pop(),secondLastHullPoint=secondLastHullRecord[0],crossProduct=secondLastHullPoint.cross(lastHullPoint,currentPoint);if(crossProduct<0)hullRecords.push(secondLastHullRecord),hullRecords.push(lastHullRecord),hullRecords.push(currentRecord),correctTurnFound=!0;else if(0===crossProduct){const THRESHOLD=1e-10,angleBetween=lastHullPoint.angleBetween(secondLastHullPoint,currentPoint);Math.abs(angleBetween-180)<THRESHOLD||lastHullPoint.equals(currentPoint)||secondLastHullPoint.equals(lastHullPoint)?(insidePoints[getKey(lastHullRecord)]=lastHullPoint,hullRecords.push(secondLastHullRecord)):Math.abs((angleBetween+1)%360-1)<THRESHOLD&&(hullRecords.push(secondLastHullRecord),sortedRecords.push(lastHullRecord))}else insidePoints[getKey(lastHullRecord)]=lastHullPoint,hullRecords.push(secondLastHullRecord)}}let lowestHullIndex;hullRecords.length>2&&hullRecords.pop();let indexOfLowestHullIndexRecord=-1;for(let i=0,n=hullRecords.length;i<n;i+=1){const currentHullIndex=hullRecords[i][1];(void 0===lowestHullIndex||currentHullIndex<lowestHullIndex)&&(lowestHullIndex=currentHullIndex,indexOfLowestHullIndexRecord=i)}let hullPointRecordsReordered=[];if(indexOfLowestHullIndexRecord>0){const newFirstChunk=hullRecords.slice(indexOfLowestHullIndexRecord),newSecondChunk=hullRecords.slice(0,indexOfLowestHullIndexRecord);hullPointRecordsReordered=newFirstChunk.concat(newSecondChunk)}else hullPointRecordsReordered=hullRecords;const hullPoints=[];for(let i=0,n=hullPointRecordsReordered.length;i<n;i+=1)hullPoints.push(hullPointRecordsReordered[i][0]);return new Polyline(hullPoints)}equals(p){return null!=p&&(p.points.length===this.points.length&&p.points.every(((a,i)=>a.equals(this.points[i]))))}clone(){return new Polyline(this.points.map((p=>p.clone())))}toJSON(){return this.points.map((p=>p.toJSON()))}serialize(){return this.points.map((p=>`${p.serialize()}`)).join(" ")}}!function(Polyline){Polyline.isPolyline=function isPolyline(instance){return null!=instance&&instance instanceof Polyline}}(Polyline||(Polyline={})),function(Polyline){Polyline.parse=function parse(svgString){const str=svgString.trim();if(""===str)return new Polyline;const points=[],coords=str.split(/\s*,\s*|\s+/);for(let i=0,ii=coords.length;i<ii;i+=2)points.push({x:+coords[i],y:+coords[i+1]});return new Polyline(points)}}(Polyline||(Polyline={}));class Curve extends Geometry{constructor(start,controlPoint1,controlPoint2,end){super(),this.PRECISION=3,this.start=Point.create(start),this.controlPoint1=Point.create(controlPoint1),this.controlPoint2=Point.create(controlPoint2),this.end=Point.create(end)}bbox(){const start=this.start,controlPoint1=this.controlPoint1,controlPoint2=this.controlPoint2,end=this.end,x0=start.x,y0=start.y,x1=controlPoint1.x,y1=controlPoint1.y,x2=controlPoint2.x,y2=controlPoint2.y,x3=end.x,y3=end.y,points=[],tvalues=[],bounds=[[],[]];let a,b,c,t,t1,t2,b2ac,sqrtb2ac,x,y,mt;for(let i=0;i<2;i+=1)if(0===i?(b=6*x0-12*x1+6*x2,a=-3*x0+9*x1-9*x2+3*x3,c=3*x1-3*x0):(b=6*y0-12*y1+6*y2,a=-3*y0+9*y1-9*y2+3*y3,c=3*y1-3*y0),Math.abs(a)<1e-12){if(Math.abs(b)<1e-12)continue;t=-c/b,t>0&&t<1&&tvalues.push(t)}else b2ac=b*b-4*c*a,sqrtb2ac=Math.sqrt(b2ac),b2ac<0||(t1=(-b+sqrtb2ac)/(2*a),t1>0&&t1<1&&tvalues.push(t1),t2=(-b-sqrtb2ac)/(2*a),t2>0&&t2<1&&tvalues.push(t2));let j=tvalues.length;const jlen=j;for(;j;)j-=1,t=tvalues[j],mt=1-t,x=mt*mt*mt*x0+3*mt*mt*t*x1+3*mt*t*t*x2+t*t*t*x3,bounds[0][j]=x,y=mt*mt*mt*y0+3*mt*mt*t*y1+3*mt*t*t*y2+t*t*t*y3,bounds[1][j]=y,points[j]={X:x,Y:y};tvalues[jlen]=0,tvalues[jlen+1]=1,points[jlen]={X:x0,Y:y0},points[jlen+1]={X:x3,Y:y3},bounds[0][jlen]=x0,bounds[1][jlen]=y0,bounds[0][jlen+1]=x3,bounds[1][jlen+1]=y3,tvalues.length=jlen+2,bounds[0].length=jlen+2,bounds[1].length=jlen+2,points.length=jlen+2;const left=Math.min.apply(null,bounds[0]),top=Math.min.apply(null,bounds[1]),right=Math.max.apply(null,bounds[0]),bottom=Math.max.apply(null,bounds[1]);return new Rectangle(left,top,right-left,bottom-top)}closestPoint(p,options={}){return this.pointAtT(this.closestPointT(p,options))}closestPointLength(p,options={}){const opts=this.getOptions(options);return this.lengthAtT(this.closestPointT(p,opts),opts)}closestPointNormalizedLength(p,options={}){const opts=this.getOptions(options),cpLength=this.closestPointLength(p,opts);if(!cpLength)return 0;const length=this.length(opts);return 0===length?0:cpLength/length}closestPointT(p,options={}){const precision=this.getPrecision(options),subdivisions=this.getDivisions(options),precisionRatio=Math.pow(10,-precision);let investigatedSubdivision=null,investigatedSubdivisionStartT=0,investigatedSubdivisionEndT=0,distFromStart=0,distFromEnd=0,chordLength=0,minSumDist=null;const count=subdivisions.length;let piece=count>0?1/count:0;for(subdivisions.forEach(((division,i)=>{const startDist=division.start.distance(p),endDist=division.end.distance(p),sumDist=startDist+endDist;(null==minSumDist||sumDist<minSumDist)&&(investigatedSubdivision=division,investigatedSubdivisionStartT=i*piece,investigatedSubdivisionEndT=(i+1)*piece,distFromStart=startDist,distFromEnd=endDist,minSumDist=sumDist,chordLength=division.endpointDistance())}));;){const startPrecisionRatio=distFromStart?Math.abs(distFromStart-distFromEnd)/distFromStart:0,endPrecisionRatio=null!=distFromEnd?Math.abs(distFromStart-distFromEnd)/distFromEnd:0;if(startPrecisionRatio<precisionRatio||endPrecisionRatio<precisionRatio||(!distFromStart||distFromStart<chordLength*precisionRatio||(!distFromEnd||distFromEnd<chordLength*precisionRatio)))return distFromStart<=distFromEnd?investigatedSubdivisionStartT:investigatedSubdivisionEndT;const divided=investigatedSubdivision.divide(.5);piece/=2;const startDist1=divided[0].start.distance(p),endDist1=divided[0].end.distance(p),sumDist1=startDist1+endDist1,startDist2=divided[1].start.distance(p),endDist2=divided[1].end.distance(p);sumDist1<=startDist2+endDist2?(investigatedSubdivision=divided[0],investigatedSubdivisionEndT-=piece,distFromStart=startDist1,distFromEnd=endDist1):(investigatedSubdivision=divided[1],investigatedSubdivisionStartT+=piece,distFromStart=startDist2,distFromEnd=endDist2)}}closestPointTangent(p,options={}){return this.tangentAtT(this.closestPointT(p,options))}containsPoint(p,options={}){return this.toPolyline(options).containsPoint(p)}divideAt(ratio,options={}){if(ratio<=0)return this.divideAtT(0);if(ratio>=1)return this.divideAtT(1);const t=this.tAt(ratio,options);return this.divideAtT(t)}divideAtLength(length,options={}){const t=this.tAtLength(length,options);return this.divideAtT(t)}divide(t){return this.divideAtT(t)}divideAtT(t){const start=this.start,controlPoint1=this.controlPoint1,controlPoint2=this.controlPoint2,end=this.end;if(t<=0)return[new Curve(start,start,start,start),new Curve(start,controlPoint1,controlPoint2,end)];if(t>=1)return[new Curve(start,controlPoint1,controlPoint2,end),new Curve(end,end,end,end)];const dividerPoints=this.getSkeletonPoints(t),startControl1=dividerPoints.startControlPoint1,startControl2=dividerPoints.startControlPoint2,divider=dividerPoints.divider,dividerControl1=dividerPoints.dividerControlPoint1,dividerControl2=dividerPoints.dividerControlPoint2;return[new Curve(start,startControl1,startControl2,divider),new Curve(divider,dividerControl1,dividerControl2,end)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(t){const start=this.start,control1=this.controlPoint1,control2=this.controlPoint2,end=this.end;if(t<=0)return{startControlPoint1:start.clone(),startControlPoint2:start.clone(),divider:start.clone(),dividerControlPoint1:control1.clone(),dividerControlPoint2:control2.clone()};if(t>=1)return{startControlPoint1:control1.clone(),startControlPoint2:control2.clone(),divider:end.clone(),dividerControlPoint1:end.clone(),dividerControlPoint2:end.clone()};const midpoint1=new Line(start,control1).pointAt(t),midpoint2=new Line(control1,control2).pointAt(t),midpoint3=new Line(control2,end).pointAt(t),subControl1=new Line(midpoint1,midpoint2).pointAt(t),subControl2=new Line(midpoint2,midpoint3).pointAt(t);return{startControlPoint1:midpoint1,startControlPoint2:subControl1,divider:new Line(subControl1,subControl2).pointAt(t),dividerControlPoint1:subControl2,dividerControlPoint2:midpoint3}}getSubdivisions(options={}){const precision=this.getPrecision(options);let subdivisions=[new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===precision)return subdivisions;let previousLength=this.endpointDistance();const precisionRatio=Math.pow(10,-precision);let iteration=0;for(;;){iteration+=1;const divisions=[];subdivisions.forEach((c=>{const divided=c.divide(.5);divisions.push(divided[0],divided[1])}));const length=divisions.reduce(((memo,c)=>memo+c.endpointDistance()),0);if(iteration>1&&(0!==length?(length-previousLength)/length:0)<precisionRatio)return divisions;subdivisions=divisions,previousLength=length}}length(options={}){return this.getDivisions(options).reduce(((memo,c)=>memo+c.endpointDistance()),0)}lengthAtT(t,options={}){if(t<=0)return 0;const precision=void 0===options.precision?this.PRECISION:options.precision;return this.divide(t)[0].length({precision})}pointAt(ratio,options={}){if(ratio<=0)return this.start.clone();if(ratio>=1)return this.end.clone();const t=this.tAt(ratio,options);return this.pointAtT(t)}pointAtLength(length,options={}){const t=this.tAtLength(length,options);return this.pointAtT(t)}pointAtT(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider}isDifferentiable(){const start=this.start,control1=this.controlPoint1,control2=this.controlPoint2,end=this.end;return!(start.equals(control1)&&control1.equals(control2)&&control2.equals(end))}tangentAt(ratio,options={}){if(!this.isDifferentiable())return null;ratio<0?ratio=0:ratio>1&&(ratio=1);const t=this.tAt(ratio,options);return this.tangentAtT(t)}tangentAtLength(length,options={}){if(!this.isDifferentiable())return null;const t=this.tAtLength(length,options);return this.tangentAtT(t)}tangentAtT(t){if(!this.isDifferentiable())return null;t<0&&(t=0),t>1&&(t=1);const skeletonPoints=this.getSkeletonPoints(t),p1=skeletonPoints.startControlPoint2,p2=skeletonPoints.dividerControlPoint1,tangentStart=skeletonPoints.divider,tangentLine=new Line(p1,p2);return tangentLine.translate(tangentStart.x-p1.x,tangentStart.y-p1.y),tangentLine}getPrecision(options={}){return null==options.precision?this.PRECISION:options.precision}getDivisions(options={}){if(null!=options.subdivisions)return options.subdivisions;const precision=this.getPrecision(options);return this.getSubdivisions({precision})}getOptions(options={}){return{precision:this.getPrecision(options),subdivisions:this.getDivisions(options)}}tAt(ratio,options={}){if(ratio<=0)return 0;if(ratio>=1)return 1;const opts=this.getOptions(options),length=this.length(opts)*ratio;return this.tAtLength(length,opts)}tAtLength(length,options={}){let fromStart=!0;length<0&&(fromStart=!1,length=-length);const precision=this.getPrecision(options),subdivisions=this.getDivisions(options),opts={precision,subdivisions};let investigatedSubdivisionStartT,investigatedSubdivisionEndT,investigatedSubdivision=null,baselinePointDistFromStart=0,baselinePointDistFromEnd=0,memo=0;const count=subdivisions.length;let piece=count>0?1/count:0;for(let i=0;i<count;i+=1){const index=fromStart?i:count-1-i,division=subdivisions[i],dist=division.endpointDistance();if(length<=memo+dist){investigatedSubdivision=division,investigatedSubdivisionStartT=index*piece,investigatedSubdivisionEndT=(index+1)*piece,baselinePointDistFromStart=fromStart?length-memo:dist+memo-length,baselinePointDistFromEnd=fromStart?dist+memo-length:length-memo;break}memo+=dist}if(null==investigatedSubdivision)return fromStart?1:0;const total=this.length(opts),precisionRatio=Math.pow(10,-precision);for(;;){let ratio,newBaselinePointDistFromStart,newBaselinePointDistFromEnd;if(ratio=0!==total?baselinePointDistFromStart/total:0,ratio<precisionRatio)return investigatedSubdivisionStartT;if(ratio=0!==total?baselinePointDistFromEnd/total:0,ratio<precisionRatio)return investigatedSubdivisionEndT;const divided=investigatedSubdivision.divide(.5);piece/=2;const baseline1Length=divided[0].endpointDistance(),baseline2Length=divided[1].endpointDistance();baselinePointDistFromStart<=baseline1Length?(investigatedSubdivision=divided[0],investigatedSubdivisionEndT-=piece,newBaselinePointDistFromStart=baselinePointDistFromStart,newBaselinePointDistFromEnd=baseline1Length-newBaselinePointDistFromStart):(investigatedSubdivision=divided[1],investigatedSubdivisionStartT+=piece,newBaselinePointDistFromStart=baselinePointDistFromStart-baseline1Length,newBaselinePointDistFromEnd=baseline2Length-newBaselinePointDistFromStart),baselinePointDistFromStart=newBaselinePointDistFromStart,baselinePointDistFromEnd=newBaselinePointDistFromEnd}}toPoints(options={}){const subdivisions=this.getDivisions(options),points=[subdivisions[0].start.clone()];return subdivisions.forEach((c=>points.push(c.end.clone()))),points}toPolyline(options={}){return new Polyline(this.toPoints(options))}scale(sx,sy,origin){return this.start.scale(sx,sy,origin),this.controlPoint1.scale(sx,sy,origin),this.controlPoint2.scale(sx,sy,origin),this.end.scale(sx,sy,origin),this}rotate(angle,origin){return this.start.rotate(angle,origin),this.controlPoint1.rotate(angle,origin),this.controlPoint2.rotate(angle,origin),this.end.rotate(angle,origin),this}translate(tx,ty){return"number"==typeof tx?(this.start.translate(tx,ty),this.controlPoint1.translate(tx,ty),this.controlPoint2.translate(tx,ty),this.end.translate(tx,ty)):(this.start.translate(tx),this.controlPoint1.translate(tx),this.controlPoint2.translate(tx),this.end.translate(tx)),this}equals(c){return null!=c&&this.start.equals(c.start)&&this.controlPoint1.equals(c.controlPoint1)&&this.controlPoint2.equals(c.controlPoint2)&&this.end.equals(c.end)}clone(){return new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}!function(Curve){Curve.isCurve=function isCurve(instance){return null!=instance&&instance instanceof Curve}}(Curve||(Curve={})),function(Curve){function getFirstControlPoints(rhs){const n=rhs.length,x=[],tmp=[];let b=2;x[0]=rhs[0]/b;for(let i=1;i<n;i+=1)tmp[i]=1/b,b=(i<n-1?4:3.5)-tmp[i],x[i]=(rhs[i]-x[i-1])/b;for(let i=1;i<n;i+=1)x[n-i-1]-=tmp[n-i]*x[n-i];return x}Curve.throughPoints=function throughPoints(points){if(null==points||Array.isArray(points)&&points.length<2)throw new Error("At least 2 points are required");const controlPoints=function getCurveControlPoints(points){const knots=points.map((p=>Point.clone(p))),firstControlPoints=[],secondControlPoints=[],n=knots.length-1;if(1===n)return firstControlPoints[0]=new Point((2*knots[0].x+knots[1].x)/3,(2*knots[0].y+knots[1].y)/3),secondControlPoints[0]=new Point(2*firstControlPoints[0].x-knots[0].x,2*firstControlPoints[0].y-knots[0].y),[firstControlPoints,secondControlPoints];const rhs=[];for(let i=1;i<n-1;i+=1)rhs[i]=4*knots[i].x+2*knots[i+1].x;rhs[0]=knots[0].x+2*knots[1].x,rhs[n-1]=(8*knots[n-1].x+knots[n].x)/2;const x=getFirstControlPoints(rhs);for(let i=1;i<n-1;i+=1)rhs[i]=4*knots[i].y+2*knots[i+1].y;rhs[0]=knots[0].y+2*knots[1].y,rhs[n-1]=(8*knots[n-1].y+knots[n].y)/2;const y=getFirstControlPoints(rhs);for(let i=0;i<n;i+=1)firstControlPoints.push(new Point(x[i],y[i])),i<n-1?secondControlPoints.push(new Point(2*knots[i+1].x-x[i+1],2*knots[i+1].y-y[i+1])):secondControlPoints.push(new Point((knots[n].x+x[n-1])/2,(knots[n].y+y[n-1])/2));return[firstControlPoints,secondControlPoints]}(points),curves=[];for(let i=0,ii=controlPoints[0].length;i<ii;i+=1){const controlPoint1=new Point(controlPoints[0][i].x,controlPoints[0][i].y),controlPoint2=new Point(controlPoints[1][i].x,controlPoints[1][i].y);curves.push(new Curve(points[i],controlPoint1,controlPoint2,points[i+1]))}return curves}}(Curve||(Curve={}));class Segment extends Geometry{constructor(){super(...arguments),this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(p,options){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(p);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(t,options){if(t<=0)return 0;const length=this.length();return t>=1?length:length*t}divideAtT(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class LineTo extends Segment{constructor(x,y){super(),Line.isLine(x)?this.endPoint=x.end.clone().round(2):this.endPoint=Point.create(x,y).round(2)}get type(){return"L"}get line(){return new Line(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(p){return this.line.closestPoint(p)}closestPointLength(p){return this.line.closestPointLength(p)}closestPointNormalizedLength(p){return this.line.closestPointNormalizedLength(p)}closestPointTangent(p){return this.line.closestPointTangent(p)}length(){return this.line.length()}divideAt(ratio){const divided=this.line.divideAt(ratio);return[new LineTo(divided[0]),new LineTo(divided[1])]}divideAtLength(length){const divided=this.line.divideAtLength(length);return[new LineTo(divided[0]),new LineTo(divided[1])]}getSubdivisions(){return[]}pointAt(ratio){return this.line.pointAt(ratio)}pointAtLength(length){return this.line.pointAtLength(length)}tangentAt(ratio){return this.line.tangentAt(ratio)}tangentAtLength(length){return this.line.tangentAtLength(length)}isDifferentiable(){return null!=this.previousSegment&&!this.start.equals(this.end)}clone(){return new LineTo(this.end)}scale(sx,sy,origin){return this.end.scale(sx,sy,origin),this}rotate(angle,origin){return this.end.rotate(angle,origin),this}translate(tx,ty){return"number"==typeof tx?this.end.translate(tx,ty):this.end.translate(tx),this}equals(s){return this.type===s.type&&this.start.equals(s.start)&&this.end.equals(s.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const end=this.end;return`${this.type} ${end.x} ${end.y}`}}!function(LineTo){LineTo.create=function create(...args){const len=args.length,arg0=args[0];if(Line.isLine(arg0))return new LineTo(arg0);if(Point.isPointLike(arg0))return 1===len?new LineTo(arg0):args.map((arg=>new LineTo(arg)));if(2===len)return new LineTo(+args[0],+args[1]);const segments=[];for(let i=0;i<len;i+=2){const x=+args[i],y=+args[i+1];segments.push(new LineTo(x,y))}return segments}}(LineTo||(LineTo={}));class Close extends Segment{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new Line(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(p){return this.line.closestPoint(p)}closestPointLength(p){return this.line.closestPointLength(p)}closestPointNormalizedLength(p){return this.line.closestPointNormalizedLength(p)}closestPointTangent(p){return this.line.closestPointTangent(p)}length(){return this.line.length()}divideAt(ratio){const divided=this.line.divideAt(ratio);return[divided[1].isDifferentiable()?new LineTo(divided[0]):this.clone(),new LineTo(divided[1])]}divideAtLength(length){const divided=this.line.divideAtLength(length);return[divided[1].isDifferentiable()?new LineTo(divided[0]):this.clone(),new LineTo(divided[1])]}getSubdivisions(){return[]}pointAt(ratio){return this.line.pointAt(ratio)}pointAtLength(length){return this.line.pointAtLength(length)}tangentAt(ratio){return this.line.tangentAt(ratio)}tangentAtLength(length){return this.line.tangentAtLength(length)}isDifferentiable(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)}scale(){return this}rotate(){return this}translate(){return this}equals(s){return this.type===s.type&&this.start.equals(s.start)&&this.end.equals(s.end)}clone(){return new Close}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}!function(Close){Close.create=function create(){return new Close}}(Close||(Close={}));class MoveTo extends Segment{constructor(x,y){super(),this.isVisible=!1,this.isSubpathStart=!0,Line.isLine(x)||Curve.isCurve(x)?this.endPoint=x.end.clone().round(2):this.endPoint=Point.create(x,y).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(sx,sy,origin){return this.end.scale(sx,sy,origin),this}rotate(angle,origin){return this.end.rotate(angle,origin),this}translate(tx,ty){return"number"==typeof tx?this.end.translate(tx,ty):this.end.translate(tx),this}clone(){return new MoveTo(this.end)}equals(s){return this.type===s.type&&this.end.equals(s.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const end=this.end;return`${this.type} ${end.x} ${end.y}`}}!function(MoveTo){MoveTo.create=function create(...args){const len=args.length,arg0=args[0];if(Line.isLine(arg0))return new MoveTo(arg0);if(Curve.isCurve(arg0))return new MoveTo(arg0);if(Point.isPointLike(arg0)){if(1===len)return new MoveTo(arg0);const segments=[];for(let i=0;i<len;i+=1)0===i?segments.push(new MoveTo(args[i])):segments.push(new LineTo(args[i]));return segments}if(2===len)return new MoveTo(+args[0],+args[1]);const segments=[];for(let i=0;i<len;i+=2){const x=+args[i],y=+args[i+1];0===i?segments.push(new MoveTo(x,y)):segments.push(new LineTo(x,y))}return segments}}(MoveTo||(MoveTo={}));class CurveTo extends Segment{constructor(arg0,arg1,arg2,arg3,arg4,arg5){super(),Curve.isCurve(arg0)?(this.controlPoint1=arg0.controlPoint1.clone().round(2),this.controlPoint2=arg0.controlPoint2.clone().round(2),this.endPoint=arg0.end.clone().round(2)):"number"==typeof arg0?(this.controlPoint1=new Point(arg0,arg1).round(2),this.controlPoint2=new Point(arg2,arg3).round(2),this.endPoint=new Point(arg4,arg5).round(2)):(this.controlPoint1=Point.create(arg0).round(2),this.controlPoint2=Point.create(arg1).round(2),this.endPoint=Point.create(arg2).round(2))}get type(){return"C"}get curve(){return new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(p){return this.curve.closestPoint(p)}closestPointLength(p){return this.curve.closestPointLength(p)}closestPointNormalizedLength(p){return this.curve.closestPointNormalizedLength(p)}closestPointTangent(p){return this.curve.closestPointTangent(p)}length(){return this.curve.length()}divideAt(ratio,options={}){const divided=this.curve.divideAt(ratio,options);return[new CurveTo(divided[0]),new CurveTo(divided[1])]}divideAtLength(length,options={}){const divided=this.curve.divideAtLength(length,options);return[new CurveTo(divided[0]),new CurveTo(divided[1])]}divideAtT(t){const divided=this.curve.divideAtT(t);return[new CurveTo(divided[0]),new CurveTo(divided[1])]}getSubdivisions(){return[]}pointAt(ratio){return this.curve.pointAt(ratio)}pointAtLength(length){return this.curve.pointAtLength(length)}tangentAt(ratio){return this.curve.tangentAt(ratio)}tangentAtLength(length){return this.curve.tangentAtLength(length)}isDifferentiable(){if(!this.previousSegment)return!1;const start=this.start,control1=this.controlPoint1,control2=this.controlPoint2,end=this.end;return!(start.equals(control1)&&control1.equals(control2)&&control2.equals(end))}scale(sx,sy,origin){return this.controlPoint1.scale(sx,sy,origin),this.controlPoint2.scale(sx,sy,origin),this.end.scale(sx,sy,origin),this}rotate(angle,origin){return this.controlPoint1.rotate(angle,origin),this.controlPoint2.rotate(angle,origin),this.end.rotate(angle,origin),this}translate(tx,ty){return"number"==typeof tx?(this.controlPoint1.translate(tx,ty),this.controlPoint2.translate(tx,ty),this.end.translate(tx,ty)):(this.controlPoint1.translate(tx),this.controlPoint2.translate(tx),this.end.translate(tx)),this}equals(s){return this.start.equals(s.start)&&this.end.equals(s.end)&&this.controlPoint1.equals(s.controlPoint1)&&this.controlPoint2.equals(s.controlPoint2)}clone(){return new CurveTo(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const c1=this.controlPoint1,c2=this.controlPoint2,end=this.end;return[this.type,c1.x,c1.y,c2.x,c2.y,end.x,end.y].join(" ")}}function rotate(x,y,rad){return{x:x*Math.cos(rad)-y*Math.sin(rad),y:x*Math.sin(rad)+y*Math.cos(rad)}}function q2c(x1,y1,ax,ay,x2,y2){const v13=1/3,v23=2/3;return[v13*x1+v23*ax,v13*y1+v23*ay,v13*x2+v23*ax,v13*y2+v23*ay,x2,y2]}function a2c(x1,y1,rx,ry,angle,largeArcFlag,sweepFlag,x2,y2,recursive){const v120=120*Math.PI/180,rad=Math.PI/180*(+angle||0);let xy,f1,f2,cx,cy,res=[];if(recursive)f1=recursive[0],f2=recursive[1],cx=recursive[2],cy=recursive[3];else{xy=rotate(x1,y1,-rad),x1=xy.x,y1=xy.y,xy=rotate(x2,y2,-rad);const x=(x1-(x2=xy.x))/2,y=(y1-(y2=xy.y))/2;let h=x*x/(rx*rx)+y*y/(ry*ry);h>1&&(h=Math.sqrt(h),rx*=h,ry*=h);const rx2=rx*rx,ry2=ry*ry,k=(largeArcFlag===sweepFlag?-1:1)*Math.sqrt(Math.abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x)));cx=k*rx*y/ry+(x1+x2)/2,cy=k*-ry*x/rx+(y1+y2)/2,f1=Math.asin((y1-cy)/ry),f2=Math.asin((y2-cy)/ry),f1=x1<cx?Math.PI-f1:f1,f2=x2<cx?Math.PI-f2:f2,f1<0&&(f1=2*Math.PI+f1),f2<0&&(f2=2*Math.PI+f2),sweepFlag&&f1>f2&&(f1-=2*Math.PI),!sweepFlag&&f2>f1&&(f2-=2*Math.PI)}let df=f2-f1;if(Math.abs(df)>v120){const f2old=f2,x2old=x2,y2old=y2;f2=f1+v120*(sweepFlag&&f2>f1?1:-1),res=a2c(x2=cx+rx*Math.cos(f2),y2=cy+ry*Math.sin(f2),rx,ry,angle,0,sweepFlag,x2old,y2old,[f2,f2old,cx,cy])}df=f2-f1;const c1=Math.cos(f1),s1=Math.sin(f1),c2=Math.cos(f2),s2=Math.sin(f2),t=Math.tan(df/4),hx=4/3*(rx*t),hy=4/3*(ry*t),m1=[x1,y1],m2=[x1+hx*s1,y1-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2];if(m2[0]=2*m1[0]-m2[0],m2[1]=2*m1[1]-m2[1],recursive)return[m2,m3,m4].concat(res);{res=[m2,m3,m4].concat(res).join().split(",");const newres=[],ii=res.length;for(let i=0;i<ii;i+=1)newres[i]=i%2?rotate(+res[i-1],+res[i],rad).y:rotate(+res[i],+res[i+1],rad).x;return newres}}function abs(pathString){const pathArray=function parse(pathData){if(!pathData)return null;const spaces="\t\n\v\f\r \u2028\u2029",segmentReg=new RegExp(`([a-z])[${spaces},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${spaces}]*,?[${spaces}]*)+)`,"ig"),commandParamReg=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${spaces}]*,?[${spaces}]*`,"ig"),paramsCount={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},segmetns=[];return pathData.replace(segmentReg,((input,cmd,args)=>{const params=[];let command=cmd.toLowerCase();args.replace(commandParamReg,((a,b)=>(b&&params.push(+b),a))),"m"===command&&params.length>2&&(segmetns.push([cmd,...params.splice(0,2)]),command="l",cmd="m"===cmd?"l":"L");const count=paramsCount[command];for(;params.length>=count&&(segmetns.push([cmd,...params.splice(0,count)]),count););return input})),segmetns}(pathString);if(!pathArray||!pathArray.length)return[["M",0,0]];let x=0,y=0,mx=0,my=0;const segments=[];for(let i=0,ii=pathArray.length;i<ii;i+=1){const r=[];segments.push(r);const segment=pathArray[i],command=segment[0];if(command!==command.toUpperCase())switch(r[0]=command.toUpperCase(),r[0]){case"A":r[1]=segment[1],r[2]=segment[2],r[3]=segment[3],r[4]=segment[4],r[5]=segment[5],r[6]=+segment[6]+x,r[7]=+segment[7]+y;break;case"V":r[1]=+segment[1]+y;break;case"H":r[1]=+segment[1]+x;break;case"M":mx=+segment[1]+x,my=+segment[2]+y;for(let j=1,jj=segment.length;j<jj;j+=1)r[j]=+segment[j]+(j%2?x:y);break;default:for(let j=1,jj=segment.length;j<jj;j+=1)r[j]=+segment[j]+(j%2?x:y)}else for(let j=0,jj=segment.length;j<jj;j+=1)r[j]=segment[j];switch(r[0]){case"Z":x=+mx,y=+my;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":mx=r[r.length-2],my=r[r.length-1],x=r[r.length-2],y=r[r.length-1];break;default:x=r[r.length-2],y=r[r.length-1]}}return segments}function normalize(path){const pathArray=abs(path),attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function processPath(path,d,pcom){let nx,ny;if(!path)return["C",d.x,d.y,d.x,d.y,d.x,d.y];switch(path[0]in{T:1,Q:1}||(d.qx=null,d.qy=null),path[0]){case"M":d.X=path[1],d.Y=path[2];break;case"A":return 0===parseFloat(path[1])||0===parseFloat(path[2])?["L",path[6],path[7]]:["C"].concat(a2c.apply(0,[d.x,d.y].concat(path.slice(1))));case"S":return"C"===pcom||"S"===pcom?(nx=2*d.x-d.bx,ny=2*d.y-d.by):(nx=d.x,ny=d.y),["C",nx,ny].concat(path.slice(1));case"T":return"Q"===pcom||"T"===pcom?(d.qx=2*d.x-d.qx,d.qy=2*d.y-d.qy):(d.qx=d.x,d.qy=d.y),["C"].concat(q2c(d.x,d.y,d.qx,d.qy,path[1],path[2]));case"Q":return d.qx=path[1],d.qy=path[2],["C"].concat(q2c(d.x,d.y,path[1],path[2],path[3],path[4]));case"H":return["L"].concat(path[1],d.y);case"V":return["L"].concat(d.x,path[1])}return path}function fixArc(pp,i){if(pp[i].length>7){pp[i].shift();const pi=pp[i];for(;pi.length;)commands[i]="A",i+=1,pp.splice(i,0,["C"].concat(pi.splice(0,6)));pp.splice(i,1),ii=pathArray.length}}const commands=[];let prevCommand="",ii=pathArray.length;for(let i=0;i<ii;i+=1){let command="";pathArray[i]&&(command=pathArray[i][0]),"C"!==command&&(commands[i]=command,i>0&&(prevCommand=commands[i-1])),pathArray[i]=processPath(pathArray[i],attrs,prevCommand),"A"!==commands[i]&&"C"===command&&(commands[i]="C"),fixArc(pathArray,i);const seg=pathArray[i],seglen=seg.length;attrs.x=seg[seglen-2],attrs.y=seg[seglen-1],attrs.bx=parseFloat(seg[seglen-4])||attrs.x,attrs.by=parseFloat(seg[seglen-3])||attrs.y}return pathArray[0][0]&&"M"===pathArray[0][0]||pathArray.unshift(["M",0,0]),pathArray}function normalizePathData(pathData){return normalize(pathData).map((segment=>segment.map((item=>"string"==typeof item?item:GeometryUtil.round(item,2))))).join(",").split(",").join(" ")}!function(CurveTo){CurveTo.create=function create(...args){const len=args.length,arg0=args[0];if(Curve.isCurve(arg0))return new CurveTo(arg0);if(Point.isPointLike(arg0)){if(3===len)return new CurveTo(args[0],args[1],args[2]);const segments=[];for(let i=0;i<len;i+=3)segments.push(new CurveTo(args[i],args[i+1],args[i+2]));return segments}if(6===len)return new CurveTo(args[0],args[1],args[2],args[3],args[4],args[5]);const segments=[];for(let i=0;i<len;i+=6)segments.push(new CurveTo(args[i],args[i+1],args[i+2],args[i+3],args[i+4],args[i+5]));return segments}}(CurveTo||(CurveTo={}));class Path extends Geometry{constructor(args){if(super(),this.PRECISION=3,this.segments=[],Array.isArray(args))if(Line.isLine(args[0])||Curve.isCurve(args[0])){let previousObj=null;args.forEach(((o,i)=>{0===i&&this.appendSegment(Path.createSegment("M",o.start)),null==previousObj||previousObj.end.equals(o.start)||this.appendSegment(Path.createSegment("M",o.start)),Line.isLine(o)?this.appendSegment(Path.createSegment("L",o.end)):Curve.isCurve(o)&&this.appendSegment(Path.createSegment("C",o.controlPoint1,o.controlPoint2,o.end)),previousObj=o}))}else{args.forEach((s=>{s.isSegment&&this.appendSegment(s)}))}else null!=args&&(Line.isLine(args)?(this.appendSegment(Path.createSegment("M",args.start)),this.appendSegment(Path.createSegment("L",args.end))):Curve.isCurve(args)?(this.appendSegment(Path.createSegment("M",args.start)),this.appendSegment(Path.createSegment("C",args.controlPoint1,args.controlPoint2,args.end))):Polyline.isPolyline(args)?args.points&&args.points.length&&args.points.forEach(((point,index)=>{const segment=0===index?Path.createSegment("M",point):Path.createSegment("L",point);this.appendSegment(segment)})):args.isSegment&&this.appendSegment(args))}get start(){const segments=this.segments,count=segments.length;if(0===count)return null;for(let i=0;i<count;i+=1){const segment=segments[i];if(segment.isVisible)return segment.start}return segments[count-1].end}get end(){const segments=this.segments,count=segments.length;if(0===count)return null;for(let i=count-1;i>=0;i-=1){const segment=segments[i];if(segment.isVisible)return segment.end}return segments[count-1].end}moveTo(...args){return this.appendSegment(MoveTo.create.call(null,...args))}lineTo(...args){return this.appendSegment(LineTo.create.call(null,...args))}curveTo(...args){return this.appendSegment(CurveTo.create.call(null,...args))}arcTo(rx,ry,xAxisRotation,largeArcFlag,sweepFlag,endX,endY){const start=this.end||new Point,points="number"==typeof endX?arcToCurves(start.x,start.y,rx,ry,xAxisRotation,largeArcFlag,sweepFlag,endX,endY):arcToCurves(start.x,start.y,rx,ry,xAxisRotation,largeArcFlag,sweepFlag,endX.x,endX.y);if(null!=points)for(let i=0,ii=points.length;i<ii;i+=6)this.curveTo(points[i],points[i+1],points[i+2],points[i+3],points[i+4],points[i+5]);return this}quadTo(x1,y1,x,y){const start=this.end||new Point,data=["M",start.x,start.y];if("number"==typeof x1)data.push("Q",x1,y1,x,y);else{const p=y1;data.push("Q",x1.x,x1.y,p.x,p.y)}const path=Path.parse(data.join(" "));return this.appendSegment(path.segments.slice(1)),this}close(){return this.appendSegment(Close.create())}drawPoints(points,options={}){const raw=drawPoints(points,options),sub=Path.parse(raw);sub&&sub.segments&&this.appendSegment(sub.segments)}bbox(){const segments=this.segments,count=segments.length;if(0===count)return null;let bbox;for(let i=0;i<count;i+=1){const segment=segments[i];if(segment.isVisible){const segmentBBox=segment.bbox();null!=segmentBBox&&(bbox=bbox?bbox.union(segmentBBox):segmentBBox)}}if(null!=bbox)return bbox;const lastSegment=segments[count-1];return new Rectangle(lastSegment.end.x,lastSegment.end.y,0,0)}appendSegment(seg){const count=this.segments.length;let currentSegment,previousSegment=0!==count?this.segments[count-1]:null;if(Array.isArray(seg))for(let i=0,ii=seg.length;i<ii;i+=1){const segment=seg[i];currentSegment=this.prepareSegment(segment,previousSegment,null),this.segments.push(currentSegment),previousSegment=currentSegment}else null!=seg&&seg.isSegment&&(currentSegment=this.prepareSegment(seg,previousSegment,null),this.segments.push(currentSegment));return this}insertSegment(index,seg){const count=this.segments.length;if(index<0&&(index=count+index+1),index>count||index<0)throw new Error("Index out of range.");let currentSegment,previousSegment=null,nextSegment=null;if(0!==count&&(index>=1?(previousSegment=this.segments[index-1],nextSegment=previousSegment.nextSegment):(previousSegment=null,nextSegment=this.segments[0])),Array.isArray(seg))for(let i=0,ii=seg.length;i<ii;i+=1){const segment=seg[i];currentSegment=this.prepareSegment(segment,previousSegment,nextSegment),this.segments.splice(index+i,0,currentSegment),previousSegment=currentSegment}else currentSegment=this.prepareSegment(seg,previousSegment,nextSegment),this.segments.splice(index,0,currentSegment);return this}removeSegment(index){const idx=this.fixIndex(index),removedSegment=this.segments.splice(idx,1)[0],previousSegment=removedSegment.previousSegment,nextSegment=removedSegment.nextSegment;return previousSegment&&(previousSegment.nextSegment=nextSegment),nextSegment&&(nextSegment.previousSegment=previousSegment),removedSegment.isSubpathStart&&nextSegment&&this.updateSubpathStartSegment(nextSegment),removedSegment}replaceSegment(index,seg){const idx=this.fixIndex(index);let currentSegment;const replacedSegment=this.segments[idx];let previousSegment=replacedSegment.previousSegment;const nextSegment=replacedSegment.nextSegment;let updateSubpathStart=replacedSegment.isSubpathStart;if(Array.isArray(seg)){this.segments.splice(index,1);for(let i=0,ii=seg.length;i<ii;i+=1){const segment=seg[i];currentSegment=this.prepareSegment(segment,previousSegment,nextSegment),this.segments.splice(index+i,0,currentSegment),previousSegment=currentSegment,updateSubpathStart&&currentSegment.isSubpathStart&&(updateSubpathStart=!1)}}else currentSegment=this.prepareSegment(seg,previousSegment,nextSegment),this.segments.splice(idx,1,currentSegment),updateSubpathStart&&currentSegment.isSubpathStart&&(updateSubpathStart=!1);updateSubpathStart&&nextSegment&&this.updateSubpathStartSegment(nextSegment)}getSegment(index){const idx=this.fixIndex(index);return this.segments[idx]}fixIndex(index){const length=this.segments.length;if(0===length)throw new Error("Path has no segments.");let i=index;for(;i<0;)i=length+i;if(i>=length||i<0)throw new Error("Index out of range.");return i}segmentAt(ratio,options={}){const index=this.segmentIndexAt(ratio,options);return index?this.getSegment(index):null}segmentAtLength(length,options={}){const index=this.segmentIndexAtLength(length,options);return index?this.getSegment(index):null}segmentIndexAt(ratio,options={}){if(0===this.segments.length)return null;const rate=GeometryUtil.clamp(ratio,0,1),opt=this.getOptions(options),length=this.length(opt)*rate;return this.segmentIndexAtLength(length,opt)}segmentIndexAtLength(length,options={}){const count=this.segments.length;if(0===count)return null;let fromStart=!0;length<0&&(fromStart=!1,length=-length);const precision=this.getPrecision(options),segmentSubdivisions=this.getSubdivisions(options);let memo=0,lastVisibleIndex=null;for(let i=0;i<count;i+=1){const index=fromStart?i:count-1-i,segment=this.segments[index],subdivisions=segmentSubdivisions[index],len=segment.length({precision,subdivisions});if(segment.isVisible){if(length<=memo+len)return index;lastVisibleIndex=index}memo+=len}return lastVisibleIndex}getSegmentSubdivisions(options={}){const precision=this.getPrecision(options),segmentSubdivisions=[];for(let i=0,ii=this.segments.length;i<ii;i+=1){const subdivisions=this.segments[i].getSubdivisions({precision});segmentSubdivisions.push(subdivisions)}return segmentSubdivisions}updateSubpathStartSegment(segment){let previous=segment.previousSegment,current=segment;for(;current&&!current.isSubpathStart;)current.subpathStartSegment=null!=previous?previous.subpathStartSegment:null,previous=current,current=current.nextSegment}prepareSegment(segment,previousSegment,nextSegment){segment.previousSegment=previousSegment,segment.nextSegment=nextSegment,null!=previousSegment&&(previousSegment.nextSegment=segment),null!=nextSegment&&(nextSegment.previousSegment=segment);let updateSubpathStart=segment;return segment.isSubpathStart&&(segment.subpathStartSegment=segment,updateSubpathStart=nextSegment),null!=updateSubpathStart&&this.updateSubpathStartSegment(updateSubpathStart),segment}closestPoint(p,options={}){const t=this.closestPointT(p,options);return t?this.pointAtT(t):null}closestPointLength(p,options={}){const opts=this.getOptions(options),t=this.closestPointT(p,opts);return t?this.lengthAtT(t,opts):0}closestPointNormalizedLength(p,options={}){const opts=this.getOptions(options),cpLength=this.closestPointLength(p,opts);if(0===cpLength)return 0;const length=this.length(opts);return 0===length?0:cpLength/length}closestPointT(p,options={}){if(0===this.segments.length)return null;const precision=this.getPrecision(options),segmentSubdivisions=this.getSubdivisions(options);let closestPointT,minSquaredDistance=1/0;for(let i=0,ii=this.segments.length;i<ii;i+=1){const segment=this.segments[i],subdivisions=segmentSubdivisions[i];if(segment.isVisible){const segmentClosestPointT=segment.closestPointT(p,{precision,subdivisions}),segmentClosestPoint=segment.pointAtT(segmentClosestPointT),squaredDistance=GeometryUtil.squaredLength(segmentClosestPoint,p);squaredDistance<minSquaredDistance&&(closestPointT={segmentIndex:i,value:segmentClosestPointT},minSquaredDistance=squaredDistance)}}return closestPointT||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(p,options={}){if(0===this.segments.length)return null;const precision=this.getPrecision(options),segmentSubdivisions=this.getSubdivisions(options);let closestPointTangent,minSquaredDistance=1/0;for(let i=0,ii=this.segments.length;i<ii;i+=1){const segment=this.segments[i],subdivisions=segmentSubdivisions[i];if(segment.isDifferentiable()){const segmentClosestPointT=segment.closestPointT(p,{precision,subdivisions}),segmentClosestPoint=segment.pointAtT(segmentClosestPointT),squaredDistance=GeometryUtil.squaredLength(segmentClosestPoint,p);squaredDistance<minSquaredDistance&&(closestPointTangent=segment.tangentAtT(segmentClosestPointT),minSquaredDistance=squaredDistance)}}return closestPointTangent||null}containsPoint(p,options={}){const polylines=this.toPolylines(options);if(!polylines)return!1;let numIntersections=0;for(let i=0,ii=polylines.length;i<ii;i+=1){polylines[i].containsPoint(p)&&(numIntersections+=1)}return numIntersections%2==1}pointAt(ratio,options={}){if(0===this.segments.length)return null;if(ratio<=0)return this.start.clone();if(ratio>=1)return this.end.clone();const opts=this.getOptions(options),length=this.length(opts)*ratio;return this.pointAtLength(length,opts)}pointAtLength(length,options={}){if(0===this.segments.length)return null;if(0===length)return this.start.clone();let fromStart=!0;length<0&&(fromStart=!1,length=-length);const precision=this.getPrecision(options),segmentSubdivisions=this.getSubdivisions(options);let lastVisibleSegment,memo=0;for(let i=0,ii=this.segments.length;i<ii;i+=1){const index=fromStart?i:ii-1-i,segment=this.segments[index],subdivisions=segmentSubdivisions[index],d=segment.length({precision,subdivisions});if(segment.isVisible){if(length<=memo+d)return segment.pointAtLength((fromStart?1:-1)*(length-memo),{precision,subdivisions});lastVisibleSegment=segment}memo+=d}if(lastVisibleSegment)return fromStart?lastVisibleSegment.end:lastVisibleSegment.start;return this.segments[this.segments.length-1].end.clone()}pointAtT(t){const segments=this.segments,numSegments=segments.length;if(0===numSegments)return null;const segmentIndex=t.segmentIndex;if(segmentIndex<0)return segments[0].pointAtT(0);if(segmentIndex>=numSegments)return segments[numSegments-1].pointAtT(1);const tValue=GeometryUtil.clamp(t.value,0,1);return segments[segmentIndex].pointAtT(tValue)}divideAt(ratio,options={}){if(0===this.segments.length)return null;const rate=GeometryUtil.clamp(ratio,0,1),opts=this.getOptions(options),length=this.length(opts)*rate;return this.divideAtLength(length,opts)}divideAtLength(length,options={}){if(0===this.segments.length)return null;let fromStart=!0;length<0&&(fromStart=!1,length=-length);const precision=this.getPrecision(options),segmentSubdivisions=this.getSubdivisions(options);let divided,dividedSegmentIndex,lastValidSegment,lastValidSegmentIndex,t,memo=0;for(let i=0,ii=this.segments.length;i<ii;i+=1){const index=fromStart?i:ii-1-i,segment=this.getSegment(index),opts={precision,subdivisions:segmentSubdivisions[index]},len=segment.length(opts);if(segment.isDifferentiable()&&(lastValidSegment=segment,lastValidSegmentIndex=index,length<=memo+len)){dividedSegmentIndex=index,divided=segment.divideAtLength((fromStart?1:-1)*(length-memo),opts);break}memo+=len}if(!lastValidSegment)return null;divided||(dividedSegmentIndex=lastValidSegmentIndex,t=fromStart?1:0,divided=lastValidSegment.divideAtT(t));const pathCopy=this.clone(),index=dividedSegmentIndex;pathCopy.replaceSegment(index,divided);const divisionStartIndex=index;let divisionMidIndex=index+1,divisionEndIndex=index+2;divided[0].isDifferentiable()||(pathCopy.removeSegment(divisionStartIndex),divisionMidIndex-=1,divisionEndIndex-=1);const movetoEnd=pathCopy.getSegment(divisionMidIndex).start;pathCopy.insertSegment(divisionMidIndex,Path.createSegment("M",movetoEnd)),divisionEndIndex+=1,divided[1].isDifferentiable()||(pathCopy.removeSegment(divisionEndIndex-1),divisionEndIndex-=1);const secondPathSegmentIndexConversion=divisionEndIndex-divisionStartIndex-1;for(let i=divisionEndIndex,ii=pathCopy.segments.length;i<ii;i+=1){const originalSegment=this.getSegment(i-secondPathSegmentIndexConversion),segment=pathCopy.getSegment(i);if("Z"===segment.type&&!originalSegment.subpathStartSegment.end.equals(segment.subpathStartSegment.end)){const convertedSegment=Path.createSegment("L",originalSegment.end);pathCopy.replaceSegment(i,convertedSegment)}}return[new Path(pathCopy.segments.slice(0,divisionMidIndex)),new Path(pathCopy.segments.slice(divisionMidIndex))]}intersectsWithLine(line,options={}){const polylines=this.toPolylines(options);if(null==polylines)return null;let intersections=null;for(let i=0,ii=polylines.length;i<ii;i+=1){const polyline=polylines[i],intersection=line.intersect(polyline);intersection&&(null==intersections&&(intersections=[]),Array.isArray(intersection)?intersections.push(...intersection):intersections.push(intersection))}return intersections}isDifferentiable(){for(let i=0,ii=this.segments.length;i<ii;i+=1){if(this.segments[i].isDifferentiable())return!0}return!1}isValid(){const segments=this.segments;return 0===segments.length||"M"===segments[0].type}length(options={}){if(0===this.segments.length)return 0;const segmentSubdivisions=this.getSubdivisions(options);let length=0;for(let i=0,ii=this.segments.length;i<ii;i+=1){const segment=this.segments[i],subdivisions=segmentSubdivisions[i];length+=segment.length({subdivisions})}return length}lengthAtT(t,options={}){const count=this.segments.length;if(0===count)return 0;let segmentIndex=t.segmentIndex;if(segmentIndex<0)return 0;let tValue=GeometryUtil.clamp(t.value,0,1);segmentIndex>=count&&(segmentIndex=count-1,tValue=1);const precision=this.getPrecision(options),segmentSubdivisions=this.getSubdivisions(options);let length=0;for(let i=0;i<segmentIndex;i+=1){const segment=this.segments[i],subdivisions=segmentSubdivisions[i];length+=segment.length({precision,subdivisions})}const segment=this.segments[segmentIndex],subdivisions=segmentSubdivisions[segmentIndex];return length+=segment.lengthAtT(tValue,{precision,subdivisions}),length}tangentAt(ratio,options={}){if(0===this.segments.length)return null;const rate=GeometryUtil.clamp(ratio,0,1),opts=this.getOptions(options),length=this.length(opts)*rate;return this.tangentAtLength(length,opts)}tangentAtLength(length,options={}){if(0===this.segments.length)return null;let fromStart=!0;length<0&&(fromStart=!1,length=-length);const precision=this.getPrecision(options),segmentSubdivisions=this.getSubdivisions(options);let lastValidSegment,memo=0;for(let i=0,ii=this.segments.length;i<ii;i+=1){const index=fromStart?i:ii-1-i,segment=this.segments[index],subdivisions=segmentSubdivisions[index],len=segment.length({precision,subdivisions});if(segment.isDifferentiable()){if(length<=memo+len)return segment.tangentAtLength((fromStart?1:-1)*(length-memo),{precision,subdivisions});lastValidSegment=segment}memo+=len}if(lastValidSegment){const t=fromStart?1:0;return lastValidSegment.tangentAtT(t)}return null}tangentAtT(t){const count=this.segments.length;if(0===count)return null;const segmentIndex=t.segmentIndex;if(segmentIndex<0)return this.segments[0].tangentAtT(0);if(segmentIndex>=count)return this.segments[count-1].tangentAtT(1);const tValue=GeometryUtil.clamp(t.value,0,1);return this.segments[segmentIndex].tangentAtT(tValue)}getPrecision(options={}){return null==options.precision?this.PRECISION:options.precision}getSubdivisions(options={}){if(null==options.segmentSubdivisions){const precision=this.getPrecision(options);return this.getSegmentSubdivisions({precision})}return options.segmentSubdivisions}getOptions(options={}){return{precision:this.getPrecision(options),segmentSubdivisions:this.getSubdivisions(options)}}toPoints(options={}){const segments=this.segments,count=segments.length;if(0===count)return null;const segmentSubdivisions=this.getSubdivisions(options),points=[];let partialPoints=[];for(let i=0;i<count;i+=1){const segment=segments[i];if(segment.isVisible){const divisions=segmentSubdivisions[i];divisions.length>0?divisions.forEach((c=>partialPoints.push(c.start))):partialPoints.push(segment.start)}else partialPoints.length>0&&(partialPoints.push(segments[i-1].end),points.push(partialPoints),partialPoints=[])}return partialPoints.length>0&&(partialPoints.push(this.end),points.push(partialPoints)),points}toPolylines(options={}){const points=this.toPoints(options);return points?points.map((arr=>new Polyline(arr))):null}scale(sx,sy,origin){return this.segments.forEach((s=>s.scale(sx,sy,origin))),this}rotate(angle,origin){return this.segments.forEach((segment=>segment.rotate(angle,origin))),this}translate(tx,ty){return"number"==typeof tx?this.segments.forEach((s=>s.translate(tx,ty))):this.segments.forEach((s=>s.translate(tx))),this}clone(){const path=new Path;return this.segments.forEach((s=>path.appendSegment(s.clone()))),path}equals(p){if(null==p)return!1;const segments=this.segments,otherSegments=p.segments,count=segments.length;if(otherSegments.length!==count)return!1;for(let i=0;i<count;i+=1){const a=segments[i],b=otherSegments[i];if(a.type!==b.type||!a.equals(b))return!1}return!0}toJSON(){return this.segments.map((s=>s.toJSON()))}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map((s=>s.serialize())).join(" ")}toString(){return this.serialize()}}!function(Path){Path.isPath=function isPath(instance){return null!=instance&&instance instanceof Path}}(Path||(Path={})),function(Path){function createSegment(type,...args){if("M"===type)return MoveTo.create.call(null,...args);if("L"===type)return LineTo.create.call(null,...args);if("C"===type)return CurveTo.create.call(null,...args);if("z"===type||"Z"===type)return Close.create();throw new Error(`Invalid path segment type "${type}"`)}Path.parse=function parse(pathData){if(!pathData)return new Path;const path=new Path,commands=Path.normalize(pathData).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=commands)for(let i=0,ii=commands.length;i<ii;i+=1){const argRe=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,args=commands[i].match(argRe);if(null!=args){const type=args[0],coords=args.slice(1).map((a=>+a)),segment=createSegment.call(null,type,...coords);path.appendSegment(segment)}}return path},Path.createSegment=createSegment}(Path||(Path={})),function(Path){Path.normalize=normalizePathData,Path.isValid=isValid,Path.drawArc=drawArc,Path.drawPoints=drawPoints,Path.arcToCurves=arcToCurves}(Path||(Path={}));class Registry{constructor(options){this.options=Object.assign({},options),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(name,options,force=!1){if("object"==typeof name)return void Object.entries(name).forEach((([key,val])=>{this.register(key,val,options)}));!this.exist(name)||force||Platform.isApplyingHMR()||this.onDuplicated(name);const process=this.options.process,entity=process?call(process,this,name,options):options;return this.data[name]=entity,entity}unregister(name){const entity=name?this.data[name]:null;return delete this.data[name],entity}get(name){return name?this.data[name]:null}exist(name){return!!name&&null!=this.data[name]}onDuplicated(name){try{throw this.options.onConflict&&call(this.options.onConflict,this,name),new Error(`${lodash_es_upperFirst(this.options.type)} with name '${name}' already registered.`)}catch(err){throw err}}onNotFound(name,prefix){throw new Error(this.getSpellingSuggestion(name,prefix))}getSpellingSuggestion(name,prefix){const suggestion=this.getSpellingSuggestionForName(name),prefixed=prefix?`${prefix} ${lodash_es_lowerFirst(this.options.type)}`:this.options.type;return`${lodash_es_upperFirst(prefixed)} with name '${name}' does not exist.${suggestion?` Did you mean '${suggestion}'?`:""}`}getSpellingSuggestionForName(name){return function getSpellingSuggestion(name,candidates,getName){const maximumLengthDifference=Math.min(2,Math.floor(.34*name.length));let bestCandidate,bestDistance=Math.floor(.4*name.length)+1,justCheckExactMatches=!1;const nameLowerCase=name.toLowerCase();for(const candidate of candidates){const candidateName=getName(candidate);if(void 0!==candidateName&&Math.abs(candidateName.length-nameLowerCase.length)<=maximumLengthDifference){const candidateNameLowerCase=candidateName.toLowerCase();if(candidateNameLowerCase===nameLowerCase){if(candidateName===name)continue;return candidate}if(justCheckExactMatches)continue;if(candidateName.length<3)continue;const distance=levenshteinWithMax(nameLowerCase,candidateNameLowerCase,bestDistance-1);if(void 0===distance)continue;distance<3?(justCheckExactMatches=!0,bestCandidate=candidate):(bestDistance=distance,bestCandidate=candidate)}}return bestCandidate}(name,Object.keys(this.data),(candidate=>candidate))}}!function(Registry){Registry.create=function create(options){return new Registry(options)}}(Registry||(Registry={}));const dot={color:"#aaaaaa",thickness:1,markup:"rect",update(elem,options){const width=options.thickness*options.sx,height=options.thickness*options.sy;attr(elem,{width,height,rx:width,ry:height,fill:options.color})}},fixedDot={color:"#aaaaaa",thickness:1,markup:"rect",update(elem,options){const size=options.sx<=1?options.thickness*options.sx:options.thickness;attr(elem,{width:size,height:size,rx:size,ry:size,fill:options.color})}},mesh={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(elem,options){let d;const width=options.width,height=options.height,thickness=options.thickness;d=width-thickness>=0&&height-thickness>=0?["M",width,0,"H0 M0 0 V0",height].join(" "):"M 0 0 0 0",attr(elem,{d,stroke:options.color,"stroke-width":options.thickness})}},doubleMesh=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(elem,options){let d;const width=options.width,height=options.height,thickness=options.thickness;d=width-thickness>=0&&height-thickness>=0?["M",width,0,"H0 M0 0 V0",height].join(" "):"M 0 0 0 0",attr(elem,{d,stroke:options.color,"stroke-width":options.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(elem,options){let d;const factor=options.factor||1,width=options.width*factor,height=options.height*factor,thickness=options.thickness;d=width-thickness>=0&&height-thickness>=0?["M",width,0,"H0 M0 0 V0",height].join(" "):"M 0 0 0 0",options.width=width,options.height=height,attr(elem,{d,stroke:options.color,"stroke-width":options.thickness})}}];class Grid{constructor(){this.patterns={},this.root=Vector.create(createSvgDocument(),{width:"100%",height:"100%"},[createSvgElement("defs")]).node}add(id,elem){const firstChild=this.root.childNodes[0];firstChild&&firstChild.appendChild(elem),this.patterns[id]=elem,Vector.create("rect",{width:"100%",height:"100%",fill:`url(#${id})`}).appendTo(this.root)}get(id){return this.patterns[id]}has(id){return null!=this.patterns[id]}}!function(Grid){Grid.presets=grid_main_namespaceObject,Grid.registry=Registry.create({type:"grid"}),Grid.registry.register(Grid.presets,!0)}(Grid||(Grid={}));const flipX=function(img){const canvas=document.createElement("canvas"),width=img.width,height=img.height;canvas.width=2*width,canvas.height=height;const ctx=canvas.getContext("2d");return ctx.drawImage(img,0,0,width,height),ctx.translate(2*width,0),ctx.scale(-1,1),ctx.drawImage(img,0,0,width,height),canvas},flipY=function(img){const canvas=document.createElement("canvas"),width=img.width,height=img.height;canvas.width=width,canvas.height=2*height;const ctx=canvas.getContext("2d");return ctx.drawImage(img,0,0,width,height),ctx.translate(0,2*height),ctx.scale(1,-1),ctx.drawImage(img,0,0,width,height),canvas},flipXY=function(img){const canvas=document.createElement("canvas"),width=img.width,height=img.height;canvas.width=2*width,canvas.height=2*height;const ctx=canvas.getContext("2d");return ctx.drawImage(img,0,0,width,height),ctx.setTransform(-1,0,0,-1,canvas.width,canvas.height),ctx.drawImage(img,0,0,width,height),ctx.setTransform(-1,0,0,1,canvas.width,0),ctx.drawImage(img,0,0,width,height),ctx.setTransform(1,0,0,-1,0,canvas.height),ctx.drawImage(img,0,0,width,height),canvas},watermark=function(img,options){const width=img.width,height=img.height,canvas=document.createElement("canvas");canvas.width=3*width,canvas.height=3*height;const ctx=canvas.getContext("2d"),angle=null!=options.angle?-options.angle:-20,radians=Angle.toRad(angle),stepX=canvas.width/4,stepY=canvas.height/4;for(let i=0;i<4;i+=1)for(let j=0;j<4;j+=1)(i+j)%2>0&&(ctx.setTransform(1,0,0,1,(2*i-1)*stepX,(2*j-1)*stepY),ctx.rotate(radians),ctx.drawImage(img,-width/2,-height/2,width,height));return canvas};var Background,Filter;function getString(value,defaultValue){return null!=value?value:defaultValue}function util_getNumber(num,defaultValue){return null!=num&&Number.isFinite(num)?num:defaultValue}function outline(args={}){const color=getString(args.color,"blue"),width=util_getNumber(args.width,1),margin=util_getNumber(args.margin,2);return`\n    <filter>\n      <feFlood flood-color="${color}" flood-opacity="${util_getNumber(args.opacity,1)}" result="colored"/>\n      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${margin+width}" />\n      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${margin}" />\n      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n      <feMerge>\n        <feMergeNode in="outline"/>\n        <feMergeNode in="SourceGraphic"/>\n      </feMerge>\n    </filter>\n  `.trim()}function highlight(args={}){const color=getString(args.color,"red"),blur=util_getNumber(args.blur,0),width=util_getNumber(args.width,1);return`\n      <filter>\n        <feFlood flood-color="${color}" flood-opacity="${util_getNumber(args.opacity,1)}" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/>\n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    `.trim()}function blur_blur(args={}){const x=util_getNumber(args.x,2);return`\n    <filter>\n      <feGaussianBlur stdDeviation="${null!=args.y&&Number.isFinite(args.y)?[x,args.y]:x}"/>\n    </filter>\n  `.trim()}function dropShadow(args={}){const dx=util_getNumber(args.dx,0),dy=util_getNumber(args.dy,0),color=getString(args.color,"black"),blur=util_getNumber(args.blur,4),opacity=util_getNumber(args.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>\n         <feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}" />\n       </filter>`.trim():`<filter>\n         <feGaussianBlur in="SourceAlpha" stdDeviation="${blur}" />\n         <feOffset dx="${dx}" dy="${dy}" result="offsetblur" />\n         <feFlood flood-color="${color}" />\n         <feComposite in2="offsetblur" operator="in" />\n         <feComponentTransfer>\n           <feFuncA type="linear" slope="${opacity}" />\n         </feComponentTransfer>\n         <feMerge>\n           <feMergeNode/>\n           <feMergeNode in="SourceGraphic"/>\n         </feMerge>\n       </filter>`.trim()}function grayScale(args={}){const amount=util_getNumber(args.amount,1),b=.7152-.7152*(1-amount);return`\n    <filter>\n      <feColorMatrix type="matrix" values="${.2126+.7874*(1-amount)} ${b} ${.0722-.0722*(1-amount)} 0 0 ${.2126-.2126*(1-amount)} ${.7152+.2848*(1-amount)} ${.0722-.0722*(1-amount)} 0 0 ${.2126-.2126*(1-amount)} ${b} ${.0722+.9278*(1-amount)} 0 0 0 0 0 1 0"/>\n    </filter>\n  `.trim()}function sepia(args={}){const amount=util_getNumber(args.amount,1);return`\n      <filter>\n        <feColorMatrix type="matrix" values="${.393+.607*(1-amount)} ${.769-.769*(1-amount)} ${.189-.189*(1-amount)} 0 0 ${.349-.349*(1-amount)} ${.686+.314*(1-amount)} ${.168-.168*(1-amount)} 0 0 ${.272-.272*(1-amount)} ${.534-.534*(1-amount)} ${.131+.869*(1-amount)} 0 0 0 0 0 1 0"/>\n      </filter>\n    `.trim()}function saturate(args={}){return`\n      <filter>\n        <feColorMatrix type="saturate" values="${1-util_getNumber(args.amount,1)}"/>\n      </filter>\n    `.trim()}function hueRotate(args={}){return`\n      <filter>\n        <feColorMatrix type="hueRotate" values="${util_getNumber(args.angle,0)}"/>\n      </filter>\n    `.trim()}function invert(args={}){const amount=util_getNumber(args.amount,1),amount2=1-amount;return`\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="${amount} ${amount2}"/>\n          <feFuncG type="table" tableValues="${amount} ${amount2}"/>\n          <feFuncB type="table" tableValues="${amount} ${amount2}"/>\n        </feComponentTransfer>\n      </filter>\n    `.trim()}function brightness(args={}){const amount=util_getNumber(args.amount,1);return`\n    <filter>\n      <feComponentTransfer>\n        <feFuncR type="linear" slope="${amount}"/>\n        <feFuncG type="linear" slope="${amount}"/>\n        <feFuncB type="linear" slope="${amount}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()}function contrast(args={}){const amount=util_getNumber(args.amount,1),amount2=.5-amount/2;return`\n    <filter>\n     <feComponentTransfer>\n        <feFuncR type="linear" slope="${amount}" intercept="${amount2}"/>\n        <feFuncG type="linear" slope="${amount}" intercept="${amount2}"/>\n        <feFuncB type="linear" slope="${amount}" intercept="${amount2}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()}!function(Background){Background.presets=Object.assign({},background_main_namespaceObject),Background.presets["flip-x"]=flipX,Background.presets["flip-y"]=flipY,Background.presets["flip-xy"]=flipXY,Background.registry=Registry.create({type:"background pattern"}),Background.registry.register(Background.presets,!0)}(Background||(Background={})),function(Filter){Filter.presets=filter_main_namespaceObject,Filter.registry=Registry.create({type:"filter"}),Filter.registry.register(Filter.presets,!0)}(Filter||(Filter={}));const raw={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},ref={},refX={position:positionWrapper("x","width","origin")},refY={position:positionWrapper("y","height","origin")},refDx={position:positionWrapper("x","width","corner")},refDy={position:positionWrapper("y","height","corner")},refWidth={set:setWrapper("width","width")},refHeight={set:setWrapper("height","height")},refRx={set:setWrapper("rx","width")},refRy={set:setWrapper("ry","height")},refRInscribed={set:(()=>{const widthFn=setWrapper("r","width"),heightFn=setWrapper("r","height");return function(value,options){const refBBox=options.refBBox;return call(refBBox.height>refBBox.width?widthFn:heightFn,this,value,options)}})()},refRCircumscribed={set(val,{refBBox}){let value=parseFloat(val);const percentage=number_isPercentage(val);percentage&&(value/=100);const diagonalLength=Math.sqrt(refBBox.height*refBBox.height+refBBox.width*refBBox.width);let rValue;return Number.isFinite(value)&&(rValue=percentage||value>=0&&value<=1?value*diagonalLength:Math.max(value+diagonalLength,0)),{r:rValue}}},refCx={set:setWrapper("cx","width")},refCy={set:setWrapper("cy","height")},refDResetOffset={set:dWrapper({resetOffset:!0})},refDKeepOffset={set:dWrapper({resetOffset:!1})},refPointsResetOffset={set:pointsWrapper({resetOffset:!0})},refPointsKeepOffset={set:pointsWrapper({resetOffset:!1})},refR=refRInscribed,refD=refDResetOffset,refPoints=refPointsResetOffset,refX2=refX,refY2=refY,refWidth2=refWidth,refHeight2=refHeight;function positionWrapper(axis,dimension,origin){return(val,{refBBox})=>{if(null==val)return null;let value=parseFloat(val);const percentage=number_isPercentage(val);let delta;if(percentage&&(value/=100),Number.isFinite(value)){const refOrigin=refBBox[origin];delta=percentage||value>0&&value<1?refOrigin[axis]+refBBox[dimension]*value:refOrigin[axis]+value}const point=new Point;return point[axis]=delta||0,point}}function setWrapper(attrName,dimension){return function(val,{refBBox}){let value=parseFloat(val);const percentage=number_isPercentage(val);percentage&&(value/=100);const attrs={};if(Number.isFinite(value)){const attrValue=percentage||value>=0&&value<=1?value*refBBox[dimension]:Math.max(value+refBBox[dimension],0);attrs[attrName]=attrValue}return attrs}}function shapeWrapper(shapeConstructor,options){const resetOffset=options&&options.resetOffset;return function(value,{elem,refBBox}){let cache=data(elem,"x6-shape");if(!cache||cache.value!==value){const cachedShape=shapeConstructor(value);cache={value,shape:cachedShape,shapeBBox:cachedShape.bbox()},data(elem,"x6-shape",cache)}const shape=cache.shape.clone(),shapeBBox=cache.shapeBBox.clone(),shapeOrigin=shapeBBox.getOrigin(),refOrigin=refBBox.getOrigin();shapeBBox.x=refOrigin.x,shapeBBox.y=refOrigin.y;const fitScale=refBBox.getMaxScaleToFit(shapeBBox,refOrigin),sx=0===shapeBBox.width||0===refBBox.width?1:fitScale.sx,sy=0===shapeBBox.height||0===refBBox.height?1:fitScale.sy;return shape.scale(sx,sy,shapeOrigin),resetOffset&&shape.translate(-shapeOrigin.x,-shapeOrigin.y),shape}}function dWrapper(options){const shape=shapeWrapper((function pathConstructor(value){return Path.parse(value)}),options);return(value,args)=>({d:shape(value,args).serialize()})}function pointsWrapper(options){const shape=shapeWrapper((points=>new Polyline(points)),options);return(value,args)=>({points:shape(value,args).serialize()})}const fill={qualify:lodash_es_isPlainObject,set:(fill,{view})=>`url(#${view.graph.defineGradient(fill)})`},stroke={qualify:lodash_es_isPlainObject,set(stroke,{view}){const cell=view.cell,options=Object.assign({},stroke);if(cell.isEdge()&&"linearGradient"===options.type){const edgeView=view,source=edgeView.sourcePoint,target=edgeView.targetPoint;options.id=`gradient-${options.type}-${cell.id}`,options.attrs=Object.assign(Object.assign({},options.attrs),{x1:source.x,y1:source.y,x2:target.x,y2:target.y,gradientUnits:"userSpaceOnUse"}),view.graph.defs.remove(options.id)}return`url(#${view.graph.defineGradient(options)})`}},attr_text_text={qualify:(text,{attrs})=>null==attrs.textWrap||!lodash_es_isPlainObject(attrs.textWrap),set(text,{view,elem,attrs}){const cache=data(elem,"x6-text"),json=str=>{try{return JSON.parse(str)}catch(error){return str}},options={x:attrs.x,eol:attrs.eol,annotations:json(attrs.annotations),textPath:json(attrs["text-path"]||attrs.textPath),textVerticalAnchor:attrs["text-vertical-anchor"]||attrs.textVerticalAnchor,displayEmpty:"true"===(attrs["display-empty"]||attrs.displayEmpty),lineHeight:attrs["line-height"]||attrs.lineHeight},fontSize=attrs["font-size"]||attrs.fontSize,textHash=JSON.stringify([text,options]);if(fontSize&&elem.setAttribute("font-size",fontSize),null==cache||cache!==textHash){const textPath=options.textPath;if(null!=textPath&&"object"==typeof textPath){const selector=textPath.selector;if("string"==typeof selector){const pathNode=view.find(selector)[0];pathNode instanceof SVGPathElement&&(ensureId(pathNode),options.textPath=Object.assign({"xlink:href":`#${pathNode.id}`},textPath))}}text_text(elem,`${text}`,options),data(elem,"x6-text",textHash)}}},textWrap={qualify:lodash_es_isPlainObject,set(val,{view,elem,attrs,refBBox}){const info=val,width=info.width||0;number_isPercentage(width)?refBBox.width*=parseFloat(width)/100:width<=0?refBBox.width+=width:refBBox.width=width;const height=info.height||0;let wrappedText;number_isPercentage(height)?refBBox.height*=parseFloat(height)/100:height<=0?refBBox.height+=height:refBBox.height=height;let txt=info.text;null==txt&&(txt=attrs.text||(null==elem?void 0:elem.textContent)),wrappedText=null!=txt?breakText(`${txt}`,refBBox,{"font-weight":attrs["font-weight"]||attrs.fontWeight,"font-size":attrs["font-size"]||attrs.fontSize,"font-family":attrs["font-family"]||attrs.fontFamily,lineHeight:attrs.lineHeight},{ellipsis:info.ellipsis}):"",call(attr_text_text.set,this,wrappedText,{view,elem,attrs,refBBox,cell:view.cell})}},isTextInUse=(val,{attrs})=>void 0!==attrs.text,lineHeight={qualify:isTextInUse},textVerticalAnchor={qualify:isTextInUse},textPath={qualify:isTextInUse},annotations={qualify:isTextInUse},eol={qualify:isTextInUse},displayEmpty={qualify:isTextInUse},title={qualify:(title,{elem})=>elem instanceof SVGElement,set(val,{elem}){const title=`${val}`,cache=data(elem,"x6-title");if(null==cache||cache!==title){data(elem,"x6-title",title);const firstChild=elem.firstChild;if(firstChild&&"TITLE"===firstChild.tagName.toUpperCase()){firstChild.textContent=title}else{const titleNode=document.createElementNS(elem.namespaceURI,"title");titleNode.textContent=title,elem.insertBefore(titleNode,firstChild)}}}},xAlign={offset:offsetWrapper("x","width","right")},yAlign={offset:offsetWrapper("y","height","bottom")},resetOffset={offset:(val,{refBBox})=>val?{x:-refBBox.x,y:-refBBox.y}:{x:0,y:0}};function offsetWrapper(axis,dimension,corner){return(value,{refBBox})=>{const point=new Point;let delta;return delta="middle"===value?refBBox[dimension]/2:value===corner?refBBox[dimension]:"number"==typeof value&&Number.isFinite(value)?value>-1&&value<1?-refBBox[dimension]*value:-value:number_isPercentage(value)?refBBox[dimension]*parseFloat(value)/100:0,point[axis]=-(refBBox[axis]+delta),point}}const style={qualify:lodash_es_isPlainObject,set(styles,{elem}){css(elem,styles)}},html={set(html,{elem}){elem.innerHTML=`${html}`}},filter={qualify:lodash_es_isPlainObject,set:(filter,{view})=>`url(#${view.graph.defineFilter(filter)})`},port={set:port=>null!=port&&"object"==typeof port&&port.id?port.id:port};function util_normalize(d,offset1,offset2){let offsetX,offsetY;"object"==typeof offset1?(offsetX=offset1.x,offsetY=offset1.y):(offsetX=offset1,offsetY=offset2);const path=Path.parse(d),bbox=path.bbox();if(bbox){let ty=-bbox.height/2-bbox.y,tx=-bbox.width/2-bbox.x;"number"==typeof offsetX&&(tx-=offsetX),"number"==typeof offsetY&&(ty-=offsetY),path.translate(tx,ty)}return path.serialize()}var classic_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const block=_a=>{var{size,width,height,offset,open}=_a;return createClassicMarker({size,width,height,offset},!0===open,!0,void 0,classic_rest(_a,["size","width","height","offset","open"]))},classic=_a=>{var{size,width,height,offset,factor}=_a;return createClassicMarker({size,width,height,offset},!1,!1,factor,classic_rest(_a,["size","width","height","offset","factor"]))};function createClassicMarker(options,open,full,factor=3/4,attrs={}){const size=options.size||10,width=options.width||size,height=options.height||size,path=new Path,localAttrs={};if(open)path.moveTo(width,0).lineTo(0,height/2).lineTo(width,height),localAttrs.fill="none";else{if(path.moveTo(0,height/2),path.lineTo(width,0),!full){const f=lodash_es_clamp(factor,0,1);path.lineTo(width*f,height/2)}path.lineTo(width,height),path.close()}return Object.assign(Object.assign(Object.assign({},localAttrs),attrs),{tagName:"path",d:util_normalize(path.serialize(),{x:null!=options.offset?options.offset:-width/2})})}var diamond_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const diamond=_a=>{var{size,width,height,offset}=_a,attrs=diamond_rest(_a,["size","width","height","offset"]);const s=size||10,w=width||s,h=height||s,path=new Path;return path.moveTo(0,h/2).lineTo(w/2,0).lineTo(w,h/2).lineTo(w/2,h).close(),Object.assign(Object.assign({},attrs),{tagName:"path",d:util_normalize(path.serialize(),null==offset?-w/2:offset)})};var path_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const path=_a=>{var{d,offsetX,offsetY}=_a,attrs=path_rest(_a,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},attrs),{tagName:"path",d:util_normalize(d,offsetX,offsetY)})};var cross_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const cross=_a=>{var{size,width,height,offset}=_a,attrs=cross_rest(_a,["size","width","height","offset"]);const s=size||10,w=width||s,h=height||s,path=new Path;return path.moveTo(0,0).lineTo(w,h).moveTo(0,h).lineTo(w,0),Object.assign(Object.assign({},attrs),{tagName:"path",fill:"none",d:util_normalize(path.serialize(),offset||-w/2)})};var async_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const async_async=_a=>{var{width,height,offset,open,flip}=_a,attrs=async_rest(_a,["width","height","offset","open","flip"]);let h=height||6;const w=width||10,opened=!0===open,fliped=!0===flip,result=Object.assign(Object.assign({},attrs),{tagName:"path"});fliped&&(h=-h);const path=new Path;return path.moveTo(0,h).lineTo(w,0),opened?result.fill="none":(path.lineTo(w,h),path.close()),result.d=util_normalize(path.serialize(),{x:offset||-w/2,y:h/2}),result};var circle_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const circle=_a=>{var{r}=_a,attrs=circle_rest(_a,["r"]);const radius=r||5;return Object.assign(Object.assign({cx:radius},attrs),{tagName:"circle",r:radius})},circlePlus=_a=>{var{r}=_a,attrs=circle_rest(_a,["r"]);const radius=r||5,path=new Path;return path.moveTo(radius,0).lineTo(radius,2*radius),path.moveTo(0,radius).lineTo(2*radius,radius),{children:[Object.assign(Object.assign({},circle({r:radius})),{fill:"none"}),Object.assign(Object.assign({},attrs),{tagName:"path",d:util_normalize(path.serialize(),-radius)})]}};var ellipse_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const ellipse=_a=>{var{rx,ry}=_a,attrs=ellipse_rest(_a,["rx","ry"]);const radiusX=rx||5,radiusy=ry||5;return Object.assign(Object.assign({cx:radiusX},attrs),{tagName:"ellipse",rx:radiusX,ry:radiusy})};var Marker;!function(Marker){Marker.presets=marker_main_namespaceObject,Marker.registry=Registry.create({type:"marker"}),Marker.registry.register(Marker.presets,!0)}(Marker||(Marker={})),function(Marker){Marker.normalize=util_normalize}(Marker||(Marker={}));var marker_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};function qualify(value){return"string"==typeof value||lodash_es_isPlainObject(value)}const sourceMarker={qualify,set:(marker,{view,attrs})=>createMarker("marker-start",marker,view,attrs)},targetMarker={qualify,set:(marker,{view,attrs})=>createMarker("marker-end",marker,view,attrs,{transform:"rotate(180)"})},vertexMarker={qualify,set:(marker,{view,attrs})=>createMarker("marker-mid",marker,view,attrs)};function createMarker(type,marker,view,attrs,manual={}){const def="string"==typeof marker?{name:marker}:marker,{name,args}=def,others=marker_rest(def,["name","args"]);let preset=others;if(name&&"string"==typeof name){const fn=Marker.registry.get(name);if(!fn)return Marker.registry.onNotFound(name);preset=fn(Object.assign(Object.assign({},others),args))}const options=Object.assign(Object.assign(Object.assign({},function normalizeAttr(attr,type){const result={},stroke=attr.stroke;"string"==typeof stroke&&(result.stroke=stroke,result.fill=stroke);let strokeOpacity=attr.strokeOpacity;null==strokeOpacity&&(strokeOpacity=attr["stroke-opacity"]);null==strokeOpacity&&(strokeOpacity=attr.opacity);null!=strokeOpacity&&(result["stroke-opacity"]=strokeOpacity,result["fill-opacity"]=strokeOpacity);if("marker-mid"!==type){const strokeWidth=parseFloat(attr.strokeWidth||attr["stroke-width"]);if(Number.isFinite(strokeWidth)&&strokeWidth>1){const offset=Math.ceil(strokeWidth/2);result.refX="marker-start"===type?offset:-offset}}return result}(attrs,type)),manual),preset);return{[type]:`url(#${view.graph.defineMarker(options)})`}}const isEdgeView=(val,{view})=>view.cell.isEdge(),connection={qualify:isEdgeView,set(val,args){var _a,_b,_c,_d;const view=args.view,reverse=val.reverse||!1,stubs=val.stubs||0;let d;if(Number.isFinite(stubs)&&0!==stubs)if(reverse){let offset,length;const len=view.getConnectionLength()||0;stubs<0?(offset=(len+stubs)/2,length=-stubs):(offset=stubs,length=len-2*stubs);const path=view.getConnection();d=null===(_d=null===(_c=null===(_b=null===(_a=null==path?void 0:path.divideAtLength(offset))||void 0===_a?void 0:_a[1])||void 0===_b?void 0:_b.divideAtLength(length))||void 0===_c?void 0:_c[0])||void 0===_d?void 0:_d.serialize()}else{let offset;if(stubs<0){offset=((view.getConnectionLength()||0)+stubs)/2}else offset=stubs;const path=view.getConnection();if(path){const sourceParts=path.divideAtLength(offset),targetParts=path.divideAtLength(-offset);sourceParts&&targetParts&&(d=`${sourceParts[0].serialize()} ${targetParts[1].serialize()}`)}}return{d:d||view.getConnectionPathData()}}},atConnectionLengthKeepGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtLength",{rotate:!0})},atConnectionLengthIgnoreGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtLength",{rotate:!1})},atConnectionRatioKeepGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtRatio",{rotate:!0})},atConnectionRatioIgnoreGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtRatio",{rotate:!1})},atConnectionLength=atConnectionLengthKeepGradient,atConnectionRatio=atConnectionRatioKeepGradient;function atConnectionWrapper(method,options){const zeroVector={x:1,y:0};return(value,args)=>{let p,angle;const view=args.view,tangent=view[method](Number(value));return tangent?(angle=options.rotate?tangent.vector().vectorAngle(zeroVector):0,p=tangent.start):(p=view.path.start,angle=0),0===angle?{transform:`translate(${p.x},${p.y}')`}:{transform:`translate(${p.x},${p.y}') rotate(${angle})`}}}var Attr;!function(Attr){Attr.isValidDefinition=function isValidDefinition(def,val,options){if(null!=def){if("string"==typeof def)return!0;if("function"!=typeof def.qualify||call(def.qualify,this,val,options))return!0}return!1}}(Attr||(Attr={})),function(Attr){Attr.presets=Object.assign(Object.assign({},raw),attr_main_namespaceObject),Attr.registry=Registry.create({type:"attribute definition"}),Attr.registry.register(Attr.presets,!0)}(Attr||(Attr={}));const Config={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix:suffix=>`${Config.prefixCls}-${suffix}`},defaultClassName=Config.prefix("highlighted"),className={highlight(cellView,magnet,options){addClass(magnet,options&&options.className||defaultClassName)},unhighlight(cellView,magnet,options){removeClass(magnet,options&&options.className||defaultClassName)}},opacity_className=Config.prefix("highlight-opacity"),opacity={highlight(cellView,magnet){addClass(magnet,opacity_className)},unhighlight(cellView,magnetEl){removeClass(magnetEl,opacity_className)}};var util_Util;!function(Util){function transformPoint(point,matrix){const ret=function createSVGPoint(x,y){const p=createSvgElement("svg").createSVGPoint();return p.x=x,p.y=y,p}(point.x,point.y).matrixTransform(matrix);return new Point(ret.x,ret.y)}function transformRectangle(rect,matrix){const p=createSvgElement("svg").createSVGPoint();p.x=rect.x,p.y=rect.y;const corner1=p.matrixTransform(matrix);p.x=rect.x+rect.width,p.y=rect.y;const corner2=p.matrixTransform(matrix);p.x=rect.x+rect.width,p.y=rect.y+rect.height;const corner3=p.matrixTransform(matrix);p.x=rect.x,p.y=rect.y+rect.height;const corner4=p.matrixTransform(matrix),minX=Math.min(corner1.x,corner2.x,corner3.x,corner4.x),maxX=Math.max(corner1.x,corner2.x,corner3.x,corner4.x),minY=Math.min(corner1.y,corner2.y,corner3.y,corner4.y),maxY=Math.max(corner1.y,corner2.y,corner3.y,corner4.y);return new Rectangle(minX,minY,maxX-minX,maxY-minY)}function getBBox(elem,options={}){let outputBBox;if(!elem.ownerSVGElement||!isSVGGraphicsElement(elem)){if(isHTMLElement(elem)){const{left,top,width,height}=getBoundingOffsetRect(elem);return new Rectangle(left,top,width,height)}return new Rectangle(0,0,0,0)}let target=options.target;if(!options.recursive){try{outputBBox=elem.getBBox()}catch(e){outputBBox={x:elem.clientLeft,y:elem.clientTop,width:elem.clientWidth,height:elem.clientHeight}}if(!target)return Rectangle.create(outputBBox);return transformRectangle(outputBBox,getTransformToElement(elem,target))}{const children=elem.childNodes,n=children.length;if(0===n)return getBBox(elem,{target});target||(target=elem);for(let i=0;i<n;i+=1){const child=children[i];let childBBox;childBBox=0===child.childNodes.length?getBBox(child,{target}):getBBox(child,{target,recursive:!0}),outputBBox=outputBBox?outputBBox.union(childBBox):childBBox}return outputBBox}}function getBoundingOffsetRect(elem){let left=0,top=0,width=0,height=0;if(elem){let current=elem;for(;current;)left+=current.offsetLeft,top+=current.offsetTop,current=current.offsetParent,current&&(left+=parseInt(style_getComputedStyle(current,"borderLeft"),10),top+=parseInt(style_getComputedStyle(current,"borderTop"),10));width=elem.offsetWidth,height=elem.offsetHeight}return{left,top,width,height}}function toGeometryShape(elem){const attr=name=>{const s=elem.getAttribute(name),v=s?parseFloat(s):0;return Number.isNaN(v)?0:v};switch(elem instanceof SVGElement&&elem.nodeName.toLowerCase()){case"rect":return new Rectangle(attr("x"),attr("y"),attr("width"),attr("height"));case"circle":return new Ellipse(attr("cx"),attr("cy"),attr("r"),attr("r"));case"ellipse":return new Ellipse(attr("cx"),attr("cy"),attr("rx"),attr("ry"));case"polyline":{const points=getPointsFromSvgElement(elem);return new Polyline(points)}case"polygon":{const points=getPointsFromSvgElement(elem);return points.length>1&&points.push(points[0]),new Polyline(points)}case"path":{let d=elem.getAttribute("d");return Path.isValid(d)||(d=Path.normalize(d)),Path.parse(d)}case"line":return new Line(attr("x1"),attr("y1"),attr("x2"),attr("y2"))}return getBBox(elem)}function findShapeNode(magnet){if(null==magnet)return null;let node=magnet;do{let tagName=node.tagName;if("string"!=typeof tagName)return null;if(tagName=tagName.toUpperCase(),hasClass(node,"x6-port"))node=node.nextElementSibling;else if("G"===tagName)node=node.firstElementChild;else{if("TITLE"!==tagName)break;node=node.nextElementSibling}}while(node);return node}Util.normalizeMarker=util_normalize,Util.transformPoint=transformPoint,Util.transformLine=function transformLine(line,matrix){return new Line(transformPoint(line.start,matrix),transformPoint(line.end,matrix))},Util.transformPolyline=function transformPolyline(polyline,matrix){let points=polyline instanceof Polyline?polyline.points:polyline;return Array.isArray(points)||(points=[]),new Polyline(points.map((p=>transformPoint(p,matrix))))},Util.transformRectangle=transformRectangle,Util.bbox=function bbox(elem,withoutTransformations,target){let box;const ownerSVGElement=elem.ownerSVGElement;if(!ownerSVGElement)return new Rectangle(0,0,0,0);try{box=elem.getBBox()}catch(e){box={x:elem.clientLeft,y:elem.clientTop,width:elem.clientWidth,height:elem.clientHeight}}return withoutTransformations?Rectangle.create(box):transformRectangle(box,getTransformToElement(elem,target||ownerSVGElement))},Util.getBBox=getBBox,Util.getBoundingOffsetRect=getBoundingOffsetRect,Util.toGeometryShape=toGeometryShape,Util.translateAndAutoOrient=function translateAndAutoOrient(elem,position,reference,target){const pos=Point.create(position),ref=Point.create(reference);if(!target){target=elem instanceof SVGSVGElement?elem:elem.ownerSVGElement}const s=scale(elem);elem.setAttribute("transform","");const bbox=getBBox(elem,{target}).scale(s.sx,s.sy),translateToOrigin=createSVGTransform();translateToOrigin.setTranslate(-bbox.x-bbox.width/2,-bbox.y-bbox.height/2);const rotateAroundOrigin=createSVGTransform(),angle=pos.angleBetween(ref,pos.clone().translate(1,0));angle&&rotateAroundOrigin.setRotate(angle,0,0);const translateFromOrigin=createSVGTransform(),finalPosition=pos.clone().move(ref,bbox.width/2);translateFromOrigin.setTranslate(2*pos.x-finalPosition.x,2*pos.y-finalPosition.y);const ctm=getTransformToElement(elem,target),transform=createSVGTransform();transform.setMatrix(translateFromOrigin.matrix.multiply(rotateAroundOrigin.matrix.multiply(translateToOrigin.matrix.multiply(ctm.scale(s.sx,s.sy))))),elem.setAttribute("transform",matrixToTransformString(transform.matrix))},Util.findShapeNode=findShapeNode,Util.getBBoxV2=function getBBoxV2(elem){const node=findShapeNode(elem);if(!isSVGGraphicsElement(node)){if(isHTMLElement(elem)){const{left,top,width,height}=getBoundingOffsetRect(elem);return new Rectangle(left,top,width,height)}return new Rectangle(0,0,0,0)}return toGeometryShape(node).bbox()||Rectangle.create()}}(util_Util||(util_Util={}));const defaultOptions={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},stroke_stroke={highlight(cellView,magnet,options){const id=stroke_Private.getHighlighterId(magnet,options);if(stroke_Private.hasCache(id))return;options=lodash_es_defaultsDeep({},options,defaultOptions);const magnetVel=Vector.create(magnet);let pathData,magnetBBox;try{pathData=magnetVel.toPathData()}catch(error){magnetBBox=util_Util.bbox(magnetVel.node,!0),pathData=rectToPathData(Object.assign(Object.assign({},options),magnetBBox))}const path=createSvgElement("path");if(attr(path,Object.assign({d:pathData,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},options.attrs?kebablizeAttrs(options.attrs):null)),cellView.isEdgeElement(magnet))attr(path,"d",cellView.getConnectionPathData());else{let highlightMatrix=magnetVel.getTransformToElement(cellView.container);const padding=options.padding;if(padding){null==magnetBBox&&(magnetBBox=util_Util.bbox(magnetVel.node,!0));const cx=magnetBBox.x+magnetBBox.width/2,cy=magnetBBox.y+magnetBBox.height/2;magnetBBox=util_Util.transformRectangle(magnetBBox,highlightMatrix);const width=Math.max(magnetBBox.width,1),height=Math.max(magnetBBox.height,1),sx=(width+padding)/width,sy=(height+padding)/height,paddingMatrix=createSVGMatrix({a:sx,b:0,c:0,d:sy,e:cx-sx*cx,f:cy-sy*cy});highlightMatrix=highlightMatrix.multiply(paddingMatrix)}transform(path,highlightMatrix)}addClass(path,Config.prefix("highlight-stroke"));const cell=cellView.cell,removeHandler=()=>stroke_Private.removeHighlighter(id);cell.on("removed",removeHandler),cell.model&&cell.model.on("reseted",removeHandler),cellView.container.appendChild(path),stroke_Private.setCache(id,path)},unhighlight(cellView,magnet,opt){stroke_Private.removeHighlighter(stroke_Private.getHighlighterId(magnet,opt))}};var stroke_Private,Highlighter;function normalizePoint(bbox,args={}){return new Point(normalizePercentage(args.x,bbox.width),normalizePercentage(args.y,bbox.height))}function toResult(point,angle,rawArgs){return Object.assign({angle,position:point.toJSON()},rawArgs)}!function(Private){Private.getHighlighterId=function getHighlighterId(magnet,options){return ensureId(magnet),magnet.id+JSON.stringify(options)};const cache={};Private.setCache=function setCache(id,elem){cache[id]=elem},Private.hasCache=function hasCache(id){return null!=cache[id]},Private.removeHighlighter=function removeHighlighter(id){const elem=cache[id];elem&&(remove(elem),delete cache[id])}}(stroke_Private||(stroke_Private={})),function(Highlighter){Highlighter.check=function check(name,highlighter){if("function"!=typeof highlighter.highlight)throw new Error(`Highlighter '${name}' is missing required \`highlight()\` method`);if("function"!=typeof highlighter.unhighlight)throw new Error(`Highlighter '${name}' is missing required \`unhighlight()\` method`)}}(Highlighter||(Highlighter={})),function(Highlighter){Highlighter.presets=highlighter_main_namespaceObject,Highlighter.registry=Registry.create({type:"highlighter"}),Highlighter.registry.register(Highlighter.presets,!0)}(Highlighter||(Highlighter={}));const absolute=(portsPositionArgs,elemBBox)=>portsPositionArgs.map((({x,y,angle})=>toResult(normalizePoint(elemBBox,{x,y}),angle||0))),ellipse_ellipse=(portsPositionArgs,elemBBox,groupPositionArgs)=>{const startAngle=groupPositionArgs.start||0,stepAngle=groupPositionArgs.step||20;return ellipseLayout(portsPositionArgs,elemBBox,startAngle,((index,count)=>(index+.5-count/2)*stepAngle))},ellipseSpread=(portsPositionArgs,elemBBox,groupPositionArgs)=>{const startAngle=groupPositionArgs.start||0,stepAngle=groupPositionArgs.step||360/portsPositionArgs.length;return ellipseLayout(portsPositionArgs,elemBBox,startAngle,(index=>index*stepAngle))};function ellipseLayout(portsPositionArgs,elemBBox,startAngle,stepFn){const center=elemBBox.getCenter(),start=elemBBox.getTopCenter(),ratio=elemBBox.width/elemBBox.height,ellipse=Ellipse.fromRect(elemBBox),count=portsPositionArgs.length;return portsPositionArgs.map(((item,index)=>{const angle=startAngle+stepFn(index,count),p=start.clone().rotate(-angle,center).scale(ratio,1,center),theta=item.compensateRotate?-ellipse.tangentTheta(p):0;return(item.dx||item.dy)&&p.translate(item.dx||0,item.dy||0),item.dr&&p.move(center,item.dr),toResult(p.round(),theta,item)}))}var line_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const line=(portsPositionArgs,elemBBox,groupPositionArgs)=>lineLayout(portsPositionArgs,normalizePoint(elemBBox,groupPositionArgs.start||elemBBox.getOrigin()),normalizePoint(elemBBox,groupPositionArgs.end||elemBBox.getCorner()),groupPositionArgs),left=(portsPositionArgs,elemBBox,groupPositionArgs)=>lineLayout(portsPositionArgs,elemBBox.getTopLeft(),elemBBox.getBottomLeft(),groupPositionArgs),right=(portsPositionArgs,elemBBox,groupPositionArgs)=>lineLayout(portsPositionArgs,elemBBox.getTopRight(),elemBBox.getBottomRight(),groupPositionArgs),line_top=(portsPositionArgs,elemBBox,groupPositionArgs)=>lineLayout(portsPositionArgs,elemBBox.getTopLeft(),elemBBox.getTopRight(),groupPositionArgs),bottom=(portsPositionArgs,elemBBox,groupPositionArgs)=>lineLayout(portsPositionArgs,elemBBox.getBottomLeft(),elemBBox.getBottomRight(),groupPositionArgs);function lineLayout(portsPositionArgs,p1,p2,groupPositionArgs){const line=new Line(p1,p2),length=portsPositionArgs.length;return portsPositionArgs.map(((_a,index)=>{var{strict}=_a,offset=line_rest(_a,["strict"]);const ratio=strict||groupPositionArgs.strict?(index+1)/(length+1):(index+.5)/length,p=line.pointAt(ratio);return(offset.dx||offset.dy)&&p.translate(offset.dx||0,offset.dy||0),toResult(p.round(),0,offset)}))}var PortLayout;!function(PortLayout){PortLayout.presets=port_layout_main_namespaceObject,PortLayout.registry=Registry.create({type:"port layout"}),PortLayout.registry.register(PortLayout.presets,!0)}(PortLayout||(PortLayout={}));const util_defaults={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function util_toResult(preset,args){const{x,y,angle,attrs}=args||{};return lodash_es_defaultsDeep({},{angle,attrs,position:{x,y}},preset,util_defaults)}const manual=(portPosition,elemBBox,args)=>util_toResult({position:elemBBox.getTopLeft()},args),side_left=(portPosition,elemBBox,args)=>util_toResult({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},args),side_right=(portPosition,elemBBox,args)=>util_toResult({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},args),side_top=(portPosition,elemBBox,args)=>util_toResult({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},args),side_bottom=(portPosition,elemBBox,args)=>util_toResult({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},args),outside=(portPosition,elemBBox,args)=>outsideLayout(portPosition,elemBBox,!1,args),outsideOriented=(portPosition,elemBBox,args)=>outsideLayout(portPosition,elemBBox,!0,args),inside=(portPosition,elemBBox,args)=>insideLayout(portPosition,elemBBox,!1,args),insideOriented=(portPosition,elemBBox,args)=>insideLayout(portPosition,elemBBox,!0,args);function outsideLayout(portPosition,elemBBox,autoOrient,args){const offset=null!=args.offset?args.offset:15,angle=elemBBox.getCenter().theta(portPosition),bboxAngles=getBBoxAngles(elemBBox);let y,tx,ty,textAnchor,orientAngle=0;return angle<bboxAngles[1]||angle>bboxAngles[2]?(y=".3em",tx=offset,ty=0,textAnchor="start"):angle<bboxAngles[0]?(y="0",tx=0,ty=-offset,autoOrient?(orientAngle=-90,textAnchor="start"):textAnchor="middle"):angle<bboxAngles[3]?(y=".3em",tx=-offset,ty=0,textAnchor="end"):(y=".6em",tx=0,ty=offset,autoOrient?(orientAngle=90,textAnchor="start"):textAnchor="middle"),util_toResult({position:{x:Math.round(tx),y:Math.round(ty)},angle:orientAngle,attrs:{".":{y,"text-anchor":textAnchor}}},args)}function insideLayout(portPosition,elemBBox,autoOrient,args){const offset=null!=args.offset?args.offset:15,angle=elemBBox.getCenter().theta(portPosition),bboxAngles=getBBoxAngles(elemBBox);let y,tx,ty,textAnchor,orientAngle=0;return angle<bboxAngles[1]||angle>bboxAngles[2]?(y=".3em",tx=-offset,ty=0,textAnchor="end"):angle<bboxAngles[0]?(y=".6em",tx=0,ty=offset,autoOrient?(orientAngle=90,textAnchor="start"):textAnchor="middle"):angle<bboxAngles[3]?(y=".3em",tx=offset,ty=0,textAnchor="start"):(y="0em",tx=0,ty=-offset,autoOrient?(orientAngle=-90,textAnchor="start"):textAnchor="middle"),util_toResult({position:{x:Math.round(tx),y:Math.round(ty)},angle:orientAngle,attrs:{".":{y,"text-anchor":textAnchor}}},args)}function getBBoxAngles(elemBBox){const center=elemBBox.getCenter(),tl=center.theta(elemBBox.getTopLeft()),bl=center.theta(elemBBox.getBottomLeft()),br=center.theta(elemBBox.getBottomRight());return[tl,center.theta(elemBBox.getTopRight()),br,bl]}const radial=(portPosition,elemBBox,args)=>radialLayout(portPosition.diff(elemBBox.getCenter()),!1,args),radialOriented=(portPosition,elemBBox,args)=>radialLayout(portPosition.diff(elemBBox.getCenter()),!0,args);function radialLayout(portCenterOffset,autoOrient,args){const offset=null!=args.offset?args.offset:20,origin=new Point(0,0),angle=-portCenterOffset.theta(origin);let textAnchor,y=".3em",orientAngle=angle;return(angle+90)%180==0?(textAnchor=autoOrient?"end":"middle",autoOrient||-270!==angle||(y="0em")):angle>-270&&angle<-90?(textAnchor="start",orientAngle=angle-180):textAnchor="end",util_toResult({position:portCenterOffset.clone().move(origin,offset).diff(portCenterOffset).round().round().toJSON(),angle:autoOrient?orientAngle:0,attrs:{".":{y,"text-anchor":textAnchor}}},args)}var PortLabelLayout;!function(PortLabelLayout){PortLabelLayout.presets=port_label_layout_main_namespaceObject,PortLabelLayout.registry=Registry.create({type:"port label layout"}),PortLabelLayout.registry.register(PortLabelLayout.presets,!0)}(PortLabelLayout||(PortLabelLayout={}));var view_Private,Markup,view_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class View extends basecoat_Basecoat{get priority(){return 2}get disposeContainer(){return!0}constructor(){super(),this.cid=view_Private.uniqueId(),View.views[this.cid]=this}confirmUpdate(flag,options){return 0}empty(elem=this.container){return empty(elem),this}unmount(elem=this.container){return remove(elem),this}remove(elem=this.container){return elem===this.container?(this.removeEventListeners(document),this.onRemove(),delete View.views[this.cid],this.disposeContainer&&this.unmount(elem)):this.unmount(elem),this}onRemove(){}setClass(className,elem=this.container){elem.classList.value=Array.isArray(className)?className.join(" "):className}addClass(className,elem=this.container){return addClass(elem,Array.isArray(className)?className.join(" "):className),this}removeClass(className,elem=this.container){return removeClass(elem,Array.isArray(className)?className.join(" "):className),this}setStyle(style,elem=this.container){return css(elem,style),this}setAttrs(attrs,elem=this.container){return null!=attrs&&null!=elem&&attr(elem,attrs),this}findAttr(attrName,elem=this.container){let current=elem;for(;current&&1===current.nodeType;){const value=current.getAttribute(attrName);if(null!=value)return value;if(current===this.container)return null;current=current.parentNode}return null}find(selector,rootElem=this.container,selectors=this.selectors){return View.find(selector,rootElem,selectors).elems}findOne(selector,rootElem=this.container,selectors=this.selectors){const nodes=this.find(selector,rootElem,selectors);return nodes.length>0?nodes[0]:null}findByAttr(attrName,elem=this.container){let node=elem;for(;node&&node.getAttribute;){const val=node.getAttribute(attrName);if((null!=val||node===this.container)&&"false"!==val)return node;node=node.parentNode}return null}getSelector(elem,prevSelector){let selector;if(elem===this.container)return"string"==typeof prevSelector&&(selector=`> ${prevSelector}`),selector;if(elem){const nth=index(elem)+1;selector=`${elem.tagName.toLowerCase()}:nth-child(${nth})`,prevSelector&&(selector+=` > ${prevSelector}`),selector=this.getSelector(elem.parentNode,selector)}return selector}prefixClassName(className){return Config.prefix(className)}delegateEvents(events,append){if(null==events)return this;append||this.undelegateEvents();const splitter=/^(\S+)\s*(.*)$/;return Object.keys(events).forEach((key=>{const match=key.match(splitter);if(null==match)return;const method=this.getEventHandler(events[key]);"function"==typeof method&&this.delegateEvent(match[1],match[2],method)})),this}undelegateEvents(){return Event.off(this.container,this.getEventNamespace()),this}delegateDocumentEvents(events,data){return this.addEventListeners(document,events,data),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(eventName,selector,listener){return Event.on(this.container,eventName+this.getEventNamespace(),selector,listener),this}undelegateEvent(eventName,selector,listener){const name=eventName+this.getEventNamespace();return null==selector?Event.off(this.container,name):"string"==typeof selector?Event.off(this.container,name,selector,listener):Event.off(this.container,name,selector),this}addEventListeners(elem,events,data){if(null==events)return this;const ns=this.getEventNamespace();return Object.keys(events).forEach((eventName=>{const method=this.getEventHandler(events[eventName]);"function"==typeof method&&Event.on(elem,eventName+ns,data,method)})),this}removeEventListeners(elem){return null!=elem&&Event.off(elem,this.getEventNamespace()),this}getEventNamespace(){return`.${Config.prefixCls}-event-${this.cid}`}getEventHandler(handler){let method;if("string"==typeof handler){const fn=this[handler];"function"==typeof fn&&(method=(...args)=>fn.call(this,...args))}else method=(...args)=>handler.call(this,...args);return method}getEventTarget(e,options={}){const{target,type,clientX=0,clientY=0}=e;return options.fromPoint||"touchmove"===type||"touchend"===type?document.elementFromPoint(clientX,clientY):target}stopPropagation(e){return this.setEventData(e,{propagationStopped:!0}),this}isPropagationStopped(e){return!0===this.getEventData(e).propagationStopped}getEventData(e){return this.eventData(e)}setEventData(e,data){return this.eventData(e,data)}eventData(e,data){if(null==e)throw new TypeError("Event object required");let currentData=e.data;const key=`__${this.cid}__`;return null==data?null==currentData?{}:currentData[key]||{}:(null==currentData&&(currentData=e.data={}),null==currentData[key]?currentData[key]=Object.assign({},data):currentData[key]=Object.assign(Object.assign({},currentData[key]),data),currentData[key])}normalizeEvent(evt){return View.normalizeEvent(evt)}dispose(){this.remove()}}view_decorate([View.dispose()],View.prototype,"dispose",null),function(View){View.createElement=function createElement(tagName,isSvgElement){return isSvgElement?createSvgElement(tagName||"g"):createElementNS(tagName||"div")},View.find=function find(selector,rootElem,selectors){if(!selector||"."===selector)return{elems:[rootElem]};if(selectors){const nodes=selectors[selector];if(nodes)return{elems:Array.isArray(nodes)?nodes:[nodes]}}if(Config.useCSSSelector){const validSelector=selector.includes(">")?`:scope ${selector}`:selector;return{isCSSSelector:!0,elems:Array.prototype.slice.call(rootElem.querySelectorAll(validSelector))}}return{elems:[]}},View.normalizeEvent=function normalizeEvent(evt){let normalizedEvent=evt;const originalEvent=evt.originalEvent,touchEvt=originalEvent&&originalEvent.changedTouches&&originalEvent.changedTouches[0];if(touchEvt){for(const key in evt)void 0===touchEvt[key]&&(touchEvt[key]=evt[key]);normalizedEvent=touchEvt}return normalizedEvent}}(View||(View={})),function(View){View.views={},View.getView=function getView(cid){return View.views[cid]||null}}(View||(View={})),function(Private){let counter=0;Private.uniqueId=function uniqueId(){const id=`v${counter}`;return counter+=1,id}}(view_Private||(view_Private={}));class Cache{constructor(view){this.view=view,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new Dictionary,this.pathCache={}}get(elem){return this.elemCache.has(elem)||this.elemCache.set(elem,{}),this.elemCache.get(elem)}getData(elem){const meta=this.get(elem);return meta.data||(meta.data={}),meta.data}getMatrix(elem){const meta=this.get(elem);if(null==meta.matrix){const target=this.view.container;meta.matrix=function getTransformToParentElement(elem,target){let matrix=createSVGMatrix();if(isSVGGraphicsElement(target)&&isSVGGraphicsElement(elem)){let node=elem;const matrixList=[];for(;node&&node!==target;){const nodeMatrix=transformStringToMatrix(node.getAttribute("transform")||null);matrixList.push(nodeMatrix),node=node.parentNode}matrixList.reverse().forEach((m=>{matrix=matrix.multiply(m)}))}return matrix}(elem,target)}return createSVGMatrix(meta.matrix)}getShape(elem){const meta=this.get(elem);return null==meta.shape&&(meta.shape=util_Util.toGeometryShape(elem)),meta.shape.clone()}getBoundingRect(elem){const meta=this.get(elem);return null==meta.boundingRect&&(meta.boundingRect=util_Util.getBBoxV2(elem)),meta.boundingRect.clone()}}!function(Markup){function isStringMarkup(markup){return null!=markup&&"string"==typeof markup}function parseJSONMarkup(markup,options={ns:elem_ns.svg}){const fragment=document.createDocumentFragment(),groups={},selectors={},queue=[{markup:Array.isArray(markup)?markup:[markup],parent:fragment,ns:options.ns}];for(;queue.length>0;){const item=queue.pop();let ns=item.ns||elem_ns.svg;const defines=item.markup,parentNode=item.parent;defines.forEach((define=>{const tagName=define.tagName;if(!tagName)throw new TypeError("Invalid tagName");define.ns&&(ns=define.ns);const node=ns?createElementNS(tagName,ns):createElement(tagName),attrs=define.attrs;attrs&&attr(node,kebablizeAttrs(attrs));const style=define.style;style&&css(node,style);const className=define.className;null!=className&&node.setAttribute("class",Array.isArray(className)?className.join(" "):className),define.textContent&&(node.textContent=define.textContent);const selector=define.selector;if(null!=selector){if(selectors[selector])throw new TypeError("Selector must be unique");selectors[selector]=node}if(define.groupSelector){let nodeGroups=define.groupSelector;Array.isArray(nodeGroups)||(nodeGroups=[nodeGroups]),nodeGroups.forEach((name=>{groups[name]||(groups[name]=[]),groups[name].push(node)}))}parentNode.appendChild(node);const children=define.children;Array.isArray(children)&&queue.push({ns,markup:children,parent:node})}))}return Object.keys(groups).forEach((groupName=>{if(selectors[groupName])throw new Error("Ambiguous group selector");selectors[groupName]=groups[groupName]})),{fragment,selectors,groups}}function createContainer(firstChild){return firstChild instanceof SVGElement?createSvgElement("g"):createElement("div")}Markup.isJSONMarkup=function isJSONMarkup(markup){return null!=markup&&!isStringMarkup(markup)},Markup.isStringMarkup=isStringMarkup,Markup.clone=function clone(markup){return null==markup||isStringMarkup(markup)?markup:lodash_es_cloneDeep(markup)},Markup.sanitize=function sanitize(markup){return`${markup}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")},Markup.parseJSONMarkup=parseJSONMarkup,Markup.renderMarkup=function renderMarkup(markup){if(isStringMarkup(markup)){const nodes=Vector.createVectors(markup),count=nodes.length;if(1===count)return{elem:nodes[0].node};if(count>1){const elem=createContainer(nodes[0].node);return nodes.forEach((node=>{elem.appendChild(node.node)})),{elem}}return{}}const result=parseJSONMarkup(markup),fragment=result.fragment;let elem=null;return fragment.childNodes.length>1?(elem=createContainer(fragment.firstChild),elem.appendChild(fragment)):elem=fragment.firstChild,{elem,selectors:result.selectors}},Markup.parseLabelStringMarkup=function parseLabelStringMarkup(markup){const children=Vector.createVectors(markup),fragment=document.createDocumentFragment();for(let i=0,n=children.length;i<n;i+=1){const currentChild=children[i].node;fragment.appendChild(currentChild)}return{fragment,selectors:{}}}}(Markup||(Markup={})),function(Markup){Markup.getSelector=function getSelector(elem,stop,prev){if(null!=elem){let selector;const tagName=elem.tagName.toLowerCase();if(elem===stop)return selector="string"==typeof prev?`> ${tagName} > ${prev}`:`> ${tagName}`,selector;const parent=elem.parentNode;if(parent&&parent.childNodes.length>1){selector=`${tagName}:nth-child(${index(elem)+1})`}else selector=tagName;return prev&&(selector+=` > ${prev}`),getSelector(elem.parentNode,stop,selector)}return prev}}(Markup||(Markup={})),function(Markup){Markup.getPortContainerMarkup=function getPortContainerMarkup(){return"g"},Markup.getPortMarkup=function getPortMarkup(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}},Markup.getPortLabelMarkup=function getPortLabelMarkup(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}}(Markup||(Markup={})),function(Markup){Markup.getEdgeMarkup=function getEdgeMarkup(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}}(Markup||(Markup={})),function(Markup){Markup.getForeignObjectMarkup=function getForeignObjectMarkup(bare=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:elem_ns.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:elem_ns.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:bare?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}}(Markup||(Markup={}));class AttrManager{constructor(view){this.view=view}get cell(){return this.view.cell}getDefinition(attrName){return this.cell.getAttrDefinition(attrName)}processAttrs(elem,raw){let normal,set,offset,position;const specials=[];return Object.keys(raw).forEach((name=>{const val=raw[name],definition=this.getDefinition(name),isValid=call(Attr.isValidDefinition,this.view,definition,val,{elem,attrs:raw,cell:this.cell,view:this.view});if(definition&&isValid)"string"==typeof definition?(null==normal&&(normal={}),normal[definition]=val):null!==val&&specials.push({name,definition});else{null==normal&&(normal={});const normalName=CASE_SENSITIVE_ATTR.includes(name)?name:kebabCase(name);normal[normalName]=val}})),specials.forEach((({name,definition})=>{const val=raw[name];"function"==typeof definition.set&&(null==set&&(set={}),set[name]=val);"function"==typeof definition.offset&&(null==offset&&(offset={}),offset[name]=val);"function"==typeof definition.position&&(null==position&&(position={}),position[name]=val)})),{raw,normal,set,offset,position}}mergeProcessedAttrs(allProcessedAttrs,roProcessedAttrs){allProcessedAttrs.set=Object.assign(Object.assign({},allProcessedAttrs.set),roProcessedAttrs.set),allProcessedAttrs.position=Object.assign(Object.assign({},allProcessedAttrs.position),roProcessedAttrs.position),allProcessedAttrs.offset=Object.assign(Object.assign({},allProcessedAttrs.offset),roProcessedAttrs.offset);const transform=allProcessedAttrs.normal&&allProcessedAttrs.normal.transform;null!=transform&&roProcessedAttrs.normal&&(roProcessedAttrs.normal.transform=transform),allProcessedAttrs.normal=roProcessedAttrs.normal}findAttrs(cellAttrs,rootNode,selectorCache,selectors){const merge=[],result=new Dictionary;return Object.keys(cellAttrs).forEach((selector=>{const attrs=cellAttrs[selector];if(!lodash_es_isPlainObject(attrs))return;const{isCSSSelector,elems}=View.find(selector,rootNode,selectors);selectorCache[selector]=elems;for(let i=0,l=elems.length;i<l;i+=1){const elem=elems[i],unique=selectors&&selectors[selector]===elem,prev=result.get(elem);if(prev){prev.array||(merge.push(elem),prev.array=!0,prev.attrs=[prev.attrs],prev.priority=[prev.priority]);const attributes=prev.attrs,selectedLength=prev.priority;if(unique)attributes.unshift(attrs),selectedLength.unshift(-1);else{const sortIndex=lodash_es_sortedIndex(selectedLength,isCSSSelector?-1:l);attributes.splice(sortIndex,0,attrs),selectedLength.splice(sortIndex,0,l)}}else result.set(elem,{elem,attrs,priority:unique?-1:l,array:!1})}})),merge.forEach((node=>{const item=result.get(node),arr=item.attrs;item.attrs=arr.reduceRight(((memo,attrs)=>lodash_es_merge(memo,attrs)),{})})),result}updateRelativeAttrs(elem,processedAttrs,refBBox){const rawAttrs=processedAttrs.raw||{};let nodeAttrs=processedAttrs.normal||{};const setAttrs=processedAttrs.set,positionAttrs=processedAttrs.position,offsetAttrs=processedAttrs.offset,getOptions=()=>({elem,cell:this.cell,view:this.view,attrs:rawAttrs,refBBox:refBBox.clone()});if(null!=setAttrs&&Object.keys(setAttrs).forEach((name=>{const val=setAttrs[name],def=this.getDefinition(name);if(null!=def){const ret=call(def.set,this.view,val,getOptions());"object"==typeof ret?nodeAttrs=Object.assign(Object.assign({},nodeAttrs),ret):null!=ret&&(nodeAttrs[name]=ret)}})),elem instanceof HTMLElement)return void this.view.setAttrs(nodeAttrs,elem);const nodeTransform=nodeAttrs.transform,nodeMatrix=transformStringToMatrix(nodeTransform?`${nodeTransform}`:null),nodePosition=new Point(nodeMatrix.e,nodeMatrix.f);nodeTransform&&(delete nodeAttrs.transform,nodeMatrix.e=0,nodeMatrix.f=0);let positioned=!1;null!=positionAttrs&&Object.keys(positionAttrs).forEach((name=>{const val=positionAttrs[name],def=this.getDefinition(name);if(null!=def){const ts=call(def.position,this.view,val,getOptions());null!=ts&&(positioned=!0,nodePosition.translate(Point.create(ts)))}})),this.view.setAttrs(nodeAttrs,elem);let offseted=!1;if(null!=offsetAttrs){const nodeBoundingRect=this.view.getBoundingRectOfElement(elem);if(nodeBoundingRect.width>0&&nodeBoundingRect.height>0){const nodeBBox=util_Util.transformRectangle(nodeBoundingRect,nodeMatrix);Object.keys(offsetAttrs).forEach((name=>{const val=offsetAttrs[name],def=this.getDefinition(name);if(null!=def){const ts=call(def.offset,this.view,val,{elem,cell:this.cell,view:this.view,attrs:rawAttrs,refBBox:nodeBBox});null!=ts&&(offseted=!0,nodePosition.translate(Point.create(ts)))}}))}}(null!=nodeTransform||positioned||offseted)&&(nodePosition.round(1),nodeMatrix.e=nodePosition.x,nodeMatrix.f=nodePosition.y,elem.setAttribute("transform",matrixToTransformString(nodeMatrix)))}update(rootNode,attrs,options){const selectorCache={},nodesAttrs=this.findAttrs(options.attrs||attrs,rootNode,selectorCache,options.selectors),nodesAllAttrs=options.attrs?this.findAttrs(attrs,rootNode,selectorCache,options.selectors):nodesAttrs,specialItems=[];nodesAttrs.each((data=>{const node=data.elem,nodeAttrs=data.attrs,processed=this.processAttrs(node,nodeAttrs);if(null==processed.set&&null==processed.position&&null==processed.offset)this.view.setAttrs(processed.normal,node);else{const data=nodesAllAttrs.get(node),nodeAllAttrs=data?data.attrs:null,refSelector=nodeAllAttrs&&null==nodeAttrs.ref?nodeAllAttrs.ref:nodeAttrs.ref;let refNode;if(refSelector){if(refNode=(selectorCache[refSelector]||this.view.find(refSelector,rootNode,options.selectors))[0],!refNode)throw new Error(`"${refSelector}" reference does not exist.`)}else refNode=null;const item={node,refNode,attributes:nodeAllAttrs,processedAttributes:processed},index=specialItems.findIndex((item=>item.refNode===node));index>-1?specialItems.splice(index,0,item):specialItems.push(item)}}));const bboxCache=new Dictionary;let rotatableMatrix;specialItems.forEach((item=>{const node=item.node,refNode=item.refNode;let unrotatedRefBBox;const isRefNodeRotatable=null!=refNode&&null!=options.rotatableNode&&contains(options.rotatableNode,refNode);if(refNode&&(unrotatedRefBBox=bboxCache.get(refNode)),!unrotatedRefBBox){const target=isRefNodeRotatable?options.rotatableNode:rootNode;unrotatedRefBBox=refNode?util_Util.getBBox(refNode,{target}):options.rootBBox,refNode&&bboxCache.set(refNode,unrotatedRefBBox)}let processedAttrs;options.attrs&&item.attributes?(processedAttrs=this.processAttrs(node,item.attributes),this.mergeProcessedAttrs(processedAttrs,item.processedAttributes)):processedAttrs=item.processedAttributes;let refBBox=unrotatedRefBBox;isRefNodeRotatable&&null!=options.rotatableNode&&!options.rotatableNode.contains(node)&&(rotatableMatrix||(rotatableMatrix=transformStringToMatrix(attr(options.rotatableNode,"transform"))),refBBox=util_Util.transformRectangle(unrotatedRefBBox,rotatableMatrix)),this.updateRelativeAttrs(node,processedAttrs,refBBox)}))}}class FlagManager{get cell(){return this.view.cell}constructor(view,actions,bootstrap=[]){this.view=view;const flags={},attrs={};let shift=0;Object.keys(actions).forEach((attr=>{let labels=actions[attr];Array.isArray(labels)||(labels=[labels]),labels.forEach((label=>{let flag=flags[label];flag||(shift+=1,flag=flags[label]=1<<shift),attrs[attr]|=flag}))}));let labels=bootstrap;if(Array.isArray(labels)||(labels=[labels]),labels.forEach((label=>{flags[label]||(shift+=1,flags[label]=1<<shift)})),shift>25)throw new Error("Maximum number of flags exceeded.");this.flags=flags,this.attrs=attrs,this.bootstrap=bootstrap}getFlag(label){const flags=this.flags;return null==flags?0:Array.isArray(label)?label.reduce(((memo,key)=>memo|flags[key]),0):0|flags[label]}hasAction(flag,label){return flag&this.getFlag(label)}removeAction(flag,label){return flag^flag&this.getFlag(label)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let flag=0;return this.attrs?(Object.keys(this.attrs).forEach((attr=>{this.cell.hasChanged(attr)&&(flag|=this.attrs[attr])})),flag):flag}}var cell_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},cell_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class CellView extends View{static getDefaults(){return this.defaults}static config(options){this.defaults=this.getOptions(options)}static getOptions(options){const mergeActions=(arr1,arr2)=>null!=arr2?lodash_es_uniq([...Array.isArray(arr1)?arr1:[arr1],...Array.isArray(arr2)?arr2:[arr2]]):Array.isArray(arr1)?[...arr1]:[arr1],ret=lodash_es_cloneDeep(this.getDefaults()),{bootstrap,actions,events,documentEvents}=options,others=cell_rest(options,["bootstrap","actions","events","documentEvents"]);return bootstrap&&(ret.bootstrap=mergeActions(ret.bootstrap,bootstrap)),actions&&Object.entries(actions).forEach((([key,val])=>{const raw=ret.actions[key];val&&raw?ret.actions[key]=mergeActions(raw,val):val&&(ret.actions[key]=mergeActions(val))})),events&&(ret.events=Object.assign(Object.assign({},ret.events),events)),options.documentEvents&&(ret.documentEvents=Object.assign(Object.assign({},ret.documentEvents),documentEvents)),lodash_es_merge(ret,others)}get[Symbol.toStringTag](){return CellView.toStringTag}constructor(cell,options={}){super(),this.cell=cell,this.options=this.ensureOptions(options),this.graph=this.options.graph,this.attr=new AttrManager(this),this.flag=new FlagManager(this,this.options.actions,this.options.bootstrap),this.cache=new Cache(this),this.setContainer(this.ensureContainer()),this.setup(),this.init()}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(options){return this.getConstructor().getOptions(options)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return View.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(container){if(this.container!==container){this.undelegateEvents(),this.container=container,null!=this.options.events&&this.delegateEvents(this.options.events);const attrs=this.getContainerAttrs();null!=attrs&&this.setAttrs(attrs,container);const style=this.getContainerStyle();null!=style&&this.setStyle(style,container);const className=this.getContainerClassName();null!=className&&this.addClass(className,container)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(flag,options={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(actions){return this.flag.getFlag(actions)}hasAction(flag,actions){return this.flag.hasAction(flag,actions)}removeAction(flag,actions){return this.flag.removeAction(flag,actions)}handleAction(flag,action,handle,additionalRemovedActions){if(this.hasAction(flag,action)){handle();const removedFlags=[action];return additionalRemovedActions&&("string"==typeof additionalRemovedActions?removedFlags.push(additionalRemovedActions):removedFlags.push(...additionalRemovedActions)),this.removeAction(flag,removedFlags)}return flag}setup(){this.cell.on("changed",this.onCellChanged,this)}onCellChanged({options}){this.onAttrsChange(options)}onAttrsChange(options){let flag=this.flag.getChangedFlag();!options.updated&&flag&&(options.dirty&&this.hasAction(flag,"update")&&(flag|=this.getFlag("render")),options.toolId&&(options.async=!1),null!=this.graph&&this.graph.renderer.requestViewUpdate(this,flag,options))}parseJSONMarkup(markup,rootElem){const result=Markup.parseJSONMarkup(markup),selectors=result.selectors,rootSelector=this.rootSelector;if(rootElem&&rootSelector){if(selectors[rootSelector])throw new Error("Invalid root selector");selectors[rootSelector]=rootElem}return result}can(feature){let interacting=this.graph.options.interacting;if("function"==typeof interacting&&(interacting=call(interacting,this.graph,this)),"object"==typeof interacting){let val=interacting[feature];return"function"==typeof val&&(val=call(val,this.graph,this)),!1!==val}return"boolean"==typeof interacting&&interacting}cleanCache(){return this.cache.clean(),this}getCache(elem){return this.cache.get(elem)}getDataOfElement(elem){return this.cache.getData(elem)}getMatrixOfElement(elem){return this.cache.getMatrix(elem)}getShapeOfElement(elem){return this.cache.getShape(elem)}getBoundingRectOfElement(elem){return this.cache.getBoundingRect(elem)}getBBoxOfElement(elem){const rect=this.getBoundingRectOfElement(elem),matrix=this.getMatrixOfElement(elem),rm=this.getRootRotatedMatrix(),tm=this.getRootTranslatedMatrix();return util_Util.transformRectangle(rect,tm.multiply(rm).multiply(matrix))}getUnrotatedBBoxOfElement(elem){const rect=this.getBoundingRectOfElement(elem),matrix=this.getMatrixOfElement(elem),tm=this.getRootTranslatedMatrix();return util_Util.transformRectangle(rect,tm.multiply(matrix))}getBBox(options={}){let bbox;if(options.useCellGeometry){const cell=this.cell,angle=cell.isNode()?cell.getAngle():0;bbox=cell.getBBox().bbox(angle)}else bbox=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(bbox)}getRootTranslatedMatrix(){const cell=this.cell,pos=cell.isNode()?cell.getPosition():{x:0,y:0};return createSVGMatrix().translate(pos.x,pos.y)}getRootRotatedMatrix(){let matrix=createSVGMatrix();const cell=this.cell,angle=cell.isNode()?cell.getAngle():0;if(angle){const bbox=cell.getBBox(),cx=bbox.width/2,cy=bbox.height/2;matrix=matrix.translate(cx,cy).rotate(angle).translate(-cx,-cy)}return matrix}findMagnet(elem=this.container){return this.findByAttr("magnet",elem)}updateAttrs(rootNode,attrs,options={}){null==options.rootBBox&&(options.rootBBox=new Rectangle),null==options.selectors&&(options.selectors=this.selectors),this.attr.update(rootNode,attrs,options)}isEdgeElement(magnet){return this.cell.isEdge()&&(null==magnet||magnet===this.container)}prepareHighlight(elem,options={}){const magnet=elem||this.container;return options.partial=magnet===this.container,magnet}highlight(elem,options={}){const magnet=this.prepareHighlight(elem,options);return this.notify("cell:highlight",{magnet,options,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet,options,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet,options,view:this,node:this.cell,cell:this.cell}),this}unhighlight(elem,options={}){const magnet=this.prepareHighlight(elem,options);return this.notify("cell:unhighlight",{magnet,options,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet,options,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet,options,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(magnet,options){}getEdgeTerminal(magnet,x,y,edge,type){const cell=this.cell,portId=this.findAttr("port",magnet),selector=magnet.getAttribute("data-selector"),terminal={cell:cell.id};return null!=selector&&(terminal.magnet=selector),null!=portId?(terminal.port=portId,cell.isNode()&&(cell.hasPort(portId)||null!=selector||(terminal.selector=this.getSelector(magnet)))):null==selector&&this.container!==magnet&&(terminal.selector=this.getSelector(magnet)),terminal}getMagnetFromEdgeTerminal(terminal){const cell=this.cell,root=this.container,portId=terminal.port;let magnet,selector=terminal.magnet;return null!=portId&&cell.isNode()&&cell.hasPort(portId)?magnet=this.findPortElem(portId,selector)||root:(selector||(selector=terminal.selector),selector||null==portId||(selector=`[port="${portId}"]`),magnet=this.findOne(selector,root,this.selectors)),magnet}hasTools(name){const tools=this.tools;return null!=tools&&(null==name||tools.name===name)}addTools(config){if(this.removeTools(),config){if(!this.can("toolsAddable"))return this;const tools=ToolsView.isToolsView(config)?config:new ToolsView(config);this.tools=tools,tools.config({view:this}),tools.mount()}return this}updateTools(options={}){return this.tools&&this.tools.update(options),this}removeTools(){return this.tools&&(this.tools.remove(),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const tools=this.cell.getTools();return this.addTools(tools),this}notify(name,args){return this.trigger(name,args),this.graph.trigger(name,args),this}getEventArgs(e,x,y){const view=this,cell=view.cell;return null==x||null==y?{e,view,cell}:{e,x,y,view,cell}}onClick(e,x,y){this.notify("cell:click",this.getEventArgs(e,x,y))}onDblClick(e,x,y){this.notify("cell:dblclick",this.getEventArgs(e,x,y))}onContextMenu(e,x,y){this.notify("cell:contextmenu",this.getEventArgs(e,x,y))}onMouseDown(e,x,y){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,x,y))}onMouseUp(e,x,y){this.notify("cell:mouseup",this.getEventArgs(e,x,y)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(e,x,y){this.notify("cell:mousemove",this.getEventArgs(e,x,y))}onMouseOver(e){this.notify("cell:mouseover",this.getEventArgs(e))}onMouseOut(e){this.notify("cell:mouseout",this.getEventArgs(e))}onMouseEnter(e){this.notify("cell:mouseenter",this.getEventArgs(e))}onMouseLeave(e){this.notify("cell:mouseleave",this.getEventArgs(e))}onMouseWheel(e,x,y,delta){this.notify("cell:mousewheel",Object.assign({delta},this.getEventArgs(e,x,y)))}onCustomEvent(e,name,x,y){this.notify("cell:customevent",Object.assign({name},this.getEventArgs(e,x,y))),this.notify(name,Object.assign({},this.getEventArgs(e,x,y)))}onMagnetMouseDown(e,magnet,x,y){}onMagnetDblClick(e,magnet,x,y){}onMagnetContextMenu(e,magnet,x,y){}onLabelMouseDown(e,x,y){}checkMouseleave(e){const target=this.getEventTarget(e,{fromPoint:!0}),view=this.graph.findViewByElem(target);view!==this&&(this.onMouseLeave(e),view&&view.onMouseEnter(e))}dispose(){this.cell.off("changed",this.onCellChanged,this)}}CellView.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},cell_decorate([CellView.dispose()],CellView.prototype,"dispose",null),function(CellView){CellView.Flag=FlagManager,CellView.Attr=AttrManager}(CellView||(CellView={})),function(CellView){CellView.toStringTag=`X6.${CellView.name}`,CellView.isCellView=function isCellView(instance){if(null==instance)return!1;if(instance instanceof CellView)return!0;const tag=instance[Symbol.toStringTag],view=instance;return(null==tag||tag===CellView.toStringTag)&&"function"==typeof view.isNodeView&&"function"==typeof view.isEdgeView&&"function"==typeof view.confirmUpdate}}(CellView||(CellView={})),function(CellView){CellView.priority=function priority(value){return function(ctor){ctor.config({priority:value})}},CellView.bootstrap=function bootstrap(actions){return function(ctor){ctor.config({bootstrap:actions})}}}(CellView||(CellView={})),function(CellView){CellView.registry=Registry.create({type:"view"})}(CellView||(CellView={}));class ToolsView extends View{get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return ToolsView.toStringTag}constructor(options={}){super(),this.svgContainer=this.createContainer(!0,options),this.htmlContainer=this.createContainer(!1,options),this.config(options)}createContainer(svg,options){const container=svg?View.createElement("g",!0):View.createElement("div",!1);return addClass(container,this.prefixClassName("cell-tools")),options.className&&addClass(container,options.className),container}config(options){if(this.options=Object.assign(Object.assign({},this.options),options),!CellView.isCellView(options.view)||options.view===this.cellView)return this;this.cellView=options.view,this.cell.isEdge()?(addClass(this.svgContainer,this.prefixClassName("edge-tools")),addClass(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(addClass(this.svgContainer,this.prefixClassName("node-tools")),addClass(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const tools=this.options.items;if(!Array.isArray(tools))return this;this.tools=[];const normalizedTools=[];tools.forEach((meta=>{if(ToolsView.ToolItem.isToolItem(meta))"vertices"===meta.name?normalizedTools.unshift(meta):normalizedTools.push(meta);else{"vertices"===("object"==typeof meta?meta.name:meta)?normalizedTools.unshift(meta):normalizedTools.push(meta)}}));for(let i=0;i<normalizedTools.length;i+=1){const meta=normalizedTools[i];let tool;if(ToolsView.ToolItem.isToolItem(meta))tool=meta;else{const name="object"==typeof meta?meta.name:meta,args="object"==typeof meta&&meta.args||{};if(name)if(this.cell.isNode()){const ctor=NodeTool.registry.get(name);if(!ctor)return NodeTool.registry.onNotFound(name);tool=new ctor(args)}else if(this.cell.isEdge()){const ctor=EdgeTool.registry.get(name);if(!ctor)return EdgeTool.registry.onNotFound(name);tool=new ctor(args)}}if(tool){tool.config(this.cellView,this),tool.render();(!1!==tool.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(tool.container),this.tools.push(tool)}}return this}update(options={}){const tools=this.tools;return tools&&tools.forEach((tool=>{options.toolId!==tool.cid&&tool.isVisible()&&tool.update()})),this}focus(focusedTool){const tools=this.tools;return tools&&tools.forEach((tool=>{focusedTool===tool?tool.show():tool.hide()})),this}blur(blurredTool){const tools=this.tools;return tools&&tools.forEach((tool=>{tool===blurredTool||tool.isVisible()||(tool.show(),tool.update())})),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const tools=this.tools;return tools&&(tools.forEach((tool=>tool.remove())),this.tools=null),remove(this.svgContainer),remove(this.htmlContainer),super.remove()}mount(){const tools=this.tools,cellView=this.cellView;if(cellView&&tools){const hasSVG=tools.some((tool=>!1!==tool.options.isSVGElement)),hasHTML=tools.some((tool=>!1===tool.options.isSVGElement));if(hasSVG){(this.options.local?cellView.container:cellView.graph.view.decorator).appendChild(this.svgContainer)}hasHTML&&this.graph.container.appendChild(this.htmlContainer)}return this}}!function(ToolsView){ToolsView.toStringTag=`X6.${ToolsView.name}`,ToolsView.isToolsView=function isToolsView(instance){if(null==instance)return!1;if(instance instanceof ToolsView)return!0;const tag=instance[Symbol.toStringTag],view=instance;return(null==tag||tag===ToolsView.toStringTag)&&null!=view.graph&&null!=view.cell&&"function"==typeof view.config&&"function"==typeof view.update&&"function"==typeof view.focus&&"function"==typeof view.blur&&"function"==typeof view.show&&"function"==typeof view.hide}}(ToolsView||(ToolsView={})),function(ToolsView){class ToolItem extends View{static getDefaults(){return this.defaults}static config(options){this.defaults=this.getOptions(options)}static getOptions(options){return lodash_es_merge(lodash_es_cloneDeep(this.getDefaults()),options)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return ToolItem.toStringTag}constructor(options={}){super(),this.visible=!0,this.options=this.getOptions(options),this.container=View.createElement(this.options.tagName||"g",!1!==this.options.isSVGElement),addClass(this.container,this.prefixClassName("cell-tool")),"string"==typeof this.options.className&&addClass(this.container,this.options.className),this.init()}init(){}getOptions(options){return this.constructor.getOptions(options)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(view,toolsView){return this.cellView=view,this.parent=toolsView,this.stamp(this.container),this.cell.isEdge()?addClass(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&addClass(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const markup=this.options.markup;if(markup){const meta=Markup.parseJSONMarkup(markup);this.container.appendChild(meta.fragment),this.childNodes=meta.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(elem){elem&&elem.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return this.visible}focus(){const opacity=this.options.focusOpacity;return null!=opacity&&Number.isFinite(opacity)&&(this.container.style.opacity=`${opacity}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(evt){return null==this.graph||null==this.cellView||this.graph.view.guard(evt,this.cellView)}}ToolItem.defaults={isSVGElement:!0,tagName:"g"},ToolsView.ToolItem=ToolItem,function(ToolItem){let counter=0;ToolItem.define=function define(options){const tool=createClass(function getClassName(name){return name?pascalCase(name):(counter+=1,`CustomTool${counter}`)}(options.name),this);return tool.config(options),tool}}(ToolItem=ToolsView.ToolItem||(ToolsView.ToolItem={})),function(ToolItem){ToolItem.toStringTag=`X6.${ToolItem.name}`,ToolItem.isToolItem=function isToolItem(instance){if(null==instance)return!1;if(instance instanceof ToolItem)return!0;const tag=instance[Symbol.toStringTag],view=instance;return(null==tag||tag===ToolItem.toStringTag)&&null!=view.graph&&null!=view.cell&&"function"==typeof view.config&&"function"==typeof view.update&&"function"==typeof view.focus&&"function"==typeof view.blur&&"function"==typeof view.show&&"function"==typeof view.hide&&"function"==typeof view.isVisible}}(ToolItem=ToolsView.ToolItem||(ToolsView.ToolItem={}))}(ToolsView||(ToolsView={}));const noop_noop=terminal=>terminal;function toPercentage(value,max){return 0===max?"0%":`${Math.round(value/max*100)}%`}function pin(relative){return(terminal,view,magnet,coords)=>view.isEdgeElement(magnet)?function pinEdgeTerminal(relative,end,view,magnet,coords){const connection=view.getConnection();if(!connection)return end;const length=connection.closestPointLength(coords);if(relative){const totalLength=connection.length();end.anchor={name:"ratio",args:{ratio:length/totalLength}}}else end.anchor={name:"length",args:{length}};return end}(relative,terminal,view,0,coords):function pinNodeTerminal(relative,data,view,magnet,coords){const node=view.cell,angle=node.getAngle(),bbox=view.getUnrotatedBBoxOfElement(magnet),center=node.getBBox().getCenter(),pos=Point.create(coords).rotate(angle,center);let dx=pos.x-bbox.x,dy=pos.y-bbox.y;relative&&(dx=toPercentage(dx,bbox.width),dy=toPercentage(dy,bbox.height));return data.anchor={name:"topLeft",args:{dx,dy,rotate:!0}},data}(relative,terminal,view,magnet,coords)}const pinRelative=pin(!0),pinAbsolute=pin(!1);var ConnectionStrategy;function getAnchor(pos,terminalView,terminalMagnet,type){return call(ConnectionStrategy.presets.pinRelative,this.graph,{},terminalView,terminalMagnet,pos,this.cell,type,{}).anchor}function getViewBBox(view,quick){return quick?view.cell.getBBox():view.cell.isEdge()?view.getConnection().bbox():view.getUnrotatedBBoxOfElement(view.container)}!function(ConnectionStrategy){ConnectionStrategy.presets=connection_strategy_main_namespaceObject,ConnectionStrategy.registry=Registry.create({type:"connection strategy"}),ConnectionStrategy.registry.register(ConnectionStrategy.presets,!0)}(ConnectionStrategy||(ConnectionStrategy={}));class Button extends ToolsView.ToolItem{onRender(){addClass(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const matrix=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();transform(this.container,matrix,{absolute:!0})}getNodeMatrix(){const view=this.cellView,options=this.options;let{x=0,y=0}=options;const{offset,useCellGeometry,rotate}=options;let bbox=getViewBBox(view,useCellGeometry);const angle=view.cell.getAngle();rotate||(bbox=bbox.bbox(angle));let offsetX=0,offsetY=0;"number"==typeof offset?(offsetX=offset,offsetY=offset):"object"==typeof offset&&(offsetX=offset.x,offsetY=offset.y),x=normalizePercentage(x,bbox.width),y=normalizePercentage(y,bbox.height);let matrix=createSVGMatrix().translate(bbox.x+bbox.width/2,bbox.y+bbox.height/2);return rotate&&(matrix=matrix.rotate(angle)),matrix=matrix.translate(x+offsetX-bbox.width/2,y+offsetY-bbox.height/2),matrix}getEdgeMatrix(){const view=this.cellView,options=this.options,{offset=0,distance=0,rotate}=options;let tangent,position,angle;const d=normalizePercentage(distance,1);tangent=d>=0&&d<=1?view.getTangentAtRatio(d):view.getTangentAtLength(d),tangent?(position=tangent.start,angle=tangent.vector().vectorAngle(new Point(1,0))||0):(position=view.getConnection().start,angle=0);let matrix=createSVGMatrix().translate(position.x,position.y).rotate(angle);return matrix="object"==typeof offset?matrix.translate(offset.x||0,offset.y||0):matrix.translate(0,offset),rotate||(matrix=matrix.rotate(-angle)),matrix}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const onClick=this.options.onClick;"function"==typeof onClick&&call(onClick,this.cellView,{e,view:this.cellView,cell:this.cellView.cell,btn:this})}}!function(Button){Button.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})}(Button||(Button={})),function(Button){Button.Remove=Button.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick({view,btn}){btn.parent.remove(),view.cell.remove({ui:!0,toolId:btn.cid})}})}(Button||(Button={}));var boundary_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class Boundary extends ToolsView.ToolItem{onRender(){if(addClass(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const _a=this.options.attrs,{class:className}=_a,attrs=boundary_rest(_a,["class"]);attr(this.container,kebablizeAttrs(attrs)),className&&addClass(this.container,className)}this.update()}update(){const view=this.cellView,options=this.options,{useCellGeometry,rotate}=options,padding=normalizeSides(options.padding);let bbox=getViewBBox(view,useCellGeometry).moveAndExpand({x:-padding.left,y:-padding.top,width:padding.left+padding.right,height:padding.top+padding.bottom});const cell=view.cell;if(cell.isNode()){const angle=cell.getAngle();if(angle)if(rotate){const origin=cell.getBBox().getCenter();transform_rotate(this.container,angle,origin.x,origin.y,{absolute:!0})}else bbox=bbox.bbox(angle)}return attr(this.container,bbox.toJSON()),this}}!function(Boundary){Boundary.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})}(Boundary||(Boundary={}));class Vertices extends ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const handles=this.handles;this.handles=[],handles&&handles.forEach((handle=>{this.stopHandleListening(handle),handle.remove()}))}renderHandles(){const vertices=this.vertices;for(let i=0,l=vertices.length;i<l;i+=1){const vertex=vertices[i],createHandle=this.options.createHandle,processHandle=this.options.processHandle,handle=createHandle({index:i,graph:this.graph,guard:evt=>this.guard(evt),attrs:this.options.attrs||{}});processHandle&&processHandle(handle),handle.updatePosition(vertex.x,vertex.y),this.stamp(handle.container),this.container.appendChild(handle.container),this.handles.push(handle),this.startHandleListening(handle)}}updateHandles(){const vertices=this.vertices;for(let i=0,l=vertices.length;i<l;i+=1){const vertex=vertices[i],handle=this.handles[i];handle&&handle.updatePosition(vertex.x,vertex.y)}}updatePath(){const connection=this.childNodes.connection;connection&&connection.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(handle){const edgeView=this.cellView;edgeView.can("vertexMovable")&&(handle.on("change",this.onHandleChange,this),handle.on("changing",this.onHandleChanging,this),handle.on("changed",this.onHandleChanged,this)),edgeView.can("vertexDeletable")&&handle.on("remove",this.onHandleRemove,this)}stopHandleListening(handle){const edgeView=this.cellView;edgeView.can("vertexMovable")&&(handle.off("change",this.onHandleChange,this),handle.off("changing",this.onHandleChanging,this),handle.off("changed",this.onHandleChanged,this)),edgeView.can("vertexDeletable")&&handle.off("remove",this.onHandleRemove,this)}getNeighborPoints(index){const edgeView=this.cellView,vertices=this.vertices,prev=index>0?vertices[index-1]:edgeView.sourceAnchor,next=index<vertices.length-1?vertices[index+1]:edgeView.targetAnchor;return{prev:Point.create(prev),next:Point.create(next)}}getMouseEventArgs(evt){const e=this.normalizeEvent(evt),{x,y}=this.graph.snapToGrid(e.clientX,e.clientY);return{e,x,y}}onHandleChange({e}){this.focus();const edgeView=this.cellView;if(edgeView.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:evt,x,y}=this.getMouseEventArgs(e);this.eventData(evt,{start:{x,y}}),edgeView.notifyMouseDown(evt,x,y)}}onHandleChanging({handle,e}){const edgeView=this.cellView,index=handle.options.index,{e:evt,x,y}=this.getMouseEventArgs(e),vertex={x,y};this.snapVertex(vertex,index),edgeView.cell.setVertexAt(index,vertex,{ui:!0,toolId:this.cid}),handle.updatePosition(vertex.x,vertex.y),this.options.stopPropagation||edgeView.notifyMouseMove(evt,x,y)}stopBatch(vertexAdded){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),vertexAdded&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}onHandleChanged({e}){const options=this.options,edgeView=this.cellView;if(options.addable&&this.updatePath(),!options.removeRedundancies)return void this.stopBatch(this.eventData(e).vertexAdded);edgeView.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(e).vertexAdded);const{e:evt,x,y}=this.getMouseEventArgs(e);if(!this.options.stopPropagation){edgeView.notifyMouseUp(evt,x,y);const{start}=this.eventData(evt);if(start){const{x:startX,y:startY}=start;startX===x&&startY===y&&edgeView.onClick(evt,x,y)}}edgeView.checkMouseleave(evt),options.onChanged&&options.onChanged({edge:edgeView.cell,edgeView})}snapVertex(vertex,index){const snapRadius=this.options.snapRadius||0;if(snapRadius>0){const neighbors=this.getNeighborPoints(index),prev=neighbors.prev,next=neighbors.next;Math.abs(vertex.x-prev.x)<snapRadius?vertex.x=prev.x:Math.abs(vertex.x-next.x)<snapRadius&&(vertex.x=next.x),Math.abs(vertex.y-prev.y)<snapRadius?vertex.y=neighbors.prev.y:Math.abs(vertex.y-next.y)<snapRadius&&(vertex.y=next.y)}}onHandleRemove({handle,e}){if(this.options.removable){const index=handle.options.index,edgeView=this.cellView;edgeView.cell.removeVertexAt(index,{ui:!0}),this.options.addable&&this.updatePath(),edgeView.checkMouseleave(this.normalizeEvent(e))}}allowAddVertex(e){const guard=this.guard(e),addable=this.options.addable&&this.cellView.can("vertexAddable"),matchModifiers=!this.options.modifiers||ModifierKey.isMatch(e,this.options.modifiers);return!guard&&addable&&matchModifiers}onPathMouseDown(evt){const edgeView=this.cellView;if(!this.allowAddVertex(evt))return;evt.stopPropagation(),evt.preventDefault();const e=this.normalizeEvent(evt),vertex=this.graph.snapToGrid(e.clientX,e.clientY).toJSON();edgeView.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const index=edgeView.getVertexIndex(vertex.x,vertex.y);this.snapVertex(vertex,index),edgeView.cell.insertVertex(vertex,index,{ui:!0,toolId:this.cid}),this.render();const handle=this.handles[index];this.eventData(e,{vertexAdded:!0}),handle.onMouseDown(e)}onRemove(){this.resetHandles()}}!function(Vertices){Vertices.Handle=class Handle extends View{get graph(){return this.options.graph}constructor(options){super(),this.options=options,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}render(){this.container=View.createElement("circle",!0);const attrs=this.options.attrs;if("function"==typeof attrs){const defaults=Vertices.getDefaults();this.setAttrs(Object.assign(Object.assign({},defaults.attrs),attrs(this)))}else this.setAttrs(attrs);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(x,y){this.setAttrs({cx:x,cy:y})}onMouseDown(evt){this.options.guard(evt)||(evt.stopPropagation(),evt.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},evt.data),this.emit("change",{e:evt,handle:this}))}onMouseMove(evt){this.emit("changing",{e:evt,handle:this})}onMouseUp(evt){this.emit("changed",{e:evt,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(evt){this.emit("remove",{e:evt,handle:this})}}}(Vertices||(Vertices={})),function(Vertices){const pathClassName=Config.prefix("edge-tool-vertex-path");Vertices.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:options=>new Vertices.Handle(options),markup:[{tagName:"path",selector:"connection",className:pathClassName,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${pathClassName}`]:"onPathMouseDown",[`touchstart .${pathClassName}`]:"onPathMouseDown"}})}(Vertices||(Vertices={}));class Segments extends ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){addClass(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const edgeView=this.cellView,vertices=[...this.vertices];vertices.unshift(edgeView.sourcePoint),vertices.push(edgeView.targetPoint);for(let i=0,l=vertices.length;i<l-1;i+=1){const vertex=vertices[i],nextVertex=vertices[i+1],handle=this.renderHandle(vertex,nextVertex,i);this.stamp(handle.container),this.handles.push(handle)}return this}renderHandle(vertex,nextVertex,index){const handle=this.options.createHandle({index,graph:this.graph,guard:evt=>this.guard(evt),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(handle),this.updateHandle(handle,vertex,nextVertex),this.container.appendChild(handle.container),this.startHandleListening(handle),handle}startHandleListening(handle){handle.on("change",this.onHandleChange,this),handle.on("changing",this.onHandleChanging,this),handle.on("changed",this.onHandleChanged,this)}stopHandleListening(handle){handle.off("change",this.onHandleChange,this),handle.off("changing",this.onHandleChanging,this),handle.off("changed",this.onHandleChanged,this)}resetHandles(){const handles=this.handles;this.handles=[],handles&&handles.forEach((handle=>{this.stopHandleListening(handle),handle.remove()}))}shiftHandleIndexes(delta){const handles=this.handles;for(let i=0,n=handles.length;i<n;i+=1)handles[i].options.index+=delta}resetAnchor(type,anchor){const edge=this.cellView.cell,options={ui:!0,toolId:this.cid};anchor?edge.prop([type,"anchor"],anchor,options):edge.removeProp([type,"anchor"],options)}snapHandle(handle,position,data){const axis=handle.options.axis,index=handle.options.index,vertices=this.cellView.cell.getVertices(),prev=vertices[index-2]||data.sourceAnchor,next=vertices[index+1]||data.targetAnchor,snapRadius=this.options.snapRadius;return Math.abs(position[axis]-prev[axis])<snapRadius?position[axis]=prev[axis]:Math.abs(position[axis]-next[axis])<snapRadius&&(position[axis]=next[axis]),position}onHandleChanging({handle,e}){const graph=this.graph,options=this.options,edgeView=this.cellView,anchorFn=options.anchor,axis=handle.options.axis,index=handle.options.index-1,data=this.getEventData(e),evt=this.normalizeEvent(e),coords=graph.snapToGrid(evt.clientX,evt.clientY),position=this.snapHandle(handle,coords.clone(),data),vertices=lodash_es_cloneDeep(this.vertices);let vertex=vertices[index],nextVertex=vertices[index+1];const sourceView=edgeView.sourceView,sourceBBox=edgeView.sourceBBox;let changeSourceAnchor=!1,deleteSourceAnchor=!1;if(vertex?0===index?sourceBBox.containsPoint(vertex)?(vertices.shift(),this.shiftHandleIndexes(-1),changeSourceAnchor=!0):(vertex[axis]=position[axis],deleteSourceAnchor=!0):vertex[axis]=position[axis]:(vertex=edgeView.sourceAnchor.toJSON(),vertex[axis]=position[axis],sourceBBox.containsPoint(vertex)?changeSourceAnchor=!0:(vertices.unshift(vertex),this.shiftHandleIndexes(1),deleteSourceAnchor=!0)),"function"==typeof anchorFn&&sourceView){if(changeSourceAnchor){const sourceAnchorPosition=data.sourceAnchor.clone();sourceAnchorPosition[axis]=position[axis];const sourceAnchor=call(anchorFn,edgeView,sourceAnchorPosition,sourceView,edgeView.sourceMagnet||sourceView.container,"source",edgeView,this);this.resetAnchor("source",sourceAnchor)}deleteSourceAnchor&&this.resetAnchor("source",data.sourceAnchorDef)}const targetView=edgeView.targetView,targetBBox=edgeView.targetBBox;let changeTargetAnchor=!1,deleteTargetAnchor=!1;if(nextVertex?index===vertices.length-2?targetBBox.containsPoint(nextVertex)?(vertices.pop(),changeTargetAnchor=!0):(nextVertex[axis]=position[axis],deleteTargetAnchor=!0):nextVertex[axis]=position[axis]:(nextVertex=edgeView.targetAnchor.toJSON(),nextVertex[axis]=position[axis],targetBBox.containsPoint(nextVertex)?changeTargetAnchor=!0:(vertices.push(nextVertex),deleteTargetAnchor=!0)),"function"==typeof anchorFn&&targetView){if(changeTargetAnchor){const targetAnchorPosition=data.targetAnchor.clone();targetAnchorPosition[axis]=position[axis];const targetAnchor=call(anchorFn,edgeView,targetAnchorPosition,targetView,edgeView.targetMagnet||targetView.container,"target",edgeView,this);this.resetAnchor("target",targetAnchor)}deleteTargetAnchor&&this.resetAnchor("target",data.targetAnchorDef)}Point.equalPoints(vertices,this.vertices)||this.cellView.cell.setVertices(vertices,{ui:!0,toolId:this.cid}),this.updateHandle(handle,vertex,nextVertex,0),options.stopPropagation||edgeView.notifyMouseMove(evt,coords.x,coords.y)}onHandleChange({handle,e}){const options=this.options,handles=this.handles,edgeView=this.cellView,index=handle.options.index;if(Array.isArray(handles)){for(let i=0,n=handles.length;i<n;i+=1)i!==index&&handles[i].hide();if(this.focus(),this.setEventData(e,{sourceAnchor:edgeView.sourceAnchor.clone(),targetAnchor:edgeView.targetAnchor.clone(),sourceAnchorDef:lodash_es_cloneDeep(this.cell.prop(["source","anchor"])),targetAnchorDef:lodash_es_cloneDeep(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!options.stopPropagation){const normalizedEvent=this.normalizeEvent(e),coords=this.graph.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);edgeView.notifyMouseDown(normalizedEvent,coords.x,coords.y)}}}onHandleChanged({e}){const options=this.options,edgeView=this.cellView;options.removeRedundancies&&edgeView.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const normalizedEvent=this.normalizeEvent(e),coords=this.graph.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),options.stopPropagation||edgeView.notifyMouseUp(normalizedEvent,coords.x,coords.y),edgeView.checkMouseleave(normalizedEvent),options.onChanged&&options.onChanged({edge:edgeView.cell,edgeView})}updateHandle(handle,vertex,nextVertex,offset=0){const precision=this.options.precision||0,vertical=Math.abs(vertex.x-nextVertex.x)<precision,horizontal=Math.abs(vertex.y-nextVertex.y)<precision;if(vertical||horizontal){const segmentLine=new Line(vertex,nextVertex);if(segmentLine.length()<this.options.threshold)handle.hide();else{const position=segmentLine.getCenter(),axis=vertical?"x":"y";position[axis]+=offset||0;const angle=segmentLine.vector().vectorAngle(new Point(1,0));handle.updatePosition(position.x,position.y,angle,this.cellView),handle.show(),handle.options.axis=axis}}else handle.hide()}onRemove(){this.resetHandles()}}!function(Segments){Segments.Handle=class Handle extends View{constructor(options){super(),this.options=options,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=View.createElement("rect",!0);const attrs=this.options.attrs;if("function"==typeof attrs){const defaults=Segments.getDefaults();this.setAttrs(Object.assign(Object.assign({},defaults.attrs),attrs(this)))}else this.setAttrs(attrs);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(x,y,angle,view){const p=view.getClosestPoint(new Point(x,y))||new Point(x,y);let matrix=createSVGMatrix().translate(p.x,p.y);if(p.equals({x,y}))matrix=matrix.rotate(angle);else{let deg=new Line(x,y,p.x,p.y).vector().vectorAngle(new Point(1,0));0!==deg&&(deg+=90),matrix=matrix.rotate(deg)}this.setAttrs({transform:matrixToTransformString(matrix),cursor:angle%180==0?"row-resize":"col-resize"})}onMouseDown(evt){this.options.guard(evt)||(this.trigger("change",{e:evt,handle:this}),evt.stopPropagation(),evt.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},evt.data))}onMouseMove(evt){this.emit("changing",{e:evt,handle:this})}onMouseUp(evt){this.emit("changed",{e:evt,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}}(Segments||(Segments={})),function(Segments){Segments.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:options=>new Segments.Handle(options),anchor:getAnchor})}(Segments||(Segments={}));class Anchor extends ToolsView.ToolItem{get type(){return this.options.type}onRender(){addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const type=this.type;return this.cellView.getTerminalView(type)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const childNodes=this.childNodes;if(!childNodes)return;const anchorNode=childNodes.anchor;if(!anchorNode)return;const type=this.type,edgeView=this.cellView,options=this.options,position=edgeView.getTerminalAnchor(type),customAnchor=edgeView.cell.prop([type,"anchor"]);anchorNode.setAttribute("transform",`translate(${position.x}, ${position.y})`);const anchorAttrs=customAnchor?options.customAnchorAttrs:options.defaultAnchorAttrs;anchorAttrs&&Object.keys(anchorAttrs).forEach((attrName=>{anchorNode.setAttribute(attrName,anchorAttrs[attrName])}))}updateArea(){const childNodes=this.childNodes;if(!childNodes)return;const areaNode=childNodes.area;if(!areaNode)return;const type=this.type,edgeView=this.cellView,terminalView=edgeView.getTerminalView(type);if(terminalView){const terminalCell=terminalView.cell,magnet=edgeView.getTerminalMagnet(type);let bbox,angle,center,padding=this.options.areaPadding||0;Number.isFinite(padding)||(padding=0),terminalView.isEdgeElement(magnet)?(bbox=terminalView.getBBox(),angle=0,center=bbox.getCenter()):(bbox=terminalView.getUnrotatedBBoxOfElement(magnet),angle=terminalCell.getAngle(),center=bbox.getCenter(),angle&&center.rotate(-angle,terminalCell.getBBox().getCenter())),bbox.inflate(padding),attr(areaNode,{x:-bbox.width/2,y:-bbox.height/2,width:bbox.width,height:bbox.height,transform:`translate(${center.x}, ${center.y}) rotate(${angle})`})}}toggleArea(visible){if(this.childNodes){const elem=this.childNodes.area;elem&&(elem.style.display=visible?"":"none")}}onMouseDown(evt){this.guard(evt)||(evt.stopPropagation(),evt.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(anchor){const type=this.type,cell=this.cell;anchor?cell.prop([type,"anchor"],anchor,{rewrite:!0,ui:!0,toolId:this.cid}):cell.removeProp([type,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(evt){const terminalType=this.type,edgeView=this.cellView,terminalView=edgeView.getTerminalView(terminalType);if(null==terminalView)return;const e=this.normalizeEvent(evt),terminalCell=terminalView.cell,terminalMagnet=edgeView.getTerminalMagnet(terminalType);let coords=this.graph.coord.clientToLocalPoint(e.clientX,e.clientY);const snapFn=this.options.snap;if("function"==typeof snapFn){const tmp=call(snapFn,edgeView,coords,terminalView,terminalMagnet,terminalType,edgeView,this);coords=Point.create(tmp)}if(this.options.restrictArea)if(terminalView.isEdgeElement(terminalMagnet)){const pointAtConnection=terminalView.getClosestPoint(coords);pointAtConnection&&(coords=pointAtConnection)}else{const bbox=terminalView.getUnrotatedBBoxOfElement(terminalMagnet),angle=terminalCell.getAngle(),origin=terminalCell.getBBox().getCenter(),rotatedCoords=coords.clone().rotate(angle,origin);bbox.containsPoint(rotatedCoords)||(coords=bbox.getNearestPointToPoint(rotatedCoords).rotate(-angle,origin))}let anchor;const anchorFn=this.options.anchor;"function"==typeof anchorFn&&(anchor=call(anchorFn,edgeView,coords,terminalView,terminalMagnet,terminalType,edgeView,this)),this.resetAnchor(anchor),this.update()}onMouseUp(evt){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const edgeView=this.cellView;this.options.removeRedundancies&&edgeView.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const anchor=this.options.resetAnchor;anchor&&this.resetAnchor(!0===anchor?void 0:anchor),this.update()}}!function(Anchor){Anchor.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:getAnchor,snap(pos,terminalView,terminalMagnet,terminalType,edgeView,toolView){const snapRadius=toolView.options.snapRadius||0,isSource="source"===terminalType,refIndex=isSource?0:-1,ref=this.cell.getVertexAt(refIndex)||this.getTerminalAnchor(isSource?"target":"source");return ref&&(Math.abs(ref.x-pos.x)<snapRadius&&(pos.x=ref.x),Math.abs(ref.y-pos.y)<snapRadius&&(pos.y=ref.y)),pos}})}(Anchor||(Anchor={}));const SourceAnchor=Anchor.define({name:"source-anchor",type:"source"}),TargetAnchor=Anchor.define({name:"target-anchor",type:"target"});var arrowhead_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class Arrowhead extends ToolsView.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const _a=this.options.attrs,{class:className}=_a,attrs=arrowhead_rest(_a,["class"]);this.setAttrs(attrs,this.container),className&&addClass(this.container,className)}}onRender(){addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const ratio=this.ratio,edgeView=this.cellView,tangent=edgeView.getTangentAtRatio(ratio),position=tangent?tangent.start:edgeView.getPointAtRatio(ratio),angle=tangent&&tangent.vector().vectorAngle(new Point(1,0))||0;if(!position)return this;const matrix=createSVGMatrix().translate(position.x,position.y).rotate(angle);return transform(this.container,matrix,{absolute:!0}),this}onMouseDown(evt){if(this.guard(evt))return;evt.stopPropagation(),evt.preventDefault();const edgeView=this.cellView;if(edgeView.can("arrowheadMovable")){edgeView.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const coords=this.graph.snapToGrid(evt.clientX,evt.clientY),data=edgeView.prepareArrowheadDragging(this.type,{x:coords.x,y:coords.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(evt,data),this.delegateDocumentEvents(this.options.documentEvents,evt.data),edgeView.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(evt){const e=this.normalizeEvent(evt),coords=this.graph.snapToGrid(e.clientX,e.clientY);this.cellView.onMouseMove(e,coords.x,coords.y),this.update()}onMouseUp(evt){this.undelegateDocumentEvents();const e=this.normalizeEvent(evt),edgeView=this.cellView,coords=this.graph.snapToGrid(e.clientX,e.clientY);edgeView.onMouseUp(e,coords.x,coords.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",edgeView.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}!function(Arrowhead){Arrowhead.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})}(Arrowhead||(Arrowhead={}));const SourceArrowhead=Arrowhead.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),TargetArrowhead=Arrowhead.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class CellEditor extends ToolsView.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5,this.dblClick=this.onCellDblClick.bind(this)}onRender(){const cellView=this.cellView;cellView&&cellView.on("cell:dblclick",this.dblClick)}createElement(){const classNames=[this.prefixClassName((this.cell.isEdge()?"edge":"node")+"-tool-editor"),this.prefixClassName("cell-tool-editor")];this.editor=ToolsView.createElement("div",!1),this.addClass(classNames,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}removeElement(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}updateEditor(){const{cell,editor}=this;if(!editor)return;const{style}=editor;cell.isNode()?this.updateNodeEditorTransform():cell.isEdge()&&this.updateEdgeEditorTransform();const{attrs}=this.options;style.fontSize=`${attrs.fontSize}px`,style.fontFamily=attrs.fontFamily,style.color=attrs.color,style.backgroundColor=attrs.backgroundColor;const text=this.getCellText()||"";return editor.innerText=text,this.setCellText(""),this}updateNodeEditorTransform(){const{graph,cell,editor}=this;if(!editor)return;let pos=Point.create(),minWidth=20,translate="",{x,y}=this.options;const{width,height}=this.options;if(void 0!==x&&void 0!==y){const bbox=cell.getBBox();x=normalizePercentage(x,bbox.width),y=normalizePercentage(y,bbox.height),pos=bbox.topLeft.translate(x,y),minWidth=bbox.width-2*x}else{const bbox=cell.getBBox();pos=bbox.center,minWidth=bbox.width-4,translate="translate(-50%, -50%)"}const scale=graph.scale(),{style}=editor;pos=graph.localToGraph(pos),style.left=`${pos.x}px`,style.top=`${pos.y}px`,style.transform=`scale(${scale.sx}, ${scale.sy}) ${translate}`,style.minWidth=`${minWidth}px`,"number"==typeof width&&(style.width=`${width}px`),"number"==typeof height&&(style.height=`${height}px`)}updateEdgeEditorTransform(){if(!this.event)return;const{graph,editor}=this;if(!editor)return;let pos=Point.create(),minWidth=20;const{style}=editor,target=this.event.target,parent=target.parentElement;if(parent&&hasClass(parent,this.prefixClassName("edge-label"))){const index=parent.getAttribute("data-index")||"0";this.labelIndex=parseInt(index,10);const matrix=parent.getAttribute("transform"),{translation}=parseTransformString(matrix);pos=new Point(translation.tx,translation.ty),minWidth=util_Util.getBBox(target).width}else{if(!this.options.labelAddable)return this;pos=graph.clientToLocal(Point.create(this.event.clientX,this.event.clientY));const d=this.cellView.path.closestPointLength(pos);this.distance=d,this.labelIndex=-1}pos=graph.localToGraph(pos);const scale=graph.scale();style.left=`${pos.x}px`,style.top=`${pos.y}px`,style.minWidth=`${minWidth}px`,style.transform=`scale(${scale.sx}, ${scale.sy}) translate(-50%, -50%)`}onDocumentMouseUp(e){if(this.editor&&e.target!==this.editor){const value=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(""!==value?value:null),this.removeElement()}}onCellDblClick({e}){this.editor||(e.stopPropagation(),this.removeElement(),this.event=e,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}onMouseDown(e){e.stopPropagation()}autoFocus(){setTimeout((()=>{this.editor&&(this.editor.focus(),this.selectText())}))}selectText(){if(window.getSelection&&this.editor){const range=document.createRange(),selection=window.getSelection();range.selectNodeContents(this.editor),selection.removeAllRanges(),selection.addRange(range)}}getCellText(){const{getText}=this.options;if("function"==typeof getText)return call(getText,this.cellView,{cell:this.cell,index:this.labelIndex});if("string"==typeof getText){if(this.cell.isNode())return this.cell.attr(getText);if(this.cell.isEdge()&&-1!==this.labelIndex)return this.cell.prop(`labels/${this.labelIndex}/attrs/${getText}`)}}setCellText(value){const setText=this.options.setText;if("function"!=typeof setText){if("string"==typeof setText){if(this.cell.isNode())return void(null!==value&&this.cell.attr(setText,value));if(this.cell.isEdge()){const edge=this.cell;if(-1===this.labelIndex){if(value){const newLabel={position:{distance:this.distance},attrs:{}};setByPath(newLabel,`attrs/${setText}`,value),edge.appendLabel(newLabel)}}else null!==value?edge.prop(`labels/${this.labelIndex}/attrs/${setText}`,value):"number"==typeof this.labelIndex&&edge.removeLabelAt(this.labelIndex)}}}else call(setText,this.cellView,{cell:this.cell,value,index:this.labelIndex,distance:this.distance})}onRemove(){const cellView=this.cellView;cellView&&cellView.off("cell:dblclick",this.dblClick),this.removeElement()}}!function(CellEditor){CellEditor.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})}(CellEditor||(CellEditor={})),function(CellEditor){CellEditor.NodeEditor=CellEditor.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),CellEditor.EdgeEditor=CellEditor.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})}(CellEditor||(CellEditor={}));var NodeTool,EdgeTool,tool_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};!function(NodeTool){NodeTool.presets={boundary:Boundary,button:Button,"button-remove":Button.Remove,"node-editor":CellEditor.NodeEditor},NodeTool.registry=Registry.create({type:"node tool",process(name,options){if("function"==typeof options)return options;let parent=ToolsView.ToolItem;const{inherit}=options,others=tool_rest(options,["inherit"]);if(inherit){const base=this.get(inherit);null==base?this.onNotFound(inherit,"inherited"):parent=base}return null==others.name&&(others.name=name),parent.define.call(parent,others)}}),NodeTool.registry.register(NodeTool.presets,!0)}(NodeTool||(NodeTool={})),function(EdgeTool){EdgeTool.presets={boundary:Boundary,vertices:Vertices,segments:Segments,button:Button,"button-remove":Button.Remove,"source-anchor":SourceAnchor,"target-anchor":TargetAnchor,"source-arrowhead":SourceArrowhead,"target-arrowhead":TargetArrowhead,"edge-editor":CellEditor.EdgeEditor},EdgeTool.registry=Registry.create({type:"edge tool",process(name,options){if("function"==typeof options)return options;let parent=ToolsView.ToolItem;const{inherit}=options,others=tool_rest(options,["inherit"]);if(inherit){const base=this.get(inherit);null==base?this.onNotFound(inherit,"inherited"):parent=base}return null==others.name&&(others.name=name),parent.define.call(parent,others)}}),EdgeTool.registry.register(EdgeTool.presets,!0)}(EdgeTool||(EdgeTool={}));const center=createBBoxAnchor("center"),bbox_top=createBBoxAnchor("topCenter"),bbox_bottom=createBBoxAnchor("bottomCenter"),bbox_left=createBBoxAnchor("leftMiddle"),bbox_right=createBBoxAnchor("rightMiddle"),topLeft=createBBoxAnchor("topLeft"),topRight=createBBoxAnchor("topRight"),bottomLeft=createBBoxAnchor("bottomLeft"),bottomRight=createBBoxAnchor("bottomRight");function createBBoxAnchor(method){return function(view,magnet,ref,options={}){const bbox=options.rotate?view.getUnrotatedBBoxOfElement(magnet):view.getBBoxOfElement(magnet),result=bbox[method];result.x+=normalizePercentage(options.dx,bbox.width),result.y+=normalizePercentage(options.dy,bbox.height);const cell=view.cell;return options.rotate?result.rotate(-cell.getAngle(),cell.getBBox().getCenter()):result}}function resolve(fn){return function(view,magnet,ref,options){if(ref instanceof Element){const refView=this.graph.findViewByElem(ref);let refPoint;if(refView)if(refView.isEdgeElement(ref)){refPoint=getPointAtEdge(refView,null!=options.fixedAt?options.fixedAt:"50%")}else refPoint=refView.getBBoxOfElement(ref).getCenter();else refPoint=new Point;return fn.call(this,view,magnet,refPoint,options)}return fn.apply(this,arguments)}}function getPointAtEdge(edgeView,value){const isPercentage=number_isPercentage(value),num="string"==typeof value?parseFloat(value):value;return isPercentage?edgeView.getPointAtRatio(num/100):edgeView.getPointAtLength(num)}const orth=resolve((function(view,magnet,refPoint,options){const angle=Angle.normalize(view.cell.getAngle()),bbox=view.getBBoxOfElement(magnet),result=bbox.getCenter(),topLeft=bbox.getTopLeft(),bottomRight=bbox.getBottomRight();let padding=options.padding;if(Number.isFinite(padding)||(padding=0),topLeft.y+padding<=refPoint.y&&refPoint.y<=bottomRight.y-padding){const dy=refPoint.y-result.y;result.x+=0===angle||180===angle?0:1*dy/Math.tan(Angle.toRad(angle)),result.y+=dy}else if(topLeft.x+padding<=refPoint.x&&refPoint.x<=bottomRight.x-padding){const dx=refPoint.x-result.x;result.y+=90===angle||270===angle?0:dx*Math.tan(Angle.toRad(angle)),result.x+=dx}return result})),nodeCenter=function(view,magnet,ref,options,endType){const result=view.cell.getConnectionPoint(this.cell,endType);return(options.dx||options.dy)&&result.translate(options.dx||0,options.dy||0),result},midSide=resolve((function(view,magnet,refPoint,options){let bbox,center,angle=0;const node=view.cell;options.rotate?(bbox=view.getUnrotatedBBoxOfElement(magnet),center=node.getBBox().getCenter(),angle=node.getAngle()):bbox=view.getBBoxOfElement(magnet);const padding=options.padding;null!=padding&&Number.isFinite(padding)&&bbox.inflate(padding),options.rotate&&refPoint.rotate(angle,center);const side=bbox.getNearestSideToPoint(refPoint);let result;switch(side){case"left":result=bbox.getLeftMiddle();break;case"right":result=bbox.getRightMiddle();break;case"top":result=bbox.getTopCenter();break;case"bottom":result=bbox.getBottomCenter()}const direction=options.direction;return"H"===direction?"top"!==side&&"bottom"!==side||(result=refPoint.x<=bbox.x+bbox.width?bbox.getLeftMiddle():bbox.getRightMiddle()):"V"===direction&&(result=refPoint.y<=bbox.y+bbox.height?bbox.getTopCenter():bbox.getBottomCenter()),options.rotate?result.rotate(-angle,center):result}));var NodeAnchor;!function(NodeAnchor){NodeAnchor.presets=node_anchor_main_namespaceObject,NodeAnchor.registry=Registry.create({type:"node endpoint"}),NodeAnchor.registry.register(NodeAnchor.presets,!0)}(NodeAnchor||(NodeAnchor={}));const ratio=function(view,magnet,ref,options){let ratio=null!=options.ratio?options.ratio:.5;return ratio>1&&(ratio/=100),view.getPointAtRatio(ratio)},length_length=function(view,magnet,ref,options){const length=null!=options.length?options.length:20;return view.getPointAtLength(length)},getClosestPoint=function(view,magnet,refPoint,options){const closestPoint=view.getClosestPoint(refPoint);return null!=closestPoint?closestPoint:new Point},closest=resolve(getClosestPoint),orth_orth=resolve((function(view,magnet,refPoint,options){const path=view.getConnection(),segmentSubdivisions=view.getConnectionSubdivisions(),vLine=new Line(refPoint.clone().translate(0,1e6),refPoint.clone().translate(0,-1e6)),hLine=new Line(refPoint.clone().translate(1e6,0),refPoint.clone().translate(-1e6,0)),vIntersections=vLine.intersect(path,{segmentSubdivisions}),hIntersections=hLine.intersect(path,{segmentSubdivisions}),intersections=[];return vIntersections&&intersections.push(...vIntersections),hIntersections&&intersections.push(...hIntersections),intersections.length>0?refPoint.closest(intersections):null!=options.fallbackAt?getPointAtEdge(view,options.fallbackAt):call(getClosestPoint,this,view,magnet,refPoint,options)}));var EdgeAnchor;function util_offset(p1,p2,offset){let tx;if("object"==typeof offset){if(Number.isFinite(offset.y)){const line=new Line(p2,p1),{start,end}=line.parallel(offset.y);p2=start,p1=end}tx=offset.x}else tx=offset;if(null==tx||!Number.isFinite(tx))return p1;const length=p1.distance(p2);return 0===tx&&length>0?p1:p1.move(p2,-Math.min(tx,length-1))}function getStrokeWidth(magnet){const stroke=magnet.getAttribute("stroke-width");return null===stroke?0:parseFloat(stroke)||0}!function(EdgeAnchor){EdgeAnchor.presets=edge_anchor_main_namespaceObject,EdgeAnchor.registry=Registry.create({type:"edge endpoint"}),EdgeAnchor.registry.register(EdgeAnchor.presets,!0)}(EdgeAnchor||(EdgeAnchor={}));const bbox=function(line,view,magnet,options){const bbox=view.getBBoxOfElement(magnet);options.stroked&&bbox.inflate(getStrokeWidth(magnet)/2);const intersections=line.intersect(bbox);return util_offset(intersections&&intersections.length?line.start.closest(intersections):line.end,line.start,options.offset)},rect=function(line,view,magnet,options,type){const cell=view.cell,angle=cell.isNode()?cell.getAngle():0;if(0===angle)return call(bbox,this,line,view,magnet,options,type);const bboxRaw=view.getUnrotatedBBoxOfElement(magnet);options.stroked&&bboxRaw.inflate(getStrokeWidth(magnet)/2);const center=bboxRaw.getCenter(),lineRaw=line.clone().rotate(angle,center),intersections=lineRaw.setLength(1e6).intersect(bboxRaw);return util_offset(intersections&&intersections.length?lineRaw.start.closest(intersections).rotate(-angle,center):line.end,line.start,options.offset)},boundary=function(line,view,magnet,options){let node,intersection;const anchor=line.end,selector=options.selector;if(node="string"==typeof selector?view.findOne(selector):Array.isArray(selector)?getByPath(magnet,selector):function findShapeNode(magnet){if(null==magnet)return null;let node=magnet;do{let tagName=node.tagName;if("string"!=typeof tagName)return null;if(tagName=tagName.toUpperCase(),"G"===tagName)node=node.firstElementChild;else{if("TITLE"!==tagName)break;node=node.nextElementSibling}}while(node);return node}(magnet),!isSVGGraphicsElement(node)){if(node===magnet||!isSVGGraphicsElement(magnet))return anchor;node=magnet}const localShape=view.getShapeOfElement(node),magnetMatrix=view.getMatrixOfElement(node),translateMatrix=view.getRootTranslatedMatrix(),rotateMatrix=view.getRootRotatedMatrix(),targetMatrix=translateMatrix.multiply(rotateMatrix).multiply(magnetMatrix),localMatrix=targetMatrix.inverse(),localLine=util_Util.transformLine(line,localMatrix),localRef=localLine.start.clone(),data=view.getDataOfElement(node);if(!1===options.insideout){null==data.shapeBBox&&(data.shapeBBox=localShape.bbox());const localBBox=data.shapeBBox;if(null!=localBBox&&localBBox.containsPoint(localRef))return anchor}let pathOptions;if(!0===options.extrapolate&&localLine.setLength(1e6),Path.isPath(localShape)){const precision=options.precision||2;null==data.segmentSubdivisions&&(data.segmentSubdivisions=localShape.getSegmentSubdivisions({precision})),pathOptions={precision,segmentSubdivisions:data.segmentSubdivisions},intersection=localLine.intersect(localShape,pathOptions)}else intersection=localLine.intersect(localShape);intersection?Array.isArray(intersection)&&(intersection=localRef.closest(intersection)):!0===options.sticky&&(intersection=Rectangle.isRectangle(localShape)?localShape.getNearestPointToPoint(localRef):Ellipse.isEllipse(localShape)?localShape.intersectsWithLineFromCenterToPoint(localRef):localShape.closestPoint(localRef,pathOptions));const cp=intersection?util_Util.transformPoint(intersection,targetMatrix):anchor;let cpOffset=options.offset||0;return!1!==options.stroked&&("object"==typeof cpOffset?(cpOffset=Object.assign({},cpOffset),null==cpOffset.x&&(cpOffset.x=0),cpOffset.x+=getStrokeWidth(node)/2):cpOffset+=getStrokeWidth(node)/2),util_offset(cp,line.start,cpOffset)};const anchor_anchor=function(line,view,magnet,options){const{alignOffset,align}=options;return align&&function alignLine(line,type,offset=0){const{start,end}=line;let a,b,direction,coordinate;switch(type){case"left":coordinate="x",a=end,b=start,direction=-1;break;case"right":coordinate="x",a=start,b=end,direction=1;break;case"top":coordinate="y",a=end,b=start,direction=-1;break;case"bottom":coordinate="y",a=start,b=end,direction=1;break;default:return}start[coordinate]<end[coordinate]?a[coordinate]=b[coordinate]:b[coordinate]=a[coordinate],Number.isFinite(offset)&&(a[coordinate]+=direction*offset,b[coordinate]+=direction*offset)}(line,align,alignOffset),util_offset(line.end,line.start,options.offset)};var ConnectionPoint;!function(ConnectionPoint){ConnectionPoint.presets=connection_point_main_namespaceObject,ConnectionPoint.registry=Registry.create({type:"connection point"}),ConnectionPoint.registry.register(ConnectionPoint.presets,!0)}(ConnectionPoint||(ConnectionPoint={}));const normal=function(vertices){return[...vertices]},oneSide=function(vertices,options,edgeView){const side=options.side||"bottom",padding=normalizeSides(options.padding||40),sourceBBox=edgeView.sourceBBox,targetBBox=edgeView.targetBBox,sourcePoint=sourceBBox.getCenter(),targetPoint=targetBBox.getCenter();let coord,dim,factor;switch(side){case"top":factor=-1,coord="y",dim="height";break;case"left":factor=-1,coord="x",dim="width";break;case"right":factor=1,coord="x",dim="width";break;default:factor=1,coord="y",dim="height"}return sourcePoint[coord]+=factor*(sourceBBox[dim]/2+padding[side]),targetPoint[coord]+=factor*(targetBBox[dim]/2+padding[side]),factor*(sourcePoint[coord]-targetPoint[coord])>0?targetPoint[coord]=sourcePoint[coord]:sourcePoint[coord]=targetPoint[coord],[sourcePoint.toJSON(),...vertices,targetPoint.toJSON()]};function getPointBBox(p){return new Rectangle(p.x,p.y,0,0)}function getPaddingBox(options={}){const sides=normalizeSides(options.padding||20);return{x:-sides.left,y:-sides.top,width:sides.left+sides.right,height:sides.top+sides.bottom}}function getSourceBBox(view,options={}){return view.sourceBBox.clone().moveAndExpand(getPaddingBox(options))}function getTargetBBox(view,options={}){return view.targetBBox.clone().moveAndExpand(getPaddingBox(options))}const router_orth_orth=function(vertices,options,edgeView){let sourceBBox=getSourceBBox(edgeView,options),targetBBox=getTargetBBox(edgeView,options);const sourceAnchor=function getSourceAnchor(view,options={}){return view.sourceAnchor?view.sourceAnchor:getSourceBBox(view,options).getCenter()}(edgeView,options),targetAnchor=function getTargetAnchor(view,options={}){return view.targetAnchor?view.targetAnchor:getTargetBBox(view,options).getCenter()}(edgeView,options);sourceBBox=sourceBBox.union(getPointBBox(sourceAnchor)),targetBBox=targetBBox.union(getPointBBox(targetAnchor));const points=vertices.map((p=>Point.create(p)));points.unshift(sourceAnchor),points.push(targetAnchor);let bearing=null;const result=[];for(let i=0,len=points.length-1;i<len;i+=1){let route=null;const from=points[i],to=points[i+1],isOrthogonal=null!=orth_Private.getBearing(from,to);if(0===i)i+1===len?sourceBBox.intersectsWithRect(targetBBox.clone().inflate(1))?route=orth_Private.insideNode(from,to,sourceBBox,targetBBox):isOrthogonal||(route=orth_Private.nodeToNode(from,to,sourceBBox,targetBBox)):sourceBBox.containsPoint(to)?route=orth_Private.insideNode(from,to,sourceBBox,getPointBBox(to).moveAndExpand(getPaddingBox(options))):isOrthogonal||(route=orth_Private.nodeToVertex(from,to,sourceBBox));else if(i+1===len){const isOrthogonalLoop=isOrthogonal&&orth_Private.getBearing(to,from)===bearing;targetBBox.containsPoint(from)||isOrthogonalLoop?route=orth_Private.insideNode(from,to,getPointBBox(from).moveAndExpand(getPaddingBox(options)),targetBBox,bearing):isOrthogonal||(route=orth_Private.vertexToNode(from,to,targetBBox,bearing))}else isOrthogonal||(route=orth_Private.vertexToVertex(from,to,bearing));route?(result.push(...route.points),bearing=route.direction):bearing=orth_Private.getBearing(from,to),i+1<len&&result.push(to)}return result};var orth_Private;!function(Private){const opposites={N:"S",S:"N",E:"W",W:"E"},radians={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function freeJoin(p1,p2,bbox){let p=new Point(p1.x,p2.y);return bbox.containsPoint(p)&&(p=new Point(p2.x,p1.y)),p}function getBBoxSize(bbox,bearing){return bbox["W"===bearing||"E"===bearing?"width":"height"]}function getBearing(from,to){return from.x===to.x?from.y>to.y?"N":"S":from.y===to.y?from.x>to.x?"W":"E":null}function vertexToVertex(from,to,bearing){const p1=new Point(from.x,to.y),p2=new Point(to.x,from.y),d1=getBearing(from,p1),d2=getBearing(from,p2),opposite=bearing?opposites[bearing]:null,p=d1===bearing||d1!==opposite&&(d2===opposite||d2!==bearing)?p1:p2;return{points:[p],direction:getBearing(p,to)}}function nodeToVertex(from,to,fromBBox){const p=freeJoin(from,to,fromBBox);return{points:[p],direction:getBearing(p,to)}}Private.getBBoxSize=getBBoxSize,Private.getBearing=getBearing,Private.vertexToVertex=vertexToVertex,Private.nodeToVertex=nodeToVertex,Private.vertexToNode=function vertexToNode(from,to,toBBox,bearing){const points=[new Point(from.x,to.y),new Point(to.x,from.y)],freePoints=points.filter((p=>!toBBox.containsPoint(p))),freeBearingPoints=freePoints.filter((p=>getBearing(p,from)!==bearing));let p;if(freeBearingPoints.length>0)return p=freeBearingPoints.filter((p=>getBearing(from,p)===bearing)).pop(),p=p||freeBearingPoints[0],{points:[p],direction:getBearing(p,to)};{p=lodash_es_difference(points,freePoints)[0];const p2=Point.create(to).move(p,-getBBoxSize(toBBox,bearing)/2);return{points:[freeJoin(p2,from,toBBox),p2],direction:getBearing(p2,to)}}},Private.nodeToNode=function nodeToNode(from,to,fromBBox,toBBox){let route=nodeToVertex(to,from,toBBox);const p1=route.points[0];if(fromBBox.containsPoint(p1)){route=nodeToVertex(from,to,fromBBox);const p2=route.points[0];if(toBBox.containsPoint(p2)){const fromBorder=Point.create(from).move(p2,-getBBoxSize(fromBBox,getBearing(from,p2))/2),toBorder=Point.create(to).move(p1,-getBBoxSize(toBBox,getBearing(to,p1))/2),mid=new Line(fromBorder,toBorder).getCenter(),startRoute=nodeToVertex(from,mid,fromBBox),endRoute=vertexToVertex(mid,to,startRoute.direction);route.points=[startRoute.points[0],endRoute.points[0]],route.direction=endRoute.direction}}return route},Private.insideNode=function insideNode(from,to,fromBBox,toBBox,bearing){const boundary=fromBBox.union(toBBox).inflate(1),center=boundary.getCenter(),reversed=center.distance(to)>center.distance(from),start=reversed?to:from,end=reversed?from:to;let p1,p2,p3,points;return bearing?(p1=Point.fromPolar(boundary.width+boundary.height,radians[bearing],start),p1=boundary.getNearestPointToPoint(p1).move(p1,-1)):p1=boundary.getNearestPointToPoint(start).move(start,1),p2=freeJoin(p1,end,boundary),p1.round().equals(p2.round())?(p2=Point.fromPolar(boundary.width+boundary.height,Angle.toRad(p1.theta(start))+Math.PI/2,end),p2=boundary.getNearestPointToPoint(p2).move(end,1).round(),p3=freeJoin(p1,p2,boundary),points=reversed?[p2,p3,p1]:[p1,p3,p2]):points=reversed?[p2,p1]:[p1,p2],{points,direction:getBearing(reversed?p1:p2,to)}}}(orth_Private||(orth_Private={}));const options_defaults={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return options_resolve(this.step,this)},directions(){const step=options_resolve(this.step,this),cost=options_resolve(this.cost,this);return[{cost,offsetX:step,offsetY:0},{cost,offsetX:-step,offsetY:0},{cost,offsetX:0,offsetY:step},{cost,offsetX:0,offsetY:-step}]},penalties(){const step=options_resolve(this.step,this);return{0:0,45:step/2,90:step/2}},paddingBox(){const step=options_resolve(this.step,this);return{x:-step,y:-step,width:2*step,height:2*step}},fallbackRouter:router_orth_orth,draggingRouter:null,snapToGrid:!0};function options_resolve(input,options){return"function"==typeof input?input.call(options):input}class SortedSet{constructor(){this.items=[],this.hash={},this.values={}}add(item,value){this.hash[item]?this.items.splice(this.items.indexOf(item),1):this.hash[item]=1,this.values[item]=value;const index=lodash_es_sortedIndexBy(this.items,item,(key=>this.values[key]));this.items.splice(index,0,item)}pop(){const item=this.items.shift();return item&&(this.hash[item]=2),item}isOpen(item){return 1===this.hash[item]}isClose(item){return 2===this.hash[item]}isEmpty(){return 0===this.items.length}}class ObstacleMap{constructor(options){this.options=options,this.mapGridSize=100,this.map={}}build(model,edge){const options=this.options,excludedTerminals=options.excludeTerminals.reduce(((memo,type)=>{const terminal=edge[type];if(terminal){const cell=model.getCell(terminal.cell);cell&&memo.push(cell)}return memo}),[]);let excludedAncestors=[];const source=model.getCell(edge.getSourceCellId());source&&(excludedAncestors=lodash_es_union(excludedAncestors,source.getAncestors().map((cell=>cell.id))));const target=model.getCell(edge.getTargetCellId());target&&(excludedAncestors=lodash_es_union(excludedAncestors,target.getAncestors().map((cell=>cell.id))));const mapGridSize=this.mapGridSize;return model.getNodes().reduce(((map,node)=>{const excludedTerminal=excludedTerminals.some((cell=>cell.id===node.id)),excludedShape=!!node.shape&&options.excludeShapes.includes(node.shape),excludedNode=options.excludeNodes.some((item=>"string"==typeof item?node.id===item:item===node)),excludedAncestor=excludedAncestors.includes(node.id),excluded=excludedShape||excludedTerminal||excludedNode||excludedAncestor;if(node.isVisible()&&!excluded){const bbox=node.getBBox().moveAndExpand(options.paddingBox),origin=bbox.getOrigin().snapToGrid(mapGridSize),corner=bbox.getCorner().snapToGrid(mapGridSize);for(let x=origin.x;x<=corner.x;x+=mapGridSize)for(let y=origin.y;y<=corner.y;y+=mapGridSize){const key=new Point(x,y).toString();null==map[key]&&(map[key]=[]),map[key].push(bbox)}}return map}),this.map),this}isAccessible(point){const key=point.clone().snapToGrid(this.mapGridSize).toString(),rects=this.map[key];return!rects||rects.every((rect=>!rect.containsPoint(point)))}}function util_getSourceBBox(view,options){const bbox=view.sourceBBox.clone();return options&&options.paddingBox?bbox.moveAndExpand(options.paddingBox):bbox}function util_getTargetBBox(view,options){const bbox=view.targetBBox.clone();return options&&options.paddingBox?bbox.moveAndExpand(options.paddingBox):bbox}function getSourceEndpoint(view,options){if(view.sourceAnchor)return view.sourceAnchor;return util_getSourceBBox(view,options).getCenter()}function getDirectionAngle(start,end,directionCount,grid,options){const quadrant=360/directionCount,angleTheta=start.theta(function fixAngleEnd(start,end,grid,options){const step=options.step,diffX=end.x-start.x,diffY=end.y-start.y,gridStepsX=diffX/grid.x,gridStepsY=diffY/grid.y,distanceX=gridStepsX*step,distanceY=gridStepsY*step;return new Point(start.x+distanceX,start.y+distanceY)}(start,end,grid,options)),normalizedAngle=Angle.normalize(angleTheta+quadrant/2);return quadrant*Math.floor(normalizedAngle/quadrant)}function getDirectionChange(angle1,angle2){const change=Math.abs(angle1-angle2);return change>180?360-change:change}function getGridDimension(diff,step){if(!diff)return step;const abs=Math.abs(diff),count=Math.round(abs/step);if(!count)return abs;return step+(abs-count*step)/count}function round(point,precision){return point.round(precision)}function align(point,grid,precision){return round(function snapGrid(point,grid){const source=grid.source,x=GeometryUtil.snapToGrid(point.x-source.x,grid.x)+source.x,y=GeometryUtil.snapToGrid(point.y-source.y,grid.y)+source.y;return new Point(x,y)}(point.clone(),grid),precision)}function getKey(point){return point.toString()}function util_normalizePoint(point){return new Point(0===point.x?0:Math.abs(point.x)/point.x,0===point.y?0:Math.abs(point.y)/point.y)}function getCost(from,anchors){let min=1/0;for(let i=0,len=anchors.length;i<len;i+=1){const dist=from.manhattanDistance(anchors[i]);dist<min&&(min=dist)}return min}function getRectPoints(anchor,bbox,directionList,grid,options){const precision=options.precision,directionMap=options.directionMap,centerVector=anchor.diff(bbox.getCenter()),rectPoints=Object.keys(directionMap).reduce(((res,key)=>{if(directionList.includes(key)){const direction=directionMap[key],ending=new Point(anchor.x+direction.x*(Math.abs(centerVector.x)+bbox.width),anchor.y+direction.y*(Math.abs(centerVector.y)+bbox.height)),intersections=new Line(anchor,ending).intersect(bbox)||[];let farthestIntersectionDistance,farthestIntersection=null;for(let i=0;i<intersections.length;i+=1){const intersection=intersections[i],distance=anchor.squaredDistance(intersection);(null==farthestIntersectionDistance||distance>farthestIntersectionDistance)&&(farthestIntersectionDistance=distance,farthestIntersection=intersection)}if(farthestIntersection){let target=align(farthestIntersection,grid,precision);bbox.containsPoint(target)&&(target=align(target.translate(direction.x*grid.x,direction.y*grid.y),grid,precision)),res.push(target)}}return res}),[]);return bbox.containsPoint(anchor)||rectPoints.push(align(anchor,grid,precision)),rectPoints}function reconstructRoute(parents,points,tailPoint,from,to){const route=[];let point,prevDiff=util_normalizePoint(to.diff(tailPoint)),currentKey=getKey(tailPoint),parent=parents[currentKey];for(;parent;){point=points[currentKey];const diff=util_normalizePoint(point.diff(parent));diff.equals(prevDiff)||(route.unshift(point),prevDiff=diff),currentKey=getKey(parent),parent=parents[currentKey]}const leadPoint=points[currentKey];return util_normalizePoint(leadPoint.diff(from)).equals(prevDiff)||route.unshift(leadPoint),route}function findRoute(edgeView,from,to,map,options){const precision=options.precision;let sourceEndpoint,targetEndpoint;sourceEndpoint=Rectangle.isRectangle(from)?round(getSourceEndpoint(edgeView,options).clone(),precision):round(from.clone(),precision),targetEndpoint=Rectangle.isRectangle(to)?round(function getTargetEndpoint(view,options){return view.targetAnchor?view.targetAnchor:util_getTargetBBox(view,options).getCenter()}(edgeView,options).clone(),precision):round(to.clone(),precision);const grid=function getGrid(step,source,target){return{source:source.clone(),x:getGridDimension(target.x-source.x,step),y:getGridDimension(target.y-source.y,step)}}(options.step,sourceEndpoint,targetEndpoint),startPoint=sourceEndpoint,endPoint=targetEndpoint;let startPoints,endPoints;if(startPoints=Rectangle.isRectangle(from)?getRectPoints(startPoint,from,options.startDirections,grid,options):[startPoint],endPoints=Rectangle.isRectangle(to)?getRectPoints(targetEndpoint,to,options.endDirections,grid,options):[endPoint],startPoints=startPoints.filter((p=>map.isAccessible(p))),endPoints=endPoints.filter((p=>map.isAccessible(p))),startPoints.length>0&&endPoints.length>0){const openSet=new SortedSet,points={},parents={},costs={};for(let i=0,n=startPoints.length;i<n;i+=1){const startPoint=startPoints[i],key=getKey(startPoint);openSet.add(key,getCost(startPoint,endPoints)),points[key]=startPoint,costs[key]=0}const previousRouteDirectionAngle=options.previousDirectionAngle,isPathBeginning=void 0===previousRouteDirectionAngle;let direction,directionChange;const directions=function getGridOffsets(grid,options){const step=options.step;return options.directions.forEach((direction=>{direction.gridOffsetX=direction.offsetX/step*grid.x,direction.gridOffsetY=direction.offsetY/step*grid.y})),options.directions}(grid,options),numDirections=directions.length,endPointsKeys=endPoints.reduce(((res,endPoint)=>{const key=getKey(endPoint);return res.push(key),res}),[]),sameStartEndPoints=Point.equalPoints(startPoints,endPoints);let loopsRemaining=options.maxLoopCount;for(;!openSet.isEmpty()&&loopsRemaining>0;){const currentKey=openSet.pop(),currentPoint=points[currentKey],currentParent=parents[currentKey],currentCost=costs[currentKey],isStartPoint=currentPoint.equals(startPoint),isRouteBeginning=null==currentParent;let previousDirectionAngle;previousDirectionAngle=isRouteBeginning?isPathBeginning?isStartPoint?null:getDirectionAngle(startPoint,currentPoint,numDirections,grid,options):previousRouteDirectionAngle:getDirectionAngle(currentParent,currentPoint,numDirections,grid,options);if(!(isRouteBeginning&&sameStartEndPoints)&&endPointsKeys.indexOf(currentKey)>=0)return options.previousDirectionAngle=previousDirectionAngle,reconstructRoute(parents,points,currentPoint,startPoint,endPoint);for(let i=0;i<numDirections;i+=1){direction=directions[i];const directionAngle=direction.angle;if(directionChange=getDirectionChange(previousDirectionAngle,directionAngle),(!isPathBeginning||!isStartPoint)&&directionChange>options.maxDirectionChange)continue;const neighborPoint=align(currentPoint.clone().translate(direction.gridOffsetX||0,direction.gridOffsetY||0),grid,precision),neighborKey=getKey(neighborPoint);if(openSet.isClose(neighborKey)||!map.isAccessible(neighborPoint))continue;if(endPointsKeys.indexOf(neighborKey)>=0){if(!neighborPoint.equals(endPoint)){if(getDirectionChange(directionAngle,getDirectionAngle(neighborPoint,endPoint,numDirections,grid,options))>options.maxDirectionChange)continue}}const costFromStart=currentCost+direction.cost+(isStartPoint?0:options.penalties[directionChange]);(!openSet.isOpen(neighborKey)||costFromStart<costs[neighborKey])&&(points[neighborKey]=neighborPoint,parents[neighborKey]=currentPoint,costs[neighborKey]=costFromStart,openSet.add(neighborKey,costFromStart+getCost(neighborPoint,endPoints)))}loopsRemaining-=1}}return options.fallbackRoute?call(options.fallbackRoute,this,startPoint,endPoint,options):null}const router=function(vertices,optionsRaw,edgeView){const options=function resolveOptions(options){const result=Object.keys(options).reduce(((memo,key)=>(memo[key]="fallbackRouter"===key||"draggingRouter"===key||"fallbackRoute"===key?options[key]:options_resolve(options[key],options),memo)),{});if(result.padding){const sides=normalizeSides(result.padding);result.paddingBox={x:-sides.left,y:-sides.top,width:sides.left+sides.right,height:sides.top+sides.bottom}}return result.directions.forEach((direction=>{const point1=new Point(0,0),point2=new Point(direction.offsetX,direction.offsetY);direction.angle=Angle.normalize(point1.theta(point2))})),result}(optionsRaw),sourceBBox=util_getSourceBBox(edgeView,options),targetBBox=util_getTargetBBox(edgeView,options),sourceEndpoint=getSourceEndpoint(edgeView,options),map=new ObstacleMap(options).build(edgeView.graph.model,edgeView.cell),oldVertices=vertices.map((p=>Point.create(p))),newVertices=[];let from,to,tailPoint=sourceEndpoint;for(let i=0,len=oldVertices.length;i<=len;i+=1){let partialRoute=null;if(from=to||sourceBBox,to=oldVertices[i],null==to){to=targetBBox;const edge=edgeView.cell;if((null==edge.getSourceCellId()||null==edge.getTargetCellId())&&"function"==typeof options.draggingRouter){const dragFrom=from===sourceBBox?sourceEndpoint:from,dragTo=to.getOrigin();partialRoute=call(options.draggingRouter,edgeView,dragFrom,dragTo,options)}}if(null==partialRoute&&(partialRoute=findRoute(edgeView,from,to,map,options)),null===partialRoute)return console.warn("Unable to execute manhattan algorithm, use orth instead"),call(options.fallbackRouter,this,vertices,options,edgeView);const leadPoint=partialRoute[0];leadPoint&&leadPoint.equals(tailPoint)&&partialRoute.shift(),tailPoint=partialRoute[partialRoute.length-1]||tailPoint,newVertices.push(...partialRoute)}return options.snapToGrid?function snap(vertices,gridSize=10){if(vertices.length<=1)return vertices;for(let i=0,len=vertices.length;i<len-1;i+=1){const first=vertices[i],second=vertices[i+1];if(first.x===second.x){const x=gridSize*Math.round(first.x/gridSize);first.x!==x&&(first.x=x,second.x=x)}else if(first.y===second.y){const y=gridSize*Math.round(first.y/gridSize);first.y!==y&&(first.y=y,second.y=y)}}return vertices}(newVertices,edgeView.graph.grid.getGridSize()):newVertices},manhattan=function(vertices,options,edgeView){return call(router,this,vertices,Object.assign(Object.assign({},options_defaults),options),edgeView)},metro_defaults={maxDirectionChange:45,directions(){const step=options_resolve(this.step,this),cost=options_resolve(this.cost,this),diagonalCost=Math.ceil(Math.sqrt(step*step<<1));return[{cost,offsetX:step,offsetY:0},{cost:diagonalCost,offsetX:step,offsetY:step},{cost,offsetX:0,offsetY:step},{cost:diagonalCost,offsetX:-step,offsetY:step},{cost,offsetX:-step,offsetY:0},{cost:diagonalCost,offsetX:-step,offsetY:-step},{cost,offsetX:0,offsetY:-step},{cost:diagonalCost,offsetX:step,offsetY:-step}]},fallbackRoute(from,to,options){const theta=from.theta(to),route=[];let a={x:to.x,y:from.y},b={x:from.x,y:to.y};if(theta%180>90){const t=a;a=b,b=t}const p1=theta%90<45?a:b,l1=new Line(from,p1),alpha=90*Math.ceil(theta/90),p2=Point.fromPolar(l1.squaredLength(),Angle.toRad(alpha+135),p1),l2=new Line(to,p2),intersectionPoint=l1.intersectsWithLine(l2),point=intersectionPoint||to,directionFrom=intersectionPoint?point:from,quadrant=360/options.directions.length,angleTheta=directionFrom.theta(to),normalizedAngle=Angle.normalize(angleTheta+quadrant/2),directionAngle=quadrant*Math.floor(normalizedAngle/quadrant);return options.previousDirectionAngle=directionAngle,point&&route.push(point.round()),route.push(to),route}},metro=function(vertices,options,linkView){return call(manhattan,this,vertices,Object.assign(Object.assign({},metro_defaults),options),linkView)},er=function(vertices,options,edgeView){const offsetRaw=options.offset||32,min=null==options.min?16:options.min;let offset=0,direction=options.direction;const sourceBBox=edgeView.sourceBBox,targetBBox=edgeView.targetBBox,sourcePoint=sourceBBox.getCenter(),targetPoint=targetBBox.getCenter();if("number"==typeof offsetRaw&&(offset=offsetRaw),null==direction){let dx=targetBBox.left-sourceBBox.right,dy=targetBBox.top-sourceBBox.bottom;dx>=0&&dy>=0?direction=dx>=dy?"L":"T":dx<=0&&dy>=0?(dx=sourceBBox.left-targetBBox.right,direction=dx>=0&&dx>=dy?"R":"T"):dx>=0&&dy<=0?(dy=sourceBBox.top-targetBBox.bottom,direction=dy>=0?dx>=dy?"L":"B":"L"):(dx=sourceBBox.left-targetBBox.right,dy=sourceBBox.top-targetBBox.bottom,direction=dx>=0&&dy>=0?dx>=dy?"R":"B":dx<=0&&dy>=0?"B":dx>=0&&dy<=0||Math.abs(dx)>Math.abs(dy)?"R":"B")}let coord,dim,factor;"H"===direction?direction=targetPoint.x-sourcePoint.x>=0?"L":"R":"V"===direction&&(direction=targetPoint.y-sourcePoint.y>=0?"T":"B"),"center"===offsetRaw&&("L"===direction?offset=(targetBBox.left-sourceBBox.right)/2:"R"===direction?offset=(sourceBBox.left-targetBBox.right)/2:"T"===direction?offset=(targetBBox.top-sourceBBox.bottom)/2:"B"===direction&&(offset=(sourceBBox.top-targetBBox.bottom)/2));const horizontal="L"===direction||"R"===direction;if(horizontal){if(targetPoint.y===sourcePoint.y)return[...vertices];factor="L"===direction?1:-1,coord="x",dim="width"}else{if(targetPoint.x===sourcePoint.x)return[...vertices];factor="T"===direction?1:-1,coord="y",dim="height"}const source=sourcePoint.clone(),target=targetPoint.clone();if(source[coord]+=factor*(sourceBBox[dim]/2+offset),target[coord]-=factor*(targetBBox[dim]/2+offset),horizontal){const sourceX=source.x,targetX=target.x,sourceDelta=sourceBBox.width/2+min,targetDelta=targetBBox.width/2+min;targetPoint.x>sourcePoint.x?targetX<=sourceX&&(source.x=Math.max(targetX,sourcePoint.x+sourceDelta),target.x=Math.min(sourceX,targetPoint.x-targetDelta)):targetX>=sourceX&&(source.x=Math.min(targetX,sourcePoint.x-sourceDelta),target.x=Math.max(sourceX,targetPoint.x+targetDelta))}else{const sourceY=source.y,targetY=target.y,sourceDelta=sourceBBox.height/2+min,targetDelta=targetBBox.height/2+min;targetPoint.y>sourcePoint.y?targetY<=sourceY&&(source.y=Math.max(targetY,sourcePoint.y+sourceDelta),target.y=Math.min(sourceY,targetPoint.y-targetDelta)):targetY>=sourceY&&(source.y=Math.min(targetY,sourcePoint.y-sourceDelta),target.y=Math.max(sourceY,targetPoint.y+targetDelta))}return[source.toJSON(),...vertices,target.toJSON()]};function rollup(points,merge){if(null!=merge&&!1!==merge){const amount="boolean"==typeof merge?0:merge;if(amount>0){const center1=Point.create(points[1]).move(points[2],amount),center2=Point.create(points[1]).move(points[0],amount);return[center1.toJSON(),...points,center2.toJSON()]}{const center=points[1];return[Object.assign({},center),...points,Object.assign({},center)]}}return points}const loop=function(vertices,options,edgeView){const width=options.width||50,halfHeight=(options.height||80)/2,angle=options.angle||"auto",sourceAnchor=edgeView.sourceAnchor,targetAnchor=edgeView.targetAnchor,sourceBBox=edgeView.sourceBBox,targetBBox=edgeView.targetBBox;if(sourceAnchor.equals(targetAnchor)){const getVertices=angle=>{const rad=Angle.toRad(angle),sin=Math.sin(rad),cos=Math.cos(rad),center=new Point(sourceAnchor.x+cos*width,sourceAnchor.y+sin*width),ref=new Point(center.x-cos*halfHeight,center.y-sin*halfHeight),p1=ref.clone().rotate(-90,center),p2=ref.clone().rotate(90,center);return[p1.toJSON(),center.toJSON(),p2.toJSON()]},validate=end=>{const start=sourceAnchor.clone().move(end,-1),line=new Line(start,end);return!sourceBBox.containsPoint(end)&&!sourceBBox.intersectsWithLine(line)},angles=[0,90,180,270,45,135,225,315];if("number"==typeof angle)return rollup(getVertices(angle),options.merge);const center=sourceBBox.getCenter();if(center.equals(sourceAnchor))return rollup(getVertices(0),options.merge);const deg=center.angleBetween(sourceAnchor,center.clone().translate(1,0));let ret=getVertices(deg);if(validate(ret[1]))return rollup(ret,options.merge);for(let i=1,l=angles.length;i<l;i+=1)if(ret=getVertices(deg+angles[i]),validate(ret[1]))return rollup(ret,options.merge);return rollup(ret,options.merge)}{const line=new Line(sourceAnchor,targetAnchor);let parallel=line.parallel(-width),center=parallel.getCenter(),p1=parallel.start.clone().move(parallel.end,halfHeight),p2=parallel.end.clone().move(parallel.start,halfHeight);const ref=line.parallel(-1),line1=new Line(ref.start,center),line2=new Line(ref.end,center);if((sourceBBox.containsPoint(center)||targetBBox.containsPoint(center)||sourceBBox.intersectsWithLine(line1)||sourceBBox.intersectsWithLine(line2)||targetBBox.intersectsWithLine(line1)||targetBBox.intersectsWithLine(line2))&&(parallel=line.parallel(width),center=parallel.getCenter(),p1=parallel.start.clone().move(parallel.end,halfHeight),p2=parallel.end.clone().move(parallel.start,halfHeight)),options.merge){const line=new Line(sourceAnchor,targetAnchor),normal=new Line(center,line.center).setLength(Number.MAX_SAFE_INTEGER),intersects1=sourceBBox.intersectsWithLine(normal),intersects2=targetBBox.intersectsWithLine(normal),intersects=intersects1?Array.isArray(intersects1)?intersects1:[intersects1]:[];intersects2&&(Array.isArray(intersects2)?intersects.push(...intersects2):intersects.push(intersects2));const anchor=line.center.closest(intersects);anchor?(edgeView.sourceAnchor=anchor.clone(),edgeView.targetAnchor=anchor.clone()):(edgeView.sourceAnchor=line.center.clone(),edgeView.targetAnchor=line.center.clone())}return rollup([p1.toJSON(),center.toJSON(),p2.toJSON()],options.merge)}};var Router;!function(Router){Router.presets=router_main_namespaceObject,Router.registry=Registry.create({type:"router"}),Router.registry.register(Router.presets,!0)}(Router||(Router={}));const normal_normal=function(sourcePoint,targetPoint,routePoints,options={}){const points=[sourcePoint,...routePoints,targetPoint],polyline=new Polyline(points),path=new Path(polyline);return options.raw?path:path.serialize()},loop_loop=function(sourcePoint,targetPoint,routePoints,options={}){const fix=3===routePoints.length?0:1,p1=Point.create(routePoints[0+fix]),p2=Point.create(routePoints[2+fix]),center=Point.create(routePoints[1+fix]);if(!Point.equals(sourcePoint,targetPoint)){const middle=new Point((sourcePoint.x+targetPoint.x)/2,(sourcePoint.y+targetPoint.y)/2),angle=middle.angleBetween(Point.create(sourcePoint).rotate(90,middle),center);angle>1&&(p1.rotate(180-angle,middle),p2.rotate(180-angle,middle),center.rotate(180-angle,middle))}const pathData=`\n     M ${sourcePoint.x} ${sourcePoint.y}\n     Q ${p1.x} ${p1.y} ${center.x} ${center.y}\n     Q ${p2.x} ${p2.y} ${targetPoint.x} ${targetPoint.y}\n  `;return options.raw?Path.parse(pathData):pathData},rounded=function(sourcePoint,targetPoint,routePoints,options={}){const path=new Path;path.appendSegment(Path.createSegment("M",sourcePoint));const f13=1/3,f23=2/3,radius=options.radius||10;let prevDistance,nextDistance;for(let i=0,ii=routePoints.length;i<ii;i+=1){const curr=Point.create(routePoints[i]),prev=routePoints[i-1]||sourcePoint,next=routePoints[i+1]||targetPoint;prevDistance=nextDistance||curr.distance(prev)/2,nextDistance=curr.distance(next)/2;const startMove=-Math.min(radius,prevDistance),endMove=-Math.min(radius,nextDistance),roundedStart=curr.clone().move(prev,startMove).round(),roundedEnd=curr.clone().move(next,endMove).round(),control1=new Point(f13*roundedStart.x+f23*curr.x,f23*curr.y+f13*roundedStart.y),control2=new Point(f13*roundedEnd.x+f23*curr.x,f23*curr.y+f13*roundedEnd.y);path.appendSegment(Path.createSegment("L",roundedStart)),path.appendSegment(Path.createSegment("C",control1,control2,roundedEnd))}return path.appendSegment(Path.createSegment("L",targetPoint)),options.raw?path:path.serialize()},smooth=function(sourcePoint,targetPoint,routePoints,options={}){let path,direction=options.direction;if(routePoints&&0!==routePoints.length){const points=[sourcePoint,...routePoints,targetPoint],curves=Curve.throughPoints(points);path=new Path(curves)}else if(path=new Path,path.appendSegment(Path.createSegment("M",sourcePoint)),direction||(direction=Math.abs(sourcePoint.x-targetPoint.x)>=Math.abs(sourcePoint.y-targetPoint.y)?"H":"V"),"H"===direction){const controlPointX=(sourcePoint.x+targetPoint.x)/2;path.appendSegment(Path.createSegment("C",controlPointX,sourcePoint.y,controlPointX,targetPoint.y,targetPoint.x,targetPoint.y))}else{const controlPointY=(sourcePoint.y+targetPoint.y)/2;path.appendSegment(Path.createSegment("C",sourcePoint.x,controlPointY,targetPoint.x,controlPointY,targetPoint.x,targetPoint.y))}return options.raw?path:path.serialize()},F13=1/3,F23=2/3;function createLines(sourcePoint,targetPoint,route=[]){const points=[sourcePoint,...route,targetPoint],lines=[];return points.forEach(((point,idx)=>{const next=points[idx+1];null!=next&&lines.push(new Line(point,next))})),lines}function getDistence(p1,p2){return new Line(p1,p2).squaredLength()}function buildPath(lines,jumpSize,jumpType,radius){const path=new Path;let segment;return segment=Path.createSegment("M",lines[0].start),path.appendSegment(segment),lines.forEach(((line,index)=>{if(jumppedLines.includes(line)){let angle,diff,control1,control2;if("arc"===jumpType){angle=-90,diff=line.start.diff(line.end);(diff.x<0||0===diff.x&&diff.y<0)&&(angle+=180);const center=line.getCenter(),centerLine=new Line(center,line.end).rotate(angle,center);let halfLine;halfLine=new Line(line.start,center),control1=halfLine.pointAt(2/3).rotate(angle,line.start),control2=centerLine.pointAt(1/3).rotate(-angle,centerLine.end),segment=Path.createSegment("C",control1,control2,centerLine.end),path.appendSegment(segment),halfLine=new Line(center,line.end),control1=centerLine.pointAt(1/3).rotate(angle,centerLine.end),control2=halfLine.pointAt(1/3).rotate(-angle,line.end),segment=Path.createSegment("C",control1,control2,line.end),path.appendSegment(segment)}else if("gap"===jumpType)segment=Path.createSegment("M",line.end),path.appendSegment(segment);else if("cubic"===jumpType){angle=line.start.theta(line.end);const xOffset=.6*jumpSize;let yOffset=1.35*jumpSize;diff=line.start.diff(line.end);(diff.x<0||0===diff.x&&diff.y<0)&&(yOffset*=-1),control1=new Point(line.start.x+xOffset,line.start.y+yOffset).rotate(angle,line.start),control2=new Point(line.end.x-xOffset,line.end.y+yOffset).rotate(angle,line.end),segment=Path.createSegment("C",control1,control2,line.end),path.appendSegment(segment)}}else{const nextLine=lines[index+1];0===radius||!nextLine||jumppedLines.includes(nextLine)?(segment=Path.createSegment("L",line.end),path.appendSegment(segment)):function buildRoundedSegment(offset,path,curr,prev,next){const prevDistance=curr.distance(prev)/2,nextDistance=curr.distance(next)/2,startMove=-Math.min(offset,prevDistance),endMove=-Math.min(offset,nextDistance),roundedStart=curr.clone().move(prev,startMove).round(),roundedEnd=curr.clone().move(next,endMove).round(),control1=new Point(F13*roundedStart.x+F23*curr.x,F23*curr.y+F13*roundedStart.y),control2=new Point(F13*roundedEnd.x+F23*curr.x,F23*curr.y+F13*roundedEnd.y);let segment;segment=Path.createSegment("L",roundedStart),path.appendSegment(segment),segment=Path.createSegment("C",control1,control2,roundedEnd),path.appendSegment(segment)}(radius,path,line.end,line.start,nextLine.end)}})),path}let jumppedLines,skippedPoints;const jumpover=function(sourcePoint,targetPoint,routePoints,options={}){jumppedLines=[],skippedPoints=[],function setupUpdating(view){let updateList=view.graph._jumpOverUpdateList;if(null==updateList&&(updateList=view.graph._jumpOverUpdateList=[],view.graph.on("cell:mouseup",(()=>{const list=view.graph._jumpOverUpdateList;setTimeout((()=>{for(let i=0;i<list.length;i+=1)list[i].update()}))})),view.graph.on("model:reseted",(()=>{updateList=view.graph._jumpOverUpdateList=[]}))),updateList.indexOf(view)<0){updateList.push(view);const clean=()=>updateList.splice(updateList.indexOf(view),1);view.cell.once("change:connector",clean),view.cell.once("removed",clean)}}(this);const jumpSize=options.size||5,jumpType=options.type||"arc",radius=options.radius||0,ignoreConnectors=options.ignoreConnectors||["smooth"],graph=this.graph,allLinks=graph.model.getEdges();if(1===allLinks.length)return buildPath(createLines(sourcePoint,targetPoint,routePoints),jumpSize,jumpType,radius);const edge=this.cell,thisIndex=allLinks.indexOf(edge),defaultConnector=graph.options.connecting.connector||{},edges=allLinks.filter(((link,idx)=>{const connector=link.getConnector()||defaultConnector;return!ignoreConnectors.includes(connector.name)&&(!(idx>thisIndex)||"jumpover"!==connector.name)})),linkViews=edges.map((edge=>graph.findViewByCell(edge))),thisLines=createLines(sourcePoint,targetPoint,routePoints),linkLines=linkViews.map((linkView=>null==linkView?[]:linkView===this?thisLines:createLines(linkView.sourcePoint,linkView.targetPoint,linkView.routePoints))),jumpingLines=[];thisLines.forEach((line=>{const intersections=edges.reduce(((memo,link,i)=>{if(link!==edge){const lineIntersections=function findLineIntersections(line,crossCheckLines){const intersections=[];return crossCheckLines.forEach((crossCheckLine=>{const intersection=line.intersectsWithLine(crossCheckLine);intersection&&intersections.push(intersection)})),intersections}(line,linkLines[i]);memo.push(...lineIntersections)}return memo}),[]).sort(((a,b)=>getDistence(line.start,a)-getDistence(line.start,b)));intersections.length>0?jumpingLines.push(...function createJumps(line,intersections,jumpSize){return intersections.reduce(((memo,point,idx)=>{if(skippedPoints.includes(point))return memo;const lastLine=memo.pop()||line,jumpStart=Point.create(point).move(lastLine.start,-jumpSize);let jumpEnd=Point.create(point).move(lastLine.start,+jumpSize);const nextPoint=intersections[idx+1];if(null!=nextPoint){const distance=jumpEnd.distance(nextPoint);distance<=jumpSize&&(jumpEnd=nextPoint.move(lastLine.start,distance),skippedPoints.push(nextPoint))}else if(jumpStart.distance(lastLine.end)<2*jumpSize+1)return memo.push(lastLine),memo;if(jumpEnd.distance(lastLine.start)<2*jumpSize+1)return memo.push(lastLine),memo;const jumpLine=new Line(jumpStart,jumpEnd);return jumppedLines.push(jumpLine),memo.push(new Line(lastLine.start,jumpStart),jumpLine,new Line(jumpEnd,lastLine.end)),memo}),[])}(line,intersections,jumpSize)):jumpingLines.push(line)}));const path=buildPath(jumpingLines,jumpSize,jumpType,radius);return jumppedLines=[],skippedPoints=[],options.raw?path:path.serialize()};var Connector;!function(Connector){Connector.presets=connector_main_namespaceObject,Connector.registry=Registry.create({type:"connector"}),Connector.registry.register(Connector.presets,!0)}(Connector||(Connector={}));var store_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class store_Store extends basecoat_Basecoat{constructor(data={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(lodash_es_cloneDeep(data)),this.changed={}}mutate(data,options={}){const unset=!0===options.unset,silent=!0===options.silent,changes=[],changing=this.changing;this.changing=!0,changing||(this.previous=lodash_es_cloneDeep(this.data),this.changed={});const current=this.data,previous=this.previous,changed=this.changed;if(Object.keys(data).forEach((k=>{const key=k,newValue=data[key];lodash_es_isEqual(current[key],newValue)||changes.push(key),lodash_es_isEqual(previous[key],newValue)?delete changed[key]:changed[key]=newValue,unset?delete current[key]:current[key]=newValue})),!silent&&changes.length>0&&(this.pending=!0,this.pendingOptions=options,changes.forEach((key=>{this.emit("change:*",{key,options,store:this,current:current[key],previous:previous[key]})}))),changing)return this;if(!silent)for(;this.pending;)this.pending=!1,this.emit("changed",{current,previous,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(key,defaultValue){if(null==key)return this.data;const ret=this.data[key];return null==ret?defaultValue:ret}getPrevious(key){if(this.previous){const ret=this.previous[key];return null==ret?void 0:ret}}set(key,value,options){return null!=key&&("object"==typeof key?this.mutate(key,value):this.mutate({[key]:value},options)),this}remove(key,options){const subset={};let opts;if("string"==typeof key)subset[key]=undefined,opts=options;else if(Array.isArray(key))key.forEach((k=>subset[k]=undefined)),opts=options;else{for(const key in this.data)subset[key]=undefined;opts=key}return this.mutate(subset,Object.assign(Object.assign({},opts),{unset:!0})),this}getByPath(path){return getByPath(this.data,path,"/")}setByPath(path,value,options={}){const pathArray=Array.isArray(path)?[...path]:path.split("/"),pathString=Array.isArray(path)?path.join("/"):path,property=pathArray[0],pathArrayLength=pathArray.length;if(options.propertyPath=pathString,options.propertyValue=value,options.propertyPathArray=pathArray,1===pathArrayLength)this.set(property,value,options);else{const update={};let diver=update,nextKey=property;for(let i=1;i<pathArrayLength;i+=1){const key=pathArray[i],isArrayIndex=Number.isFinite(Number(key));diver=diver[nextKey]=isArrayIndex?[]:{},nextKey=key}setByPath(update,pathArray,value,"/");const data=lodash_es_cloneDeep(this.data);options.rewrite&&unsetByPath(data,path,"/");const merged=lodash_es_merge(data,update);this.set(property,merged[property],options)}return this}removeByPath(path,options){const keys=Array.isArray(path)?path:path.split("/"),key=keys[0];if(1===keys.length)this.remove(key,options);else{const paths=keys.slice(1),prop=lodash_es_cloneDeep(this.get(key));prop&&unsetByPath(prop,paths),this.set(key,prop,options)}return this}hasChanged(key){return null==key?Object.keys(this.changed).length>0:key in this.changed}getChanges(diff){if(null==diff)return this.hasChanged()?lodash_es_cloneDeep(this.changed):null;const old=this.changing?this.previous:this.data,changed={};let hasChanged;for(const key in diff){const val=diff[key];lodash_es_isEqual(old[key],val)||(changed[key]=val,hasChanged=!0)}return hasChanged?lodash_es_cloneDeep(changed):null}toJSON(){return lodash_es_cloneDeep(this.data)}clone(){return new(0,this.constructor)(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}store_decorate([basecoat_Basecoat.dispose()],store_Store.prototype,"dispose",null);class Animation{constructor(cell){this.cell=cell,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(path,targetValue,options={},delim="/"){const startValue=this.cell.getPropByPath(path),localOptions=lodash_es_defaults(options,Animation.defaultOptions),timing=this.getTiming(localOptions.timing),interpolate=this.getInterp(localOptions.interp,startValue,targetValue);let startTime=0;const key=Array.isArray(path)?path.join(delim):path,paths=Array.isArray(path)?path:path.split(delim),iterate=()=>{const now=(new Date).getTime();0===startTime&&(startTime=now);let progress=(now-startTime)/localOptions.duration;progress<1?this.ids[key]=requestAnimationFrame(iterate):progress=1;const currentValue=interpolate(timing(progress));this.cell.setPropByPath(paths,currentValue),options.progress&&options.progress(Object.assign({progress,currentValue},this.getArgs(key))),1===progress&&(this.cell.notify("transition:complete",this.getArgs(key)),options.complete&&options.complete(this.getArgs(key)),this.cell.notify("transition:finish",this.getArgs(key)),options.finish&&options.finish(this.getArgs(key)),this.clean(key))};return setTimeout((()=>{this.stop(path,void 0,delim),this.cache[key]={startValue,targetValue,options:localOptions},this.ids[key]=requestAnimationFrame(iterate),this.cell.notify("transition:start",this.getArgs(key)),options.start&&options.start(this.getArgs(key))}),options.delay),this.stop.bind(this,path,delim,options)}stop(path,options={},delim="/"){const paths=Array.isArray(path)?path:path.split(delim);return Object.keys(this.ids).filter((key=>lodash_es_isEqual(paths,key.split(delim).slice(0,paths.length)))).forEach((key=>{cancelAnimationFrame(this.ids[key]);const data=this.cache[key],commonArgs=this.getArgs(key),localOptions=Object.assign(Object.assign({},data.options),options),jumpedToEnd=localOptions.jumpedToEnd;jumpedToEnd&&null!=data.targetValue&&(this.cell.setPropByPath(key,data.targetValue),this.cell.notify("transition:end",Object.assign({},commonArgs)),this.cell.notify("transition:complete",Object.assign({},commonArgs)),localOptions.complete&&localOptions.complete(Object.assign({},commonArgs)));const stopArgs=Object.assign({jumpedToEnd},commonArgs);this.cell.notify("transition:stop",Object.assign({},stopArgs)),localOptions.stop&&localOptions.stop(Object.assign({},stopArgs)),this.cell.notify("transition:finish",Object.assign({},commonArgs)),localOptions.finish&&localOptions.finish(Object.assign({},commonArgs)),this.clean(key)})),this}clean(key){delete this.ids[key],delete this.cache[key]}getTiming(timing){return"string"==typeof timing?Timing[timing]:timing}getInterp(interp,startValue,targetValue){return interp?interp(startValue,targetValue):"number"==typeof targetValue?Interp.number(startValue,targetValue):"string"==typeof targetValue?"#"===targetValue[0]?Interp.color(startValue,targetValue):Interp.unit(startValue,targetValue):Interp.object(startValue,targetValue)}getArgs(key){const data=this.cache[key];return{path:key,startValue:data.startValue,targetValue:data.targetValue,cell:this.cell}}}!function(Animation){Animation.defaultOptions={delay:10,duration:100,timing:"linear"}}(Animation||(Animation={}));var ShareRegistry,model_cell_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},model_cell_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class Cell extends basecoat_Basecoat{static config(presets){const{markup,propHooks,attrHooks}=presets,others=model_cell_rest(presets,["markup","propHooks","attrHooks"]);null!=markup&&(this.markup=markup),propHooks&&(this.propHooks=this.propHooks.slice(),Array.isArray(propHooks)?this.propHooks.push(...propHooks):"function"==typeof propHooks?this.propHooks.push(propHooks):Object.values(propHooks).forEach((hook=>{"function"==typeof hook&&this.propHooks.push(hook)}))),attrHooks&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),attrHooks)),this.defaults=lodash_es_merge({},this.defaults,others)}static getMarkup(){return this.markup}static getDefaults(raw){return raw?this.defaults:lodash_es_cloneDeep(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(cell,metadata){return this.propHooks.reduce(((memo,hook)=>hook?call(hook,cell,memo):memo),metadata)}get[Symbol.toStringTag](){return Cell.toStringTag}constructor(metadata={}){super();const defaults=this.constructor.getDefaults(!0),props=lodash_es_merge({},this.preprocess(defaults),this.preprocess(metadata));this.id=props.id||uuid(),this.store=new store_Store(props),this.animation=new Animation(this),this.setup(),this.init(),this.postprocess(metadata)}init(){}get model(){return this._model}set model(model){this._model!==model&&(this._model=model)}preprocess(metadata,ignoreIdCheck){const id=metadata.id,props=this.constructor.applyPropHooks(this,metadata);return null==id&&!0!==ignoreIdCheck&&(props.id=uuid()),props}postprocess(metadata){}setup(){this.store.on("change:*",(metadata=>{const{key,current,previous,options}=metadata;this.notify("change:*",{key,options,current,previous,cell:this}),this.notify(`change:${key}`,{options,current,previous,cell:this});const type=key;"source"!==type&&"target"!==type||this.notify("change:terminal",{type,current,previous,options,cell:this})})),this.store.on("changed",(({options})=>this.notify("changed",{options,cell:this})))}notify(name,args){this.trigger(name,args);const model=this.model;return model&&(model.notify(`cell:${name}`,args),this.isNode()?model.notify(`node:${name}`,Object.assign(Object.assign({},args),{node:this})):this.isEdge()&&model.notify(`edge:${name}`,Object.assign(Object.assign({},args),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(cell){return this.store===cell.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(key,defaultValue){return null==key?this.store.get():this.store.get(key,defaultValue)}setProp(key,value,options){if("string"==typeof key)this.store.set(key,value,options);else{const props=this.preprocess(key,!0);this.store.set(lodash_es_merge({},this.getProp(),props),value),this.postprocess(key)}return this}removeProp(key,options){return"string"==typeof key||Array.isArray(key)?this.store.removeByPath(key,options):this.store.remove(options),this}hasChanged(key){return null==key?this.store.hasChanged():this.store.hasChanged(key)}getPropByPath(path){return this.store.getByPath(path)}setPropByPath(path,value,options={}){return this.model&&("children"===path?this._children=value?value.map((id=>this.model.getCell(id))).filter((child=>null!=child)):null:"parent"===path&&(this._parent=value?this.model.getCell(value):null)),this.store.setByPath(path,value,options),this}removePropByPath(path,options={}){const paths=Array.isArray(path)?path:path.split("/");return"attrs"===paths[0]&&(options.dirty=!0),this.store.removeByPath(paths,options),this}prop(key,value,options){return null==key?this.getProp():"string"==typeof key||Array.isArray(key)?1===arguments.length?this.getPropByPath(key):null==value?this.removePropByPath(key,options||{}):this.setPropByPath(key,value,options||{}):this.setProp(key,value||{})}previous(name){return this.store.getPrevious(name)}get zIndex(){return this.getZIndex()}set zIndex(z){null==z?this.removeZIndex():this.setZIndex(z)}getZIndex(){return this.store.get("zIndex")}setZIndex(z,options={}){return this.store.set("zIndex",z,options),this}removeZIndex(options={}){return this.store.remove("zIndex",options),this}toFront(options={}){const model=this.model;if(model){let cells,z=model.getMaxZIndex();options.deep?(cells=this.getDescendants({deep:!0,breadthFirst:!0}),cells.unshift(this)):cells=[this],z=z-cells.length+1;const count=model.total();let changed=model.indexOf(this)!==count-cells.length;changed||(changed=cells.some(((cell,index)=>cell.getZIndex()!==z+index))),changed&&this.batchUpdate("to-front",(()=>{z+=cells.length,cells.forEach(((cell,index)=>{cell.setZIndex(z+index,options)}))}))}return this}toBack(options={}){const model=this.model;if(model){let cells,z=model.getMinZIndex();options.deep?(cells=this.getDescendants({deep:!0,breadthFirst:!0}),cells.unshift(this)):cells=[this];let changed=0!==model.indexOf(this);changed||(changed=cells.some(((cell,index)=>cell.getZIndex()!==z+index))),changed&&this.batchUpdate("to-back",(()=>{z-=cells.length,cells.forEach(((cell,index)=>{cell.setZIndex(z+index,options)}))}))}return this}get markup(){return this.getMarkup()}set markup(value){null==value?this.removeMarkup():this.setMarkup(value)}getMarkup(){let markup=this.store.get("markup");if(null==markup){markup=this.constructor.getMarkup()}return markup}setMarkup(markup,options={}){return this.store.set("markup",markup,options),this}removeMarkup(options={}){return this.store.remove("markup",options),this}get attrs(){return this.getAttrs()}set attrs(value){null==value?this.removeAttrs():this.setAttrs(value)}getAttrs(){const result=this.store.get("attrs");return result?Object.assign({},result):{}}setAttrs(attrs,options={}){if(null==attrs)this.removeAttrs(options);else{const set=attrs=>this.store.set("attrs",attrs,options);if(!0===options.overwrite)set(attrs);else{const prev=this.getAttrs();!1===options.deep?set(Object.assign(Object.assign({},prev),attrs)):set(lodash_es_merge({},prev,attrs))}}return this}replaceAttrs(attrs,options={}){return this.setAttrs(attrs,Object.assign(Object.assign({},options),{overwrite:!0}))}updateAttrs(attrs,options={}){return this.setAttrs(attrs,Object.assign(Object.assign({},options),{deep:!1}))}removeAttrs(options={}){return this.store.remove("attrs",options),this}getAttrDefinition(attrName){if(!attrName)return null;const hooks=this.constructor.getAttrHooks()||{};let definition=hooks[attrName]||Attr.registry.get(attrName);if(!definition){const name=lodash_es_camelCase(attrName);definition=hooks[name]||Attr.registry.get(name)}return definition||null}getAttrByPath(path){return null==path||""===path?this.getAttrs():this.getPropByPath(this.prefixAttrPath(path))}setAttrByPath(path,value,options={}){return this.setPropByPath(this.prefixAttrPath(path),value,options),this}removeAttrByPath(path,options={}){return this.removePropByPath(this.prefixAttrPath(path),options),this}prefixAttrPath(path){return Array.isArray(path)?["attrs"].concat(path):`attrs/${path}`}attr(path,value,options){return null==path?this.getAttrByPath():"string"==typeof path||Array.isArray(path)?1===arguments.length?this.getAttrByPath(path):null==value?this.removeAttrByPath(path,options||{}):this.setAttrByPath(path,value,options||{}):this.setAttrs(path,value||{})}get visible(){return this.isVisible()}set visible(value){this.setVisible(value)}setVisible(visible,options={}){return this.store.set("visible",visible,options),this}isVisible(){return!1!==this.store.get("visible")}show(options={}){return this.isVisible()||this.setVisible(!0,options),this}hide(options={}){return this.isVisible()&&this.setVisible(!1,options),this}toggleVisible(isVisible,options={}){const localOptions="boolean"==typeof isVisible?options:isVisible;return("boolean"==typeof isVisible?isVisible:!this.isVisible())?this.show(localOptions):this.hide(localOptions),this}get data(){return this.getData()}set data(val){this.setData(val)}getData(){return this.store.get("data")}setData(data,options={}){if(null==data)this.removeData(options);else{const set=data=>this.store.set("data",data,options);if(!0===options.overwrite)set(data);else{const prev=this.getData();!1===options.deep?set("object"==typeof data?Object.assign(Object.assign({},prev),data):data):set(lodash_es_merge({},prev,data))}}return this}replaceData(data,options={}){return this.setData(data,Object.assign(Object.assign({},options),{overwrite:!0}))}updateData(data,options={}){return this.setData(data,Object.assign(Object.assign({},options),{deep:!1}))}removeData(options={}){return this.store.remove("data",options),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const parentId=this.getParentId();if(parentId&&this.model){const parent=this.model.getCell(parentId);return this._parent=parent,parent}return null}getChildren(){const childrenIds=this.store.get("children");if(childrenIds&&childrenIds.length&&this.model){const children=childrenIds.map((id=>{var _a;return null===(_a=this.model)||void 0===_a?void 0:_a.getCell(id)})).filter((cell=>null!=cell));return this._children=children,[...children]}return null}hasParent(){return null!=this.parent}isParentOf(child){return null!=child&&child.getParent()===this}isChildOf(parent){return null!=parent&&this.getParent()===parent}eachChild(iterator,context){return this.children&&this.children.forEach(iterator,context),this}filterChild(filter,context){return this.children?this.children.filter(filter,context):[]}getChildCount(){return null==this.children?0:this.children.length}getChildIndex(child){return null==this.children?-1:this.children.indexOf(child)}getChildAt(index){return null!=this.children&&index>=0?this.children[index]:null}getAncestors(options={}){const ancestors=[];let parent=this.getParent();for(;parent;)ancestors.push(parent),parent=!1!==options.deep?parent.getParent():null;return ancestors}getDescendants(options={}){if(!1!==options.deep){if(options.breadthFirst){const cells=[],queue=this.getChildren()||[];for(;queue.length>0;){const parent=queue.shift(),children=parent.getChildren();cells.push(parent),children&&queue.push(...children)}return cells}{const cells=this.getChildren()||[];return cells.forEach((cell=>{cells.push(...cell.getDescendants(options))})),cells}}return this.getChildren()||[]}isDescendantOf(ancestor,options={}){if(null==ancestor)return!1;if(!1!==options.deep){let current=this.getParent();for(;current;){if(current===ancestor)return!0;current=current.getParent()}return!1}return this.isChildOf(ancestor)}isAncestorOf(descendant,options={}){return null!=descendant&&descendant.isDescendantOf(this,options)}contains(cell){return this.isAncestorOf(cell)}getCommonAncestor(...cells){return Cell.getCommonAncestor(this,...cells)}setParent(parent,options={}){return this._parent=parent,parent?this.store.set("parent",parent.id,options):this.store.remove("parent",options),this}setChildren(children,options={}){return this._children=children,null!=children?this.store.set("children",children.map((child=>child.id)),options):this.store.remove("children",options),this}unembed(child,options={}){const children=this.children;if(null!=children&&null!=child){const index=this.getChildIndex(child);-1!==index&&(children.splice(index,1),child.setParent(null,options),this.setChildren(children,options))}return this}embed(child,options={}){return child.addTo(this,options),this}addTo(target,options={}){return Cell.isCell(target)?target.addChild(this,options):target.addCell(this,options),this}insertTo(parent,index,options={}){return parent.insertChild(this,index,options),this}addChild(child,options={}){return this.insertChild(child,void 0,options)}insertChild(child,index,options={}){if(null!=child&&child!==this){const oldParent=child.getParent(),changed=this!==oldParent;let pos=index;if(null==pos&&(pos=this.getChildCount(),changed||(pos-=1)),oldParent){const children=oldParent.getChildren();if(children){const index=children.indexOf(child);index>=0&&(child.setParent(null,options),children.splice(index,1),oldParent.setChildren(children,options))}}let children=this.children;if(null==children?(children=[],children.push(child)):children.splice(pos,0,child),child.setParent(this,options),this.setChildren(children,options),changed&&this.model){const incomings=this.model.getIncomingEdges(this),outgoings=this.model.getOutgoingEdges(this);incomings&&incomings.forEach((edge=>edge.updateParent(options))),outgoings&&outgoings.forEach((edge=>edge.updateParent(options)))}this.model&&this.model.addCell(child,options)}return this}removeFromParent(options={}){const parent=this.getParent();if(null!=parent){const index=parent.getChildIndex(this);parent.removeChildAt(index,options)}return this}removeChild(child,options={}){const index=this.getChildIndex(child);return this.removeChildAt(index,options)}removeChildAt(index,options={}){const child=this.getChildAt(index);return null!=this.children&&null!=child&&(this.unembed(child,options),child.remove(options)),child}remove(options={}){return this.batchUpdate("remove",(()=>{const parent=this.getParent();parent&&parent.removeChild(this,options),!1!==options.deep&&this.eachChild((child=>child.remove(options))),this.model&&this.model.removeCell(this,options)})),this}transition(path,target,options={},delim="/"){return this.animation.start(path,target,options,delim)}stopTransition(path,options,delim="/"){return this.animation.stop(path,options,delim),this}getTransitions(){return this.animation.get()}translate(tx,ty,options){return this}scale(sx,sy,origin,options){return this}addTools(items,obj,options){const toolItems=Array.isArray(items)?items:[items],name="string"==typeof obj?obj:null,config="object"==typeof obj?obj:"object"==typeof options?options:{};if(config.reset)return this.setTools({name,items:toolItems,local:config.local},config);let tools=lodash_es_cloneDeep(this.getTools());return null==tools||null==name||tools.name===name?(null==tools&&(tools={}),tools.items||(tools.items=[]),tools.name=name,tools.items=[...tools.items,...toolItems],this.setTools(Object.assign({},tools),config)):void 0}setTools(tools,options={}){return null==tools?this.removeTools():this.store.set("tools",Cell.normalizeTools(tools),options),this}getTools(){return this.store.get("tools")}removeTools(options={}){return this.store.remove("tools",options),this}hasTools(name){const tools=this.getTools();return null!=tools&&(null==name||tools.name===name)}hasTool(name){const tools=this.getTools();return null!=tools&&tools.items.some((item=>"string"==typeof item?item===name:item.name===name))}removeTool(nameOrIndex,options={}){const tools=lodash_es_cloneDeep(this.getTools());if(tools){let updated=!1;const items=tools.items.slice(),remove=index=>{items.splice(index,1),updated=!0};if("number"==typeof nameOrIndex)remove(nameOrIndex);else for(let i=items.length-1;i>=0;i-=1){const item=items[i];("string"==typeof item?item===nameOrIndex:item.name===nameOrIndex)&&remove(i)}updated&&(tools.items=items,this.setTools(tools,options))}return this}getBBox(options){return new Rectangle}getConnectionPoint(edge,type){return new Point}toJSON(options={}){const props=Object.assign({},this.store.get()),toString=Object.prototype.toString,cellType=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!props.shape){const ctor=this.constructor;throw new Error(`Unable to serialize ${cellType} missing "shape" prop, check the ${cellType} "${ctor.name||toString.call(ctor)}"`)}const ctor=this.constructor,diff=!0===options.diff,attrs=props.attrs||{},presets=ctor.getDefaults(!0),defaults=diff?this.preprocess(presets,!0):presets,defaultAttrs=defaults.attrs||{},finalAttrs={};Object.entries(props).forEach((([key,val])=>{if(null!=val&&!Array.isArray(val)&&"object"==typeof val&&!lodash_es_isPlainObject(val))throw new Error(`Can only serialize ${cellType} with plain-object props, but got a "${toString.call(val)}" type of key "${key}" on ${cellType} "${this.id}"`);if("attrs"!==key&&"shape"!==key&&diff){const preset=defaults[key];lodash_es_isEqual(val,preset)&&delete props[key]}})),Object.keys(attrs).forEach((key=>{const attr=attrs[key],defaultAttr=defaultAttrs[key];Object.keys(attr).forEach((name=>{const value=attr[name],defaultValue=defaultAttr?defaultAttr[name]:null;null==value||"object"!=typeof value||Array.isArray(value)?null!=defaultAttr&&lodash_es_isEqual(defaultValue,value)||(null==finalAttrs[key]&&(finalAttrs[key]={}),finalAttrs[key][name]=value):Object.keys(value).forEach((subName=>{const subValue=value[subName];if(null==defaultAttr||null==defaultValue||!lodash_es_isObject(defaultValue)||!lodash_es_isEqual(defaultValue[subName],subValue)){null==finalAttrs[key]&&(finalAttrs[key]={}),null==finalAttrs[key][name]&&(finalAttrs[key][name]={});finalAttrs[key][name][subName]=subValue}}))}))}));const finalProps=Object.assign(Object.assign({},props),{attrs:lodash_es_isEmpty(finalAttrs)?void 0:finalAttrs});null==finalProps.attrs&&delete finalProps.attrs;const ret=finalProps;return 0===ret.angle&&delete ret.angle,lodash_es_cloneDeep(ret)}clone(options={}){if(!options.deep){const data=Object.assign({},this.store.get());options.keepId||delete data.id,delete data.parent,delete data.children;return new(0,this.constructor)(data)}return Cell.deepClone(this)[this.id]}findView(graph){return graph.findViewByCell(this)}startBatch(name,data={},model=this.model){return this.notify("batch:start",{name,data,cell:this}),model&&model.startBatch(name,Object.assign(Object.assign({},data),{cell:this})),this}stopBatch(name,data={},model=this.model){return model&&model.stopBatch(name,Object.assign(Object.assign({},data),{cell:this})),this.notify("batch:stop",{name,data,cell:this}),this}batchUpdate(name,execute,data){const model=this.model;this.startBatch(name,data,model);const result=execute();return this.stopBatch(name,data,model),result}dispose(){this.removeFromParent(),this.store.dispose()}}Cell.defaults={},Cell.attrHooks={},Cell.propHooks=[],model_cell_decorate([basecoat_Basecoat.dispose()],Cell.prototype,"dispose",null),function(Cell){Cell.normalizeTools=function normalizeTools(raw){return"string"==typeof raw?{items:[raw]}:Array.isArray(raw)?{items:raw}:raw.items?raw:{items:[raw]}}}(Cell||(Cell={})),function(Cell){Cell.toStringTag=`X6.${Cell.name}`,Cell.isCell=function isCell(instance){if(null==instance)return!1;if(instance instanceof Cell)return!0;const tag=instance[Symbol.toStringTag],cell=instance;return(null==tag||tag===Cell.toStringTag)&&"function"==typeof cell.isNode&&"function"==typeof cell.isEdge&&"function"==typeof cell.prop&&"function"==typeof cell.attr}}(Cell||(Cell={})),function(Cell){Cell.getCommonAncestor=function getCommonAncestor(...cells){const ancestors=cells.filter((cell=>null!=cell)).map((cell=>cell.getAncestors())).sort(((a,b)=>a.length-b.length));return ancestors.shift().find((cell=>ancestors.every((item=>item.includes(cell)))))||null},Cell.getCellsBBox=function getCellsBBox(cells,options={}){let bbox=null;for(let i=0,ii=cells.length;i<ii;i+=1){const cell=cells[i];let rect=cell.getBBox(options);if(rect){if(cell.isNode()){const angle=cell.getAngle();null!=angle&&0!==angle&&(rect=rect.bbox(angle))}bbox=null==bbox?rect:bbox.union(rect)}}return bbox},Cell.deepClone=function deepClone(cell){const cells=[cell,...cell.getDescendants({deep:!0})];return Cell.cloneCells(cells)},Cell.cloneCells=function cloneCells(cells){const inputs=lodash_es_uniq(cells),cloneMap=inputs.reduce(((map,cell)=>(map[cell.id]=cell.clone(),map)),{});return inputs.forEach((cell=>{const clone=cloneMap[cell.id];if(clone.isEdge()){const sourceId=clone.getSourceCellId(),targetId=clone.getTargetCellId();sourceId&&cloneMap[sourceId]&&clone.setSource(Object.assign(Object.assign({},clone.getSource()),{cell:cloneMap[sourceId].id})),targetId&&cloneMap[targetId]&&clone.setTarget(Object.assign(Object.assign({},clone.getTarget()),{cell:cloneMap[targetId].id}))}const parent=cell.getParent();parent&&cloneMap[parent.id]&&clone.setParent(cloneMap[parent.id]);const children=cell.getChildren();if(children&&children.length){const embeds=children.reduce(((memo,child)=>(cloneMap[child.id]&&memo.push(cloneMap[child.id]),memo)),[]);embeds.length>0&&clone.setChildren(embeds)}})),cloneMap}}(Cell||(Cell={})),function(Cell){Cell.config({propHooks(_a){var{tools}=_a,metadata=model_cell_rest(_a,["tools"]);return tools&&(metadata.tools=Cell.normalizeTools(tools)),metadata}})}(Cell||(Cell={})),function(ShareRegistry){let edgeRegistry,nodeRegistry;ShareRegistry.exist=function exist(name,isNode){return isNode?null!=edgeRegistry&&edgeRegistry.exist(name):null!=nodeRegistry&&nodeRegistry.exist(name)},ShareRegistry.setEdgeRegistry=function setEdgeRegistry(registry){edgeRegistry=registry},ShareRegistry.setNodeRegistry=function setNodeRegistry(registry){nodeRegistry=registry}}(ShareRegistry||(ShareRegistry={}));class PortManager{constructor(data){this.ports=[],this.groups={},this.init(lodash_es_cloneDeep(data))}getPorts(){return this.ports}getGroup(groupName){return null!=groupName?this.groups[groupName]:null}getPortsByGroup(groupName){return this.ports.filter((p=>p.group===groupName||null==p.group&&null==groupName))}getPortsLayoutByGroup(groupName,elemBBox){const ports=this.getPortsByGroup(groupName),group=groupName?this.getGroup(groupName):null,groupPosition=group?group.position:null,groupPositionName=groupPosition?groupPosition.name:null;let layoutFn;if(null!=groupPositionName){const fn=PortLayout.registry.get(groupPositionName);if(null==fn)return PortLayout.registry.onNotFound(groupPositionName);layoutFn=fn}else layoutFn=PortLayout.presets.left;const portsArgs=ports.map((port=>port&&port.position&&port.position.args||{})),groupArgs=groupPosition&&groupPosition.args||{};return layoutFn(portsArgs,elemBBox,groupArgs).map(((portLayout,index)=>{const port=ports[index];return{portLayout,portId:port.id,portSize:port.size,portAttrs:port.attrs,labelSize:port.label.size,labelLayout:this.getPortLabelLayout(port,Point.create(portLayout.position),elemBBox)}}))}init(data){const{groups,items}=data;null!=groups&&Object.keys(groups).forEach((key=>{this.groups[key]=this.parseGroup(groups[key])})),Array.isArray(items)&&items.forEach((item=>{this.ports.push(this.parsePort(item))}))}parseGroup(group){return Object.assign(Object.assign({},group),{label:this.getLabel(group,!0),position:this.getPortPosition(group.position,!0)})}parsePort(port){const result=Object.assign({},port),group=this.getGroup(port.group)||{};return result.markup=result.markup||group.markup,result.attrs=lodash_es_merge({},group.attrs,result.attrs),result.position=this.createPosition(group,result),result.label=lodash_es_merge({},group.label,this.getLabel(result)),result.zIndex=this.getZIndex(group,result),result.size=Object.assign(Object.assign({},group.size),result.size),result}getZIndex(group,port){return"number"==typeof port.zIndex?port.zIndex:"number"==typeof group.zIndex||"auto"===group.zIndex?group.zIndex:"auto"}createPosition(group,port){return lodash_es_merge({name:"left",args:{}},group.position,{args:port.args})}getPortPosition(position,setDefault=!1){if(null==position){if(setDefault)return{name:"left",args:{}}}else{if("string"==typeof position)return{name:position,args:{}};if(Array.isArray(position))return{name:"absolute",args:{x:position[0],y:position[1]}};if("object"==typeof position)return position}return{args:{}}}getPortLabelPosition(position,setDefault=!1){if(null==position){if(setDefault)return{name:"left",args:{}}}else{if("string"==typeof position)return{name:position,args:{}};if("object"==typeof position)return position}return{args:{}}}getLabel(item,setDefaults=!1){const label=item.label||{};return label.position=this.getPortLabelPosition(label.position,setDefaults),label}getPortLabelLayout(port,portPosition,elemBBox){const name=port.label.position.name||"left",args=port.label.position.args||{},layoutFn=PortLabelLayout.registry.get(name)||PortLabelLayout.presets.left;return layoutFn?layoutFn(portPosition,elemBBox,args):null}}var node_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class Node extends Cell{get[Symbol.toStringTag](){return Node.toStringTag}constructor(metadata={}){super(metadata),this.initPorts()}preprocess(metadata,ignoreIdCheck){const{x,y,width,height}=metadata,others=node_rest(metadata,["x","y","width","height"]);if(null!=x||null!=y){const position=others.position;others.position=Object.assign(Object.assign({},position),{x:null!=x?x:position?position.x:0,y:null!=y?y:position?position.y:0})}if(null!=width||null!=height){const size=others.size;others.size=Object.assign(Object.assign({},size),{width:null!=width?width:size?size.width:0,height:null!=height?height:size?size.height:0})}return super.preprocess(others,ignoreIdCheck)}isNode(){return!0}size(width,height,options){return void 0===width?this.getSize():"number"==typeof width?this.setSize(width,height,options):this.setSize(width,height)}getSize(){const size=this.store.get("size");return size?Object.assign({},size):{width:1,height:1}}setSize(width,height,options){return"object"==typeof width?this.resize(width.width,width.height,height):this.resize(width,height,options),this}resize(width,height,options={}){this.startBatch("resize",options);const direction=options.direction;if(direction){const currentSize=this.getSize();switch(direction){case"left":case"right":height=currentSize.height;break;case"top":case"bottom":width=currentSize.width}let quadrant={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[direction];const angle=Angle.normalize(this.getAngle()||0);options.absolute&&(quadrant+=Math.floor((angle+45)/90),quadrant%=4);const bbox=this.getBBox();let fixedPoint;fixedPoint=0===quadrant?bbox.getBottomLeft():1===quadrant?bbox.getCorner():2===quadrant?bbox.getTopRight():bbox.getOrigin();const imageFixedPoint=fixedPoint.clone().rotate(-angle,bbox.getCenter()),radius=Math.sqrt(width*width+height*height)/2;let alpha=quadrant*Math.PI/2;alpha+=Math.atan(quadrant%2==0?height/width:width/height),alpha-=Angle.toRad(angle);const origin=Point.fromPolar(radius,alpha,imageFixedPoint).clone().translate(width/-2,height/-2);this.store.set("size",{width,height},options),this.setPosition(origin.x,origin.y,options)}else this.store.set("size",{width,height},options);return this.stopBatch("resize",options),this}scale(sx,sy,origin,options={}){const scaledBBox=this.getBBox().scale(sx,sy,null==origin?void 0:origin);return this.startBatch("scale",options),this.setPosition(scaledBBox.x,scaledBBox.y,options),this.resize(scaledBBox.width,scaledBBox.height,options),this.stopBatch("scale"),this}position(arg0,arg1,arg2){return"number"==typeof arg0?this.setPosition(arg0,arg1,arg2):this.getPosition(arg0)}getPosition(options={}){if(options.relative){const parent=this.getParent();if(null!=parent&&parent.isNode()){const currentPosition=this.getPosition(),parentPosition=parent.getPosition();return{x:currentPosition.x-parentPosition.x,y:currentPosition.y-parentPosition.y}}}const pos=this.store.get("position");return pos?Object.assign({},pos):{x:0,y:0}}setPosition(arg0,arg1,arg2={}){let x,y,options;if("object"==typeof arg0?(x=arg0.x,y=arg0.y,options=arg1||{}):(x=arg0,y=arg1,options=arg2||{}),options.relative){const parent=this.getParent();if(null!=parent&&parent.isNode()){const parentPosition=parent.getPosition();x+=parentPosition.x,y+=parentPosition.y}}if(options.deep){const currentPosition=this.getPosition();this.translate(x-currentPosition.x,y-currentPosition.y,options)}else this.store.set("position",{x,y},options);return this}translate(tx=0,ty=0,options={}){if(0===tx&&0===ty)return this;options.translateBy=options.translateBy||this.id;const position=this.getPosition();if(null!=options.restrict&&options.translateBy===this.id){const bbox=this.getBBox({deep:!0}),ra=options.restrict,dx=position.x-bbox.x,dy=position.y-bbox.y,x=Math.max(ra.x+dx,Math.min(ra.x+ra.width+dx-bbox.width,position.x+tx)),y=Math.max(ra.y+dy,Math.min(ra.y+ra.height+dy-bbox.height,position.y+ty));tx=x-position.x,ty=y-position.y}const translatedPosition={x:position.x+tx,y:position.y+ty};return options.tx=tx,options.ty=ty,options.transition?("object"!=typeof options.transition&&(options.transition={}),this.transition("position",translatedPosition,Object.assign(Object.assign({},options.transition),{interp:Interp.object})),this.eachChild((child=>{var _a;(null===(_a=options.exclude)||void 0===_a?void 0:_a.includes(child))||child.translate(tx,ty,options)}))):(this.startBatch("translate",options),this.store.set("position",translatedPosition,options),this.eachChild((child=>{var _a;(null===(_a=options.exclude)||void 0===_a?void 0:_a.includes(child))||child.translate(tx,ty,options)})),this.stopBatch("translate",options)),this}angle(val,options){return null==val?this.getAngle():this.rotate(val,options)}getAngle(){return this.store.get("angle",0)}rotate(angle,options={}){const currentAngle=this.getAngle();if(options.center){const size=this.getSize(),position=this.getPosition(),center=this.getBBox().getCenter();center.rotate(currentAngle-angle,options.center);const dx=center.x-size.width/2-position.x,dy=center.y-size.height/2-position.y;this.startBatch("rotate",{angle,options}),this.setPosition(position.x+dx,position.y+dy,options),this.rotate(angle,Object.assign(Object.assign({},options),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",options.absolute?angle:(currentAngle+angle)%360,options);return this}getBBox(options={}){if(options.deep){const cells=this.getDescendants({deep:!0,breadthFirst:!0});return cells.push(this),Cell.getCellsBBox(cells)}return Rectangle.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(edge,type){const bbox=this.getBBox(),center=bbox.getCenter(),terminal=edge.getTerminal(type);if(null==terminal)return center;const portId=terminal.port;if(!portId||!this.hasPort(portId))return center;const port=this.getPort(portId);if(!port||!port.group)return center;const position=this.getPortsPosition(port.group)[portId].position,portCenter=Point.create(position).translate(bbox.getOrigin()),angle=this.getAngle();return angle&&portCenter.rotate(-angle,center),portCenter}fit(options={}){const embeds=(this.getChildren()||[]).filter((cell=>cell.isNode()));if(0===embeds.length)return this;this.startBatch("fit-embeds",options),options.deep&&embeds.forEach((cell=>cell.fit(options)));let{x,y,width,height}=Cell.getCellsBBox(embeds);const padding=normalizeSides(options.padding);return x-=padding.left,y-=padding.top,width+=padding.left+padding.right,height+=padding.bottom+padding.top,this.store.set({position:{x,y},size:{width,height}},options),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(markup){this.setPortContainerMarkup(markup)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||Markup.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(markup,options={}){return this.store.set("portContainerMarkup",Markup.clone(markup),options),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(markup){this.setPortMarkup(markup)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||Markup.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(markup,options={}){return this.store.set("portMarkup",Markup.clone(markup),options),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(markup){this.setPortLabelMarkup(markup)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||Markup.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(markup,options={}){return this.store.set("portLabelMarkup",Markup.clone(markup),options),this}get ports(){const res=this.store.get("ports",{items:[]});return null==res.items&&(res.items=[]),res}getPorts(){return lodash_es_cloneDeep(this.ports.items)}getPortsByGroup(groupName){return this.getPorts().filter((port=>port.group===groupName))}getPort(portId){return lodash_es_cloneDeep(this.ports.items.find((port=>port.id&&port.id===portId)))}getPortAt(index){return this.ports.items[index]||null}hasPorts(){return this.ports.items.length>0}hasPort(portId){return-1!==this.getPortIndex(portId)}getPortIndex(port){const portId="string"==typeof port?port:port.id;return null!=portId?this.ports.items.findIndex((item=>item.id===portId)):-1}getPortsPosition(groupName){const size=this.getSize();return this.port.getPortsLayoutByGroup(groupName,new Rectangle(0,0,size.width,size.height)).reduce(((memo,item)=>{const layout=item.portLayout;return memo[item.portId]={position:Object.assign({},layout.position),angle:layout.angle||0},memo}),{})}getPortProp(portId,path){return this.getPropByPath(this.prefixPortPath(portId,path))}setPortProp(portId,arg1,arg2,arg3){if("string"==typeof arg1||Array.isArray(arg1)){const path=this.prefixPortPath(portId,arg1),value=arg2;return this.setPropByPath(path,value,arg3)}const path=this.prefixPortPath(portId),value=arg1;return this.setPropByPath(path,value,arg2)}removePortProp(portId,path,options){return"string"==typeof path||Array.isArray(path)?this.removePropByPath(this.prefixPortPath(portId,path),options):this.removePropByPath(this.prefixPortPath(portId),path)}portProp(portId,path,value,options){return null==path?this.getPortProp(portId):"string"==typeof path||Array.isArray(path)?2===arguments.length?this.getPortProp(portId,path):null==value?this.removePortProp(portId,path,options):this.setPortProp(portId,path,value,options):this.setPortProp(portId,path,value)}prefixPortPath(portId,path){const index=this.getPortIndex(portId);if(-1===index)throw new Error(`Unable to find port with id: "${portId}"`);return null==path||""===path?["ports","items",`${index}`]:Array.isArray(path)?["ports","items",`${index}`,...path]:`ports/items/${index}/${path}`}addPort(port,options){const ports=[...this.ports.items];return ports.push(port),this.setPropByPath("ports/items",ports,options),this}addPorts(ports,options){return this.setPropByPath("ports/items",[...this.ports.items,...ports],options),this}insertPort(index,port,options){const ports=[...this.ports.items];return ports.splice(index,0,port),this.setPropByPath("ports/items",ports,options),this}removePort(port,options={}){return this.removePortAt(this.getPortIndex(port),options)}removePortAt(index,options={}){if(index>=0){const ports=[...this.ports.items];ports.splice(index,1),options.rewrite=!0,this.setPropByPath("ports/items",ports,options)}return this}removePorts(portsForRemoval,opt){let options;if(Array.isArray(portsForRemoval)){if(options=opt||{},portsForRemoval.length){options.rewrite=!0;const remainingPorts=[...this.ports.items].filter((cp=>!portsForRemoval.some((p=>{const id="string"==typeof p?p:p.id;return cp.id===id}))));this.setPropByPath("ports/items",remainingPorts,options)}}else options=portsForRemoval||{},options.rewrite=!0,this.setPropByPath("ports/items",[],options);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(groupName,bbox){return this.port.getPortsLayoutByGroup(groupName,bbox)}initPorts(){this.updatePortData(),this.on("change:ports",(()=>{this.processRemovedPort(),this.updatePortData()}))}processRemovedPort(){const current=this.ports,currentItemsMap={};current.items.forEach((item=>{item.id&&(currentItemsMap[item.id]=!0)}));const removed={};(this.store.getPrevious("ports")||{items:[]}).items.forEach((item=>{item.id&&!currentItemsMap[item.id]&&(removed[item.id]=!0)}));const model=this.model;if(model&&!lodash_es_isEmpty(removed)){model.getConnectedEdges(this,{incoming:!0}).forEach((edge=>{const portId=edge.getTargetPortId();portId&&removed[portId]&&edge.remove()}));model.getConnectedEdges(this,{outgoing:!0}).forEach((edge=>{const portId=edge.getSourcePortId();portId&&removed[portId]&&edge.remove()}))}}validatePorts(){const ids={},errors=[];return this.ports.items.forEach((p=>{"object"!=typeof p&&errors.push(`Invalid port ${p}.`),null==p.id&&(p.id=this.generatePortId()),ids[p.id]&&errors.push("Duplicitied port id."),ids[p.id]=!0})),errors}generatePortId(){return uuid()}updatePortData(){const err=this.validatePorts();if(err.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(err.join(" "));const prev=this.port?this.port.getPorts():null;this.port=new PortManager(this.ports);const curr=this.port.getPorts(),added=prev?curr.filter((item=>prev.find((prevPort=>prevPort.id===item.id))?null:item)):[...curr],removed=prev?prev.filter((item=>curr.find((curPort=>curPort.id===item.id))?null:item)):[];added.length>0&&this.notify("ports:added",{added,cell:this,node:this}),removed.length>0&&this.notify("ports:removed",{removed,cell:this,node:this})}}Node.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(Node){Node.toStringTag=`X6.${Node.name}`,Node.isNode=function isNode(instance){if(null==instance)return!1;if(instance instanceof Node)return!0;const tag=instance[Symbol.toStringTag],node=instance;return(null==tag||tag===Node.toStringTag)&&"function"==typeof node.isNode&&"function"==typeof node.isEdge&&"function"==typeof node.prop&&"function"==typeof node.attr&&"function"==typeof node.size&&"function"==typeof node.position}}(Node||(Node={})),function(Node){Node.config({propHooks(_a){var{ports}=_a,metadata=node_rest(_a,["ports"]);return ports&&(metadata.ports=Array.isArray(ports)?{items:ports}:ports),metadata}})}(Node||(Node={})),function(Node){Node.registry=Registry.create({type:"node",process(shape,options){if(ShareRegistry.exist(shape,!0))throw new Error(`Node with name '${shape}' was registered by anthor Edge`);if("function"==typeof options)return options.config({shape}),options;let parent=Node;const{inherit}=options,config=node_rest(options,["inherit"]);if(inherit)if("string"==typeof inherit){const base=this.get(inherit);null==base?this.onNotFound(inherit,"inherited"):parent=base}else parent=inherit;null==config.constructorName&&(config.constructorName=shape);const ctor=parent.define.call(parent,config);return ctor.config({shape}),ctor}}),ShareRegistry.setNodeRegistry(Node.registry)}(Node||(Node={})),function(Node){let counter=0;Node.define=function define(config){const{constructorName,overwrite}=config,others=node_rest(config,["constructorName","overwrite"]),ctor=createClass(function getClassName(name){return name?pascalCase(name):(counter+=1,`CustomNode${counter}`)}(constructorName||others.shape),this);return ctor.config(others),others.shape&&Node.registry.register(others.shape,ctor,overwrite),ctor},Node.create=function create(options){const shape=options.shape||"rect",Ctor=Node.registry.get(shape);return Ctor?new Ctor(options):Node.registry.onNotFound(shape)}}(Node||(Node={}));var edge_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class Edge extends Cell{get[Symbol.toStringTag](){return Edge.toStringTag}constructor(metadata={}){super(metadata)}preprocess(metadata,ignoreIdCheck){const{source,sourceCell,sourcePort,sourcePoint,target,targetCell,targetPort,targetPoint}=metadata,data=edge_rest(metadata,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),isValidId=val=>"string"==typeof val||"number"==typeof val;if(null!=source)if(Cell.isCell(source))data.source={cell:source.id};else if(isValidId(source))data.source={cell:source};else if(Point.isPoint(source))data.source=source.toJSON();else if(Array.isArray(source))data.source={x:source[0],y:source[1]};else{const cell=source.cell;Cell.isCell(cell)?data.source=Object.assign(Object.assign({},source),{cell:cell.id}):data.source=source}if(null!=sourceCell||null!=sourcePort){let terminal=data.source;if(null!=sourceCell){const id=isValidId(sourceCell)?sourceCell:sourceCell.id;terminal?terminal.cell=id:terminal=data.source={cell:id}}null!=sourcePort&&terminal&&(terminal.port=sourcePort)}else null!=sourcePoint&&(data.source=Point.create(sourcePoint).toJSON());if(null!=target)if(Cell.isCell(target))data.target={cell:target.id};else if(isValidId(target))data.target={cell:target};else if(Point.isPoint(target))data.target=target.toJSON();else if(Array.isArray(target))data.target={x:target[0],y:target[1]};else{const cell=target.cell;Cell.isCell(cell)?data.target=Object.assign(Object.assign({},target),{cell:cell.id}):data.target=target}if(null!=targetCell||null!=targetPort){let terminal=data.target;if(null!=targetCell){const id=isValidId(targetCell)?targetCell:targetCell.id;terminal?terminal.cell=id:terminal=data.target={cell:id}}null!=targetPort&&terminal&&(terminal.port=targetPort)}else null!=targetPoint&&(data.target=Point.create(targetPoint).toJSON());return super.preprocess(data,ignoreIdCheck)}setup(){super.setup(),this.on("change:labels",(args=>this.onLabelsChanged(args))),this.on("change:vertices",(args=>this.onVertexsChanged(args)))}isEdge(){return!0}disconnect(options={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},options),this}get source(){return this.getSource()}set source(data){this.setSource(data)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(source,args,options={}){return this.setTerminal("source",source,args,options)}get target(){return this.getTarget()}set target(data){this.setTarget(data)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(target,args,options={}){return this.setTerminal("target",target,args,options)}getTerminal(type){return Object.assign({},this.store.get(type))}setTerminal(type,terminal,args,options={}){if(Cell.isCell(terminal))return this.store.set(type,lodash_es_merge({},args,{cell:terminal.id}),options),this;const p=terminal;return Point.isPoint(terminal)||null!=p.x&&null!=p.y?(this.store.set(type,lodash_es_merge({},args,{x:p.x,y:p.y}),options),this):(this.store.set(type,lodash_es_cloneDeep(terminal),options),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(type){const terminal=this[type];if(Point.isPointLike(terminal))return Point.create(terminal);const cell=this.getTerminalCell(type);return cell?cell.getConnectionPoint(this,type):new Point}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(type){if(this.model){const cellId="source"===type?this.getSourceCellId():this.getTargetCellId();if(cellId)return this.model.getCell(cellId)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(type){let cell=this;const visited={};for(;cell&&cell.isEdge();){if(visited[cell.id])return null;visited[cell.id]=!0,cell=cell.getTerminalCell(type)}return cell&&cell.isNode()?cell:null}get router(){return this.getRouter()}set router(data){null==data?this.removeRouter():this.setRouter(data)}getRouter(){return this.store.get("router")}setRouter(name,args,options){return"object"==typeof name?this.store.set("router",name,args):this.store.set("router",{name,args},options),this}removeRouter(options={}){return this.store.remove("router",options),this}get connector(){return this.getConnector()}set connector(data){null==data?this.removeConnector():this.setConnector(data)}getConnector(){return this.store.get("connector")}setConnector(name,args,options){return"object"==typeof name?this.store.set("connector",name,args):this.store.set("connector",{name,args},options),this}removeConnector(options={}){return this.store.remove("connector",options)}getDefaultLabel(){const ctor=this.constructor,defaults=this.store.get("defaultLabel")||ctor.defaultLabel||{};return lodash_es_cloneDeep(defaults)}get labels(){return this.getLabels()}set labels(labels){this.setLabels(labels)}getLabels(){return[...this.store.get("labels",[])].map((item=>this.parseLabel(item)))}setLabels(labels,options={}){return this.store.set("labels",Array.isArray(labels)?labels:[labels],options),this}insertLabel(label,index,options={}){const labels=this.getLabels(),len=labels.length;let idx=null!=index&&Number.isFinite(index)?index:len;return idx<0&&(idx=len+idx+1),labels.splice(idx,0,this.parseLabel(label)),this.setLabels(labels,options)}appendLabel(label,options={}){return this.insertLabel(label,-1,options)}getLabelAt(index){const labels=this.getLabels();return null!=index&&Number.isFinite(index)?this.parseLabel(labels[index]):null}setLabelAt(index,label,options={}){if(null!=index&&Number.isFinite(index)){const labels=this.getLabels();labels[index]=this.parseLabel(label),this.setLabels(labels,options)}return this}removeLabelAt(index,options={}){const labels=this.getLabels(),idx=null!=index&&Number.isFinite(index)?index:-1,removed=labels.splice(idx,1);return this.setLabels(labels,options),removed.length?removed[0]:null}parseLabel(label){if("string"==typeof label){return this.constructor.parseStringLabel(label)}return label}onLabelsChanged({previous,current}){const added=previous&&current?current.filter((label1=>previous.find((label2=>label1===label2||lodash_es_isEqual(label1,label2)))?null:label1)):current?[...current]:[],removed=previous&&current?previous.filter((label1=>current.find((label2=>label1===label2||lodash_es_isEqual(label1,label2)))?null:label1)):previous?[...previous]:[];added.length>0&&this.notify("labels:added",{added,cell:this,edge:this}),removed.length>0&&this.notify("labels:removed",{removed,cell:this,edge:this})}get vertices(){return this.getVertices()}set vertices(vertices){this.setVertices(vertices)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(vertices,options={}){const points=Array.isArray(vertices)?vertices:[vertices];return this.store.set("vertices",points.map((p=>Point.toJSON(p))),options),this}insertVertex(vertice,index,options={}){const vertices=this.getVertices(),len=vertices.length;let idx=null!=index&&Number.isFinite(index)?index:len;return idx<0&&(idx=len+idx+1),vertices.splice(idx,0,Point.toJSON(vertice)),this.setVertices(vertices,options)}appendVertex(vertex,options={}){return this.insertVertex(vertex,-1,options)}getVertexAt(index){if(null!=index&&Number.isFinite(index)){return this.getVertices()[index]}return null}setVertexAt(index,vertice,options={}){if(null!=index&&Number.isFinite(index)){const vertices=this.getVertices();vertices[index]=vertice,this.setVertices(vertices,options)}return this}removeVertexAt(index,options={}){const vertices=this.getVertices(),idx=null!=index&&Number.isFinite(index)?index:-1;return vertices.splice(idx,1),this.setVertices(vertices,options)}onVertexsChanged({previous,current}){const added=previous&&current?current.filter((p1=>previous.find((p2=>Point.equals(p1,p2)))?null:p1)):current?[...current]:[],removed=previous&&current?previous.filter((p1=>current.find((p2=>Point.equals(p1,p2)))?null:p1)):previous?[...previous]:[];added.length>0&&this.notify("vertexs:added",{added,cell:this,edge:this}),removed.length>0&&this.notify("vertexs:removed",{removed,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||Markup.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}translate(tx,ty,options={}){return options.translateBy=options.translateBy||this.id,options.tx=tx,options.ty=ty,this.applyToPoints((p=>({x:(p.x||0)+tx,y:(p.y||0)+ty})),options)}scale(sx,sy,origin,options={}){return this.applyToPoints((p=>Point.create(p).scale(sx,sy,origin).toJSON()),options)}applyToPoints(worker,options={}){const attrs={},source=this.getSource(),target=this.getTarget();Point.isPointLike(source)&&(attrs.source=worker(source)),Point.isPointLike(target)&&(attrs.target=worker(target));const vertices=this.getVertices();return vertices.length>0&&(attrs.vertices=vertices.map(worker)),this.store.set(attrs,options),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const points=[this.getSourcePoint(),...this.getVertices().map((vertice=>Point.create(vertice))),this.getTargetPoint()];return new Polyline(points)}updateParent(options){let newParent=null;const source=this.getSourceCell(),target=this.getTargetCell(),prevParent=this.getParent();return source&&target&&(newParent=source===target||source.isDescendantOf(target)?target:target.isDescendantOf(source)?source:Cell.getCommonAncestor(source,target)),prevParent&&newParent&&newParent.id!==prevParent.id&&prevParent.unembed(this,options),!newParent||prevParent&&prevParent.id===newParent.id||newParent.embed(this,options),newParent}hasLoop(options={}){const source=this.getSource(),target=this.getTarget(),sourceId=source.cell,targetId=target.cell;if(!sourceId||!targetId)return!1;let loop=sourceId===targetId;if(!loop&&options.deep&&this._model){const sourceCell=this.getSourceCell(),targetCell=this.getTargetCell();sourceCell&&targetCell&&(loop=sourceCell.isAncestorOf(targetCell,options)||targetCell.isAncestorOf(sourceCell,options))}return loop}getFragmentAncestor(){const cells=[this,this.getSourceNode(),this.getTargetNode()].filter((item=>null!=item));return this.getCommonAncestor(...cells)}isFragmentDescendantOf(cell){const ancestor=this.getFragmentAncestor();return!!ancestor&&(ancestor.id===cell.id||ancestor.isDescendantOf(cell))}}Edge.defaults={},function(Edge){Edge.equalTerminals=function equalTerminals(a,b){const a1=a,b1=b;return a1.cell===b1.cell&&(a1.port===b1.port||null==a1.port&&null==b1.port)}}(Edge||(Edge={})),function(Edge){Edge.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},Edge.parseStringLabel=function parseStringLabel(text){return{attrs:{label:{text}}}}}(Edge||(Edge={})),function(Edge){Edge.toStringTag=`X6.${Edge.name}`,Edge.isEdge=function isEdge(instance){if(null==instance)return!1;if(instance instanceof Edge)return!0;const tag=instance[Symbol.toStringTag],edge=instance;return(null==tag||tag===Edge.toStringTag)&&"function"==typeof edge.isNode&&"function"==typeof edge.isEdge&&"function"==typeof edge.prop&&"function"==typeof edge.attr&&"function"==typeof edge.disconnect&&"function"==typeof edge.getSource&&"function"==typeof edge.getTarget}}(Edge||(Edge={})),function(Edge){Edge.registry=Registry.create({type:"edge",process(shape,options){if(ShareRegistry.exist(shape,!1))throw new Error(`Edge with name '${shape}' was registered by anthor Node`);if("function"==typeof options)return options.config({shape}),options;let parent=Edge;const{inherit="edge"}=options,others=edge_rest(options,["inherit"]);if("string"==typeof inherit){const base=this.get(inherit||"edge");null==base&&inherit?this.onNotFound(inherit,"inherited"):parent=base}else parent=inherit;null==others.constructorName&&(others.constructorName=shape);const ctor=parent.define.call(parent,others);return ctor.config({shape}),ctor}}),ShareRegistry.setEdgeRegistry(Edge.registry)}(Edge||(Edge={})),function(Edge){let counter=0;Edge.define=function define(config){const{constructorName,overwrite}=config,others=edge_rest(config,["constructorName","overwrite"]),ctor=createClass(function getClassName(name){return name?pascalCase(name):(counter+=1,`CustomEdge${counter}`)}(constructorName||others.shape),this);return ctor.config(others),others.shape&&Edge.registry.register(others.shape,ctor,overwrite),ctor},Edge.create=function create(options){const shape=options.shape||"edge",Ctor=Edge.registry.get(shape);return Ctor?new Ctor(options):Edge.registry.onNotFound(shape)}}(Edge||(Edge={})),function(Edge){Edge.config({shape:"basic.edge",propHooks(metadata){const{label,vertices}=metadata,others=edge_rest(metadata,["label","vertices"]);if(label){null==others.labels&&(others.labels=[]);const formated="string"==typeof label?Edge.parseStringLabel(label):label;others.labels.push(formated)}return vertices&&Array.isArray(vertices)&&(others.vertices=vertices.map((item=>Point.create(item).toJSON()))),others}}),Edge.registry.register("basic.edge",Edge)}(Edge||(Edge={}));var collection_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class Collection extends basecoat_Basecoat{constructor(cells,options={}){super(),this.length=0,this.comparator=options.comparator||"zIndex",this.clean(),cells&&this.reset(cells,{silent:!0})}toJSON(){return this.cells.map((cell=>cell.toJSON()))}add(cells,index,options){let localIndex,localOptions;"number"==typeof index?(localIndex=index,localOptions=Object.assign({merge:!1},options)):(localIndex=this.length,localOptions=Object.assign({merge:!1},index)),localIndex>this.length&&(localIndex=this.length),localIndex<0&&(localIndex+=this.length+1);const entities=Array.isArray(cells)?cells:[cells],sortable=this.comparator&&"number"!=typeof index&&!1!==localOptions.sort,sortAttr=this.comparator||null;let sort=!1;const added=[],merged=[];return entities.forEach((cell=>{const existing=this.get(cell);existing?localOptions.merge&&!cell.isSameStore(existing)&&(existing.setProp(cell.getProp(),options),merged.push(existing),sortable&&!sort&&(sort=null==sortAttr||"function"==typeof sortAttr?existing.hasChanged():"string"==typeof sortAttr?existing.hasChanged(sortAttr):sortAttr.some((key=>existing.hasChanged(key))))):(added.push(cell),this.reference(cell))})),added.length&&(sortable&&(sort=!0),this.cells.splice(localIndex,0,...added),this.length=this.cells.length),sort&&this.sort({silent:!0}),localOptions.silent||(added.forEach(((cell,i)=>{const args={cell,index:localIndex+i,options:localOptions};this.trigger("added",args),localOptions.dryrun||cell.notify("added",Object.assign({},args))})),sort&&this.trigger("sorted"),(added.length||merged.length)&&this.trigger("updated",{added,merged,removed:[],options:localOptions})),this}remove(cells,options={}){const arr=Array.isArray(cells)?cells:[cells],removed=this.removeCells(arr,options);return!options.silent&&removed.length>0&&this.trigger("updated",{options,removed,added:[],merged:[]}),Array.isArray(cells)?removed:removed[0]}removeCells(cells,options){const removed=[];for(let i=0;i<cells.length;i+=1){const cell=this.get(cells[i]);if(null==cell)continue;const index=this.cells.indexOf(cell);this.cells.splice(index,1),this.length-=1,delete this.map[cell.id],removed.push(cell),this.unreference(cell),options.dryrun||cell.remove(),options.silent||(this.trigger("removed",{cell,index,options}),options.dryrun||cell.notify("removed",{cell,index,options}))}return removed}reset(cells,options={}){const previous=this.cells.slice();if(previous.forEach((cell=>this.unreference(cell))),this.clean(),this.add(cells,Object.assign({silent:!0},options)),!options.silent){const current=this.cells.slice();this.trigger("reseted",{options,previous,current});const added=[],removed=[];current.forEach((a=>{previous.some((b=>b.id===a.id))||added.push(a)})),previous.forEach((a=>{current.some((b=>b.id===a.id))||removed.push(a)})),this.trigger("updated",{options,added,removed,merged:[]})}return this}push(cell,options){return this.add(cell,this.length,options)}pop(options){const cell=this.at(this.length-1);return this.remove(cell,options)}unshift(cell,options){return this.add(cell,0,options)}shift(options){const cell=this.at(0);return this.remove(cell,options)}get(cell){if(null==cell)return null;const id="string"==typeof cell||"number"==typeof cell?cell:cell.id;return this.map[id]||null}has(cell){return null!=this.get(cell)}at(index){return index<0&&(index+=this.length),this.cells[index]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(cell){return this.cells.indexOf(cell)}toArray(){return this.cells.slice()}sort(options={}){return null!=this.comparator&&(this.cells=lodash_es_sortBy(this.cells,this.comparator),options.silent||this.trigger("sorted")),this}clone(){return new(0,this.constructor)(this.cells.slice(),{comparator:this.comparator})}reference(cell){this.map[cell.id]=cell,cell.on("*",this.notifyCellEvent,this)}unreference(cell){cell.off("*",this.notifyCellEvent,this),delete this.map[cell.id]}notifyCellEvent(name,args){const cell=args.cell;this.trigger(`cell:${name}`,args),cell&&(cell.isNode()?this.trigger(`node:${name}`,Object.assign(Object.assign({},args),{node:cell})):cell.isEdge()&&this.trigger(`edge:${name}`,Object.assign(Object.assign({},args),{edge:cell})))}clean(){this.length=0,this.cells=[],this.map={}}dispose(){this.reset([])}}collection_decorate([Collection.dispose()],Collection.prototype,"dispose",null);var model_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class Model extends basecoat_Basecoat{get[Symbol.toStringTag](){return Model.toStringTag}constructor(cells=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new Collection(cells),this.setup()}notify(name,args){this.trigger(name,args);const graph=this.graph;return graph&&("sorted"===name||"reseted"===name||"updated"===name?graph.trigger(`model:${name}`,args):graph.trigger(name,args)),this}setup(){const collection=this.collection;collection.on("sorted",(()=>this.notify("sorted",null))),collection.on("updated",(args=>this.notify("updated",args))),collection.on("cell:change:zIndex",(()=>this.sortOnChangeZ())),collection.on("added",(({cell})=>{this.onCellAdded(cell)})),collection.on("removed",(args=>{const cell=args.cell;this.onCellRemoved(cell,args.options),this.notify("cell:removed",args),cell.isNode()?this.notify("node:removed",Object.assign(Object.assign({},args),{node:cell})):cell.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},args),{edge:cell}))})),collection.on("reseted",(args=>{this.onReset(args.current),this.notify("reseted",args)})),collection.on("edge:change:source",(({edge})=>this.onEdgeTerminalChanged(edge,"source"))),collection.on("edge:change:target",(({edge})=>{this.onEdgeTerminalChanged(edge,"target")}))}sortOnChangeZ(){this.collection.sort()}onCellAdded(cell){const cellId=cell.id;cell.isEdge()?(cell.updateParent(),this.edges[cellId]=!0,this.onEdgeTerminalChanged(cell,"source"),this.onEdgeTerminalChanged(cell,"target")):this.nodes[cellId]=!0}onCellRemoved(cell,options){const cellId=cell.id;if(cell.isEdge()){delete this.edges[cellId];const source=cell.getSource(),target=cell.getTarget();if(source&&source.cell){const cache=this.outgoings[source.cell],index=cache?cache.indexOf(cellId):-1;index>=0&&(cache.splice(index,1),0===cache.length&&delete this.outgoings[source.cell])}if(target&&target.cell){const cache=this.incomings[target.cell],index=cache?cache.indexOf(cellId):-1;index>=0&&(cache.splice(index,1),0===cache.length&&delete this.incomings[target.cell])}}else delete this.nodes[cellId];options.clear||(options.disconnectEdges?this.disconnectConnectedEdges(cell,options):this.removeConnectedEdges(cell,options)),cell.model===this&&(cell.model=null)}onReset(cells){this.nodes={},this.edges={},this.outgoings={},this.incomings={},cells.forEach((cell=>this.onCellAdded(cell)))}onEdgeTerminalChanged(edge,type){const ref="source"===type?this.outgoings:this.incomings,prev=edge.previous(type);if(prev&&prev.cell){const cellId=Cell.isCell(prev.cell)?prev.cell.id:prev.cell,cache=ref[cellId],index=cache?cache.indexOf(edge.id):-1;index>=0&&(cache.splice(index,1),0===cache.length&&delete ref[cellId])}const terminal=edge.getTerminal(type);if(terminal&&terminal.cell){const terminalId=Cell.isCell(terminal.cell)?terminal.cell.id:terminal.cell,cache=ref[terminalId]||[];-1===cache.indexOf(edge.id)&&cache.push(edge.id),ref[terminalId]=cache}}prepareCell(cell,options){return cell.model||options&&options.dryrun||(cell.model=this),null==cell.zIndex&&cell.setZIndex(this.getMaxZIndex()+1,{silent:!0}),cell}resetCells(cells,options={}){return cells.map((cell=>this.prepareCell(cell,Object.assign(Object.assign({},options),{dryrun:!0})))),this.collection.reset(cells,options),cells.map((cell=>this.prepareCell(cell,{options}))),this}clear(options={}){const raw=this.getCells();if(0===raw.length)return this;const localOptions=Object.assign(Object.assign({},options),{clear:!0});return this.batchUpdate("clear",(()=>{const cells=raw.sort(((a,b)=>(a.isEdge()?1:2)-(b.isEdge()?1:2)));for(;cells.length>0;){const cell=cells.shift();cell&&cell.remove(localOptions)}}),localOptions),this}addNode(metadata,options={}){const node=Node.isNode(metadata)?metadata:this.createNode(metadata);return this.addCell(node,options),node}updateNode(metadata,options={}){const node=this.createNode(metadata),prop=node.getProp();return node.dispose(),this.updateCell(prop,options)}createNode(metadata){return Node.create(metadata)}addEdge(metadata,options={}){const edge=Edge.isEdge(metadata)?metadata:this.createEdge(metadata);return this.addCell(edge,options),edge}createEdge(metadata){return Edge.create(metadata)}updateEdge(metadata,options={}){const edge=this.createEdge(metadata),prop=edge.getProp();return edge.dispose(),this.updateCell(prop,options)}addCell(cell,options={}){return Array.isArray(cell)?this.addCells(cell,options):(this.collection.has(cell)||this.addings.has(cell)||(this.addings.set(cell,!0),this.collection.add(this.prepareCell(cell,options),options),cell.eachChild((child=>this.addCell(child,options))),this.addings.delete(cell)),this)}addCells(cells,options={}){const count=cells.length;if(0===count)return this;const localOptions=Object.assign(Object.assign({},options),{position:count-1,maxPosition:count-1});return this.startBatch("add",Object.assign(Object.assign({},localOptions),{cells})),cells.forEach((cell=>{this.addCell(cell,localOptions),localOptions.position-=1})),this.stopBatch("add",Object.assign(Object.assign({},localOptions),{cells})),this}updateCell(prop,options={}){const existing=prop.id&&this.getCell(prop.id);return!!existing&&this.batchUpdate("update",(()=>(Object.entries(prop).forEach((([key,val])=>existing.setProp(key,val,options))),!0)),prop)}removeCell(obj,options={}){const cell="string"==typeof obj?this.getCell(obj):obj;return cell&&this.has(cell)?this.collection.remove(cell,options):null}updateCellId(cell,newId){if(cell.id===newId)return;this.startBatch("update",{id:newId}),cell.prop("id",newId);const newCell=cell.clone({keepId:!0});this.addCell(newCell);return this.getConnectedEdges(cell).forEach((edge=>{const sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell();sourceCell===cell&&edge.setSource(Object.assign(Object.assign({},edge.getSource()),{cell:newId})),targetCell===cell&&edge.setTarget(Object.assign(Object.assign({},edge.getTarget()),{cell:newId}))})),this.removeCell(cell),this.stopBatch("update",{id:newId}),newCell}removeCells(cells,options={}){return cells.length?this.batchUpdate("remove",(()=>cells.map((cell=>this.removeCell(cell,options))))):[]}removeConnectedEdges(cell,options={}){const edges=this.getConnectedEdges(cell);return edges.forEach((edge=>{edge.remove(options)})),edges}disconnectConnectedEdges(cell,options={}){const cellId="string"==typeof cell?cell:cell.id;this.getConnectedEdges(cell).forEach((edge=>{const sourceCellId=edge.getSourceCellId(),targetCellId=edge.getTargetCellId();sourceCellId===cellId&&edge.setSource({x:0,y:0},options),targetCellId===cellId&&edge.setTarget({x:0,y:0},options)}))}has(obj){return this.collection.has(obj)}total(){return this.collection.length}indexOf(cell){return this.collection.indexOf(cell)}getCell(id){return this.collection.get(id)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const first=this.collection.first();return first&&first.getZIndex()||0}getMaxZIndex(){const last=this.collection.last();return last&&last.getZIndex()||0}getCellsFromCache(cache){return cache?Object.keys(cache).map((id=>this.getCell(id))).filter((cell=>null!=cell)):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(cell){const cellId="string"==typeof cell?cell:cell.id,cellIds=this.outgoings[cellId];return cellIds?cellIds.map((id=>this.getCell(id))).filter((cell=>cell&&cell.isEdge())):null}getIncomingEdges(cell){const cellId="string"==typeof cell?cell:cell.id,cellIds=this.incomings[cellId];return cellIds?cellIds.map((id=>this.getCell(id))).filter((cell=>cell&&cell.isEdge())):null}getConnectedEdges(cell,options={}){const result=[],node="string"==typeof cell?this.getCell(cell):cell;if(null==node)return result;const cache={},indirect=options.indirect;let incoming=options.incoming,outgoing=options.outgoing;null==incoming&&null==outgoing&&(incoming=outgoing=!0);const collect=(cell,isOutgoing)=>{const edges=isOutgoing?this.getOutgoingEdges(cell):this.getIncomingEdges(cell);if(null!=edges&&edges.forEach((edge=>{cache[edge.id]||(result.push(edge),cache[edge.id]=!0,indirect&&(incoming&&collect(edge,!1),outgoing&&collect(edge,!0)))})),indirect&&cell.isEdge()){const terminal=isOutgoing?cell.getTargetCell():cell.getSourceCell();terminal&&terminal.isEdge()&&(cache[terminal.id]||(result.push(terminal),collect(terminal,isOutgoing)))}};if(outgoing&&collect(node,!0),incoming&&collect(node,!1),options.deep){const descendants=node.getDescendants({deep:!0}),embedsCache={};descendants.forEach((cell=>{cell.isNode()&&(embedsCache[cell.id]=!0)}));const collectSub=(cell,isOutgoing)=>{const edges=isOutgoing?this.getOutgoingEdges(cell.id):this.getIncomingEdges(cell.id);null!=edges&&edges.forEach((edge=>{if(!cache[edge.id]){const sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell();if(!options.enclosed&&sourceCell&&embedsCache[sourceCell.id]&&targetCell&&embedsCache[targetCell.id])return;result.push(edge),cache[edge.id]=!0}}))};descendants.forEach((cell=>{cell.isEdge()||(outgoing&&collectSub(cell,!0),incoming&&collectSub(cell,!1))}))}return result}isBoundary(cell,isOrigin){const node="string"==typeof cell?this.getCell(cell):cell,arr=isOrigin?this.getIncomingEdges(node):this.getOutgoingEdges(node);return null==arr||0===arr.length}getBoundaryNodes(isOrigin){const result=[];return Object.keys(this.nodes).forEach((nodeId=>{if(this.isBoundary(nodeId,isOrigin)){const node=this.getCell(nodeId);node&&result.push(node)}})),result}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(cell){return this.isBoundary(cell,!0)}isLeaf(cell){return this.isBoundary(cell,!1)}getNeighbors(cell,options={}){let incoming=options.incoming,outgoing=options.outgoing;null==incoming&&null==outgoing&&(incoming=outgoing=!0);const map=this.getConnectedEdges(cell,options).reduce(((memo,edge)=>{const hasLoop=edge.hasLoop(options),sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell();return incoming&&sourceCell&&sourceCell.isNode()&&!memo[sourceCell.id]&&(!hasLoop&&(sourceCell===cell||options.deep&&sourceCell.isDescendantOf(cell))||(memo[sourceCell.id]=sourceCell)),outgoing&&targetCell&&targetCell.isNode()&&!memo[targetCell.id]&&(!hasLoop&&(targetCell===cell||options.deep&&targetCell.isDescendantOf(cell))||(memo[targetCell.id]=targetCell)),memo}),{});if(cell.isEdge()){if(incoming){const sourceCell=cell.getSourceCell();sourceCell&&sourceCell.isNode()&&!map[sourceCell.id]&&(map[sourceCell.id]=sourceCell)}if(outgoing){const targetCell=cell.getTargetCell();targetCell&&targetCell.isNode()&&!map[targetCell.id]&&(map[targetCell.id]=targetCell)}}return Object.keys(map).map((id=>map[id]))}isNeighbor(cell1,cell2,options={}){let incoming=options.incoming,outgoing=options.outgoing;return null==incoming&&null==outgoing&&(incoming=outgoing=!0),this.getConnectedEdges(cell1,options).some((edge=>{const sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell();return!(!incoming||!sourceCell||sourceCell.id!==cell2.id)||!(!outgoing||!targetCell||targetCell.id!==cell2.id)}))}getSuccessors(cell,options={}){const successors=[];return this.search(cell,((curr,distance)=>{curr!==cell&&this.matchDistance(distance,options.distance)&&successors.push(curr)}),Object.assign(Object.assign({},options),{outgoing:!0})),successors}isSuccessor(cell1,cell2,options={}){let result=!1;return this.search(cell1,((curr,distance)=>{if(curr===cell2&&curr!==cell1&&this.matchDistance(distance,options.distance))return result=!0,!1}),Object.assign(Object.assign({},options),{outgoing:!0})),result}getPredecessors(cell,options={}){const predecessors=[];return this.search(cell,((curr,distance)=>{curr!==cell&&this.matchDistance(distance,options.distance)&&predecessors.push(curr)}),Object.assign(Object.assign({},options),{incoming:!0})),predecessors}isPredecessor(cell1,cell2,options={}){let result=!1;return this.search(cell1,((curr,distance)=>{if(curr===cell2&&curr!==cell1&&this.matchDistance(distance,options.distance))return result=!0,!1}),Object.assign(Object.assign({},options),{incoming:!0})),result}matchDistance(distance,preset){return null==preset||("function"==typeof preset?preset(distance):!(!Array.isArray(preset)||!preset.includes(distance))||distance===preset)}getCommonAncestor(...cells){const arr=[];return cells.forEach((item=>{item&&(Array.isArray(item)?arr.push(...item):arr.push(item))})),Cell.getCommonAncestor(...arr)}getSubGraph(cells,options={}){const subgraph=[],cache={},nodes=[],edges=[],collect=cell=>{cache[cell.id]||(subgraph.push(cell),cache[cell.id]=cell,cell.isEdge()&&edges.push(cell),cell.isNode()&&nodes.push(cell))};return cells.forEach((cell=>{if(collect(cell),options.deep){cell.getDescendants({deep:!0}).forEach((descendant=>collect(descendant)))}})),edges.forEach((edge=>{const sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell();sourceCell&&!cache[sourceCell.id]&&(subgraph.push(sourceCell),cache[sourceCell.id]=sourceCell,sourceCell.isNode()&&nodes.push(sourceCell)),targetCell&&!cache[targetCell.id]&&(subgraph.push(targetCell),cache[targetCell.id]=targetCell,targetCell.isNode()&&nodes.push(targetCell))})),nodes.forEach((node=>{this.getConnectedEdges(node,options).forEach((edge=>{const sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell();!cache[edge.id]&&sourceCell&&cache[sourceCell.id]&&targetCell&&cache[targetCell.id]&&(subgraph.push(edge),cache[edge.id]=edge)}))})),subgraph}cloneSubGraph(cells,options={}){const subgraph=this.getSubGraph(cells,options);return this.cloneCells(subgraph)}cloneCells(cells){return Cell.cloneCells(cells)}getNodesFromPoint(x,y){const p="number"==typeof x?{x,y:y||0}:x;return this.getNodes().filter((node=>node.getBBox().containsPoint(p)))}getNodesInArea(x,y,w,h,options){const rect="number"==typeof x?new Rectangle(x,y,w,h):Rectangle.create(x),opts="number"==typeof x?options:y,strict=opts&&opts.strict;return this.getNodes().filter((node=>{const bbox=node.getBBox();return strict?rect.containsRect(bbox):rect.isIntersectWithRect(bbox)}))}getEdgesInArea(x,y,w,h,options){const rect="number"==typeof x?new Rectangle(x,y,w,h):Rectangle.create(x),opts="number"==typeof x?options:y,strict=opts&&opts.strict;return this.getEdges().filter((edge=>{const bbox=edge.getBBox();return 0===bbox.width?bbox.inflate(1,0):0===bbox.height&&bbox.inflate(0,1),strict?rect.containsRect(bbox):rect.isIntersectWithRect(bbox)}))}getNodesUnderNode(node,options={}){const bbox=node.getBBox();return(null==options.by||"bbox"===options.by?this.getNodesInArea(bbox):this.getNodesFromPoint(bbox[options.by])).filter((curr=>node.id!==curr.id&&!curr.isDescendantOf(node)))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(cells,options={}){return Cell.getCellsBBox(cells,options)}search(cell,iterator,options={}){options.breadthFirst?this.breadthFirstSearch(cell,iterator,options):this.depthFirstSearch(cell,iterator,options)}breadthFirstSearch(cell,iterator,options={}){const queue=[],visited={},distance={};for(queue.push(cell),distance[cell.id]=0;queue.length>0;){const next=queue.shift();if(null==next||visited[next.id])continue;if(visited[next.id]=!0,!1===call(iterator,this,next,distance[next.id]))continue;this.getNeighbors(next,options).forEach((neighbor=>{distance[neighbor.id]=distance[next.id]+1,queue.push(neighbor)}))}}depthFirstSearch(cell,iterator,options={}){const queue=[],visited={},distance={};for(queue.push(cell),distance[cell.id]=0;queue.length>0;){const next=queue.pop();if(null==next||visited[next.id])continue;if(visited[next.id]=!0,!1===call(iterator,this,next,distance[next.id]))continue;const neighbors=this.getNeighbors(next,options),lastIndex=queue.length;neighbors.forEach((neighbor=>{distance[neighbor.id]=distance[next.id]+1,queue.splice(lastIndex,0,neighbor)}))}}getShortestPath(source,target,options={}){const adjacencyList={};this.getEdges().forEach((edge=>{const sourceId=edge.getSourceCellId(),targetId=edge.getTargetCellId();sourceId&&targetId&&(adjacencyList[sourceId]||(adjacencyList[sourceId]=[]),adjacencyList[targetId]||(adjacencyList[targetId]=[]),adjacencyList[sourceId].push(targetId),options.directed||adjacencyList[targetId].push(sourceId))}));const sourceId="string"==typeof source?source:source.id,previous=Dijkstra.run(adjacencyList,sourceId,options.weight),path=[];let targetId="string"==typeof target?target:target.id;for(previous[targetId]&&path.push(targetId);targetId=previous[targetId];)path.unshift(targetId);return path}translate(tx,ty,options){return this.getCells().filter((cell=>!cell.hasParent())).forEach((cell=>cell.translate(tx,ty,options))),this}resize(width,height,options){return this.resizeCells(width,height,this.getCells(),options)}resizeCells(width,height,cells,options={}){const bbox=this.getCellsBBox(cells);if(bbox){const sx=Math.max(width/bbox.width,0),sy=Math.max(height/bbox.height,0),origin=bbox.getOrigin();cells.forEach((cell=>cell.scale(sx,sy,origin,options)))}return this}toJSON(options={}){return Model.toJSON(this.getCells(),options)}parseJSON(data){return Model.fromJSON(data)}fromJSON(data,options={}){const cells=this.parseJSON(data);return this.resetCells(cells,options),this}startBatch(name,data={}){return this.batches[name]=(this.batches[name]||0)+1,this.notify("batch:start",{name,data}),this}stopBatch(name,data={}){return this.batches[name]=(this.batches[name]||0)-1,this.notify("batch:stop",{name,data}),this}batchUpdate(name,execute,data={}){this.startBatch(name,data);const result=execute();return this.stopBatch(name,data),result}hasActiveBatch(name=Object.keys(this.batches)){return(Array.isArray(name)?name:[name]).some((batch=>this.batches[batch]>0))}dispose(){this.collection.dispose()}}model_decorate([Model.dispose()],Model.prototype,"dispose",null),function(Model){Model.toStringTag=`X6.${Model.name}`,Model.isModel=function isModel(instance){if(null==instance)return!1;if(instance instanceof Model)return!0;const tag=instance[Symbol.toStringTag],model=instance;return(null==tag||tag===Model.toStringTag)&&"function"==typeof model.addNode&&"function"==typeof model.addEdge&&null!=model.collection}}(Model||(Model={})),function(Model){Model.toJSON=function toJSON(cells,options={}){return{cells:cells.map((cell=>cell.toJSON(options)))}},Model.fromJSON=function fromJSON(data){const cells=[];return Array.isArray(data)?cells.push(...data):(data.cells&&cells.push(...data.cells),data.nodes&&data.nodes.forEach((node=>{null==node.shape&&(node.shape="rect"),cells.push(node)})),data.edges&&data.edges.forEach((edge=>{null==edge.shape&&(edge.shape="edge"),cells.push(edge)}))),cells.map((cell=>{const type=cell.shape;if(type){if(Node.registry.exist(type))return Node.create(cell);if(Edge.registry.exist(type))return Edge.create(cell)}throw new Error("The `shape` should be specified when creating a node/edge instance")}))}}(Model||(Model={}));var base_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class Base extends Node{get label(){return this.getLabel()}set label(val){this.setLabel(val)}getLabel(){return this.getAttrByPath("text/text")}setLabel(label,options){return null==label?this.removeLabel():this.setAttrByPath("text/text",label,options),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}!function(Base){Base.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},Base.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},Base.config({attrs:{text:Object.assign({},Base.labelAttr)},propHooks(metadata){const{label}=metadata,others=base_rest(metadata,["label"]);return label&&setByPath(others,"attrs/text/text",label),others},visible:!0})}(Base||(Base={}));var util_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};function getMarkup(tagName,selector="body"){return[{tagName,selector},{tagName:"text",selector:"label"}]}function createShape(shape,config,options={}){const defaults={constructorName:shape,markup:getMarkup(shape,options.selector),attrs:{[shape]:Object.assign({},Base.bodyAttr)}};return(options.parent||Base).define(lodash_es_merge(defaults,config,{shape}))}createShape("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});const edge_Edge=Edge.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});createShape("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var poly_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class Poly extends Base{get points(){return this.getPoints()}set points(pts){this.setPoints(pts)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(points,options){return null==points?this.removePoints():this.setAttrByPath("body/refPoints",Poly.pointsToString(points),options),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}!function(Poly){function pointsToString(points){return"string"==typeof points?points:points.map((p=>Array.isArray(p)?p.join(","):Point.isPointLike(p)?`${p.x}, ${p.y}`:"")).join(" ")}Poly.pointsToString=pointsToString,Poly.config({propHooks(metadata){const{points}=metadata,others=poly_rest(metadata,["points"]);if(points){const data=pointsToString(points);data&&setByPath(others,"attrs/body/refPoints",data)}return others}})}(Poly||(Poly={}));createShape("polygon",{},{parent:Poly}),createShape("polyline",{},{parent:Poly});var shape_path_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Base.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(metadata){const{path}=metadata,others=shape_path_rest(metadata,["path"]);return path&&setByPath(others,"attrs/body/refD",path),others}});var text_block_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Base.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},Platform.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:elem_ns.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Base.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(metadata){const{text}=metadata,others=text_block_rest(metadata,["text"]);return text&&setByPath(others,"attrs/label/text",text),others},attrHooks:{text:{set(text,{cell,view,refBBox,elem,attrs}){if(!(elem instanceof HTMLElement)){const style=attrs.style||{},wrapValue={text,width:-5,height:"100%"},wrapAttrs=Object.assign({textVerticalAnchor:"middle"},style);return call(Attr.presets.textWrap.set,this,wrapValue,{cell,view,elem,refBBox,attrs:wrapAttrs}),{fill:style.color||null}}elem.textContent=text},position(text,{refBBox,elem}){if(elem instanceof SVGElement)return refBBox.getCenter()}}}}),createShape("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:function getImageUrlHook(attrName="xlink:href"){return metadata=>{const{imageUrl,imageWidth,imageHeight}=metadata,others=util_rest(metadata,["imageUrl","imageWidth","imageHeight"]);if(null!=imageUrl||null!=imageWidth||null!=imageHeight){const apply=()=>{if(others.attrs){const image=others.attrs.image;null!=imageUrl&&(image[attrName]=imageUrl),null!=imageWidth&&(image.width=imageWidth),null!=imageHeight&&(image.height=imageHeight),others.attrs.image=image}};others.attrs?(null==others.attrs.image&&(others.attrs.image={}),apply()):(others.attrs={image:{}},apply())}return others}}()},{selector:"image"}),createShape("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});class NodeView extends CellView{constructor(){super(...arguments),this.portsCache={}}get[Symbol.toStringTag](){return NodeView.toStringTag}getContainerClassName(){const classList=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||classList.push(this.prefixClassName("node-immovable")),classList.join(" ")}updateClassName(e){const target=e.target;if(target.hasAttribute("magnet")){const className=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?removeClass(target,className):addClass(target,className)}else{const className=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(className):this.addClass(className)}}isNodeView(){return!0}confirmUpdate(flag,options={}){let ret=flag;return this.hasAction(ret,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(ret,"render")?(this.render(),ret=this.removeAction(ret,["render","update","resize","translate","rotate","ports","tools"])):(ret=this.handleAction(ret,"resize",(()=>this.resize()),"update"),ret=this.handleAction(ret,"update",(()=>this.update()),Config.useCSSSelector?"ports":null),ret=this.handleAction(ret,"translate",(()=>this.translate())),ret=this.handleAction(ret,"rotate",(()=>this.rotate())),ret=this.handleAction(ret,"ports",(()=>this.renderPorts())),ret=this.handleAction(ret,"tools",(()=>{this.getFlag("tools")===flag?this.renderTools():this.updateTools(options)}))),ret}update(partialAttrs){this.cleanCache(),Config.useCSSSelector&&this.removePorts();const node=this.cell,size=node.getSize(),attrs=node.getAttrs();this.updateAttrs(this.container,attrs,{attrs:partialAttrs===attrs?null:partialAttrs,rootBBox:new Rectangle(0,0,size.width,size.height),selectors:this.selectors}),Config.useCSSSelector&&this.renderPorts()}renderMarkup(){const markup=this.cell.markup;if(markup){if("string"==typeof markup)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(markup)}throw new TypeError("Invalid node markup.")}renderJSONMarkup(markup){const ret=this.parseJSONMarkup(markup,this.container);this.selectors=ret.selectors,this.container.appendChild(ret.fragment)}render(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),Config.useCSSSelector||this.renderPorts(),this.renderTools(),this}resize(){this.cell.getAngle()&&this.rotate(),this.update()}translate(){this.updateTransform()}rotate(){this.updateTransform()}getTranslationString(){const position=this.cell.getPosition();return`translate(${position.x},${position.y})`}getRotationString(){const angle=this.cell.getAngle();if(angle){const size=this.cell.getSize();return`rotate(${angle},${size.width/2},${size.height/2})`}}updateTransform(){let transform=this.getTranslationString();const rot=this.getRotationString();rot&&(transform+=` ${rot}`),this.container.setAttribute("transform",transform)}findPortElem(portId,selector){const cache=portId?this.portsCache[portId]:null;if(!cache)return null;const portRoot=cache.portContentElement,portSelectors=cache.portContentSelectors||{};return this.findOne(selector,portRoot,portSelectors)}cleanPortsCache(){this.portsCache={}}removePorts(){Object.values(this.portsCache).forEach((cached=>{remove(cached.portElement)}))}renderPorts(){const container=this.container,references=[];container.childNodes.forEach((child=>{references.push(child)}));const parsedPorts=this.cell.getParsedPorts(),portsGropsByZ=lodash_es_groupBy(parsedPorts,"zIndex");portsGropsByZ.auto&&portsGropsByZ.auto.forEach((port=>{const portElement=this.getPortElement(port);container.append(portElement),references.push(portElement)})),Object.keys(portsGropsByZ).forEach((key=>{if("auto"!==key){const zIndex=parseInt(key,10);this.appendPorts(portsGropsByZ[key],zIndex,references)}})),this.updatePorts()}appendPorts(ports,zIndex,refs){const elems=ports.map((p=>this.getPortElement(p)));refs[zIndex]||zIndex<0?before(refs[Math.max(zIndex,0)],elems):append(this.container,elems)}getPortElement(port){const cached=this.portsCache[port.id];return cached?cached.portElement:this.createPortElement(port)}createPortElement(port){let renderResult=Markup.renderMarkup(this.cell.getPortContainerMarkup());const portElement=renderResult.elem;if(null==portElement)throw new Error("Invalid port container markup.");renderResult=Markup.renderMarkup(this.getPortMarkup(port));const portContentElement=renderResult.elem,portContentSelectors=renderResult.selectors;if(null==portContentElement)throw new Error("Invalid port markup.");this.setAttrs({port:port.id,"port-group":port.group},portContentElement);let portClass="x6-port";port.group&&(portClass+=` x6-port-${port.group}`),addClass(portElement,portClass),addClass(portElement,"x6-port"),addClass(portContentElement,"x6-port-body"),portElement.appendChild(portContentElement);let portLabelElement,portLabelSelectors,portSelectors=portContentSelectors;if(this.existPortLabel(port)){if(renderResult=Markup.renderMarkup(this.getPortLabelMarkup(port.label)),portLabelElement=renderResult.elem,portLabelSelectors=renderResult.selectors,null==portLabelElement)throw new Error("Invalid port label markup.");if(portContentSelectors&&portLabelSelectors){for(const key in portLabelSelectors)if(portContentSelectors[key]&&key!==this.rootSelector)throw new Error("Selectors within port must be unique.");portSelectors=Object.assign(Object.assign({},portContentSelectors),portLabelSelectors)}addClass(portLabelElement,"x6-port-label"),portElement.appendChild(portLabelElement)}return this.portsCache[port.id]={portElement,portSelectors,portLabelElement,portLabelSelectors,portContentElement,portContentSelectors},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port,node:this.cell,container:portElement,selectors:portSelectors,labelContainer:portLabelElement,labelSelectors:portLabelSelectors,contentContainer:portContentElement,contentSelectors:portContentSelectors}),portElement}updatePorts(){const groups=this.cell.getParsedGroups(),groupList=Object.keys(groups);0===groupList.length?this.updatePortGroup():groupList.forEach((groupName=>this.updatePortGroup(groupName)))}updatePortGroup(groupName){const bbox=Rectangle.fromSize(this.cell.getSize()),metrics=this.cell.getPortsLayoutByGroup(groupName,bbox);for(let i=0,n=metrics.length;i<n;i+=1){const metric=metrics[i],portId=metric.portId,cached=this.portsCache[portId]||{},portLayout=metric.portLayout;if(this.applyPortTransform(cached.portElement,portLayout),null!=metric.portAttrs){const options={selectors:cached.portSelectors||{}};metric.portSize&&(options.rootBBox=Rectangle.fromSize(metric.portSize)),this.updateAttrs(cached.portElement,metric.portAttrs,options)}const labelLayout=metric.labelLayout;if(labelLayout&&cached.portLabelElement&&(this.applyPortTransform(cached.portLabelElement,labelLayout,-(portLayout.angle||0)),labelLayout.attrs)){const options={selectors:cached.portLabelSelectors||{}};metric.labelSize&&(options.rootBBox=Rectangle.fromSize(metric.labelSize)),this.updateAttrs(cached.portLabelElement,labelLayout.attrs,options)}}}applyPortTransform(element,layout,initialAngle=0){const angle=layout.angle,position=layout.position;transform(element,createSVGMatrix().rotate(initialAngle).translate(position.x||0,position.y||0).rotate(angle||0),{absolute:!0})}getPortMarkup(port){return port.markup||this.cell.portMarkup}getPortLabelMarkup(label){return label.markup||this.cell.portLabelMarkup}existPortLabel(port){return port.attrs&&port.attrs.text}getEventArgs(e,x,y){const view=this,node=view.cell;return null==x||null==y?{e,view,node,cell:node}:{e,x,y,view,node,cell:node}}getPortEventArgs(e,port,pos){const view=this,node=view.cell,cell=node;return pos?{e,x:pos.x,y:pos.y,view,node,cell,port}:{e,view,node,cell,port}}notifyMouseDown(e,x,y){super.onMouseDown(e,x,y),this.notify("node:mousedown",this.getEventArgs(e,x,y))}notifyMouseMove(e,x,y){super.onMouseMove(e,x,y),this.notify("node:mousemove",this.getEventArgs(e,x,y))}notifyMouseUp(e,x,y){super.onMouseUp(e,x,y),this.notify("node:mouseup",this.getEventArgs(e,x,y))}notifyPortEvent(name,e,pos){const port=this.findAttr("port",e.target);if(port){const originType=e.type;"node:port:mouseenter"===name?e.type="mouseenter":"node:port:mouseleave"===name&&(e.type="mouseleave"),this.notify(name,this.getPortEventArgs(e,port,pos)),e.type=originType}}onClick(e,x,y){super.onClick(e,x,y),this.notify("node:click",this.getEventArgs(e,x,y)),this.notifyPortEvent("node:port:click",e,{x,y})}onDblClick(e,x,y){super.onDblClick(e,x,y),this.notify("node:dblclick",this.getEventArgs(e,x,y)),this.notifyPortEvent("node:port:dblclick",e,{x,y})}onContextMenu(e,x,y){super.onContextMenu(e,x,y),this.notify("node:contextmenu",this.getEventArgs(e,x,y)),this.notifyPortEvent("node:port:contextmenu",e,{x,y})}onMouseDown(e,x,y){this.isPropagationStopped(e)||(this.notifyMouseDown(e,x,y),this.notifyPortEvent("node:port:mousedown",e,{x,y}),this.startNodeDragging(e,x,y))}onMouseMove(e,x,y){const data=this.getEventData(e),action=data.action;if("magnet"===action)this.dragMagnet(e,x,y);else{if("move"===action){const view=data.targetView||this;view.dragNode(e,x,y),view.notify("node:moving",{e,x,y,view,cell:view.cell,node:view.cell})}this.notifyMouseMove(e,x,y),this.notifyPortEvent("node:port:mousemove",e,{x,y})}this.setEventData(e,data)}onMouseUp(e,x,y){const data=this.getEventData(e),action=data.action;if("magnet"===action)this.stopMagnetDragging(e,x,y);else if(this.notifyMouseUp(e,x,y),this.notifyPortEvent("node:port:mouseup",e,{x,y}),"move"===action){(data.targetView||this).stopNodeDragging(e,x,y)}const magnet=data.targetMagnet;magnet&&this.onMagnetClick(e,magnet,x,y),this.checkMouseleave(e)}onMouseOver(e){super.onMouseOver(e),this.notify("node:mouseover",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseenter",e),this.notifyPortEvent("node:port:mouseover",e)}onMouseOut(e){super.onMouseOut(e),this.notify("node:mouseout",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseleave",e),this.notifyPortEvent("node:port:mouseout",e)}onMouseEnter(e){this.updateClassName(e),super.onMouseEnter(e),this.notify("node:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("node:mouseleave",this.getEventArgs(e))}onMouseWheel(e,x,y,delta){super.onMouseWheel(e,x,y,delta),this.notify("node:mousewheel",Object.assign({delta},this.getEventArgs(e,x,y)))}onMagnetClick(e,magnet,x,y){const graph=this.graph;graph.view.getMouseMovedCount(e)>graph.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet},this.getEventArgs(e,x,y)))}onMagnetDblClick(e,magnet,x,y){this.notify("node:magnet:dblclick",Object.assign({magnet},this.getEventArgs(e,x,y)))}onMagnetContextMenu(e,magnet,x,y){this.notify("node:magnet:contextmenu",Object.assign({magnet},this.getEventArgs(e,x,y)))}onMagnetMouseDown(e,magnet,x,y){this.startMagnetDragging(e,x,y)}onCustomEvent(e,name,x,y){this.notify("node:customevent",Object.assign({name},this.getEventArgs(e,x,y))),super.onCustomEvent(e,name,x,y)}prepareEmbedding(e){const graph=this.graph,node=this.getEventData(e).cell||this.cell,view=graph.findViewByCell(node),localPoint=graph.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e,node,view,cell:node,x:localPoint.x,y:localPoint.y,currentParent:node.getParent()})}processEmbedding(e,data){const cell=data.cell||this.cell,graph=data.graph||this.graph,options=graph.options.embedding,findParent=options.findParent;let candidates="function"==typeof findParent?call(findParent,graph,{view:this,node:this.cell}).filter((c=>Cell.isCell(c)&&this.cell.id!==c.id&&!c.isDescendantOf(this.cell))):graph.model.getNodesUnderNode(cell,{by:findParent});if(options.frontOnly&&candidates.length>0){const zIndexMap=lodash_es_groupBy(candidates,"zIndex"),maxZIndex=lodash_es_max(Object.keys(zIndexMap).map((z=>parseInt(z,10))));maxZIndex&&(candidates=zIndexMap[maxZIndex])}candidates=candidates.filter((candidate=>candidate.visible));let newCandidateView=null;const prevCandidateView=data.candidateEmbedView,validateEmbeding=options.validate;for(let i=candidates.length-1;i>=0;i-=1){const candidate=candidates[i];if(prevCandidateView&&prevCandidateView.cell.id===candidate.id){newCandidateView=prevCandidateView;break}{const view=candidate.findView(graph);if(validateEmbeding&&call(validateEmbeding,graph,{child:this.cell,parent:view.cell,childView:this,parentView:view})){newCandidateView=view;break}}}this.clearEmbedding(data),newCandidateView&&newCandidateView.highlight(null,{type:"embedding"}),data.candidateEmbedView=newCandidateView;const localPoint=graph.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e,cell,node:cell,view:graph.findViewByCell(cell),x:localPoint.x,y:localPoint.y,currentParent:cell.getParent(),candidateParent:newCandidateView?newCandidateView.cell:null})}clearEmbedding(data){const candidateView=data.candidateEmbedView;candidateView&&(candidateView.unhighlight(null,{type:"embedding"}),data.candidateEmbedView=null)}finalizeEmbedding(e,data){this.graph.startBatch("embedding");const cell=data.cell||this.cell,graph=data.graph||this.graph,view=graph.findViewByCell(cell),parent=cell.getParent(),candidateView=data.candidateEmbedView;if(candidateView?(candidateView.unhighlight(null,{type:"embedding"}),data.candidateEmbedView=null,null!=parent&&parent.id===candidateView.cell.id||candidateView.cell.insertChild(cell,void 0,{ui:!0})):parent&&parent.unembed(cell,{ui:!0}),graph.model.getConnectedEdges(cell,{deep:!0}).forEach((edge=>{edge.updateParent({ui:!0})})),view&&candidateView){const localPoint=graph.snapToGrid(e.clientX,e.clientY);view.notify("node:embedded",{e,cell,x:localPoint.x,y:localPoint.y,node:cell,view:graph.findViewByCell(cell),previousParent:parent,currentParent:cell.getParent()})}this.graph.stopBatch("embedding")}getDelegatedView(){let cell=this.cell,view=this;for(;view&&!cell.isEdge();){if(!cell.hasParent()||view.can("stopDelegateOnDragging"))return view;cell=cell.getParent(),view=this.graph.findViewByCell(cell)}return null}validateMagnet(cellView,magnet,e){if("passive"!==magnet.getAttribute("magnet")){const validate=this.graph.options.connecting.validateMagnet;return!validate||call(validate,this.graph,{e,magnet,view:cellView,cell:cellView.cell})}return!1}startMagnetDragging(e,x,y){if(!this.can("magnetConnectable"))return;e.stopPropagation();const magnet=e.currentTarget,graph=this.graph;this.setEventData(e,{targetMagnet:magnet}),this.validateMagnet(this,magnet,e)?(graph.options.magnetThreshold<=0&&this.startConnectting(e,magnet,x,y),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):this.onMouseDown(e,x,y),graph.view.delegateDragEvents(e,this)}startConnectting(e,magnet,x,y){this.graph.model.startBatch("add-edge");const edgeView=this.createEdgeFromMagnet(magnet,x,y);edgeView.setEventData(e,edgeView.prepareArrowheadDragging("target",{x,y,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView}),edgeView.notifyMouseDown(e,x,y)}getDefaultEdge(sourceView,sourceMagnet){let edge;const create=this.graph.options.connecting.createEdge;return create&&(edge=call(create,this.graph,{sourceMagnet,sourceView,sourceCell:sourceView.cell})),edge}createEdgeFromMagnet(magnet,x,y){const graph=this.graph,model=graph.model,edge=this.getDefaultEdge(this,magnet);return edge.setSource(Object.assign(Object.assign({},edge.getSource()),this.getEdgeTerminal(magnet,x,y,edge,"source"))),edge.setTarget(Object.assign(Object.assign({},edge.getTarget()),{x,y})),edge.addTo(model,{async:!1,ui:!0}),edge.findView(graph)}dragMagnet(e,x,y){const data=this.getEventData(e),edgeView=data.edgeView;if(edgeView)edgeView.onMouseMove(e,x,y),this.autoScrollGraph(e.clientX,e.clientY);else{const graph=this.graph,magnetThreshold=graph.options.magnetThreshold,currentTarget=this.getEventTarget(e),targetMagnet=data.targetMagnet;if("onleave"===magnetThreshold){if(targetMagnet===currentTarget||targetMagnet.contains(currentTarget))return}else if(graph.view.getMouseMovedCount(e)<=magnetThreshold)return;this.startConnectting(e,targetMagnet,x,y)}}stopMagnetDragging(e,x,y){const edgeView=this.eventData(e).edgeView;edgeView&&(edgeView.onMouseUp(e,x,y),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(e,x,y){this.notify("node:unhandled:mousedown",{e,x,y,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(name,e,x,y,cell){let cells=[cell];const selection=this.graph.getPlugin("selection");if(selection&&selection.isSelectionMovable()){const selectedCells=selection.getSelectedCells();selectedCells.includes(cell)&&(cells=selectedCells.filter((c=>c.isNode())))}cells.forEach((c=>{this.notify(name,{e,x,y,cell:c,node:c,view:c.findView(this.graph)})}))}getRestrictArea(view){const restrict=this.graph.options.translating.restrict,area="function"==typeof restrict?call(restrict,this.graph,view):restrict;return"number"==typeof area?this.graph.transform.getGraphArea().inflate(area):!0===area?this.graph.transform.getGraphArea():area||null}startNodeDragging(e,x,y){const targetView=this.getDelegatedView();if(null==targetView||!targetView.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,x,y);this.setEventData(e,{targetView,action:"move"});const position=Point.create(targetView.cell.getPosition());targetView.setEventData(e,{moving:!1,offset:position.diff(x,y),restrict:this.getRestrictArea(targetView)})}dragNode(e,x,y){const node=this.cell,graph=this.graph,gridSize=graph.getGridSize(),data=this.getEventData(e),offset=data.offset,restrict=data.restrict;data.moving||(data.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,x,y,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);const posX=GeometryUtil.snapToGrid(x+offset.x,gridSize),posY=GeometryUtil.snapToGrid(y+offset.y,gridSize);node.setPosition(posX,posY,{restrict,deep:!0,ui:!0}),graph.options.embedding.enabled&&(data.embedding||(this.prepareEmbedding(e),data.embedding=!0),this.processEmbedding(e,data))}stopNodeDragging(e,x,y){const data=this.getEventData(e);data.embedding&&this.finalizeEmbedding(e,data),data.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,x,y,this.cell)),data.moving=!1,data.embedding=!1}autoScrollGraph(x,y){const scroller=this.graph.getPlugin("scroller");scroller&&scroller.autoScroll(x,y)}}!function(NodeView){NodeView.toStringTag=`X6.${NodeView.name}`,NodeView.isNodeView=function isNodeView(instance){if(null==instance)return!1;if(instance instanceof NodeView)return!0;const tag=instance[Symbol.toStringTag],view=instance;return(null==tag||tag===NodeView.toStringTag)&&"function"==typeof view.isNodeView&&"function"==typeof view.isEdgeView&&"function"==typeof view.confirmUpdate&&"function"==typeof view.update&&"function"==typeof view.findPortElem&&"function"==typeof view.resize&&"function"==typeof view.rotate&&"function"==typeof view.translate}}(NodeView||(NodeView={})),NodeView.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),NodeView.registry.register("node",NodeView,!0);var view_edge_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class EdgeView extends CellView{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.labelDestroyFn={}}get[Symbol.toStringTag](){return EdgeView.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const sourceView=this.sourceView;if(!sourceView){const sourceDef=this.cell.getSource();return new Rectangle(sourceDef.x,sourceDef.y)}const sourceMagnet=this.sourceMagnet;return sourceView.isEdgeElement(sourceMagnet)?new Rectangle(this.sourceAnchor.x,this.sourceAnchor.y):sourceView.getBBoxOfElement(sourceMagnet||sourceView.container)}get targetBBox(){const targetView=this.targetView;if(!targetView){const targetDef=this.cell.getTarget();return new Rectangle(targetDef.x,targetDef.y)}const targetMagnet=this.targetMagnet;return targetView.isEdgeElement(targetMagnet)?new Rectangle(this.targetAnchor.x,this.targetAnchor.y):targetView.getBBoxOfElement(targetMagnet||targetView.container)}isEdgeView(){return!0}confirmUpdate(flag,options={}){let ref=flag;if(this.hasAction(ref,"source")){if(!this.updateTerminalProperties("source"))return ref;ref=this.removeAction(ref,"source")}if(this.hasAction(ref,"target")){if(!this.updateTerminalProperties("target"))return ref;ref=this.removeAction(ref,"target")}return this.hasAction(ref,"render")?(this.render(),ref=this.removeAction(ref,["render","update","labels","tools"]),ref):(ref=this.handleAction(ref,"update",(()=>this.update(options))),ref=this.handleAction(ref,"labels",(()=>this.onLabelsChange(options))),ref=this.handleAction(ref,"tools",(()=>this.renderTools())),ref)}render(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}renderMarkup(){const markup=this.cell.markup;if(markup){if("string"==typeof markup)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(markup)}throw new TypeError("Invalid edge markup.")}renderJSONMarkup(markup){const ret=this.parseJSONMarkup(markup,this.container);this.selectors=ret.selectors,this.container.append(ret.fragment)}customizeLabels(){if(this.labelContainer){const edge=this.cell,labels=edge.labels;for(let i=0,n=labels.length;i<n;i+=1){const label=labels[i],container=this.labelCache[i],selectors=this.labelSelectors[i],onEdgeLabelRendered=this.graph.options.onEdgeLabelRendered;if(onEdgeLabelRendered){const fn=onEdgeLabelRendered({edge,label,container,selectors});fn&&(this.labelDestroyFn[i]=fn)}}}}destroyCustomizeLabels(){const labels=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(let i=0,n=labels.length;i<n;i+=1){const fn=this.labelDestroyFn[i],container=this.labelCache[i],selectors=this.labelSelectors[i];fn&&container&&selectors&&fn({edge:this.cell,label:labels[i],container,selectors})}this.labelDestroyFn={}}renderLabels(){const edge=this.cell,labels=edge.getLabels(),count=labels.length;let container=this.labelContainer;if(this.labelCache={},this.labelSelectors={},count<=0)return container&&container.parentNode&&container.parentNode.removeChild(container),this;container?this.empty(container):(container=createSvgElement("g"),this.addClass(this.prefixClassName("edge-labels"),container),this.labelContainer=container);for(let i=0,ii=labels.length;i<ii;i+=1){const label=labels[i],normalized=this.normalizeLabelMarkup(this.parseLabelMarkup(label.markup));let labelNode,selectors;if(normalized)labelNode=normalized.node,selectors=normalized.selectors;else{const defaultLabel=edge.getDefaultLabel(),normalized=this.normalizeLabelMarkup(this.parseLabelMarkup(defaultLabel.markup));labelNode=normalized.node,selectors=normalized.selectors}labelNode.setAttribute("data-index",`${i}`),container.appendChild(labelNode);const rootSelector=this.rootSelector;if(selectors[rootSelector])throw new Error("Ambiguous label root selector.");selectors[rootSelector]=labelNode,this.labelCache[i]=labelNode,this.labelSelectors[i]=selectors}return null==container.parentNode&&this.container.appendChild(container),this.updateLabels(),this.customizeLabels(),this}onLabelsChange(options={}){this.destroyCustomizeLabels(),this.shouldRerenderLabels(options)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(options={}){const previousLabels=this.cell.previous("labels");if(null==previousLabels)return!0;if("propertyPathArray"in options&&"propertyValue"in options){const pathArray=options.propertyPathArray||[],pathLength=pathArray.length;if(pathLength>1){if(previousLabels[pathArray[1]]){if(2===pathLength)return"object"==typeof options.propertyValue&&lodash_es_has(options.propertyValue,"markup");if("markup"!==pathArray[2])return!1}}}return!0}parseLabelMarkup(markup){return markup?"string"==typeof markup?this.parseLabelStringMarkup(markup):this.parseJSONMarkup(markup):null}parseLabelStringMarkup(labelMarkup){const children=Vector.createVectors(labelMarkup),fragment=document.createDocumentFragment();for(let i=0,n=children.length;i<n;i+=1){const currentChild=children[i].node;fragment.appendChild(currentChild)}return{fragment,selectors:{}}}normalizeLabelMarkup(markup){if(null==markup)return;const fragment=markup.fragment;if(!(fragment instanceof DocumentFragment&&fragment.hasChildNodes()))throw new Error("Invalid label markup.");let vel;const childNodes=fragment.childNodes;return vel=childNodes.length>1||"G"!==childNodes[0].nodeName.toUpperCase()?Vector.create("g").append(fragment):Vector.create(childNodes[0]),vel.addClass(this.prefixClassName("edge-label")),{node:vel.node,selectors:markup.selectors}}updateLabels(){if(this.labelContainer){const edge=this.cell,labels=edge.labels,canLabelMove=this.can("edgeLabelMovable"),defaultLabel=edge.getDefaultLabel();for(let i=0,n=labels.length;i<n;i+=1){const elem=this.labelCache[i],selectors=this.labelSelectors[i];elem.setAttribute("cursor",canLabelMove?"move":"default");const label=labels[i],attrs=lodash_es_merge({},defaultLabel.attrs,label.attrs);this.updateAttrs(elem,attrs,{selectors,rootBBox:label.size?Rectangle.fromSize(label.size):void 0})}}}renderTools(){const tools=this.cell.getTools();return this.addTools(tools),this}update(options={}){this.cleanCache(),this.updateConnection(options);const _a=this.cell.getAttrs(),{text}=_a,attrs=view_edge_rest(_a,["text"]);return null!=attrs&&this.updateAttrs(this.container,attrs,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(options),this}removeRedundantLinearVertices(options={}){const edge=this.cell,vertices=edge.getVertices(),routePoints=[this.sourceAnchor,...vertices,this.targetAnchor],rawCount=routePoints.length,polyline=new Polyline(routePoints);polyline.simplify({threshold:.01});const simplifiedPoints=polyline.points.map((point=>point.toJSON())),simplifiedCount=simplifiedPoints.length;return rawCount===simplifiedCount?0:(edge.setVertices(simplifiedPoints.slice(1,simplifiedCount-1),options),rawCount-simplifiedCount)}getTerminalView(type){switch(type){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${type}'`)}}getTerminalAnchor(type){switch(type){case"source":return Point.create(this.sourceAnchor);case"target":return Point.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${type}'`)}}getTerminalConnectionPoint(type){switch(type){case"source":return Point.create(this.sourcePoint);case"target":return Point.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${type}'`)}}getTerminalMagnet(type,options={}){switch(type){case"source":{if(options.raw)return this.sourceMagnet;const sourceView=this.sourceView;return sourceView?this.sourceMagnet||sourceView.container:null}case"target":{if(options.raw)return this.targetMagnet;const targetView=this.targetView;return targetView?this.targetMagnet||targetView.container:null}default:throw new Error(`Unknown terminal type '${type}'`)}}updateConnection(options={}){const edge=this.cell;if(options.translateBy&&edge.isFragmentDescendantOf(options.translateBy)){const tx=options.tx||0,ty=options.ty||0;this.routePoints=new Polyline(this.routePoints).translate(tx,ty).points,this.translateConnectionPoints(tx,ty),this.path.translate(tx,ty)}else{const vertices=edge.getVertices(),anchors=this.findAnchors(vertices);this.sourceAnchor=anchors.source,this.targetAnchor=anchors.target,this.routePoints=this.findRoutePoints(vertices);const connectionPoints=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=connectionPoints.source,this.targetPoint=connectionPoints.target;const markerPoints=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,markerPoints.source||this.sourcePoint,markerPoints.target||this.targetPoint)}this.cleanCache()}findAnchors(vertices){const edge=this.cell,source=edge.source,target=edge.target,firstVertex=vertices[0],lastVertex=vertices[vertices.length-1];return target.priority&&!source.priority?this.findAnchorsOrdered("target",lastVertex,"source",firstVertex):this.findAnchorsOrdered("source",firstVertex,"target",lastVertex)}findAnchorsOrdered(firstType,firstPoint,secondType,secondPoint){let firstAnchor,secondAnchor;const edge=this.cell,firstTerminal=edge[firstType],secondTerminal=edge[secondType],firstView=this.getTerminalView(firstType),secondView=this.getTerminalView(secondType),firstMagnet=this.getTerminalMagnet(firstType),secondMagnet=this.getTerminalMagnet(secondType);if(firstView){let firstRef;firstRef=firstPoint?Point.create(firstPoint):secondView?secondMagnet:Point.create(secondTerminal),firstAnchor=this.getAnchor(firstTerminal.anchor,firstView,firstMagnet,firstRef,firstType)}else firstAnchor=Point.create(firstTerminal);if(secondView){const secondRef=Point.create(secondPoint||firstAnchor);secondAnchor=this.getAnchor(secondTerminal.anchor,secondView,secondMagnet,secondRef,secondType)}else secondAnchor=Point.isPointLike(secondTerminal)?Point.create(secondTerminal):new Point;return{[firstType]:firstAnchor,[secondType]:secondAnchor}}getAnchor(def,cellView,magnet,ref,terminalType){const isEdge=cellView.isEdgeElement(magnet),connecting=this.graph.options.connecting;let anchor,config="string"==typeof def?{name:def}:def;if(!config){const defaults=isEdge?("source"===terminalType?connecting.sourceEdgeAnchor:connecting.targetEdgeAnchor)||connecting.edgeAnchor:("source"===terminalType?connecting.sourceAnchor:connecting.targetAnchor)||connecting.anchor;config="string"==typeof defaults?{name:defaults}:defaults}if(!config)throw new Error("Anchor should be specified.");const name=config.name;if(isEdge){const fn=EdgeAnchor.registry.get(name);if("function"!=typeof fn)return EdgeAnchor.registry.onNotFound(name);anchor=call(fn,this,cellView,magnet,ref,config.args||{},terminalType)}else{const fn=NodeAnchor.registry.get(name);if("function"!=typeof fn)return NodeAnchor.registry.onNotFound(name);anchor=call(fn,this,cellView,magnet,ref,config.args||{},terminalType)}return anchor?anchor.round(this.POINT_ROUNDING):new Point}findRoutePoints(vertices=[]){const defaultRouter=this.graph.options.connecting.router||Router.presets.normal,router=this.cell.getRouter()||defaultRouter;let routePoints;if("function"==typeof router)routePoints=call(router,this,vertices,{},this);else{const name="string"==typeof router?router:router.name,args="string"==typeof router?{}:router.args||{},fn=name?Router.registry.get(name):Router.presets.normal;if("function"!=typeof fn)return Router.registry.onNotFound(name);routePoints=call(fn,this,vertices,args,this)}return null==routePoints?vertices.map((p=>Point.create(p))):routePoints.map((p=>Point.create(p)))}findConnectionPoints(routePoints,sourceAnchor,targetAnchor){const edge=this.cell,connecting=this.graph.options.connecting,sourceTerminal=edge.getSource(),targetTerminal=edge.getTarget(),sourceView=this.sourceView,targetView=this.targetView,firstRoutePoint=routePoints[0],lastRoutePoint=routePoints[routePoints.length-1];let sourcePoint,targetPoint;if(sourceView&&!sourceView.isEdgeElement(this.sourceMagnet)){const sourceMagnet=this.sourceMagnet||sourceView.container,sourceLine=new Line(firstRoutePoint||targetAnchor,sourceAnchor),connectionPointDef=sourceTerminal.connectionPoint||connecting.sourceConnectionPoint||connecting.connectionPoint;sourcePoint=this.getConnectionPoint(connectionPointDef,sourceView,sourceMagnet,sourceLine,"source")}else sourcePoint=sourceAnchor;if(targetView&&!targetView.isEdgeElement(this.targetMagnet)){const targetMagnet=this.targetMagnet||targetView.container,targetConnectionPointDef=targetTerminal.connectionPoint||connecting.targetConnectionPoint||connecting.connectionPoint,targetLine=new Line(lastRoutePoint||sourceAnchor,targetAnchor);targetPoint=this.getConnectionPoint(targetConnectionPointDef,targetView,targetMagnet,targetLine,"target")}else targetPoint=targetAnchor;return{source:sourcePoint,target:targetPoint}}getConnectionPoint(def,view,magnet,line,endType){const anchor=line.end;if(null==def)return anchor;const name="string"==typeof def?def:def.name,args="string"==typeof def?{}:def.args,fn=ConnectionPoint.registry.get(name);if("function"!=typeof fn)return ConnectionPoint.registry.onNotFound(name);const connectionPoint=call(fn,this,line,view,magnet,args||{},endType);return connectionPoint?connectionPoint.round(this.POINT_ROUNDING):anchor}findMarkerPoints(routePoints,sourcePoint,targetPoint){const getLineWidth=type=>{const attrs=this.cell.getAttrs(),keys=Object.keys(attrs);for(let i=0,l=keys.length;i<l;i+=1){const attr=attrs[keys[i]];if(attr[`${type}Marker`]||attr[`${type}-marker`]){const strokeWidth=attr.strokeWidth||attr["stroke-width"];if(strokeWidth)return parseFloat(strokeWidth);break}}return null},firstRoutePoint=routePoints[0],lastRoutePoint=routePoints[routePoints.length-1];let sourceMarkerPoint,targetMarkerPoint;const sourceStrokeWidth=getLineWidth("source");sourceStrokeWidth&&(sourceMarkerPoint=sourcePoint.clone().move(firstRoutePoint||targetPoint,-sourceStrokeWidth));const targetStrokeWidth=getLineWidth("target");return targetStrokeWidth&&(targetMarkerPoint=targetPoint.clone().move(lastRoutePoint||sourcePoint,-targetStrokeWidth)),this.sourceMarkerPoint=sourceMarkerPoint||sourcePoint.clone(),this.targetMarkerPoint=targetMarkerPoint||targetPoint.clone(),{source:sourceMarkerPoint,target:targetMarkerPoint}}findPath(routePoints,sourcePoint,targetPoint){const def=this.cell.getConnector()||this.graph.options.connecting.connector;let name,args,fn;if("string"==typeof def?name=def:(name=def.name,args=def.args),name){const method=Connector.registry.get(name);if("function"!=typeof method)return Connector.registry.onNotFound(name);fn=method}else fn=Connector.presets.normal;const path=call(fn,this,sourcePoint,targetPoint,routePoints,Object.assign(Object.assign({},args),{raw:!0}),this);return"string"==typeof path?Path.parse(path):path}translateConnectionPoints(tx,ty){this.sourcePoint.translate(tx,ty),this.targetPoint.translate(tx,ty),this.sourceAnchor.translate(tx,ty),this.targetAnchor.translate(tx,ty),this.sourceMarkerPoint.translate(tx,ty),this.targetMarkerPoint.translate(tx,ty)}updateLabelPositions(){if(null==this.labelContainer)return this;if(!this.path)return this;const edge=this.cell,labels=edge.getLabels();if(0===labels.length)return this;const defaultLabel=edge.getDefaultLabel(),defaultPosition=this.normalizeLabelPosition(defaultLabel.position);for(let i=0,ii=labels.length;i<ii;i+=1){const label=labels[i],labelNode=this.labelCache[i];if(!labelNode)continue;const labelPosition=this.normalizeLabelPosition(label.position),pos=lodash_es_merge({},defaultPosition,labelPosition),matrix=this.getLabelTransformationMatrix(pos);labelNode.setAttribute("transform",matrixToTransformString(matrix))}return this}updateTerminalProperties(type){const edge=this.cell,graph=this.graph,terminal=edge[type],nodeId=terminal&&terminal.cell,viewKey=`${type}View`;if(!nodeId)return this[viewKey]=null,this.updateTerminalMagnet(type),!0;const terminalCell=graph.getCellById(nodeId);if(!terminalCell)throw new Error(`Edge's ${type} node with id "${nodeId}" not exists`);const endView=terminalCell.findView(graph);return!!endView&&(this[viewKey]=endView,this.updateTerminalMagnet(type),!0)}updateTerminalMagnet(type){const propName=`${type}Magnet`,terminalView=this.getTerminalView(type);if(terminalView){let magnet=terminalView.getMagnetFromEdgeTerminal(this.cell[type]);magnet===terminalView.container&&(magnet=null),this[propName]=magnet}else this[propName]=null}getLabelPositionAngle(idx){const label=this.cell.getLabelAt(idx);return label&&label.position&&"object"==typeof label.position&&label.position.angle||0}getLabelPositionArgs(idx){const label=this.cell.getLabelAt(idx);if(label&&label.position&&"object"==typeof label.position)return label.position.options}getDefaultLabelPositionArgs(){const defaultLabel=this.cell.getDefaultLabel();if(defaultLabel&&defaultLabel.position&&"object"==typeof defaultLabel.position)return defaultLabel.position.options}mergeLabelPositionArgs(labelPositionArgs,defaultLabelPositionArgs){return null===labelPositionArgs?null:void 0===labelPositionArgs?null===defaultLabelPositionArgs?null:defaultLabelPositionArgs:lodash_es_merge({},defaultLabelPositionArgs,labelPositionArgs)}getConnection(){return null!=this.path?this.path.clone():null}getConnectionPathData(){if(null==this.path)return"";const cache=this.cache.pathCache;return lodash_es_has(cache,"data")||(cache.data=this.path.serialize()),cache.data||""}getConnectionSubdivisions(){if(null==this.path)return null;const cache=this.cache.pathCache;return lodash_es_has(cache,"segmentSubdivisions")||(cache.segmentSubdivisions=this.path.getSegmentSubdivisions()),cache.segmentSubdivisions}getConnectionLength(){if(null==this.path)return 0;const cache=this.cache.pathCache;return lodash_es_has(cache,"length")||(cache.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),cache.length}getPointAtLength(length){return null==this.path?null:this.path.pointAtLength(length,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(ratio){return null==this.path?null:(number_isPercentage(ratio)&&(ratio=parseFloat(ratio)/100),this.path.pointAt(ratio,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(length){return null==this.path?null:this.path.tangentAtLength(length,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(ratio){return null==this.path?null:this.path.tangentAt(ratio,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(point){return null==this.path?null:this.path.closestPoint(point,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(point){return null==this.path?null:this.path.closestPointLength(point,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(point){return null==this.path?null:this.path.closestPointNormalizedLength(point,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(x,y,p3,p4){const pos={distance:0};let options,angle=0;"number"==typeof p3?(angle=p3,options=p4):options=p3,null!=options&&(pos.options=options);const isOffsetAbsolute=options&&options.absoluteOffset,isDistanceRelative=!(options&&options.absoluteDistance),isDistanceAbsoluteReverse=options&&options.absoluteDistance&&options.reverseDistance,path=this.path,pathOptions={segmentSubdivisions:this.getConnectionSubdivisions()},labelPoint=new Point(x,y),t=path.closestPointT(labelPoint,pathOptions),totalLength=this.getConnectionLength()||0;let tangent,labelOffset,labelDistance=path.lengthAtT(t,pathOptions);if(isDistanceRelative&&(labelDistance=totalLength>0?labelDistance/totalLength:0),isDistanceAbsoluteReverse&&(labelDistance=-1*(totalLength-labelDistance)||1),pos.distance=labelDistance,isOffsetAbsolute||(tangent=path.tangentAtT(t)),tangent)labelOffset=tangent.pointOffset(labelPoint);else{const closestPoint=path.pointAtT(t),labelOffsetDiff=labelPoint.diff(closestPoint);labelOffset={x:labelOffsetDiff.x,y:labelOffsetDiff.y}}return pos.offset=labelOffset,pos.angle=angle,pos}normalizeLabelPosition(pos){return"number"==typeof pos?{distance:pos}:pos}getLabelTransformationMatrix(labelPosition){const pos=this.normalizeLabelPosition(labelPosition),options=pos.options||{},labelAngle=pos.angle||0,labelDistance=pos.distance,isDistanceRelative=labelDistance>0&&labelDistance<=1;let labelOffset=0;const offsetCoord={x:0,y:0},offset=pos.offset;offset&&("number"==typeof offset?labelOffset=offset:(null!=offset.x&&(offsetCoord.x=offset.x),null!=offset.y&&(offsetCoord.y=offset.y)));const isOffsetAbsolute=0!==offsetCoord.x||0!==offsetCoord.y||0===labelOffset,isKeepGradient=options.keepGradient,isEnsureLegibility=options.ensureLegibility,path=this.path,pathOpt={segmentSubdivisions:this.getConnectionSubdivisions()},distance=isDistanceRelative?labelDistance*this.getConnectionLength():labelDistance,tangent=path.tangentAtLength(distance,pathOpt);let translation,angle=labelAngle;if(tangent){if(isOffsetAbsolute)translation=tangent.start,translation.translate(offsetCoord);else{const normal=tangent.clone();normal.rotate(-90,tangent.start),normal.setLength(labelOffset),translation=normal.end}isKeepGradient&&(angle=tangent.angle()+labelAngle,isEnsureLegibility&&(angle=Angle.normalize((angle+90)%180-90)))}else translation=path.start,isOffsetAbsolute&&translation.translate(offsetCoord);return createSVGMatrix().translate(translation.x,translation.y).rotate(angle)}getVertexIndex(x,y){const vertices=this.cell.getVertices(),vertexLength=this.getClosestPointLength(new Point(x,y));let index=0;if(null!=vertexLength)for(const ii=vertices.length;index<ii;index+=1){const currentVertex=vertices[index],currentLength=this.getClosestPointLength(currentVertex);if(null!=currentLength&&vertexLength<currentLength)break}return index}getEventArgs(e,x,y){const view=this,edge=view.cell;return null==x||null==y?{e,view,edge,cell:edge}:{e,x,y,view,edge,cell:edge}}notifyUnhandledMouseDown(e,x,y){this.notify("edge:unhandled:mousedown",{e,x,y,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(e,x,y){super.onMouseDown(e,x,y),this.notify("edge:mousedown",this.getEventArgs(e,x,y))}notifyMouseMove(e,x,y){super.onMouseMove(e,x,y),this.notify("edge:mousemove",this.getEventArgs(e,x,y))}notifyMouseUp(e,x,y){super.onMouseUp(e,x,y),this.notify("edge:mouseup",this.getEventArgs(e,x,y))}onClick(e,x,y){super.onClick(e,x,y),this.notify("edge:click",this.getEventArgs(e,x,y))}onDblClick(e,x,y){super.onDblClick(e,x,y),this.notify("edge:dblclick",this.getEventArgs(e,x,y))}onContextMenu(e,x,y){super.onContextMenu(e,x,y),this.notify("edge:contextmenu",this.getEventArgs(e,x,y))}onMouseDown(e,x,y){this.notifyMouseDown(e,x,y),this.startEdgeDragging(e,x,y)}onMouseMove(e,x,y){const data=this.getEventData(e);switch(data.action){case"drag-label":this.dragLabel(e,x,y);break;case"drag-arrowhead":this.dragArrowhead(e,x,y);break;case"drag-edge":this.dragEdge(e,x,y)}return this.notifyMouseMove(e,x,y),data}onMouseUp(e,x,y){const data=this.getEventData(e);switch(data.action){case"drag-label":this.stopLabelDragging(e,x,y);break;case"drag-arrowhead":this.stopArrowheadDragging(e,x,y);break;case"drag-edge":this.stopEdgeDragging(e,x,y)}return this.notifyMouseUp(e,x,y),this.checkMouseleave(e),data}onMouseOver(e){super.onMouseOver(e),this.notify("edge:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("edge:mouseout",this.getEventArgs(e))}onMouseEnter(e){super.onMouseEnter(e),this.notify("edge:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("edge:mouseleave",this.getEventArgs(e))}onMouseWheel(e,x,y,delta){super.onMouseWheel(e,x,y,delta),this.notify("edge:mousewheel",Object.assign({delta},this.getEventArgs(e,x,y)))}onCustomEvent(e,name,x,y){if(findParentByClass(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===name)return void this.cell.remove({ui:!0});this.notify("edge:customevent",Object.assign({name},this.getEventArgs(e,x,y)))}this.notifyMouseDown(e,x,y)}else this.notify("edge:customevent",Object.assign({name},this.getEventArgs(e,x,y))),super.onCustomEvent(e,name,x,y)}onLabelMouseDown(e,x,y){this.notifyMouseDown(e,x,y),this.startLabelDragging(e,x,y);this.getEventData(e).stopPropagation&&e.stopPropagation()}startEdgeDragging(e,x,y){this.can("edgeMovable")?this.setEventData(e,{x,y,moving:!1,action:"drag-edge"}):this.notifyUnhandledMouseDown(e,x,y)}dragEdge(e,x,y){const data=this.getEventData(e);data.moving||(data.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e,x,y,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(x-data.x,y-data.y,{ui:!0}),this.setEventData(e,{x,y}),this.notify("edge:moving",{e,x,y,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(e,x,y){const data=this.getEventData(e);data.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e,x,y,view:this,cell:this.cell,edge:this.cell})),data.moving=!1}prepareArrowheadDragging(type,options){const magnet=this.getTerminalMagnet(type),data={action:"drag-arrowhead",x:options.x,y:options.y,isNewEdge:!0===options.isNewEdge,terminalType:type,initialMagnet:magnet,initialTerminal:lodash_es_clone(this.cell[type]),fallbackAction:options.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(type),options:options.options};return this.beforeArrowheadDragging(data),data}createValidateConnectionArgs(type){const args=[];let opposite;args[4]=type,args[5]=this;let i=0,j=0;"source"===type?(i=2,opposite="target"):(j=2,opposite="source");const terminal=this.cell[opposite],cellId=terminal.cell;if(cellId){let magnet;const view=args[i]=this.graph.findViewByCell(cellId);view&&(magnet=view.getMagnetFromEdgeTerminal(terminal),magnet===view.container&&(magnet=void 0)),args[i+1]=magnet}return(cellView,magnet)=>(args[j]=cellView,args[j+1]=cellView.container===magnet?void 0:magnet,args)}beforeArrowheadDragging(data){data.zIndex=this.cell.zIndex,this.cell.toFront();const style=this.container.style;data.pointerEvents=style.pointerEvents,style.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(data)}afterArrowheadDragging(data){null!=data.zIndex&&(this.cell.setZIndex(data.zIndex,{ui:!0}),data.zIndex=null);this.container.style.pointerEvents=data.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(data)}validateConnection(sourceView,sourceMagnet,targetView,targetMagnet,terminalType,edgeView,candidateTerminal){const options=this.graph.options.connecting,allowLoop=options.allowLoop,allowNode=options.allowNode,allowEdge=options.allowEdge,allowPort=options.allowPort,allowMulti=options.allowMulti,validate=options.validateConnection,edge=edgeView?edgeView.cell:null,terminalView="target"===terminalType?targetView:sourceView,terminalMagnet="target"===terminalType?targetMagnet:sourceMagnet;let valid=!0;const doValidate=validate=>{const sourcePort="source"===terminalType?candidateTerminal?candidateTerminal.port:null:edge?edge.getSourcePortId():null,targetPort="target"===terminalType?candidateTerminal?candidateTerminal.port:null:edge?edge.getTargetPortId():null;return call(validate,this.graph,{edge,edgeView,sourceView,targetView,sourcePort,targetPort,sourceMagnet,targetMagnet,sourceCell:sourceView?sourceView.cell:null,targetCell:targetView?targetView.cell:null,type:terminalType})};if(null!=allowLoop&&("boolean"==typeof allowLoop?allowLoop||sourceView!==targetView||(valid=!1):valid=doValidate(allowLoop)),valid&&null!=allowPort&&("boolean"==typeof allowPort?!allowPort&&terminalMagnet&&(valid=!1):valid=doValidate(allowPort)),valid&&null!=allowEdge&&("boolean"==typeof allowEdge?!allowEdge&&EdgeView.isEdgeView(terminalView)&&(valid=!1):valid=doValidate(allowEdge)),valid&&null!=allowNode&&null==terminalMagnet&&("boolean"==typeof allowNode?!allowNode&&NodeView.isNodeView(terminalView)&&(valid=!1):valid=doValidate(allowNode)),valid&&null!=allowMulti&&edgeView){const edge=edgeView.cell,source="source"===terminalType?candidateTerminal:edge.getSource(),target="target"===terminalType?candidateTerminal:edge.getTarget(),terminalCell=candidateTerminal?this.graph.getCellById(candidateTerminal.cell):null;if(source&&target&&source.cell&&target.cell&&terminalCell)if("function"==typeof allowMulti)valid=doValidate(allowMulti);else{const connectedEdges=this.graph.model.getConnectedEdges(terminalCell,{outgoing:"source"===terminalType,incoming:"target"===terminalType});if(connectedEdges.length)if("withPort"===allowMulti){connectedEdges.some((link=>{const s=link.getSource(),t=link.getTarget();return s&&t&&s.cell===source.cell&&t.cell===target.cell&&null!=s.port&&s.port===source.port&&null!=t.port&&t.port===target.port}))&&(valid=!1)}else if(!allowMulti){connectedEdges.some((link=>{const s=link.getSource(),t=link.getTarget();return s&&t&&s.cell===source.cell&&t.cell===target.cell}))&&(valid=!1)}}}return valid&&null!=validate&&(valid=doValidate(validate)),valid}allowConnectToBlank(edge){const graph=this.graph,allowBlank=graph.options.connecting.allowBlank;if("function"!=typeof allowBlank)return!!allowBlank;const edgeView=graph.findViewByCell(edge),sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell(),sourceView=graph.findViewByCell(sourceCell),targetView=graph.findViewByCell(targetCell);return call(allowBlank,graph,{edge,edgeView,sourceCell,targetCell,sourceView,targetView,sourcePort:edge.getSourcePortId(),targetPort:edge.getTargetPortId(),sourceMagnet:edgeView.sourceMagnet,targetMagnet:edgeView.targetMagnet})}validateEdge(edge,type,initialTerminal){const graph=this.graph;if(!this.allowConnectToBlank(edge)){const sourceId=edge.getSourceCellId(),targetId=edge.getTargetCellId();if(!sourceId||!targetId)return!1}const validate=graph.options.connecting.validateEdge;return!validate||call(validate,graph,{edge,type,previous:initialTerminal})}arrowheadDragging(target,x,y,data){data.x=x,data.y=y,data.currentTarget!==target&&(data.currentMagnet&&data.currentView&&data.currentView.unhighlight(data.currentMagnet,{type:"magnetAdsorbed"}),data.currentView=this.graph.findViewByElem(target),data.currentView?(data.currentMagnet=data.currentView.findMagnet(target),data.currentMagnet&&this.validateConnection(...data.getValidateConnectionArgs(data.currentView,data.currentMagnet),data.currentView.getEdgeTerminal(data.currentMagnet,x,y,this.cell,data.terminalType))?data.currentView.highlight(data.currentMagnet,{type:"magnetAdsorbed"}):data.currentMagnet=null):data.currentMagnet=null),data.currentTarget=target,this.cell.prop(data.terminalType,{x,y},Object.assign(Object.assign({},data.options),{ui:!0}))}arrowheadDragged(data,x,y){const view=data.currentView,magnet=data.currentMagnet;if(!magnet||!view)return;view.unhighlight(magnet,{type:"magnetAdsorbed"});const type=data.terminalType,terminal=view.getEdgeTerminal(magnet,x,y,this.cell,type);this.cell.setTerminal(type,terminal,{ui:!0})}snapArrowhead(x,y,data){const graph=this.graph,{snap,allowEdge}=graph.options.connecting,radius="object"==typeof snap&&snap.radius||50,anchor="object"==typeof snap&&snap.anchor||"center",views=graph.renderer.findViewsInArea({x:x-radius,y:y-radius,width:2*radius,height:2*radius},{nodeOnly:!0});if(allowEdge){const edgeViews=graph.renderer.findEdgeViewsFromPoint({x,y},radius).filter((view=>view!==this));views.push(...edgeViews)}const prevView=data.closestView||null,prevMagnet=data.closestMagnet||null;let distance;data.closestView=null,data.closestMagnet=null;let minDistance=Number.MAX_SAFE_INTEGER;const pos=new Point(x,y);let terminal;views.forEach((view=>{if("false"!==view.container.getAttribute("magnet")){if(view.isNodeView())distance="center"===anchor?view.cell.getBBox().getCenter().distance(pos):view.cell.getBBox().getNearestPointToPoint(pos).distance(pos);else if(view.isEdgeView()){const point=view.getClosestPoint(pos);distance=point?point.distance(pos):Number.MAX_SAFE_INTEGER}distance<radius&&distance<minDistance&&(prevMagnet===view.container||this.validateConnection(...data.getValidateConnectionArgs(view,null),view.getEdgeTerminal(view.container,x,y,this.cell,data.terminalType)))&&(minDistance=distance,data.closestView=view,data.closestMagnet=view.container)}view.container.querySelectorAll("[magnet]").forEach((magnet=>{if("false"!==magnet.getAttribute("magnet")){const bbox=view.getBBoxOfElement(magnet);distance=pos.distance(bbox.getCenter()),distance<radius&&distance<minDistance&&(prevMagnet===magnet||this.validateConnection(...data.getValidateConnectionArgs(view,magnet),view.getEdgeTerminal(magnet,x,y,this.cell,data.terminalType)))&&(minDistance=distance,data.closestView=view,data.closestMagnet=magnet)}}))}));const type=data.terminalType,closestView=data.closestView,closestMagnet=data.closestMagnet,changed=prevMagnet!==closestMagnet;if(prevView&&changed&&prevView.unhighlight(prevMagnet,{type:"magnetAdsorbed"}),closestView){if(!changed)return;closestView.highlight(closestMagnet,{type:"magnetAdsorbed"}),terminal=closestView.getEdgeTerminal(closestMagnet,x,y,this.cell,type)}else terminal={x,y};this.cell.setTerminal(type,terminal,{},Object.assign(Object.assign({},data.options),{ui:!0}))}snapArrowheadEnd(data){const closestView=data.closestView,closestMagnet=data.closestMagnet;closestView&&closestMagnet&&(closestView.unhighlight(closestMagnet,{type:"magnetAdsorbed"}),data.currentMagnet=closestView.findMagnet(closestMagnet)),data.closestView=null,data.closestMagnet=null}finishEmbedding(data){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(data.zIndex=null)}fallbackConnection(data){if("remove"===data.fallbackAction)this.cell.remove({ui:!0});else this.cell.prop(data.terminalType,data.initialTerminal,{ui:!0})}notifyConnectionEvent(data,e){const terminalType=data.terminalType,initialTerminal=data.initialTerminal,currentTerminal=this.cell[terminalType];if(currentTerminal&&!Edge.equalTerminals(initialTerminal,currentTerminal)){const graph=this.graph,previous=initialTerminal,previousCell=previous.cell?graph.getCellById(previous.cell):null,previousPort=previous.port,previousView=previousCell?graph.findViewByCell(previousCell):null,previousPoint=previousCell||data.isNewEdge?null:Point.create(initialTerminal).toJSON(),current=currentTerminal,currentCell=current.cell?graph.getCellById(current.cell):null,currentPort=current.port,currentView=currentCell?graph.findViewByCell(currentCell):null,currentPoint=currentCell?null:Point.create(currentTerminal).toJSON();this.notify("edge:connected",{e,previousCell,previousPort,previousView,previousPoint,currentCell,currentView,currentPort,currentPoint,previousMagnet:data.initialMagnet,currentMagnet:data.currentMagnet,edge:this.cell,view:this,type:terminalType,isNew:data.isNewEdge})}}highlightAvailableMagnets(data){const graph=this.graph,cells=graph.model.getCells();data.marked={};for(let i=0,ii=cells.length;i<ii;i+=1){const view=graph.findViewByCell(cells[i]);if(!view||view.cell.id===this.cell.id)continue;const magnets=Array.prototype.slice.call(view.container.querySelectorAll("[magnet]"));"false"!==view.container.getAttribute("magnet")&&magnets.push(view.container);const availableMagnets=magnets.filter((magnet=>this.validateConnection(...data.getValidateConnectionArgs(view,magnet),view.getEdgeTerminal(magnet,data.x,data.y,this.cell,data.terminalType))));if(availableMagnets.length>0){for(let j=0,jj=availableMagnets.length;j<jj;j+=1)view.highlight(availableMagnets[j],{type:"magnetAvailable"});view.highlight(null,{type:"nodeAvailable"}),data.marked[view.cell.id]=availableMagnets}}}unhighlightAvailableMagnets(data){const marked=data.marked||{};Object.keys(marked).forEach((id=>{const view=this.graph.findViewByCell(id);if(view){marked[id].forEach((magnet=>{view.unhighlight(magnet,{type:"magnetAvailable"})})),view.unhighlight(null,{type:"nodeAvailable"})}})),data.marked=null}startArrowheadDragging(e,x,y){if(!this.can("arrowheadMovable"))return void this.notifyUnhandledMouseDown(e,x,y);const type=e.target.getAttribute("data-terminal"),data=this.prepareArrowheadDragging(type,{x,y});this.setEventData(e,data)}dragArrowhead(e,x,y){const data=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(x,y,data):this.arrowheadDragging(this.getEventTarget(e),x,y,data)}stopArrowheadDragging(e,x,y){const graph=this.graph,data=this.getEventData(e);graph.options.connecting.snap?this.snapArrowheadEnd(data):this.arrowheadDragged(data,x,y);this.validateEdge(this.cell,data.terminalType,data.initialTerminal)?(this.finishEmbedding(data),this.notifyConnectionEvent(data,e)):this.fallbackConnection(data),this.afterArrowheadDragging(data)}startLabelDragging(e,x,y){if(this.can("edgeLabelMovable")){const target=e.currentTarget,index=parseInt(target.getAttribute("data-index"),10),positionAngle=this.getLabelPositionAngle(index),labelPositionArgs=this.getLabelPositionArgs(index),defaultLabelPositionArgs=this.getDefaultLabelPositionArgs(),positionArgs=this.mergeLabelPositionArgs(labelPositionArgs,defaultLabelPositionArgs);this.setEventData(e,{index,positionAngle,positionArgs,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}dragLabel(e,x,y){const data=this.getEventData(e),originLabel=this.cell.getLabelAt(data.index),label=lodash_es_merge({},originLabel,{position:this.getLabelPosition(x,y,data.positionAngle,data.positionArgs)});this.cell.setLabelAt(data.index,label)}stopLabelDragging(e,x,y){}}!function(EdgeView){EdgeView.toStringTag=`X6.${EdgeView.name}`,EdgeView.isEdgeView=function isEdgeView(instance){if(null==instance)return!1;if(instance instanceof EdgeView)return!0;const tag=instance[Symbol.toStringTag],view=instance;return(null==tag||tag===EdgeView.toStringTag)&&"function"==typeof view.isNodeView&&"function"==typeof view.isEdgeView&&"function"==typeof view.confirmUpdate&&"function"==typeof view.update&&"function"==typeof view.getConnection}}(EdgeView||(EdgeView={})),EdgeView.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),EdgeView.registry.register("edge",EdgeView,!0);var graph_view_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class GraphView extends View{get disposeContainer(){return!1}get options(){return this.graph.options}constructor(graph){super(),this.graph=graph;const{selectors,fragment}=Markup.parseJSONMarkup(GraphView.markup);this.background=selectors.background,this.grid=selectors.grid,this.svg=selectors.svg,this.defs=selectors.defs,this.viewport=selectors.viewport,this.primer=selectors.primer,this.stage=selectors.stage,this.decorator=selectors.decorator,this.overlay=selectors.overlay,this.container=this.options.container,this.restore=GraphView.snapshoot(this.container),addClass(this.container,this.prefixClassName("graph")),append(this.container,fragment),this.delegateEvents()}delegateEvents(){const ctor=this.constructor;return super.delegateEvents(ctor.events),this}guard(e,view){return"mousedown"===e.type&&2===e.button||(!(!this.options.guard||!this.options.guard(e,view))||(e.data&&void 0!==e.data.guarded?e.data.guarded:!(view&&view.cell&&Cell.isCell(view.cell))&&(this.svg!==e.target&&this.container!==e.target&&!this.svg.contains(e.target))))}findView(elem){return this.graph.findViewByElem(elem)}onDblClick(evt){this.options.preventDefaultDblClick&&evt.preventDefault();const e=this.normalizeEvent(evt),view=this.findView(e.target);if(this.guard(e,view))return;const localPoint=this.graph.snapToGrid(e.clientX,e.clientY);view?view.onDblClick(e,localPoint.x,localPoint.y):this.graph.trigger("blank:dblclick",{e,x:localPoint.x,y:localPoint.y})}onClick(evt){if(this.getMouseMovedCount(evt)<=this.options.clickThreshold){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(this.guard(e,view))return;const localPoint=this.graph.snapToGrid(e.clientX,e.clientY);view?view.onClick(e,localPoint.x,localPoint.y):this.graph.trigger("blank:click",{e,x:localPoint.x,y:localPoint.y})}}isPreventDefaultContextMenu(view){let preventDefaultContextMenu=this.options.preventDefaultContextMenu;return"function"==typeof preventDefaultContextMenu&&(preventDefaultContextMenu=call(preventDefaultContextMenu,this.graph,{view})),preventDefaultContextMenu}onContextMenu(evt){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(this.isPreventDefaultContextMenu(view)&&evt.preventDefault(),this.guard(e,view))return;const localPoint=this.graph.snapToGrid(e.clientX,e.clientY);view?view.onContextMenu(e,localPoint.x,localPoint.y):this.graph.trigger("blank:contextmenu",{e,x:localPoint.x,y:localPoint.y})}delegateDragEvents(e,view){null==e.data&&(e.data={}),this.setEventData(e,{currentView:view||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});const ctor=this.constructor;this.delegateDocumentEvents(ctor.documentEvents,e.data),this.undelegateEvents()}getMouseMovedCount(e){return this.getEventData(e).mouseMovedCount||0}onMouseDown(evt){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(this.guard(e,view))return;this.options.preventDefaultMouseDown&&evt.preventDefault();const localPoint=this.graph.snapToGrid(e.clientX,e.clientY);view?view.onMouseDown(e,localPoint.x,localPoint.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(e.type)&&evt.preventDefault(),this.graph.trigger("blank:mousedown",{e,x:localPoint.x,y:localPoint.y})),this.delegateDragEvents(e,view)}onMouseMove(evt){const data=this.getEventData(evt),startPosition=data.startPosition;if(startPosition&&startPosition.x===evt.clientX&&startPosition.y===evt.clientY)return;null==data.mouseMovedCount&&(data.mouseMovedCount=0),data.mouseMovedCount+=1;if(data.mouseMovedCount<=this.options.moveThreshold)return;const e=this.normalizeEvent(evt),localPoint=this.graph.snapToGrid(e.clientX,e.clientY),view=data.currentView;view?view.onMouseMove(e,localPoint.x,localPoint.y):this.graph.trigger("blank:mousemove",{e,x:localPoint.x,y:localPoint.y}),this.setEventData(e,data)}onMouseUp(e){this.undelegateDocumentEvents();const normalized=this.normalizeEvent(e),localPoint=this.graph.snapToGrid(normalized.clientX,normalized.clientY),view=this.getEventData(e).currentView;if(view?view.onMouseUp(normalized,localPoint.x,localPoint.y):this.graph.trigger("blank:mouseup",{e:normalized,x:localPoint.x,y:localPoint.y}),!e.isPropagationStopped()){const ev=new EventObject(e,{type:"click",data:e.data});this.onClick(ev)}e.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(evt){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(!this.guard(e,view))if(view)view.onMouseOver(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseover",{e})}}onMouseOut(evt){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(!this.guard(e,view))if(view)view.onMouseOut(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseout",{e})}}onMouseEnter(evt){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(this.guard(e,view))return;const relatedView=this.graph.findViewByElem(e.relatedTarget);if(view){if(relatedView===view)return;view.onMouseEnter(e)}else{if(relatedView)return;this.graph.trigger("graph:mouseenter",{e})}}onMouseLeave(evt){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(this.guard(e,view))return;const relatedView=this.graph.findViewByElem(e.relatedTarget);if(view){if(relatedView===view)return;view.onMouseLeave(e)}else{if(relatedView)return;this.graph.trigger("graph:mouseleave",{e})}}onMouseWheel(evt){const e=this.normalizeEvent(evt),view=this.findView(e.target);if(this.guard(e,view))return;const originalEvent=e.originalEvent,localPoint=this.graph.snapToGrid(originalEvent.clientX,originalEvent.clientY),delta=Math.max(-1,Math.min(1,originalEvent.wheelDelta||-originalEvent.detail));view?view.onMouseWheel(e,localPoint.x,localPoint.y,delta):this.graph.trigger("blank:mousewheel",{e,delta,x:localPoint.x,y:localPoint.y})}onCustomEvent(evt){const elem=evt.currentTarget,event=elem.getAttribute("event")||elem.getAttribute("data-event");if(event){const view=this.findView(elem);if(view){const e=this.normalizeEvent(evt);if(this.guard(e,view))return;const localPoint=this.graph.snapToGrid(e.clientX,e.clientY);view.onCustomEvent(e,event,localPoint.x,localPoint.y)}}}handleMagnetEvent(evt,handler){const magnetElem=evt.currentTarget,magnetValue=magnetElem.getAttribute("magnet");if(magnetValue&&"false"!==magnetValue.toLowerCase()){const view=this.findView(magnetElem);if(view){const e=this.normalizeEvent(evt);if(this.guard(e,view))return;const localPoint=this.graph.snapToGrid(e.clientX,e.clientY);call(handler,this.graph,view,e,magnetElem,localPoint.x,localPoint.y)}}}onMagnetMouseDown(e){this.handleMagnetEvent(e,((view,e,magnet,x,y)=>{view.onMagnetMouseDown(e,magnet,x,y)}))}onMagnetDblClick(e){this.handleMagnetEvent(e,((view,e,magnet,x,y)=>{view.onMagnetDblClick(e,magnet,x,y)}))}onMagnetContextMenu(e){const view=this.findView(e.target);this.isPreventDefaultContextMenu(view)&&e.preventDefault(),this.handleMagnetEvent(e,((view,e,magnet,x,y)=>{view.onMagnetContextMenu(e,magnet,x,y)}))}onLabelMouseDown(evt){const labelNode=evt.currentTarget,view=this.findView(labelNode);if(view){const e=this.normalizeEvent(evt);if(this.guard(e,view))return;const localPoint=this.graph.snapToGrid(e.clientX,e.clientY);view.onLabelMouseDown(e,localPoint.x,localPoint.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}graph_view_decorate([View.dispose()],GraphView.prototype,"dispose",null),function(GraphView){const prefixCls=`${Config.prefixCls}-graph`;GraphView.markup=[{ns:elem_ns.xhtml,tagName:"div",selector:"background",className:`${prefixCls}-background`},{ns:elem_ns.xhtml,tagName:"div",selector:"grid",className:`${prefixCls}-grid`},{ns:elem_ns.svg,tagName:"svg",selector:"svg",className:`${prefixCls}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":elem_ns.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${prefixCls}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${prefixCls}-svg-primer`},{tagName:"g",selector:"stage",className:`${prefixCls}-svg-stage`},{tagName:"g",selector:"decorator",className:`${prefixCls}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${prefixCls}-svg-overlay`}]}]}],GraphView.snapshoot=function snapshoot(elem){const cloned=elem.cloneNode();return elem.childNodes.forEach((child=>cloned.appendChild(child))),()=>{for(empty(elem);elem.attributes.length>0;)elem.removeAttribute(elem.attributes[0].name);for(let i=0,l=cloned.attributes.length;i<l;i+=1){const attr=cloned.attributes[i];elem.setAttribute(attr.name,attr.value)}cloned.childNodes.forEach((child=>elem.appendChild(child)))}}}(GraphView||(GraphView={})),function(GraphView){const prefixCls=Config.prefixCls;GraphView.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${prefixCls}-cell`]:"onMouseEnter",[`mouseleave  .${prefixCls}-cell`]:"onMouseLeave",[`mouseenter  .${prefixCls}-cell-tools`]:"onMouseEnter",[`mouseleave  .${prefixCls}-cell-tools`]:"onMouseLeave",[`mousedown   .${prefixCls}-cell [event]`]:"onCustomEvent",[`touchstart  .${prefixCls}-cell [event]`]:"onCustomEvent",[`mousedown   .${prefixCls}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${prefixCls}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${prefixCls}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${prefixCls}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${prefixCls}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${prefixCls}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${prefixCls}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${prefixCls}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${prefixCls}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${prefixCls}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${prefixCls}-cell image`]:"onImageDragStart",[`mousedown   .${prefixCls}-edge .${prefixCls}-edge-label`]:"onLabelMouseDown",[`touchstart  .${prefixCls}-edge .${prefixCls}-edge-label`]:"onLabelMouseDown"},GraphView.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(GraphView||(GraphView={}));class base_Base extends Disposable{get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}constructor(graph){super(),this.graph=graph,this.init()}init(){}}var css_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class CSSManager extends base_Base{init(){Config.autoInsertCSS&&function loader_ensure(name,content){const cssModule=cssModules.find((m=>m.name===name));if(!(cssModule&&(cssModule.loadTimes+=1,cssModule.loadTimes>1)||Platform.isApplyingHMR())){const styleElement=document.createElement("style");styleElement.setAttribute("type","text/css"),styleElement.textContent=content;const head=document.querySelector("head");head&&head.insertBefore(styleElement,head.firstChild),cssModules.push({name,loadTimes:1,styleElement})}}("core",".x6-graph {\n  position: relative;\n  overflow: hidden;\n  outline: none;\n  touch-action: none;\n}\n.x6-graph-background,\n.x6-graph-grid,\n.x6-graph-svg {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-background-stage,\n.x6-graph-grid-stage,\n.x6-graph-svg-stage {\n  user-select: none;\n}\n.x6-graph.x6-graph-pannable {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph.x6-graph-panning {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-node {\n  cursor: move;\n  /* stylelint-disable-next-line */\n}\n.x6-node.x6-node-immovable {\n  cursor: default;\n}\n.x6-node * {\n  -webkit-user-drag: none;\n}\n.x6-node .scalable * {\n  vector-effect: non-scaling-stroke;\n}\n.x6-node [magnet='true'] {\n  cursor: crosshair;\n  transition: opacity 0.3s;\n}\n.x6-node [magnet='true']:hover {\n  opacity: 0.7;\n}\n.x6-node foreignObject {\n  display: block;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-node foreignObject > body {\n  position: static;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-edge .source-marker,\n.x6-edge .target-marker {\n  vector-effect: non-scaling-stroke;\n}\n.x6-edge .connection {\n  stroke-linejoin: round;\n  fill: none;\n}\n.x6-edge .connection-wrap {\n  cursor: move;\n  opacity: 0;\n  fill: none;\n  stroke: #000;\n  stroke-width: 15;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n.x6-edge .connection-wrap:hover {\n  opacity: 0.4;\n  stroke-opacity: 0.4;\n}\n.x6-edge .vertices {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .vertices .vertex {\n  fill: #1abc9c;\n}\n.x6-edge .vertices .vertex :hover {\n  fill: #34495e;\n  stroke: none;\n}\n.x6-edge .vertices .vertex-remove {\n  cursor: pointer;\n  fill: #fff;\n}\n.x6-edge .vertices .vertex-remove-area {\n  cursor: pointer;\n  opacity: 0.1;\n}\n.x6-edge .vertices .vertex-group:hover .vertex-remove-area {\n  opacity: 1;\n}\n.x6-edge .arrowheads {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .arrowheads .arrowhead {\n  fill: #1abc9c;\n}\n.x6-edge .arrowheads .arrowhead :hover {\n  fill: #f39c12;\n  stroke: none;\n}\n.x6-edge .tools {\n  cursor: pointer;\n  opacity: 0;\n}\n.x6-edge .tools .tool-options {\n  display: none;\n}\n.x6-edge .tools .tool-remove circle {\n  fill: #f00;\n}\n.x6-edge .tools .tool-remove path {\n  fill: #fff;\n}\n.x6-edge:hover .vertices,\n.x6-edge:hover .arrowheads,\n.x6-edge:hover .tools {\n  opacity: 1;\n}\n.x6-highlight-opacity {\n  opacity: 0.3;\n}\n.x6-cell-tool-editor {\n  position: relative;\n  display: inline-block;\n  min-height: 1em;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n  white-space: normal;\n  text-align: center;\n  vertical-align: top;\n  overflow-wrap: normal;\n  outline: none;\n  transform-origin: 0 0;\n  -webkit-user-drag: none;\n}\n.x6-edge-tool-editor {\n  border: 1px solid #275fc5;\n  border-radius: 2px;\n}\n")}dispose(){!function clean(name){const index=cssModules.findIndex((m=>m.name===name));if(index>-1){const cssModule=cssModules[index];if(cssModule.loadTimes-=1,cssModule.loadTimes>0)return;let styleElement=cssModule.styleElement;styleElement&&styleElement.parentNode&&styleElement.parentNode.removeChild(styleElement),styleElement=null,cssModules.splice(index,1)}}("core")}}css_decorate([CSSManager.dispose()],CSSManager.prototype,"dispose",null);var Options,options_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};!function(Options){Options.get=function get(options){const{grid,panning,mousewheel,embedding}=options,others=options_rest(options,["grid","panning","mousewheel","embedding"]),container=options.container;if(null==container)throw new Error("Ensure the container of the graph is specified and valid");null==others.width&&(others.width=container.clientWidth),null==others.height&&(others.height=container.clientHeight);const result=lodash_es_merge({},Options.defaults,others),defaultGrid={size:10,visible:!1};return result.grid="number"==typeof grid?{size:grid,visible:!1}:"boolean"==typeof grid?Object.assign(Object.assign({},defaultGrid),{visible:grid}):Object.assign(Object.assign({},defaultGrid),grid),["panning","mousewheel","embedding"].forEach((key=>{const val=options[key];"boolean"==typeof val?result[key].enabled=val:result[key]=Object.assign(Object.assign({},result[key]),val)})),result}}(Options||(Options={})),function(Options){Options.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:Config.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:Config.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection:({type,sourceView,targetView})=>null!=("target"===type?targetView:sourceView),createEdge:()=>new edge_Edge},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:()=>!1}}(Options||(Options={}));var grid_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},grid_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class GridManager extends base_Base{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(visible){this.grid.visible!==visible&&(this.grid.visible=visible,this.update())}getGridSize(){return this.grid.size}setGridSize(size){this.grid.size=Math.max(size,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(options){this.clear(),this.instance=null,Object.assign(this.grid,options),this.patterns=this.resolveGrid(options),this.update()}update(options={}){const gridSize=this.grid.size;if(gridSize<=1||!this.grid.visible)return this.clear();const ctm=this.graph.matrix(),grid=this.getInstance(),items=Array.isArray(options)?options:[options];this.patterns.forEach(((settings,index)=>{const id=`pattern_${index}`,sx=ctm.a||1,sy=ctm.d||1,{update,markup}=settings,others=grid_rest(settings,["update","markup"]),options=Object.assign(Object.assign(Object.assign({},others),items[index]),{sx,sy,ox:ctm.e||0,oy:ctm.f||0,width:gridSize*sx,height:gridSize*sy});grid.has(id)||grid.add(id,Vector.create("pattern",{id,patternUnits:"userSpaceOnUse"},Vector.createVectors(markup)).node);const patternElem=grid.get(id);"function"==typeof update&&update(patternElem.childNodes[0],options);let x=options.ox%options.width;x<0&&(x+=options.width);let y=options.oy%options.height;y<0&&(y+=options.height),attr(patternElem,{x,y,width:options.width,height:options.height})}));const base64=(new XMLSerializer).serializeToString(grid.root),url=`url(data:image/svg+xml;base64,${btoa(base64)})`;this.elem.style.backgroundImage=url}getInstance(){return this.instance||(this.instance=new Grid),this.instance}resolveGrid(options){if(!options)return[];const type=options.type;if(null==type)return[Object.assign(Object.assign({},Grid.presets.dot),options.args)];const items=Grid.registry.get(type);if(items){let args=options.args||[];return Array.isArray(args)||(args=[args]),Array.isArray(items)?items.map(((item,index)=>Object.assign(Object.assign({},item),args[index]))):[Object.assign(Object.assign({},items),args[0])]}return Grid.registry.onNotFound(type)}dispose(){this.stopListening(),this.clear()}}grid_decorate([base_Base.dispose()],GridManager.prototype,"dispose",null);class TransformManager extends base_Base{get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get stage(){return this.graph.view.stage}init(){this.resize()}getMatrix(){const transform=this.viewport.getAttribute("transform");return transform!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=transform),createSVGMatrix(this.viewportMatrix)}setMatrix(matrix){const ctm=createSVGMatrix(matrix),transform=matrixToTransformString(ctm);this.viewport.setAttribute("transform",transform),this.viewportMatrix=ctm,this.viewportTransformString=transform}resize(width,height){let w=void 0===width?this.options.width:width,h=void 0===height?this.options.height:height;this.options.width=w,this.options.height=h,"number"==typeof w&&(w=Math.round(w)),"number"==typeof h&&(h=Math.round(h)),this.container.style.width=null==w?"":`${w}px`,this.container.style.height=null==h?"":`${h}px`;const size=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},size)),this}getComputedSize(){let w=this.options.width,h=this.options.height;return lodash_es_isNumber(w)||(w=this.container.clientWidth),lodash_es_isNumber(h)||(h=this.container.clientHeight),{width:w,height:h}}getScale(){return function matrixToScale(matrix){let a,b,c,d;return matrix?(a=null==matrix.a?1:matrix.a,d=null==matrix.d?1:matrix.d,b=matrix.b,c=matrix.c):a=d=1,{sx:b?Math.sqrt(a*a+b*b):a,sy:c?Math.sqrt(c*c+d*d):d}}(this.getMatrix())}scale(sx,sy=sx,ox=0,oy=0){if(sx=this.clampScale(sx),sy=this.clampScale(sy),ox||oy){const ts=this.getTranslation(),tx=ts.tx-ox*(sx-1),ty=ts.ty-oy*(sy-1);tx===ts.tx&&ty===ts.ty||this.translate(tx,ty)}const matrix=this.getMatrix();return matrix.a=sx,matrix.d=sy,this.setMatrix(matrix),this.graph.trigger("scale",{sx,sy,ox,oy}),this}clampScale(scale){const range=this.graph.options.scaling;return lodash_es_clamp(scale,range.min||.01,range.max||16)}getZoom(){return this.getScale().sx}zoom(factor,options){options=options||{};let sx=factor,sy=factor;const scale=this.getScale(),clientSize=this.getComputedSize();let cx=clientSize.width/2,cy=clientSize.height/2;if(options.absolute||(sx+=scale.sx,sy+=scale.sy),options.scaleGrid&&(sx=Math.round(sx/options.scaleGrid)*options.scaleGrid,sy=Math.round(sy/options.scaleGrid)*options.scaleGrid),options.maxScale&&(sx=Math.min(options.maxScale,sx),sy=Math.min(options.maxScale,sy)),options.minScale&&(sx=Math.max(options.minScale,sx),sy=Math.max(options.minScale,sy)),options.center&&(cx=options.center.x,cy=options.center.y),sx=this.clampScale(sx),sy=this.clampScale(sy),cx||cy){const ts=this.getTranslation(),tx=cx-(cx-ts.tx)*(sx/scale.sx),ty=cy-(cy-ts.ty)*(sy/scale.sy);tx===ts.tx&&ty===ts.ty||this.translate(tx,ty)}return this.scale(sx,sy),this}getRotation(){return function matrixToRotation(matrix){let p={x:0,y:1};matrix&&(p=deltaTransformPoint(matrix,p));const deg=180*Math.atan2(p.y,p.x)/Math.PI%360-90;return{angle:deg%360+(deg<0?360:0)}}(this.getMatrix())}rotate(angle,cx,cy){if(null==cx||null==cy){const bbox=util_Util.getBBox(this.stage);cx=bbox.width/2,cy=bbox.height/2}const ctm=this.getMatrix().translate(cx,cy).rotate(angle).translate(-cx,-cy);return this.setMatrix(ctm),this}getTranslation(){return function matrixToTranslation(matrix){return{tx:matrix&&matrix.e||0,ty:matrix&&matrix.f||0}}(this.getMatrix())}translate(tx,ty){const matrix=this.getMatrix();matrix.e=tx||0,matrix.f=ty||0,this.setMatrix(matrix);const ts=this.getTranslation();return this.options.x=ts.tx,this.options.y=ts.ty,this.graph.trigger("translate",Object.assign({},ts)),this}setOrigin(ox,oy){return this.translate(ox||0,oy||0)}fitToContent(gridWidth,gridHeight,padding,options){if("object"==typeof gridWidth){const opts=gridWidth;gridWidth=opts.gridWidth||1,gridHeight=opts.gridHeight||1,padding=opts.padding||0,options=opts}else gridWidth=gridWidth||1,gridHeight=gridHeight||1,padding=padding||0,null==options&&(options={});const paddings=normalizeSides(padding),border=options.border||0,contentArea=options.contentArea?Rectangle.create(options.contentArea):this.getContentArea(options);border>0&&contentArea.inflate(border);const scale=this.getScale(),translate=this.getTranslation(),sx=scale.sx,sy=scale.sy;contentArea.x*=sx,contentArea.y*=sy,contentArea.width*=sx,contentArea.height*=sy;let width=Math.max(Math.ceil((contentArea.width+contentArea.x)/gridWidth),1)*gridWidth,height=Math.max(Math.ceil((contentArea.height+contentArea.y)/gridHeight),1)*gridHeight,tx=0,ty=0;("negative"===options.allowNewOrigin&&contentArea.x<0||"positive"===options.allowNewOrigin&&contentArea.x>=0||"any"===options.allowNewOrigin)&&(tx=Math.ceil(-contentArea.x/gridWidth)*gridWidth,tx+=paddings.left,width+=tx),("negative"===options.allowNewOrigin&&contentArea.y<0||"positive"===options.allowNewOrigin&&contentArea.y>=0||"any"===options.allowNewOrigin)&&(ty=Math.ceil(-contentArea.y/gridHeight)*gridHeight,ty+=paddings.top,height+=ty),width+=paddings.right,height+=paddings.bottom,width=Math.max(width,options.minWidth||0),height=Math.max(height,options.minHeight||0),width=Math.min(width,options.maxWidth||Number.MAX_SAFE_INTEGER),height=Math.min(height,options.maxHeight||Number.MAX_SAFE_INTEGER);const size=this.getComputedSize(),sizeChanged=width!==size.width||height!==size.height;return(tx!==translate.tx||ty!==translate.ty)&&this.translate(tx,ty),sizeChanged&&this.resize(width,height),new Rectangle(-tx/sx,-ty/sy,width/sx,height/sy)}scaleContentToFit(options={}){this.scaleContentToFitImpl(options)}scaleContentToFitImpl(options={},translate=!0){let contentBBox,contentLocalOrigin;if(options.contentArea){const contentArea=options.contentArea;contentBBox=this.graph.localToGraph(contentArea),contentLocalOrigin=Point.create(contentArea)}else contentBBox=this.getContentBBox(options),contentLocalOrigin=this.graph.graphToLocal(contentBBox);if(!contentBBox.width||!contentBBox.height)return;const padding=normalizeSides(options.padding),minScale=options.minScale||0,maxScale=options.maxScale||Number.MAX_SAFE_INTEGER,minScaleX=options.minScaleX||minScale,maxScaleX=options.maxScaleX||maxScale,minScaleY=options.minScaleY||minScale,maxScaleY=options.maxScaleY||maxScale;let fittingBox;if(options.viewportArea)fittingBox=options.viewportArea;else{const computedSize=this.getComputedSize(),currentTranslate=this.getTranslation();fittingBox={x:currentTranslate.tx,y:currentTranslate.ty,width:computedSize.width,height:computedSize.height}}fittingBox=Rectangle.create(fittingBox).moveAndExpand({x:padding.left,y:padding.top,width:-padding.left-padding.right,height:-padding.top-padding.bottom});const currentScale=this.getScale();let newSX=fittingBox.width/contentBBox.width*currentScale.sx,newSY=fittingBox.height/contentBBox.height*currentScale.sy;!1!==options.preserveAspectRatio&&(newSX=newSY=Math.min(newSX,newSY));const gridSize=options.scaleGrid;if(gridSize&&(newSX=gridSize*Math.floor(newSX/gridSize),newSY=gridSize*Math.floor(newSY/gridSize)),newSX=lodash_es_clamp(newSX,minScaleX,maxScaleX),newSY=lodash_es_clamp(newSY,minScaleY,maxScaleY),this.scale(newSX,newSY),translate){const origin=this.options,newOX=fittingBox.x-contentLocalOrigin.x*newSX-origin.x,newOY=fittingBox.y-contentLocalOrigin.y*newSY-origin.y;this.translate(newOX,newOY)}}getContentArea(options={}){return!1!==options.useCellGeometry?this.model.getAllCellsBBox()||new Rectangle:util_Util.getBBox(this.stage)}getContentBBox(options={}){return this.graph.localToGraph(this.getContentArea(options))}getGraphArea(){const rect=Rectangle.fromSize(this.getComputedSize());return this.graph.graphToLocal(rect)}zoomToRect(rect,options={}){const area=Rectangle.create(rect),graph=this.graph;options.contentArea=area,null==options.viewportArea&&(options.viewportArea={x:graph.options.x,y:graph.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(options,!1);const center=area.getCenter();return this.centerPoint(center.x,center.y),this}zoomToFit(options={}){return this.zoomToRect(this.getContentArea(options),options)}centerPoint(x,y){const clientSize=this.getComputedSize(),scale=this.getScale(),ts=this.getTranslation(),cx=clientSize.width/2,cy=clientSize.height/2;y="number"==typeof y?y:cy,x=cx-(x="number"==typeof x?x:cx)*scale.sx,y=cy-y*scale.sy,ts.tx===x&&ts.ty===y||this.translate(x,y)}centerContent(options){const center=this.graph.getContentArea(options).getCenter();this.centerPoint(center.x,center.y)}centerCell(cell){return this.positionCell(cell,"center")}positionPoint(point,x,y){const clientSize=this.getComputedSize();(x=normalizePercentage(x,Math.max(0,clientSize.width)))<0&&(x=clientSize.width+x),(y=normalizePercentage(y,Math.max(0,clientSize.height)))<0&&(y=clientSize.height+y);const ts=this.getTranslation(),scale=this.getScale(),dx=x-point.x*scale.sx,dy=y-point.y*scale.sy;ts.tx===dx&&ts.ty===dy||this.translate(dx,dy)}positionRect(rect,pos){const bbox=Rectangle.create(rect);switch(pos){case"center":return this.positionPoint(bbox.getCenter(),"50%","50%");case"top":return this.positionPoint(bbox.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(bbox.getTopRight(),"100%",0);case"right":return this.positionPoint(bbox.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(bbox.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(bbox.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(bbox.getBottomLeft(),0,"100%");case"left":return this.positionPoint(bbox.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(bbox.getTopLeft(),0,0);default:return this}}positionCell(cell,pos){const bbox=cell.getBBox();return this.positionRect(bbox,pos)}positionContent(pos,options){const rect=this.graph.getContentArea(options);return this.positionRect(rect,pos)}}var background_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class BackgroundManager extends base_Base{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(options={}){let backgroundSize=options.size||"auto auto",backgroundPosition=options.position||"center";const scale=this.graph.transform.getScale(),ts=this.graph.translate();if("object"==typeof backgroundPosition){backgroundPosition=`${ts.tx+scale.sx*(backgroundPosition.x||0)}px ${ts.ty+scale.sy*(backgroundPosition.y||0)}px`}"object"==typeof backgroundSize&&(backgroundSize=Rectangle.fromSize(backgroundSize).scale(scale.sx,scale.sy),backgroundSize=`${backgroundSize.width}px ${backgroundSize.height}px`),this.elem.style.backgroundSize=backgroundSize,this.elem.style.backgroundPosition=backgroundPosition}drawBackgroundImage(img,options={}){if(!(img instanceof HTMLImageElement))return void(this.elem.style.backgroundImage="");const cache=this.optionsCache;if(cache&&cache.image!==options.image)return;let uri;const opacity=options.opacity,backgroundSize=options.size;let backgroundRepeat=options.repeat||"no-repeat";const pattern=Background.registry.get(backgroundRepeat);if("function"==typeof pattern){const quality=options.quality||1;img.width*=quality,img.height*=quality;const canvas=pattern(img,options);if(!(canvas instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");uri=canvas.toDataURL("image/png"),backgroundRepeat=options.repeat&&backgroundRepeat!==options.repeat?options.repeat:"repeat","object"==typeof backgroundSize?(backgroundSize.width*=canvas.width/img.width,backgroundSize.height*=canvas.height/img.height):void 0===backgroundSize&&(options.size={width:canvas.width/quality,height:canvas.height/quality})}else uri=img.src,void 0===backgroundSize&&(options.size={width:img.width,height:img.height});null!=cache&&"object"==typeof options.size&&options.image===cache.image&&options.repeat===cache.repeat&&options.quality===cache.quality&&(cache.size=lodash_es_clone(options.size));const style=this.elem.style;style.backgroundImage=`url(${uri})`,style.backgroundRepeat=backgroundRepeat,style.opacity=null==opacity||opacity>=1?"":`${opacity}`,this.updateBackgroundImage(options)}updateBackgroundColor(color){this.elem.style.backgroundColor=color||""}updateBackgroundOptions(options){this.graph.options.background=options}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(options){const opts=options||{};if(this.updateBackgroundOptions(options),this.updateBackgroundColor(opts.color),opts.image){this.optionsCache=lodash_es_clone(opts);const img=document.createElement("img");img.onload=()=>this.drawBackgroundImage(img,options),img.setAttribute("crossorigin","anonymous"),img.src=opts.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}background_decorate([base_Base.dispose()],BackgroundManager.prototype,"dispose",null);var panning_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class PanningManager extends base_Base{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&!0===this.widgetOptions.enabled}init(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}startListening(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),Event.on(this.graph.container,"mousedown",this.onRightMouseDown),Event.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new MouseWheelHandle(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}stopListening(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),Event.off(this.graph.container,"mousedown",this.onRightMouseDown),Event.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}allowPanning(e,strict){return e.spaceKey=this.isSpaceKeyPressed,this.pannable&&ModifierKey.isMatch(e,this.widgetOptions.modifiers,strict)}startPanning(evt){const e=this.view.normalizeEvent(evt);this.clientX=e.clientX,this.clientY=e.clientY,this.panning=!0,this.updateClassName(),Event.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),Event.on(window,"mouseup.panning",this.stopPanning.bind(this))}pan(evt){const e=this.view.normalizeEvent(evt),dx=e.clientX-this.clientX,dy=e.clientY-this.clientY;this.clientX=e.clientX,this.clientY=e.clientY,this.graph.translateBy(dx,dy)}stopPanning(e){this.panning=!1,this.updateClassName(),Event.off(document.body,".panning"),Event.off(window,".panning")}updateClassName(){const container=this.view.container,panning=this.view.prefixClassName("graph-panning"),pannable=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(addClass(container,panning),removeClass(container,pannable)):(removeClass(container,panning),addClass(container,pannable)):(removeClass(container,panning),removeClass(container,pannable))}onMouseDown({e}){if(!this.allowBlankMouseDown(e))return;const selection=this.graph.getPlugin("selection"),allowRubberband=selection&&selection.allowRubberband(e,!0);(this.allowPanning(e,!0)||this.allowPanning(e)&&!allowRubberband)&&this.startPanning(e)}onRightMouseDown(e){const eventTypes=this.widgetOptions.eventTypes;(null==eventTypes?void 0:eventTypes.includes("rightMouseDown"))&&2===e.button&&this.allowPanning(e,!0)&&this.startPanning(e)}onMouseWheel(e,deltaX,deltaY){this.graph.translateBy(-deltaX,-deltaY)}onSpaceKeyDown(e){32===e.which&&(this.isSpaceKeyPressed=!0)}onSpaceKeyUp(e){32===e.which&&(this.isSpaceKeyPressed=!1)}allowBlankMouseDown(e){const eventTypes=this.widgetOptions.eventTypes;return(null==eventTypes?void 0:eventTypes.includes("leftMouseDown"))&&0===e.button||(null==eventTypes?void 0:eventTypes.includes("mouseWheelDown"))&&1===e.button}allowMouseWheel(e){var _a;return this.pannable&&!e.ctrlKey&&(null===(_a=this.widgetOptions.eventTypes)||void 0===_a?void 0:_a.includes("mouseWheel"))}autoPanning(x,y){const graphArea=this.graph.getGraphArea();let dx=0,dy=0;x<=graphArea.left+10&&(dx=-10),y<=graphArea.top+10&&(dy=-10),x>=graphArea.right-10&&(dx=10),y>=graphArea.bottom-10&&(dy=10),0===dx&&0===dy||this.graph.translateBy(-dx,-dy)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}panning_decorate([base_Base.dispose()],PanningManager.prototype,"dispose",null);var mousewheel_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class MouseWheel extends base_Base{constructor(){super(...arguments),this.cumulatedFactor=1}get widgetOptions(){return this.options.mousewheel}init(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new MouseWheelHandle(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}get disabled(){return!0!==this.widgetOptions.enabled}enable(force){(this.disabled||force)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(e){const guard=this.widgetOptions.guard;return(null==guard||guard(e))&&ModifierKey.isMatch(e,this.widgetOptions.modifiers)}onMouseWheel(e){const guard=this.widgetOptions.guard;if((null==guard||guard(e))&&ModifierKey.isMatch(e,this.widgetOptions.modifiers)){const factor=this.widgetOptions.factor||1.2;null==this.currentScale&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.transform.getScale().sx);e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*factor*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/factor)*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const currentScale=this.currentScale;let targetScale=this.graph.transform.clampScale(currentScale*this.cumulatedFactor);const minScale=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,maxScale=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if(targetScale=lodash_es_clamp(targetScale,minScale,maxScale),targetScale!==currentScale)if(this.widgetOptions.zoomAtMousePosition){const origin=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(targetScale,{absolute:!0,center:origin.clone()})}else this.graph.zoom(targetScale,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}mousewheel_decorate([Disposable.dispose()],MouseWheel.prototype,"dispose",null);var JOB_PRIORITY,virtual_render_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class VirtualRenderManager extends base_Base{init(){this.resetRenderArea=lodash_es_throttle(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}startListening(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}stopListening(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}enableVirtualRender(){this.options.virtual=!0,this.resetRenderArea()}disableVirtualRender(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}resetRenderArea(){if(this.options.virtual){const renderArea=this.graph.getGraphArea();this.graph.renderer.setRenderArea(renderArea)}}dispose(){this.stopListening()}}virtual_render_decorate([base_Base.dispose()],VirtualRenderManager.prototype,"dispose",null);class JobQueue{constructor(){this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}queueJob(job){if(job.priority&JOB_PRIORITY.PRIOR)job.cb();else{const index=this.findInsertionIndex(job);index>=0&&this.queue.splice(index,0,job)}}queueFlush(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.scheduleJob())}queueFlushSync(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.flushJobsSync())}clearJobs(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}flushJobs(){this.isFlushPending=!1,this.isFlushing=!0;const startTime=this.getCurrentTime();let job;for(;(job=this.queue.shift())&&(job.cb(),!(this.getCurrentTime()-startTime>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}flushJobsSync(){let job;for(this.isFlushPending=!1,this.isFlushing=!0;job=this.queue.shift();)try{job.cb()}catch(error){console.log(error)}this.isFlushing=!1}findInsertionIndex(job){let left=0,ins=this.queue.length,right=ins-1;const priority=job.priority;for(;left<=right;){const mid=(right-left>>1)+left;priority<=this.queue[mid].priority?left=mid+1:(ins=mid,right=mid-1)}return ins}scheduleJob(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}cancelScheduleJob(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}getCurrentTime(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():Date.now()-this.initialTime}}!function(JOB_PRIORITY){JOB_PRIORITY[JOB_PRIORITY.Update=2]="Update",JOB_PRIORITY[JOB_PRIORITY.RenderEdge=4]="RenderEdge",JOB_PRIORITY[JOB_PRIORITY.RenderNode=8]="RenderNode",JOB_PRIORITY[JOB_PRIORITY.PRIOR=1048576]="PRIOR"}(JOB_PRIORITY||(JOB_PRIORITY={}));var scheduler_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class Scheduler extends Disposable{get model(){return this.graph.model}get container(){return this.graph.view.stage}constructor(graph){super(),this.views={},this.willRemoveViews={},this.queue=new JobQueue,this.graph=graph,this.init()}init(){this.startListening(),this.renderViews(this.model.getCells())}startListening(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}onModelReseted({options}){this.queue.clearJobs(),this.removeZPivots(),this.resetViews();const cells=this.model.getCells();this.renderViews(cells,Object.assign(Object.assign({},options),{queue:cells.map((cell=>cell.id))}))}onCellAdded({cell,options}){this.renderViews([cell],options)}onCellRemoved({cell}){this.removeViews([cell])}onCellZIndexChanged({cell,options}){const viewItem=this.views[cell.id];viewItem&&this.requestViewUpdate(viewItem.view,Scheduler.FLAG_INSERT,options,JOB_PRIORITY.Update,!0)}onCellVisibleChanged({cell,current}){this.toggleVisible(cell,!!current)}requestViewUpdate(view,flag,options={},priority=JOB_PRIORITY.Update,flush=!0){const id=view.cell.id,viewItem=this.views[id];if(!viewItem)return;viewItem.flag=flag,viewItem.options=options;(view.hasAction(flag,["translate","resize","rotate"])||!1===options.async)&&(priority=JOB_PRIORITY.PRIOR,flush=!1),this.queue.queueJob({id,priority,cb:()=>{this.renderViewInArea(view,flag,options);const queue=options.queue;if(queue){const index=queue.indexOf(view.cell.id);index>=0&&queue.splice(index,1),0===queue.length&&this.graph.trigger("render:done")}}});this.getEffectedEdges(view).forEach((edge=>{this.requestViewUpdate(edge.view,edge.flag,options,priority,!1)})),flush&&this.flush()}setRenderArea(area){this.renderArea=area,this.flushWaitingViews()}isViewMounted(view){if(null==view)return!1;const viewItem=this.views[view.cell.id];return!!viewItem&&viewItem.state===Scheduler.ViewState.MOUNTED}renderViews(cells,options={}){cells.sort(((c1,c2)=>c1.isNode()&&c2.isEdge()?-1:0)),cells.forEach((cell=>{const id=cell.id;let flag=0,viewItem=this.views[id];if(viewItem)flag=Scheduler.FLAG_INSERT;else{const cellView=this.createCellView(cell);cellView&&(cellView.graph=this.graph,flag=Scheduler.FLAG_INSERT|cellView.getBootstrapFlag(),viewItem={view:cellView,flag,options,state:Scheduler.ViewState.CREATED},this.views[id]=viewItem)}viewItem&&this.requestViewUpdate(viewItem.view,flag,options,this.getRenderPriority(viewItem.view),!1)})),this.flush()}renderViewInArea(view,flag,options={}){const cell=view.cell,id=cell.id,viewItem=this.views[id];if(!viewItem)return;let result=0;this.isUpdatable(view)||viewItem.state===Scheduler.ViewState.MOUNTED?(result=this.updateView(view,flag,options),viewItem.flag=result):viewItem.state=Scheduler.ViewState.WAITING,result&&(!cell.isEdge()||result&view.getFlag(["source","target"])||this.queue.queueJob({id,priority:JOB_PRIORITY.RenderEdge,cb:()=>{this.updateView(view,flag,options)}}))}removeViews(cells){cells.forEach((cell=>{const id=cell.id,viewItem=this.views[id];viewItem&&(this.willRemoveViews[id]=viewItem,delete this.views[id],this.queue.queueJob({id,priority:this.getRenderPriority(viewItem.view),cb:()=>{this.removeView(viewItem.view)}}))})),this.flush()}flush(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}flushWaitingViews(){Object.values(this.views).forEach((viewItem=>{if(viewItem&&viewItem.state===Scheduler.ViewState.WAITING){const{view,flag,options}=viewItem;this.requestViewUpdate(view,flag,options,this.getRenderPriority(view),!1)}})),this.flush()}updateView(view,flag,options={}){if(null==view)return 0;if(CellView.isCellView(view)){if(flag&Scheduler.FLAG_REMOVE)return this.removeView(view.cell),0;flag&Scheduler.FLAG_INSERT&&(this.insertView(view),flag^=Scheduler.FLAG_INSERT)}return flag?view.confirmUpdate(flag,options):0}insertView(view){const viewItem=this.views[view.cell.id];if(viewItem){const zIndex=view.cell.getZIndex(),pivot=this.addZPivot(zIndex);this.container.insertBefore(view.container,pivot),view.cell.isVisible()||this.toggleVisible(view.cell,!1),viewItem.state=Scheduler.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view})}}resetViews(){this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach((viewItem=>{viewItem&&this.removeView(viewItem.view)})),this.views={},this.willRemoveViews={}}removeView(view){const cell=view.cell,viewItem=this.willRemoveViews[cell.id];viewItem&&view&&(viewItem.view.remove(),delete this.willRemoveViews[cell.id],this.graph.trigger("view:unmounted",{view}))}toggleVisible(cell,visible){const edges=this.model.getConnectedEdges(cell);for(let i=0,len=edges.length;i<len;i+=1){const edge=edges[i];if(visible){const source=edge.getSourceCell(),target=edge.getTargetCell();if(source&&!source.isVisible()||target&&!target.isVisible())continue;this.toggleVisible(edge,!0)}else this.toggleVisible(edge,!1)}const viewItem=this.views[cell.id];viewItem&&css(viewItem.view.container,{display:visible?"unset":"none"})}addZPivot(zIndex=0){null==this.zPivots&&(this.zPivots={});const pivots=this.zPivots;let pivot=pivots[zIndex];if(pivot)return pivot;pivot=pivots[zIndex]=document.createComment(`z-index:${zIndex+1}`);let neighborZ=-1/0;for(const key in pivots){const currentZ=+key;currentZ<zIndex&&currentZ>neighborZ&&(neighborZ=currentZ)}const layer=this.container;if(neighborZ!==-1/0){const neighborPivot=pivots[neighborZ];layer.insertBefore(pivot,neighborPivot.nextSibling)}else layer.insertBefore(pivot,layer.firstChild);return pivot}removeZPivots(){this.zPivots&&Object.values(this.zPivots).forEach((elem=>{elem&&elem.parentNode&&elem.parentNode.removeChild(elem)})),this.zPivots={}}createCellView(cell){const options={graph:this.graph},createViewHook=this.graph.options.createCellView;if(createViewHook){const ret=call(createViewHook,this.graph,cell);if(ret)return new ret(cell,options);if(null===ret)return null}const view=cell.view;if(null!=view&&"string"==typeof view){const def=CellView.registry.get(view);return def?new def(cell,options):CellView.registry.onNotFound(view)}return cell.isNode()?new NodeView(cell,options):cell.isEdge()?new EdgeView(cell,options):null}getEffectedEdges(view){const effectedEdges=[],cell=view.cell,edges=this.model.getConnectedEdges(cell);for(let i=0,n=edges.length;i<n;i+=1){const edge=edges[i],viewItem=this.views[edge.id];if(!viewItem)continue;const edgeView=viewItem.view;if(!this.isViewMounted(edgeView))continue;const flagLabels=["update"];edge.getTargetCell()===cell&&flagLabels.push("target"),edge.getSourceCell()===cell&&flagLabels.push("source"),effectedEdges.push({id:edge.id,view:edgeView,flag:edgeView.getFlag(flagLabels)})}return effectedEdges}isUpdatable(view){if(view.isNodeView())return!this.renderArea||this.renderArea.isIntersectWithRect(view.cell.getBBox());if(view.isEdgeView()){const edge=view.cell,sourceCell=edge.getSourceCell(),targetCell=edge.getTargetCell();if(this.renderArea&&sourceCell&&targetCell)return this.renderArea.isIntersectWithRect(sourceCell.getBBox())||this.renderArea.isIntersectWithRect(targetCell.getBBox())}return!0}getRenderPriority(view){return view.cell.isNode()?JOB_PRIORITY.RenderNode:JOB_PRIORITY.RenderEdge}dispose(){this.stopListening(),Object.keys(this.views).forEach((id=>{this.views[id].view.dispose()})),this.views={}}}scheduler_decorate([Disposable.dispose()],Scheduler.prototype,"dispose",null),function(Scheduler){Scheduler.FLAG_INSERT=1<<30,Scheduler.FLAG_REMOVE=1<<29,Scheduler.FLAG_RENDER=67108863}(Scheduler||(Scheduler={})),function(Scheduler){let ViewState;!function(ViewState){ViewState[ViewState.CREATED=0]="CREATED",ViewState[ViewState.MOUNTED=1]="MOUNTED",ViewState[ViewState.WAITING=2]="WAITING"}(ViewState=Scheduler.ViewState||(Scheduler.ViewState={}))}(Scheduler||(Scheduler={}));var renderer_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class Renderer extends base_Base{constructor(){super(...arguments),this.schedule=new Scheduler(this.graph)}requestViewUpdate(view,flag,options={}){this.schedule.requestViewUpdate(view,flag,options)}isViewMounted(view){return this.schedule.isViewMounted(view)}setRenderArea(area){this.schedule.setRenderArea(area)}findViewByElem(elem){if(null==elem)return null;const container=this.options.container,target="string"==typeof elem?container.querySelector(elem):elem instanceof Element?elem:elem[0];if(target){const id=this.graph.view.findAttr("data-cell-id",target);if(id){const views=this.schedule.views;if(views[id])return views[id].view}}return null}findViewByCell(cell){if(null==cell)return null;const id=Cell.isCell(cell)?cell.id:cell,views=this.schedule.views;return views[id]?views[id].view:null}findViewsFromPoint(p){const ref={x:p.x,y:p.y};return this.model.getCells().map((cell=>this.findViewByCell(cell))).filter((view=>null!=view&&util_Util.getBBox(view.container,{target:this.view.stage}).containsPoint(ref)))}findEdgeViewsFromPoint(p,threshold=5){return this.model.getEdges().map((edge=>this.findViewByCell(edge))).filter((view=>{if(null!=view){const point=view.getClosestPoint(p);if(point)return point.distance(p)<=threshold}return!1}))}findViewsInArea(rect,options={}){const area=Rectangle.create(rect);return this.model.getCells().map((cell=>this.findViewByCell(cell))).filter((view=>{if(view){if(options.nodeOnly&&!view.isNodeView())return!1;const bbox=util_Util.getBBox(view.container,{target:this.view.stage});return 0===bbox.width?bbox.inflate(1,0):0===bbox.height&&bbox.inflate(0,1),options.strict?area.containsRect(bbox):area.isIntersectWithRect(bbox)}return!1}))}dispose(){this.schedule.dispose()}}renderer_decorate([base_Base.dispose()],Renderer.prototype,"dispose",null);var defs_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class DefsManager extends base_Base{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(id){return null!=this.svg.getElementById(id)}filter(options){let filterId=options.id;const name=options.name;if(filterId||(filterId=`filter-${name}-${this.cid}-${hashcode(JSON.stringify(options))}`),!this.isDefined(filterId)){const fn=Filter.registry.get(name);if(null==fn)return Filter.registry.onNotFound(name);const markup=fn(options.args||{}),attrs=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},options.attrs),{id:filterId});Vector.create(Markup.sanitize(markup),attrs).appendTo(this.defs)}return filterId}gradient(options){let id=options.id;const type=options.type;if(id||(id=`gradient-${type}-${this.cid}-${hashcode(JSON.stringify(options))}`),!this.isDefined(id)){const arr=options.stops.map((stop=>{const opacity=null!=stop.opacity&&Number.isFinite(stop.opacity)?stop.opacity:1;return`<stop offset="${stop.offset}" stop-color="${stop.color}" stop-opacity="${opacity}"/>`})),markup=`<${type}>${arr.join("")}</${type}>`,attrs=Object.assign({id},options.attrs);Vector.create(markup,attrs).appendTo(this.defs)}return id}marker(options){const{id,refX,refY,markerUnits,markerOrient,tagName,children}=options,attrs=defs_rest(options,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let markerId=id;if(markerId||(markerId=`marker-${this.cid}-${hashcode(JSON.stringify(options))}`),!this.isDefined(markerId)){"path"!==tagName&&delete attrs.d;const pathMarker=Vector.create("marker",{refX,refY,id:markerId,overflow:"visible",orient:null!=markerOrient?markerOrient:"auto",markerUnits:markerUnits||"userSpaceOnUse"},children?children.map((_a=>{var{tagName}=_a,other=defs_rest(_a,["tagName"]);return Vector.create(`${tagName}`||"path",kebablizeAttrs(Object.assign(Object.assign({},attrs),other)))})):[Vector.create(tagName||"path",kebablizeAttrs(attrs))]);this.defs.appendChild(pathMarker.node)}return markerId}remove(id){const elem=this.svg.getElementById(id);elem&&elem.parentNode&&elem.parentNode.removeChild(elem)}}class CoordManager extends base_Base{getClientMatrix(){return createSVGMatrix(this.view.stage.getScreenCTM())}getClientOffset(){const rect=this.view.svg.getBoundingClientRect();return new Point(rect.left,rect.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(x,y){return("number"==typeof x?this.clientToLocalPoint(x,y):this.clientToLocalPoint(x.x,x.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(x,y){const localPoint=Point.create(x,y);return util_Util.transformPoint(localPoint,this.graph.matrix())}localToClientPoint(x,y){const localPoint=Point.create(x,y);return util_Util.transformPoint(localPoint,this.getClientMatrix())}localToPagePoint(x,y){return("number"==typeof x?this.localToGraphPoint(x,y):this.localToGraphPoint(x)).translate(this.getPageOffset())}localToGraphRect(x,y,width,height){const localRect=Rectangle.create(x,y,width,height);return util_Util.transformRectangle(localRect,this.graph.matrix())}localToClientRect(x,y,width,height){const localRect=Rectangle.create(x,y,width,height);return util_Util.transformRectangle(localRect,this.getClientMatrix())}localToPageRect(x,y,width,height){return("number"==typeof x?this.localToGraphRect(x,y,width,height):this.localToGraphRect(x)).translate(this.getPageOffset())}graphToLocalPoint(x,y){const graphPoint=Point.create(x,y);return util_Util.transformPoint(graphPoint,this.graph.matrix().inverse())}clientToLocalPoint(x,y){const clientPoint=Point.create(x,y);return util_Util.transformPoint(clientPoint,this.getClientMatrix().inverse())}clientToGraphPoint(x,y){const clientPoint=Point.create(x,y);return util_Util.transformPoint(clientPoint,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(x,y){const graphPoint=Point.create(x,y).diff(this.getPageOffset());return this.graphToLocalPoint(graphPoint)}graphToLocalRect(x,y,width,height){const graphRect=Rectangle.create(x,y,width,height);return util_Util.transformRectangle(graphRect,this.graph.matrix().inverse())}clientToLocalRect(x,y,width,height){const clientRect=Rectangle.create(x,y,width,height);return util_Util.transformRectangle(clientRect,this.getClientMatrix().inverse())}clientToGraphRect(x,y,width,height){const clientRect=Rectangle.create(x,y,width,height);return util_Util.transformRectangle(clientRect,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(x,y,width,height){const graphRect=Rectangle.create(x,y,width,height),pageOffset=this.getPageOffset();return graphRect.x-=pageOffset.x,graphRect.y-=pageOffset.y,this.graphToLocalRect(graphRect)}}var highlight_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class HighlightManager extends base_Base{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:cellView,magnet,options={}}){const resolved=this.resolveHighlighter(options);if(!resolved)return;const key=this.getHighlighterId(magnet,resolved);if(!this.highlights[key]){const highlighter=resolved.highlighter;highlighter.highlight(cellView,magnet,Object.assign({},resolved.args)),this.highlights[key]={cellView,magnet,highlighter,args:resolved.args}}}onCellUnhighlight({magnet,options={}}){const resolved=this.resolveHighlighter(options);if(!resolved)return;const id=this.getHighlighterId(magnet,resolved);this.unhighlight(id)}resolveHighlighter(options){const graphOptions=this.options;let highlighterDef=options.highlighter;if(null==highlighterDef){const type=options.type;highlighterDef=type&&graphOptions.highlighting[type]||graphOptions.highlighting.default}if(null==highlighterDef)return null;const def="string"==typeof highlighterDef?{name:highlighterDef}:highlighterDef,name=def.name,highlighter=Highlighter.registry.get(name);return null==highlighter?Highlighter.registry.onNotFound(name):(Highlighter.check(name,highlighter),{name,highlighter,args:def.args||{}})}getHighlighterId(magnet,options){return ensureId(magnet),options.name+magnet.id+JSON.stringify(options.args)}unhighlight(id){const highlight=this.highlights[id];highlight&&(highlight.highlighter.unhighlight(highlight.cellView,highlight.magnet,highlight.args),delete this.highlights[id])}dispose(){Object.keys(this.highlights).forEach((id=>this.unhighlight(id))),this.stopListening()}}highlight_decorate([HighlightManager.dispose()],HighlightManager.prototype,"dispose",null);var size_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class SizeManager extends base_Base{getScroller(){const scroller=this.graph.getPlugin("scroller");return scroller&&scroller.options.enabled?scroller:null}getContainer(){const scroller=this.getScroller();return scroller?scroller.container.parentElement:this.graph.container.parentElement}getSensorTarget(){const autoResize=this.options.autoResize;if(autoResize)return"boolean"==typeof autoResize?this.getContainer():autoResize}init(){if(this.options.autoResize){const target=this.getSensorTarget();target&&SizeSensor.bind(target,(()=>{const width=target.offsetWidth,height=target.offsetHeight;this.resize(width,height)}))}}resize(width,height){const scroller=this.getScroller();scroller?scroller.resize(width,height):this.graph.transform.resize(width,height)}dispose(){SizeSensor.clear(this.graph.container)}}size_decorate([base_Base.dispose()],SizeManager.prototype,"dispose",null);var graph_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};class Graph extends basecoat_Basecoat{get container(){return this.options.container}get[Symbol.toStringTag](){return Graph.toStringTag}constructor(options){super(),this.installedPlugins=new Set,this.options=Options.get(options),this.css=new CSSManager(this),this.view=new GraphView(this),this.defs=new DefsManager(this),this.coord=new CoordManager(this),this.transform=new TransformManager(this),this.highlight=new HighlightManager(this),this.grid=new GridManager(this),this.background=new BackgroundManager(this),this.options.model?this.model=this.options.model:(this.model=new Model,this.model.graph=this),this.renderer=new Renderer(this),this.panning=new PanningManager(this),this.mousewheel=new MouseWheel(this),this.virtualRender=new VirtualRenderManager(this),this.size=new SizeManager(this)}isNode(cell){return cell.isNode()}isEdge(cell){return cell.isEdge()}resetCells(cells,options={}){return this.model.resetCells(cells,options),this}clearCells(options={}){return this.model.clear(options),this}toJSON(options={}){return this.model.toJSON(options)}parseJSON(data){return this.model.parseJSON(data)}fromJSON(data,options={}){return this.model.fromJSON(data,options),this}getCellById(id){return this.model.getCell(id)}addNode(node,options={}){return this.model.addNode(node,options)}addNodes(nodes,options={}){return this.addCell(nodes.map((node=>Node.isNode(node)?node:this.createNode(node))),options)}createNode(metadata){return this.model.createNode(metadata)}removeNode(node,options={}){return this.model.removeCell(node,options)}addEdge(edge,options={}){return this.model.addEdge(edge,options)}addEdges(edges,options={}){return this.addCell(edges.map((edge=>Edge.isEdge(edge)?edge:this.createEdge(edge))),options)}removeEdge(edge,options={}){return this.model.removeCell(edge,options)}createEdge(metadata){return this.model.createEdge(metadata)}addCell(cell,options={}){return this.model.addCell(cell,options),this}removeCell(cell,options={}){return this.model.removeCell(cell,options)}removeCells(cells,options={}){return this.model.removeCells(cells,options)}removeConnectedEdges(cell,options={}){return this.model.removeConnectedEdges(cell,options)}disconnectConnectedEdges(cell,options={}){return this.model.disconnectConnectedEdges(cell,options),this}hasCell(cell){return this.model.has(cell)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(cell){return this.model.getOutgoingEdges(cell)}getIncomingEdges(cell){return this.model.getIncomingEdges(cell)}getConnectedEdges(cell,options={}){return this.model.getConnectedEdges(cell,options)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(cell){return this.model.isRoot(cell)}isLeafNode(cell){return this.model.isLeaf(cell)}getNeighbors(cell,options={}){return this.model.getNeighbors(cell,options)}isNeighbor(cell1,cell2,options={}){return this.model.isNeighbor(cell1,cell2,options)}getSuccessors(cell,options={}){return this.model.getSuccessors(cell,options)}isSuccessor(cell1,cell2,options={}){return this.model.isSuccessor(cell1,cell2,options)}getPredecessors(cell,options={}){return this.model.getPredecessors(cell,options)}isPredecessor(cell1,cell2,options={}){return this.model.isPredecessor(cell1,cell2,options)}getCommonAncestor(...cells){return this.model.getCommonAncestor(...cells)}getSubGraph(cells,options={}){return this.model.getSubGraph(cells,options)}cloneSubGraph(cells,options={}){return this.model.cloneSubGraph(cells,options)}cloneCells(cells){return this.model.cloneCells(cells)}getNodesFromPoint(x,y){return this.model.getNodesFromPoint(x,y)}getNodesInArea(x,y,w,h,options){return this.model.getNodesInArea(x,y,w,h,options)}getNodesUnderNode(node,options={}){return this.model.getNodesUnderNode(node,options)}searchCell(cell,iterator,options={}){return this.model.search(cell,iterator,options),this}getShortestPath(source,target,options={}){return this.model.getShortestPath(source,target,options)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(cells,options={}){return this.model.getCellsBBox(cells,options)}startBatch(name,data={}){this.model.startBatch(name,data)}stopBatch(name,data={}){this.model.stopBatch(name,data)}batchUpdate(arg1,arg2,arg3){const name="string"==typeof arg1?arg1:"update",execute="string"==typeof arg1?arg2:arg1,data="function"==typeof arg2?arg3:arg2;this.startBatch(name,data);const result=execute();return this.stopBatch(name,data),result}updateCellId(cell,newId){return this.model.updateCellId(cell,newId)}findView(ref){return Cell.isCell(ref)?this.findViewByCell(ref):this.findViewByElem(ref)}findViews(ref){return Rectangle.isRectangleLike(ref)?this.findViewsInArea(ref):Point.isPointLike(ref)?this.findViewsFromPoint(ref):[]}findViewByCell(cell){return this.renderer.findViewByCell(cell)}findViewByElem(elem){return this.renderer.findViewByElem(elem)}findViewsFromPoint(x,y){const p="number"==typeof x?{x,y}:x;return this.renderer.findViewsFromPoint(p)}findViewsInArea(x,y,width,height,options){const rect="number"==typeof x?{x,y,width,height}:x,localOptions="number"==typeof x?options:y;return this.renderer.findViewsInArea(rect,localOptions)}matrix(mat){return void 0===mat?this.transform.getMatrix():(this.transform.setMatrix(mat),this)}resize(width,height){const scroller=this.getPlugin("scroller");return scroller?scroller.resize(width,height):this.transform.resize(width,height),this}scale(sx,sy=sx,cx=0,cy=0){return void 0===sx?this.transform.getScale():(this.transform.scale(sx,sy,cx,cy),this)}zoom(factor,options){const scroller=this.getPlugin("scroller");if(scroller){if(void 0===factor)return scroller.zoom();scroller.zoom(factor,options)}else{if(void 0===factor)return this.transform.getZoom();this.transform.zoom(factor,options)}return this}zoomTo(factor,options={}){const scroller=this.getPlugin("scroller");return scroller?scroller.zoom(factor,Object.assign(Object.assign({},options),{absolute:!0})):this.transform.zoom(factor,Object.assign(Object.assign({},options),{absolute:!0})),this}zoomToRect(rect,options={}){const scroller=this.getPlugin("scroller");return scroller?scroller.zoomToRect(rect,options):this.transform.zoomToRect(rect,options),this}zoomToFit(options={}){const scroller=this.getPlugin("scroller");return scroller?scroller.zoomToFit(options):this.transform.zoomToFit(options),this}rotate(angle,cx,cy){return void 0===angle?this.transform.getRotation():(this.transform.rotate(angle,cx,cy),this)}translate(tx,ty){return void 0===tx?this.transform.getTranslation():(this.transform.translate(tx,ty),this)}translateBy(dx,dy){const ts=this.translate(),tx=ts.tx+dx,ty=ts.ty+dy;return this.translate(tx,ty)}getGraphArea(){return this.transform.getGraphArea()}getContentArea(options={}){return this.transform.getContentArea(options)}getContentBBox(options={}){return this.transform.getContentBBox(options)}fitToContent(gridWidth,gridHeight,padding,options){return this.transform.fitToContent(gridWidth,gridHeight,padding,options)}scaleContentToFit(options={}){return this.transform.scaleContentToFit(options),this}center(options){return this.centerPoint(options)}centerPoint(x,y,options){const scroller=this.getPlugin("scroller");return scroller?scroller.centerPoint(x,y,options):this.transform.centerPoint(x,y),this}centerContent(options){const scroller=this.getPlugin("scroller");return scroller?scroller.centerContent(options):this.transform.centerContent(options),this}centerCell(cell,options){const scroller=this.getPlugin("scroller");return scroller?scroller.centerCell(cell,options):this.transform.centerCell(cell),this}positionPoint(point,x,y,options={}){const scroller=this.getPlugin("scroller");return scroller?scroller.positionPoint(point,x,y,options):this.transform.positionPoint(point,x,y),this}positionRect(rect,direction,options){const scroller=this.getPlugin("scroller");return scroller?scroller.positionRect(rect,direction,options):this.transform.positionRect(rect,direction),this}positionCell(cell,direction,options){const scroller=this.getPlugin("scroller");return scroller?scroller.positionCell(cell,direction,options):this.transform.positionCell(cell,direction),this}positionContent(pos,options){const scroller=this.getPlugin("scroller");return scroller?scroller.positionContent(pos,options):this.transform.positionContent(pos,options),this}snapToGrid(x,y){return this.coord.snapToGrid(x,y)}pageToLocal(x,y,width,height){return Rectangle.isRectangleLike(x)?this.coord.pageToLocalRect(x):"number"==typeof x&&"number"==typeof y&&"number"==typeof width&&"number"==typeof height?this.coord.pageToLocalRect(x,y,width,height):this.coord.pageToLocalPoint(x,y)}localToPage(x,y,width,height){return Rectangle.isRectangleLike(x)?this.coord.localToPageRect(x):"number"==typeof x&&"number"==typeof y&&"number"==typeof width&&"number"==typeof height?this.coord.localToPageRect(x,y,width,height):this.coord.localToPagePoint(x,y)}clientToLocal(x,y,width,height){return Rectangle.isRectangleLike(x)?this.coord.clientToLocalRect(x):"number"==typeof x&&"number"==typeof y&&"number"==typeof width&&"number"==typeof height?this.coord.clientToLocalRect(x,y,width,height):this.coord.clientToLocalPoint(x,y)}localToClient(x,y,width,height){return Rectangle.isRectangleLike(x)?this.coord.localToClientRect(x):"number"==typeof x&&"number"==typeof y&&"number"==typeof width&&"number"==typeof height?this.coord.localToClientRect(x,y,width,height):this.coord.localToClientPoint(x,y)}localToGraph(x,y,width,height){return Rectangle.isRectangleLike(x)?this.coord.localToGraphRect(x):"number"==typeof x&&"number"==typeof y&&"number"==typeof width&&"number"==typeof height?this.coord.localToGraphRect(x,y,width,height):this.coord.localToGraphPoint(x,y)}graphToLocal(x,y,width,height){return Rectangle.isRectangleLike(x)?this.coord.graphToLocalRect(x):"number"==typeof x&&"number"==typeof y&&"number"==typeof width&&"number"==typeof height?this.coord.graphToLocalRect(x,y,width,height):this.coord.graphToLocalPoint(x,y)}clientToGraph(x,y,width,height){return Rectangle.isRectangleLike(x)?this.coord.clientToGraphRect(x):"number"==typeof x&&"number"==typeof y&&"number"==typeof width&&"number"==typeof height?this.coord.clientToGraphRect(x,y,width,height):this.coord.clientToGraphPoint(x,y)}defineFilter(options){return this.defs.filter(options)}defineGradient(options){return this.defs.gradient(options)}defineMarker(options){return this.defs.marker(options)}getGridSize(){return this.grid.getGridSize()}setGridSize(gridSize){return this.grid.setGridSize(gridSize),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(options){return this.grid.draw(options),this}updateBackground(){return this.background.update(),this}drawBackground(options,onGraph){const scroller=this.getPlugin("scroller");return null==scroller||null!=this.options.background&&onGraph?this.background.draw(options):scroller.drawBackground(options,onGraph),this}clearBackground(onGraph){const scroller=this.getPlugin("scroller");return null==scroller||null!=this.options.background&&onGraph?this.background.clear():scroller.clearBackground(onGraph),this}enableVirtualRender(){return this.virtualRender.enableVirtualRender(),this}disableVirtualRender(){return this.virtualRender.disableVirtualRender(),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(enabled){return null==enabled?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():enabled?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){const scroller=this.getPlugin("scroller");return scroller?scroller.isPannable():this.panning.pannable}enablePanning(){const scroller=this.getPlugin("scroller");return scroller?scroller.enablePanning():this.panning.enablePanning(),this}disablePanning(){const scroller=this.getPlugin("scroller");return scroller?scroller.disablePanning():this.panning.disablePanning(),this}togglePanning(pannable){return null==pannable?this.isPannable()?this.disablePanning():this.enablePanning():pannable!==this.isPannable()&&(pannable?this.enablePanning():this.disablePanning()),this}use(plugin,...options){return this.installedPlugins.has(plugin)||(this.installedPlugins.add(plugin),plugin.init(this,...options)),this}getPlugin(pluginName){return Array.from(this.installedPlugins).find((plugin=>plugin.name===pluginName))}getPlugins(pluginName){return Array.from(this.installedPlugins).filter((plugin=>pluginName.includes(plugin.name)))}enablePlugins(plugins){let postPlugins=plugins;Array.isArray(postPlugins)||(postPlugins=[postPlugins]);const aboutToChangePlugins=this.getPlugins(postPlugins);return null==aboutToChangePlugins||aboutToChangePlugins.forEach((plugin=>{var _a;null===(_a=null==plugin?void 0:plugin.enable)||void 0===_a||_a.call(plugin)})),this}disablePlugins(plugins){let postPlugins=plugins;Array.isArray(postPlugins)||(postPlugins=[postPlugins]);const aboutToChangePlugins=this.getPlugins(postPlugins);return null==aboutToChangePlugins||aboutToChangePlugins.forEach((plugin=>{var _a;null===(_a=null==plugin?void 0:plugin.disable)||void 0===_a||_a.call(plugin)})),this}isPluginEnabled(pluginName){var _a;const pluginIns=this.getPlugin(pluginName);return null===(_a=null==pluginIns?void 0:pluginIns.isEnabled)||void 0===_a?void 0:_a.call(pluginIns)}disposePlugins(plugins){let postPlugins=plugins;Array.isArray(postPlugins)||(postPlugins=[postPlugins]);const aboutToChangePlugins=this.getPlugins(postPlugins);return null==aboutToChangePlugins||aboutToChangePlugins.forEach((plugin=>{plugin.dispose(),this.installedPlugins.delete(plugin)})),this}dispose(clean=!0){clean&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach((plugin=>{plugin.dispose()}))}}graph_decorate([basecoat_Basecoat.dispose()],Graph.prototype,"dispose",null),function(Graph){Graph.View=GraphView,Graph.Renderer=Renderer,Graph.MouseWheel=MouseWheel,Graph.DefsManager=DefsManager,Graph.GridManager=GridManager,Graph.CoordManager=CoordManager,Graph.TransformManager=TransformManager,Graph.HighlightManager=HighlightManager,Graph.BackgroundManager=BackgroundManager,Graph.PanningManager=PanningManager}(Graph||(Graph={})),function(Graph){Graph.toStringTag=`X6.${Graph.name}`,Graph.isGraph=function isGraph(instance){if(null==instance)return!1;if(instance instanceof Graph)return!0;const tag=instance[Symbol.toStringTag];return null==tag||tag===Graph.toStringTag}}(Graph||(Graph={})),function(Graph){Graph.render=function render(options,data){const graph=options instanceof HTMLElement?new Graph({container:options}):new Graph(options);return null!=data&&graph.fromJSON(data),graph}}(Graph||(Graph={})),function(Graph){Graph.registerNode=Node.registry.register,Graph.registerEdge=Edge.registry.register,Graph.registerView=CellView.registry.register,Graph.registerAttr=Attr.registry.register,Graph.registerGrid=Grid.registry.register,Graph.registerFilter=Filter.registry.register,Graph.registerNodeTool=NodeTool.registry.register,Graph.registerEdgeTool=EdgeTool.registry.register,Graph.registerBackground=Background.registry.register,Graph.registerHighlighter=Highlighter.registry.register,Graph.registerPortLayout=PortLayout.registry.register,Graph.registerPortLabelLayout=PortLabelLayout.registry.register,Graph.registerMarker=Marker.registry.register,Graph.registerRouter=Router.registry.register,Graph.registerConnector=Connector.registry.register,Graph.registerAnchor=NodeAnchor.registry.register,Graph.registerEdgeAnchor=EdgeAnchor.registry.register,Graph.registerConnectionPoint=ConnectionPoint.registry.register}(Graph||(Graph={})),function(Graph){Graph.unregisterNode=Node.registry.unregister,Graph.unregisterEdge=Edge.registry.unregister,Graph.unregisterView=CellView.registry.unregister,Graph.unregisterAttr=Attr.registry.unregister,Graph.unregisterGrid=Grid.registry.unregister,Graph.unregisterFilter=Filter.registry.unregister,Graph.unregisterNodeTool=NodeTool.registry.unregister,Graph.unregisterEdgeTool=EdgeTool.registry.unregister,Graph.unregisterBackground=Background.registry.unregister,Graph.unregisterHighlighter=Highlighter.registry.unregister,Graph.unregisterPortLayout=PortLayout.registry.unregister,Graph.unregisterPortLabelLayout=PortLabelLayout.registry.unregister,Graph.unregisterMarker=Marker.registry.unregister,Graph.unregisterRouter=Router.registry.unregister,Graph.unregisterConnector=Connector.registry.unregister,Graph.unregisterAnchor=NodeAnchor.registry.unregister,Graph.unregisterEdgeAnchor=EdgeAnchor.registry.unregister,Graph.unregisterConnectionPoint=ConnectionPoint.registry.unregister}(Graph||(Graph={}));var html_decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},html_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class HTML extends Node{}!function(HTML){class View extends NodeView{init(){super.init(),this.cell.on("change:*",this.onCellChangeAny,this)}onCellChangeAny({key}){const content=HTML.shapeMaps[this.cell.shape];if(content){const{effect}=content;effect&&!effect.includes(key)||this.renderHTMLComponent()}}confirmUpdate(flag){const ret=super.confirmUpdate(flag);return this.handleAction(ret,View.action,(()=>this.renderHTMLComponent()))}renderHTMLComponent(){const container=this.selectors&&this.selectors.foContent;if(container){empty(container);const content=HTML.shapeMaps[this.cell.shape];if(!content)return;let{html}=content;"function"==typeof html&&(html=html(this.cell)),html&&("string"==typeof html?container.innerHTML=html:append(container,html))}}dispose(){this.cell.off("change:*",this.onCellChangeAny,this)}}html_decorate([View.dispose()],View.prototype,"dispose",null),HTML.View=View,function(View){View.action="html",View.config({bootstrap:[View.action],actions:{html:View.action}}),NodeView.registry.register("html-view",View,!0)}(View=HTML.View||(HTML.View={}))}(HTML||(HTML={})),function(HTML){HTML.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Markup.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Node.registry.register("html",HTML,!0)}(HTML||(HTML={})),function(HTML){HTML.shapeMaps={},HTML.register=function register(config){const{shape,html,effect,inherit}=config,others=html_rest(config,["shape","html","effect","inherit"]);if(!shape)throw new Error("should specify shape in config");HTML.shapeMaps[shape]={html,effect},Graph.registerNode(shape,Object.assign({inherit:inherit||"html"},others),!0)}}(HTML||(HTML={}))},"./node_modules/@babel/runtime/helpers/esm/OverloadYield.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _OverloadYield(e,d){this.v=e,this.k=d}__webpack_require__.d(__webpack_exports__,{A:()=>_OverloadYield})},"./node_modules/@babel/runtime/helpers/esm/asyncIterator.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _asyncIterator(r){var n,t,o,e=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,o=Symbol.iterator);e--;){if(t&&null!=(n=r[t]))return n.call(r);if(o&&null!=(n=r[o]))return new AsyncFromSyncIterator(n.call(r));t="@@asyncIterator",o="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(r){function AsyncFromSyncIteratorContinuation(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var n=r.done;return Promise.resolve(r.value).then((function(r){return{value:r,done:n}}))}return AsyncFromSyncIterator=function AsyncFromSyncIterator(r){this.s=r,this.n=r.next},AsyncFromSyncIterator.prototype={s:null,n:null,next:function next(){return AsyncFromSyncIteratorContinuation(this.n.apply(this.s,arguments))},return:function _return(r){var n=this.s.return;return void 0===n?Promise.resolve({value:r,done:!0}):AsyncFromSyncIteratorContinuation(n.apply(this.s,arguments))},throw:function _throw(r){var n=this.s.return;return void 0===n?Promise.reject(r):AsyncFromSyncIteratorContinuation(n.apply(this.s,arguments))}},new AsyncFromSyncIterator(r)}__webpack_require__.d(__webpack_exports__,{A:()=>_asyncIterator})},"./node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>_awaitAsyncGenerator});var _OverloadYield_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/OverloadYield.js");function _awaitAsyncGenerator(e){return new _OverloadYield_js__WEBPACK_IMPORTED_MODULE_0__.A(e,0)}},"./node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>_wrapAsyncGenerator});var _OverloadYield_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/OverloadYield.js");function _wrapAsyncGenerator(e){return function(){return new AsyncGenerator(e.apply(this,arguments))}}function AsyncGenerator(e){var r,t;function resume(r,t){try{var n=e[r](t),o=n.value,u=o instanceof _OverloadYield_js__WEBPACK_IMPORTED_MODULE_0__.A;Promise.resolve(u?o.v:o).then((function(t){if(u){var i="return"===r?"return":"next";if(!o.k||t.done)return resume(i,t);t=e[i](t).value}settle(n.done?"return":"normal",t)}),(function(e){resume("throw",e)}))}catch(e){settle("throw",e)}}function settle(e,n){switch(e){case"return":r.resolve({value:n,done:!0});break;case"throw":r.reject(n);break;default:r.resolve({value:n,done:!1})}(r=r.next)?resume(r.key,r.arg):t=null}this._invoke=function(e,n){return new Promise((function(o,u){var i={key:e,arg:n,resolve:o,reject:u,next:null};t?t=t.next=i:(r=t=i,resume(e,n))}))},"function"!=typeof e.return&&(this.return=void 0)}AsyncGenerator.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},AsyncGenerator.prototype.next=function(e){return this._invoke("next",e)},AsyncGenerator.prototype.throw=function(e){return this._invoke("throw",e)},AsyncGenerator.prototype.return=function(e){return this._invoke("return",e)}},"./node_modules/best-effort-json-parser/dist/parse.js":(__unused_webpack_module,exports)=>{"use strict";function parse(s){if(void 0!==s){if(null===s)return null;if(""===s)return"";s=s.replace(/\\+$/,(match=>match.length%2==0?match:match.slice(0,-1)));try{return JSON.parse(s)}catch(e){const[data,reminding]=":"===s.trimLeft()[0]?parseAny(s,e):parseAny(s,e,parseStringWithoutQuote);if(parse.lastParseReminding=reminding,parse.onExtraToken&&reminding.length>0){const trimmedReminding=reminding.trimRight();parse.lastParseReminding=trimmedReminding,trimmedReminding.length>0&&parse.onExtraToken(s,data,trimmedReminding)}return data}}}function parseAny(s,e,fallback){const parser=parsers[s[0]]||fallback;if(!parser)throw console.error(`no parser registered for ${JSON.stringify(s[0])}:`,{s}),e;return parser(s,e)}function parseStringCasual(s,e,delimiters){return'"'===s[0]?parseString(s):"'"===s[0]?parseSingleQuoteString(s):parseStringWithoutQuote(s,e,delimiters)}exports.q=void 0,exports.q=parse,function(parse){parse.onExtraToken=(text,data,reminding)=>{console.error("parsed json with extra tokens:",{text,data,reminding})}}(parse=exports.q||(exports.q={}));const parsers={};function skipSpace(s){return s.trimLeft()}function parseSpace(s,e){return parseAny(s=skipSpace(s),e)}parsers[" "]=parseSpace,parsers["\r"]=parseSpace,parsers["\n"]=parseSpace,parsers["\t"]=parseSpace,parsers["["]=function parseArray(s,e){s=s.substr(1);const acc=[];for(s=skipSpace(s);s.length>0;){if("]"===s[0]){s=s.substr(1);break}const res=parseAny(s,e,((s,e)=>parseStringWithoutQuote(s,e,[",","]"])));acc.push(res[0]),","===(s=skipSpace(s=res[1]))[0]&&(s=skipSpace(s=s.substring(1)))}return[acc,s]};for(const c of"0123456789.-".slice())parsers[c]=parseNumber;function parseNumber(s){for(let i=0;i<s.length;i++){const c=s[i];if(parsers[c]===parseNumber)continue;const num=s.substring(0,i);return s=s.substring(i),[numToStr(num),s]}return[numToStr(s),""]}function numToStr(s){if("-"===s)return-0;const num=+s;return Number.isNaN(num)?s:num}function parseString(s){for(let i=1;i<s.length;i++){const c=s[i];if("\\"!==c){if('"'===c){const str=fixEscapedCharacters(s.substring(0,i+1));return s=s.substring(i+1),[JSON.parse(str),s]}}else i++}return[JSON.parse(fixEscapedCharacters(s)+'"'),""]}function fixEscapedCharacters(s){return s.replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}function parseSingleQuoteString(s){for(let i=1;i<s.length;i++){const c=s[i];if("\\"!==c){if("'"===c){const str=fixEscapedCharacters(s.substring(0,i+1));return s=s.substring(i+1),[JSON.parse('"'+str.slice(1,-1)+'"'),s]}}else i++}return[JSON.parse('"'+fixEscapedCharacters(s.slice(1))+'"'),""]}function parseStringWithoutQuote(s,e,delimiters=[" "]){const index=Math.min(...delimiters.map((delimiter=>{const index=s.indexOf(delimiter);return-1===index?s.length:index})));return[s.substring(0,index).trim(),s.substring(index)]}function parseToken(s,tokenStr,tokenVal,e){for(let i=tokenStr.length;i>=1;i--)if(s.startsWith(tokenStr.slice(0,i)))return[tokenVal,s.slice(i)];{const prefix=JSON.stringify(s.slice(0,tokenStr.length));throw console.error(`unknown token starting with ${prefix}:`,{s}),e}}parsers['"']=parseString,parsers["'"]=parseSingleQuoteString,parsers["{"]=function parseObject(s,e){s=s.substr(1);const acc={};for(s=skipSpace(s);s.length>0;){if("}"===s[0]){s=s.substr(1);break}const keyRes=parseStringCasual(s,e,[":","}"]),key=keyRes[0];if(":"!==(s=skipSpace(s=keyRes[1]))[0]){acc[key]=void 0;break}if(0===(s=skipSpace(s=s.substr(1))).length){acc[key]=void 0;break}const valueRes=parseAny(s,e);acc[key]=valueRes[0],","===(s=skipSpace(s=valueRes[1]))[0]&&(s=skipSpace(s=s.substr(1)))}return[acc,s]},parsers.t=function parseTrue(s,e){return parseToken(s,"true",!0,e)},parsers.f=function parseFalse(s,e){return parseToken(s,"false",!1,e)},parsers.n=function parseNull(s,e){return parseToken(s,"null",null,e)}},"./node_modules/lodash-es/_cloneBuffer.js":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _root_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/_root.js");module=__webpack_require__.hmd(module);var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?_root_js__WEBPACK_IMPORTED_MODULE_0__.A.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;const __WEBPACK_DEFAULT_EXPORT__=function cloneBuffer(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}},"./node_modules/lodash-es/_freeGlobal.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="object"==typeof __webpack_require__.g&&__webpack_require__.g&&__webpack_require__.g.Object===Object&&__webpack_require__.g},"./node_modules/lodash-es/_nodeUtil.js":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _freeGlobal_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/_freeGlobal.js");module=__webpack_require__.hmd(module);var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&_freeGlobal_js__WEBPACK_IMPORTED_MODULE_0__.A.process;const __WEBPACK_DEFAULT_EXPORT__=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}()},"./node_modules/lodash-es/_root.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _freeGlobal_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/_freeGlobal.js"),freeSelf="object"==typeof self&&self&&self.Object===Object&&self;const __WEBPACK_DEFAULT_EXPORT__=_freeGlobal_js__WEBPACK_IMPORTED_MODULE_0__.A||freeSelf||Function("return this")()},"./node_modules/lodash-es/isBuffer.js":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>lodash_es_isBuffer});var _root=__webpack_require__("./node_modules/lodash-es/_root.js");const lodash_es_stubFalse=function stubFalse(){return!1};module=__webpack_require__.hmd(module);var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?_root.A.Buffer:void 0;const lodash_es_isBuffer=(Buffer?Buffer.isBuffer:void 0)||lodash_es_stubFalse},"./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-alert.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>NzAlertModule});var tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js"),ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-animation.mjs"),ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-config.mjs"),ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-outlet.mjs"),ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-icon.mjs"),_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/directionality-CBXD4hga.mjs");function NzAlertComponent_Conditional_0_Conditional_1_Conditional_1_ng_container_0_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainer"](0)}function NzAlertComponent_Conditional_0_Conditional_1_Conditional_1_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzAlertComponent_Conditional_0_Conditional_1_Conditional_1_ng_container_0_Template,1,0,"ng-container",7),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](3);_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r1.nzIcon)}}function NzAlertComponent_Conditional_0_Conditional_1_Conditional_2_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"nz-icon",6),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](3);_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzType",ctx_r1.nzIconType||ctx_r1.inferredIconType)("nzTheme",ctx_r1.iconTheme)}}function NzAlertComponent_Conditional_0_Conditional_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzAlertComponent_Conditional_0_Conditional_1_Conditional_1_Template,1,1,"ng-container")(2,NzAlertComponent_Conditional_0_Conditional_1_Conditional_2_Template,1,2,"nz-icon",6),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzIcon?1:2)}}function NzAlertComponent_Conditional_0_Conditional_2_Conditional_1_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](4);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r1.nzMessage)}}function NzAlertComponent_Conditional_0_Conditional_2_Conditional_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzAlertComponent_Conditional_0_Conditional_2_Conditional_1_ng_container_1_Template,2,1,"ng-container",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](3);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r1.nzMessage)}}function NzAlertComponent_Conditional_0_Conditional_2_Conditional_2_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](4);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r1.nzDescription)}}function NzAlertComponent_Conditional_0_Conditional_2_Conditional_2_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",9),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzAlertComponent_Conditional_0_Conditional_2_Conditional_2_ng_container_1_Template,2,1,"ng-container",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](3);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r1.nzDescription)}}function NzAlertComponent_Conditional_0_Conditional_2_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzAlertComponent_Conditional_0_Conditional_2_Conditional_1_Template,2,1,"span",8)(2,NzAlertComponent_Conditional_0_Conditional_2_Conditional_2_Template,2,1,"span",9),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzMessage?1:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzDescription?2:-1)}}function NzAlertComponent_Conditional_0_Conditional_3_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](3);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r1.nzAction)}}function NzAlertComponent_Conditional_0_Conditional_3_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzAlertComponent_Conditional_0_Conditional_3_ng_container_1_Template,2,1,"ng-container",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r1.nzAction)}}function NzAlertComponent_Conditional_0_Conditional_4_Conditional_1_ng_container_0_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](1,"span",12),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](4);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r1.nzCloseText)}}function NzAlertComponent_Conditional_0_Conditional_4_Conditional_1_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzAlertComponent_Conditional_0_Conditional_4_Conditional_1_ng_container_0_Template,3,1,"ng-container",7),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](3);_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r1.nzCloseText)}}function NzAlertComponent_Conditional_0_Conditional_4_Conditional_2_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"nz-icon",11)}function NzAlertComponent_Conditional_0_Conditional_4_Template(rf,ctx){if(1&rf){const _r3=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"button",10),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("click",(function NzAlertComponent_Conditional_0_Conditional_4_Template_button_click_0_listener(){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r3);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.closeAlert())})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzAlertComponent_Conditional_0_Conditional_4_Conditional_1_Template,1,1,"ng-container")(2,NzAlertComponent_Conditional_0_Conditional_4_Conditional_2_Template,1,0,"nz-icon",11),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzCloseText?1:2)}}function NzAlertComponent_Conditional_0_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("@slideAlertMotion.done",(function NzAlertComponent_Conditional_0_Template_div_animation_slideAlertMotion_done_0_listener(){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.onFadeAnimationDone())})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzAlertComponent_Conditional_0_Conditional_1_Template,3,1,"div",2)(2,NzAlertComponent_Conditional_0_Conditional_2_Template,3,2,"div",3)(3,NzAlertComponent_Conditional_0_Conditional_3_Template,2,1,"div",4)(4,NzAlertComponent_Conditional_0_Conditional_4_Template,3,1,"button",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-alert-rtl","rtl"===ctx_r1.dir)("ant-alert-success","success"===ctx_r1.nzType)("ant-alert-info","info"===ctx_r1.nzType)("ant-alert-warning","warning"===ctx_r1.nzType)("ant-alert-error","error"===ctx_r1.nzType)("ant-alert-no-icon",!ctx_r1.nzShowIcon)("ant-alert-banner",ctx_r1.nzBanner)("ant-alert-closable",ctx_r1.nzCloseable)("ant-alert-with-description",!!ctx_r1.nzDescription),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("@.disabled",ctx_r1.nzNoAnimation)("@slideAlertMotion",void 0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzShowIcon?1:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzMessage||ctx_r1.nzDescription?2:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzAction?3:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r1.nzCloseable||ctx_r1.nzCloseText?4:-1)}}let NzAlertComponent=(()=>{let _nzCloseable_decorators,_nzShowIcon_decorators,_nzCloseable_initializers=[],_nzCloseable_extraInitializers=[],_nzShowIcon_initializers=[],_nzShowIcon_extraInitializers=[];return class NzAlertComponent{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;_nzCloseable_decorators=[(0,ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.H4)()],_nzShowIcon_decorators=[(0,ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.H4)()],(0,tslib__WEBPACK_IMPORTED_MODULE_2__.G4)(null,null,_nzCloseable_decorators,{kind:"field",name:"nzCloseable",static:!1,private:!1,access:{has:obj=>"nzCloseable"in obj,get:obj=>obj.nzCloseable,set:(obj,value)=>{obj.nzCloseable=value}},metadata:_metadata},_nzCloseable_initializers,_nzCloseable_extraInitializers),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.G4)(null,null,_nzShowIcon_decorators,{kind:"field",name:"nzShowIcon",static:!1,private:!1,access:{has:obj=>"nzShowIcon"in obj,get:obj=>obj.nzShowIcon,set:(obj,value)=>{obj.nzShowIcon=value}},metadata:_metadata},_nzShowIcon_initializers,_nzShowIcon_extraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}nzConfigService;cdr;directionality;_nzModuleName="alert";nzAction=null;nzCloseText=null;nzIconType=null;nzMessage=null;nzDescription=null;nzType="info";nzCloseable=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzCloseable_initializers,!1);nzShowIcon=((0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzCloseable_extraInitializers),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzShowIcon_initializers,!1));nzBanner=((0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzShowIcon_extraInitializers),!1);nzNoAnimation=!1;nzIcon=null;nzOnClose=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter;closed=!1;iconTheme="fill";inferredIconType="info-circle";dir="ltr";isTypeSet=!1;isShowIconSet=!1;destroy$=new rxjs__WEBPACK_IMPORTED_MODULE_3__.B;constructor(nzConfigService,cdr,directionality){this.nzConfigService=nzConfigService,this.cdr=cdr,this.directionality=directionality,this.nzConfigService.getConfigChangeEventForComponent("alert").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.Q)(this.destroy$)).subscribe((()=>{this.cdr.markForCheck()}))}ngOnInit(){this.directionality.change?.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.Q)(this.destroy$)).subscribe((direction=>{this.dir=direction,this.cdr.detectChanges()})),this.dir=this.directionality.value}closeAlert(){this.closed=!0}onFadeAnimationDone(){this.closed&&this.nzOnClose.emit(!0)}ngOnChanges(changes){const{nzShowIcon,nzDescription,nzType,nzBanner}=changes;if(nzShowIcon&&(this.isShowIconSet=!0),nzType)switch(this.isTypeSet=!0,this.nzType){case"error":this.inferredIconType="close-circle";break;case"success":this.inferredIconType="check-circle";break;case"info":this.inferredIconType="info-circle";break;case"warning":this.inferredIconType="exclamation-circle"}nzDescription&&(this.iconTheme=this.nzDescription?"outline":"fill"),nzBanner&&(this.isTypeSet||(this.nzType="warning"),this.isShowIconSet||(this.nzShowIcon=!0))}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}static fac=function NzAlertComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzAlertComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.yx),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_5__.D))};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzAlertComponent,selectors:[["nz-alert"]],inputs:{nzAction:"nzAction",nzCloseText:"nzCloseText",nzIconType:"nzIconType",nzMessage:"nzMessage",nzDescription:"nzDescription",nzType:"nzType",nzCloseable:[2,"nzCloseable","nzCloseable",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzShowIcon:[2,"nzShowIcon","nzShowIcon",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzBanner:[2,"nzBanner","nzBanner",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzNoAnimation:[2,"nzNoAnimation","nzNoAnimation",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzIcon:"nzIcon"},outputs:{nzOnClose:"nzOnClose"},exportAs:["nzAlert"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["NgOnChangesFeature"]],decls:1,vars:1,consts:[[1,"ant-alert",3,"ant-alert-rtl","ant-alert-success","ant-alert-info","ant-alert-warning","ant-alert-error","ant-alert-no-icon","ant-alert-banner","ant-alert-closable","ant-alert-with-description"],[1,"ant-alert"],[1,"ant-alert-icon"],[1,"ant-alert-content"],[1,"ant-alert-action"],["type","button","tabindex","0",1,"ant-alert-close-icon"],[3,"nzType","nzTheme"],[4,"nzStringTemplateOutlet"],[1,"ant-alert-message"],[1,"ant-alert-description"],["type","button","tabindex","0",1,"ant-alert-close-icon",3,"click"],["nzType","close"],[1,"ant-alert-close-text"]],template:function NzAlertComponent_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzAlertComponent_Conditional_0_Template,5,24,"div",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.closed?-1:0)},dependencies:[ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_6__.Y3,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_6__.Dn,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_7__.C,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_7__.m],encapsulation:2,data:{animation:[ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_8__.Sn]},changeDetection:0})}})();("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzAlertComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{selector:"nz-alert",exportAs:"nzAlert",animations:[ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_8__.Sn],imports:[ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_6__.Y3,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_7__.C],template:'\n    @if (!closed) {\n      <div\n        class="ant-alert"\n        [class.ant-alert-rtl]="dir === \'rtl\'"\n        [class.ant-alert-success]="nzType === \'success\'"\n        [class.ant-alert-info]="nzType === \'info\'"\n        [class.ant-alert-warning]="nzType === \'warning\'"\n        [class.ant-alert-error]="nzType === \'error\'"\n        [class.ant-alert-no-icon]="!nzShowIcon"\n        [class.ant-alert-banner]="nzBanner"\n        [class.ant-alert-closable]="nzCloseable"\n        [class.ant-alert-with-description]="!!nzDescription"\n        [@.disabled]="nzNoAnimation"\n        [@slideAlertMotion]\n        (@slideAlertMotion.done)="onFadeAnimationDone()"\n      >\n        @if (nzShowIcon) {\n          <div class="ant-alert-icon">\n            @if (nzIcon) {\n              <ng-container *nzStringTemplateOutlet="nzIcon"></ng-container>\n            } @else {\n              <nz-icon [nzType]="nzIconType || inferredIconType" [nzTheme]="iconTheme" />\n            }\n          </div>\n        }\n\n        @if (nzMessage || nzDescription) {\n          <div class="ant-alert-content">\n            @if (nzMessage) {\n              <span class="ant-alert-message">\n                <ng-container *nzStringTemplateOutlet="nzMessage">{{ nzMessage }}</ng-container>\n              </span>\n            }\n            @if (nzDescription) {\n              <span class="ant-alert-description">\n                <ng-container *nzStringTemplateOutlet="nzDescription">{{ nzDescription }}</ng-container>\n              </span>\n            }\n          </div>\n        }\n\n        @if (nzAction) {\n          <div class="ant-alert-action">\n            <ng-container *nzStringTemplateOutlet="nzAction">{{ nzAction }}</ng-container>\n          </div>\n        }\n\n        @if (nzCloseable || nzCloseText) {\n          <button type="button" tabindex="0" class="ant-alert-close-icon" (click)="closeAlert()">\n            @if (nzCloseText) {\n              <ng-container *nzStringTemplateOutlet="nzCloseText">\n                <span class="ant-alert-close-text">{{ nzCloseText }}</span>\n              </ng-container>\n            } @else {\n              <nz-icon nzType="close" />\n            }\n          </button>\n        }\n      </div>\n    }\n  ',changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,preserveWhitespaces:!1}]}],(()=>[{type:ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.yx},{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef},{type:_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_5__.D}]),{nzAction:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzCloseText:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzIconType:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzMessage:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzDescription:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzType:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzCloseable:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzShowIcon:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzBanner:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzNoAnimation:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzIcon:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzOnClose:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Output}]});class NzAlertModule{static fac=function NzAlertModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzAlertModule)};static mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineNgModule"]({type:NzAlertModule,imports:[NzAlertComponent],exports:[NzAlertComponent]});static inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjector"]({imports:[NzAlertComponent]})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzAlertModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,args:[{exports:[NzAlertComponent],imports:[NzAlertComponent]}]}],null,null)},"./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-collapse.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{GB:()=>NzCollapseModule});var tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-animation.mjs"),ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-config.mjs"),ng_zorro_antd_core_no_animation__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-no-animation.mjs"),ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-outlet.mjs"),ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-services.mjs"),ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-util.mjs"),ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-icon.mjs"),_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/directionality-CBXD4hga.mjs");const _c0=["*"],_c1=["collapseHeader"];function NzCollapsePanelComponent_Conditional_2_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"nz-icon",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const expandedIcon_r1=ctx.$implicit,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzType",expandedIcon_r1||"right")("nzRotate",ctx_r1.nzActive?90:0)}}function NzCollapsePanelComponent_Conditional_2_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzCollapsePanelComponent_Conditional_2_ng_container_1_Template,2,2,"ng-container",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r1.nzExpandedIcon)}}function NzCollapsePanelComponent_ng_container_4_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r1.nzHeader)}}function NzCollapsePanelComponent_Conditional_5_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r1.nzExtra)}}function NzCollapsePanelComponent_Conditional_5_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzCollapsePanelComponent_Conditional_5_ng_container_1_Template,2,1,"ng-container",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r1.nzExtra)}}let NzCollapseComponent=(()=>{let _nzAccordion_decorators,_nzBordered_decorators,_nzGhost_decorators,_nzAccordion_initializers=[],_nzAccordion_extraInitializers=[],_nzBordered_initializers=[],_nzBordered_extraInitializers=[],_nzGhost_initializers=[],_nzGhost_extraInitializers=[];return class NzCollapseComponent{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;_nzAccordion_decorators=[(0,ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.H4)()],_nzBordered_decorators=[(0,ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.H4)()],_nzGhost_decorators=[(0,ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.H4)()],(0,tslib__WEBPACK_IMPORTED_MODULE_2__.G4)(null,null,_nzAccordion_decorators,{kind:"field",name:"nzAccordion",static:!1,private:!1,access:{has:obj=>"nzAccordion"in obj,get:obj=>obj.nzAccordion,set:(obj,value)=>{obj.nzAccordion=value}},metadata:_metadata},_nzAccordion_initializers,_nzAccordion_extraInitializers),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.G4)(null,null,_nzBordered_decorators,{kind:"field",name:"nzBordered",static:!1,private:!1,access:{has:obj=>"nzBordered"in obj,get:obj=>obj.nzBordered,set:(obj,value)=>{obj.nzBordered=value}},metadata:_metadata},_nzBordered_initializers,_nzBordered_extraInitializers),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.G4)(null,null,_nzGhost_decorators,{kind:"field",name:"nzGhost",static:!1,private:!1,access:{has:obj=>"nzGhost"in obj,get:obj=>obj.nzGhost,set:(obj,value)=>{obj.nzGhost=value}},metadata:_metadata},_nzGhost_initializers,_nzGhost_extraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}nzConfigService;cdr;directionality;destroy$;_nzModuleName="collapse";nzAccordion=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzAccordion_initializers,!1);nzBordered=((0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzAccordion_extraInitializers),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzBordered_initializers,!0));nzGhost=((0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzBordered_extraInitializers),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzGhost_initializers,!1));nzExpandIconPosition=((0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzGhost_extraInitializers),"start");dir="ltr";listOfNzCollapsePanelComponent=[];constructor(nzConfigService,cdr,directionality,destroy$){this.nzConfigService=nzConfigService,this.cdr=cdr,this.directionality=directionality,this.destroy$=destroy$,this.nzConfigService.getConfigChangeEventForComponent("collapse").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Q)(this.destroy$)).subscribe((()=>{this.cdr.markForCheck()}))}ngOnInit(){this.directionality.change?.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Q)(this.destroy$)).subscribe((direction=>{this.dir=direction,this.cdr.detectChanges()})),this.dir=this.directionality.value}addPanel(value){this.listOfNzCollapsePanelComponent.push(value)}removePanel(value){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(value),1)}click(collapse){this.nzAccordion&&!collapse.nzActive&&this.listOfNzCollapsePanelComponent.filter((item=>item!==collapse)).forEach((item=>{item.nzActive&&(item.nzActive=!1,item.nzActiveChange.emit(item.nzActive),item.markForCheck())})),collapse.nzActive=!collapse.nzActive,collapse.nzActiveChange.emit(collapse.nzActive)}static fac=function NzCollapseComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzCollapseComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.yx),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_4__.D),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4))};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzCollapseComponent,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function NzCollapseComponent_HostBindings(rf,ctx){2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-collapse-icon-position-start","start"===ctx.nzExpandIconPosition)("ant-collapse-icon-position-end","end"===ctx.nzExpandIconPosition)("ant-collapse-ghost",ctx.nzGhost)("ant-collapse-borderless",!ctx.nzBordered)("ant-collapse-rtl","rtl"===ctx.dir)},inputs:{nzAccordion:[2,"nzAccordion","nzAccordion",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzBordered:[2,"nzBordered","nzBordered",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzGhost:[2,"nzGhost","nzGhost",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["ProvidersFeature"]([ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4])],ngContentSelectors:_c0,decls:1,vars:0,template:function NzCollapseComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["projectionDef"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["projection"](0))},encapsulation:2,changeDetection:0})}})();("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzCollapseComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{selector:"nz-collapse",exportAs:"nzCollapse",changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,template:" <ng-content></ng-content> ",host:{class:"ant-collapse","[class.ant-collapse-icon-position-start]":"nzExpandIconPosition === 'start'","[class.ant-collapse-icon-position-end]":"nzExpandIconPosition === 'end'","[class.ant-collapse-ghost]":"nzGhost","[class.ant-collapse-borderless]":"!nzBordered","[class.ant-collapse-rtl]":"dir === 'rtl'"},providers:[ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4]}]}],(()=>[{type:ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.yx},{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef},{type:_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_4__.D},{type:ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4}]),{nzAccordion:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzBordered:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzGhost:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzExpandIconPosition:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}]});let NzCollapsePanelComponent=(()=>{let _nzShowArrow_decorators,_nzShowArrow_initializers=[],_nzShowArrow_extraInitializers=[];return class NzCollapsePanelComponent{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;_nzShowArrow_decorators=[(0,ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.H4)()],(0,tslib__WEBPACK_IMPORTED_MODULE_2__.G4)(null,null,_nzShowArrow_decorators,{kind:"field",name:"nzShowArrow",static:!1,private:!1,access:{has:obj=>"nzShowArrow"in obj,get:obj=>obj.nzShowArrow,set:(obj,value)=>{obj.nzShowArrow=value}},metadata:_metadata},_nzShowArrow_initializers,_nzShowArrow_extraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}nzConfigService;ngZone;cdr;destroy$;_nzModuleName="collapsePanel";nzActive=!1;nzDisabled=!1;nzShowArrow=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzShowArrow_initializers,!0);nzExtra=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zF)(this,_nzShowArrow_extraInitializers);nzHeader;nzExpandedIcon;nzActiveChange=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter;collapseHeader;markForCheck(){this.cdr.markForCheck()}nzCollapseComponent=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NzCollapseComponent,{host:!0});noAnimation=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(ng_zorro_antd_core_no_animation__WEBPACK_IMPORTED_MODULE_6__.z,{optional:!0});constructor(nzConfigService,ngZone,cdr,destroy$){this.nzConfigService=nzConfigService,this.ngZone=ngZone,this.cdr=cdr,this.destroy$=destroy$,this.nzConfigService.getConfigChangeEventForComponent("collapsePanel").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Q)(this.destroy$)).subscribe((()=>{this.cdr.markForCheck()}))}ngOnInit(){this.nzCollapseComponent.addPanel(this),(0,ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_7__.wN)(this.collapseHeader.nativeElement,"click").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.p)((()=>!this.nzDisabled)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Q)(this.destroy$)).subscribe((()=>{this.ngZone.run((()=>{this.nzCollapseComponent.click(this),this.cdr.markForCheck()}))}))}ngOnDestroy(){this.nzCollapseComponent.removePanel(this)}static fac=function NzCollapsePanelComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzCollapsePanelComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.yx),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgZone),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4))};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzCollapsePanelComponent,selectors:[["nz-collapse-panel"]],viewQuery:function NzCollapsePanelComponent_Query(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["viewQuery"](_c1,7),2&rf){let _t;_angular_core__WEBPACK_IMPORTED_MODULE_0__["queryRefresh"](_t=_angular_core__WEBPACK_IMPORTED_MODULE_0__["loadQuery"]())&&(ctx.collapseHeader=_t.first)}},hostAttrs:[1,"ant-collapse-item"],hostVars:6,hostBindings:function NzCollapsePanelComponent_HostBindings(rf,ctx){2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-collapse-no-arrow",!ctx.nzShowArrow)("ant-collapse-item-active",ctx.nzActive)("ant-collapse-item-disabled",ctx.nzDisabled)},inputs:{nzActive:[2,"nzActive","nzActive",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzDisabled:[2,"nzDisabled","nzDisabled",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzShowArrow:[2,"nzShowArrow","nzShowArrow",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["ProvidersFeature"]([ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4])],ngContentSelectors:_c0,decls:9,vars:8,consts:[["collapseHeader",""],["role","button",1,"ant-collapse-header"],[1,"ant-collapse-header-text"],[4,"nzStringTemplateOutlet"],[1,"ant-collapse-extra"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],[1,"ant-collapse-arrow",3,"nzType","nzRotate"]],template:function NzCollapsePanelComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["projectionDef"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",1,0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](2,NzCollapsePanelComponent_Conditional_2_Template,2,1,"div"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](3,"span",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](4,NzCollapsePanelComponent_ng_container_4_Template,2,1,"ng-container",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](5,NzCollapsePanelComponent_Conditional_5_Template,2,1,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](6,"div",5)(7,"div",6),_angular_core__WEBPACK_IMPORTED_MODULE_0__["projection"](8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["attribute"]("aria-expanded",ctx.nzActive),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.nzShowArrow?2:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx.nzHeader),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.nzExtra?5:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-collapse-content-active",ctx.nzActive),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("@.disabled",!(null==ctx.noAnimation||!ctx.noAnimation.nzNoAnimation))("@collapseMotion",ctx.nzActive?"expanded":"hidden"))},dependencies:[ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_9__.C,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_9__.m,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_10__.Y3,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_10__.Dn],encapsulation:2,data:{animation:[ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_11__.GE]},changeDetection:0})}})();("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzCollapsePanelComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{selector:"nz-collapse-panel",exportAs:"nzCollapsePanel",changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,animations:[ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_11__.GE],template:'\n    <div #collapseHeader role="button" [attr.aria-expanded]="nzActive" class="ant-collapse-header">\n      @if (nzShowArrow) {\n        <div>\n          <ng-container *nzStringTemplateOutlet="nzExpandedIcon; let expandedIcon">\n            <nz-icon [nzType]="expandedIcon || \'right\'" class="ant-collapse-arrow" [nzRotate]="nzActive ? 90 : 0" />\n          </ng-container>\n        </div>\n      }\n      <span class="ant-collapse-header-text">\n        <ng-container *nzStringTemplateOutlet="nzHeader">{{ nzHeader }}</ng-container>\n      </span>\n      @if (nzExtra) {\n        <div class="ant-collapse-extra">\n          <ng-container *nzStringTemplateOutlet="nzExtra">{{ nzExtra }}</ng-container>\n        </div>\n      }\n    </div>\n    <div\n      class="ant-collapse-content"\n      [class.ant-collapse-content-active]="nzActive"\n      [@.disabled]="!!noAnimation?.nzNoAnimation"\n      [@collapseMotion]="nzActive ? \'expanded\' : \'hidden\'"\n    >\n      <div class="ant-collapse-content-box">\n        <ng-content></ng-content>\n      </div>\n    </div>\n  ',host:{class:"ant-collapse-item","[class.ant-collapse-no-arrow]":"!nzShowArrow","[class.ant-collapse-item-active]":"nzActive","[class.ant-collapse-item-disabled]":"nzDisabled"},providers:[ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4],imports:[ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_9__.C,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_10__.Y3]}]}],(()=>[{type:ng_zorro_antd_core_config__WEBPACK_IMPORTED_MODULE_1__.yx},{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgZone},{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef},{type:ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4}]),{nzActive:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzDisabled:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzShowArrow:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzExtra:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzHeader:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzExpandedIcon:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzActiveChange:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Output}],collapseHeader:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewChild,args:["collapseHeader",{static:!0}]}]});class NzCollapseModule{static fac=function NzCollapseModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzCollapseModule)};static mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineNgModule"]({type:NzCollapseModule,imports:[NzCollapsePanelComponent,NzCollapseComponent],exports:[NzCollapsePanelComponent,NzCollapseComponent]});static inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjector"]({imports:[NzCollapsePanelComponent]})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzCollapseModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,args:[{imports:[NzCollapsePanelComponent,NzCollapseComponent],exports:[NzCollapsePanelComponent,NzCollapseComponent]}]}],null,null)},"./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-divider.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{g:()=>NzDividerModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-outlet.mjs");function NzDividerComponent_Conditional_0_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r0.nzText)}}function NzDividerComponent_Conditional_0_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzDividerComponent_Conditional_0_ng_container_1_Template,2,1,"ng-container",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r0.nzText)}}class NzDividerComponent{nzText;nzType="horizontal";nzOrientation="center";nzVariant="solid";nzDashed=!1;nzPlain=!1;static fac=function NzDividerComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzDividerComponent)};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzDividerComponent,selectors:[["nz-divider"]],hostAttrs:[1,"ant-divider"],hostVars:18,hostBindings:function NzDividerComponent_HostBindings(rf,ctx){2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-divider-horizontal","horizontal"===ctx.nzType)("ant-divider-vertical","vertical"===ctx.nzType)("ant-divider-with-text",ctx.nzText)("ant-divider-plain",ctx.nzPlain)("ant-divider-with-text-left",ctx.nzText&&"left"===ctx.nzOrientation)("ant-divider-with-text-right",ctx.nzText&&"right"===ctx.nzOrientation)("ant-divider-with-text-center",ctx.nzText&&"center"===ctx.nzOrientation)("ant-divider-dashed",ctx.nzDashed||"dashed"===ctx.nzVariant)("ant-divider-dotted","dotted"===ctx.nzVariant)},inputs:{nzText:"nzText",nzType:"nzType",nzOrientation:"nzOrientation",nzVariant:"nzVariant",nzDashed:[2,"nzDashed","nzDashed",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzPlain:[2,"nzPlain","nzPlain",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute]},exportAs:["nzDivider"],decls:1,vars:1,consts:[[1,"ant-divider-inner-text"],[4,"nzStringTemplateOutlet"]],template:function NzDividerComponent_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzDividerComponent_Conditional_0_Template,2,1,"span",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.nzText?0:-1)},dependencies:[ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_1__.C,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_1__.m],encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzDividerComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{selector:"nz-divider",exportAs:"nzDivider",preserveWhitespaces:!1,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,template:'\n    @if (nzText) {\n      <span class="ant-divider-inner-text">\n        <ng-container *nzStringTemplateOutlet="nzText">{{ nzText }}</ng-container>\n      </span>\n    }\n  ',host:{class:"ant-divider","[class.ant-divider-horizontal]":"nzType === 'horizontal'","[class.ant-divider-vertical]":"nzType === 'vertical'","[class.ant-divider-with-text]":"nzText","[class.ant-divider-plain]":"nzPlain","[class.ant-divider-with-text-left]":"nzText && nzOrientation === 'left'","[class.ant-divider-with-text-right]":"nzText && nzOrientation === 'right'","[class.ant-divider-with-text-center]":"nzText && nzOrientation === 'center'","[class.ant-divider-dashed]":"nzDashed || nzVariant === 'dashed'","[class.ant-divider-dotted]":"nzVariant === 'dotted'"},imports:[ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_1__.C]}]}],null,{nzText:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzType:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzOrientation:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzVariant:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzDashed:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzPlain:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}]});class NzDividerModule{static fac=function NzDividerModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzDividerModule)};static mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineNgModule"]({type:NzDividerModule,imports:[NzDividerComponent],exports:[NzDividerComponent]});static inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjector"]({imports:[NzDividerComponent]})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzDividerModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,args:[{imports:[NzDividerComponent],exports:[NzDividerComponent]}]}],null,null)},"./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-notification.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{xY:()=>NzNotificationService});var _angular_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-animation.mjs"),ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-outlet.mjs"),ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-icon.mjs"),ng_zorro_antd_message__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-message.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js"),ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-util.mjs"),_angular_cdk_overlay__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/overlay-module-BUj0D19H.mjs");const _c0=(a0,a1)=>({$implicit:a0,data:a1}),_c1=a0=>({$implicit:a0});function NzNotificationComponent_Conditional_1_ng_template_0_Template(rf,ctx){}function NzNotificationComponent_Conditional_1_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzNotificationComponent_Conditional_1_ng_template_0_Template,0,0,"ng-template",1),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("ngTemplateOutlet",ctx_r0.instance.template)("ngTemplateOutletContext",_angular_core__WEBPACK_IMPORTED_MODULE_0__["pureFunction2"](2,_c0,ctx_r0,null==ctx_r0.instance.options?null:ctx_r0.instance.options.nzData))}}function NzNotificationComponent_Conditional_2_Case_3_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"nz-icon",6)}function NzNotificationComponent_Conditional_2_Case_4_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"nz-icon",7)}function NzNotificationComponent_Conditional_2_Case_5_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"nz-icon",8)}function NzNotificationComponent_Conditional_2_Case_6_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"nz-icon",9)}function NzNotificationComponent_Conditional_2_ng_container_8_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"div",15),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("innerHTML",ctx_r0.instance.title,_angular_core__WEBPACK_IMPORTED_MODULE_0__["sanitizeHtml"])}}function NzNotificationComponent_Conditional_2_ng_container_10_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"div",15),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("innerHTML",ctx_r0.instance.content,_angular_core__WEBPACK_IMPORTED_MODULE_0__["sanitizeHtml"])}}function NzNotificationComponent_Conditional_2_Conditional_11_ng_template_1_Template(rf,ctx){}function NzNotificationComponent_Conditional_2_Conditional_11_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",14),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzNotificationComponent_Conditional_2_Conditional_11_ng_template_1_Template,0,0,"ng-template",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("ngTemplateOutlet",ctx)("ngTemplateOutletContext",_angular_core__WEBPACK_IMPORTED_MODULE_0__["pureFunction1"](2,_c1,ctx_r0))}}function NzNotificationComponent_Conditional_2_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",2)(1,"div",2)(2,"div"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](3,NzNotificationComponent_Conditional_2_Case_3_Template,1,0,"nz-icon",6)(4,NzNotificationComponent_Conditional_2_Case_4_Template,1,0,"nz-icon",7)(5,NzNotificationComponent_Conditional_2_Case_5_Template,1,0,"nz-icon",8)(6,NzNotificationComponent_Conditional_2_Case_6_Template,1,0,"nz-icon",9),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](7,"div",10),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](8,NzNotificationComponent_Conditional_2_ng_container_8_Template,2,1,"ng-container",11),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](9,"div",12),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](10,NzNotificationComponent_Conditional_2_ng_container_10_Template,2,1,"ng-container",13),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](11,NzNotificationComponent_Conditional_2_Conditional_11_Template,2,4,"span",14),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()()()),2&rf){let tmp_2_0,tmp_6_0;const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-notification-notice-with-icon","blank"!==ctx_r0.instance.type),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"]("success"===(tmp_2_0=ctx_r0.instance.type)?3:"info"===tmp_2_0?4:"warning"===tmp_2_0?5:"error"===tmp_2_0?6:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r0.instance.title),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r0.instance.content)("nzStringTemplateOutletContext",_angular_core__WEBPACK_IMPORTED_MODULE_0__["pureFunction2"](7,_c0,ctx_r0,null==ctx_r0.instance.options?null:ctx_r0.instance.options.nzData)),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"]((tmp_6_0=null==ctx_r0.instance.options?null:ctx_r0.instance.options.nzButton)?11:-1,tmp_6_0)}}function NzNotificationComponent_Conditional_5_ng_container_0_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"nz-icon",16),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const closeIcon_r2=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzType",closeIcon_r2)}}function NzNotificationComponent_Conditional_5_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzNotificationComponent_Conditional_5_ng_container_0_Template,2,1,"ng-container",11),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",null==ctx_r0.instance.options?null:ctx_r0.instance.options.nzCloseIcon)}}function NzNotificationComponent_Conditional_6_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"nz-icon",5)}function NzNotificationContainerComponent_For_2_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"nz-notification",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("destroyed",(function NzNotificationContainerComponent_For_2_Template_nz_notification_destroyed_0_listener($event){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.remove($event.id,$event.userAction))})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const instance_r3=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("instance",instance_r3)("placement","topLeft")}}function NzNotificationContainerComponent_For_5_Template(rf,ctx){if(1&rf){const _r4=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"nz-notification",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("destroyed",(function NzNotificationContainerComponent_For_5_Template_nz_notification_destroyed_0_listener($event){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r4);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.remove($event.id,$event.userAction))})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const instance_r5=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("instance",instance_r5)("placement","topRight")}}function NzNotificationContainerComponent_For_8_Template(rf,ctx){if(1&rf){const _r6=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"nz-notification",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("destroyed",(function NzNotificationContainerComponent_For_8_Template_nz_notification_destroyed_0_listener($event){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r6);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.remove($event.id,$event.userAction))})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const instance_r7=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("instance",instance_r7)("placement","bottomLeft")}}function NzNotificationContainerComponent_For_11_Template(rf,ctx){if(1&rf){const _r8=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"nz-notification",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("destroyed",(function NzNotificationContainerComponent_For_11_Template_nz_notification_destroyed_0_listener($event){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r8);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.remove($event.id,$event.userAction))})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const instance_r9=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("instance",instance_r9)("placement","bottomRight")}}function NzNotificationContainerComponent_For_14_Template(rf,ctx){if(1&rf){const _r10=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"nz-notification",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("destroyed",(function NzNotificationContainerComponent_For_14_Template_nz_notification_destroyed_0_listener($event){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r10);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.remove($event.id,$event.userAction))})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const instance_r11=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("instance",instance_r11)("placement","top")}}function NzNotificationContainerComponent_For_17_Template(rf,ctx){if(1&rf){const _r12=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getCurrentView"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"nz-notification",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("destroyed",(function NzNotificationContainerComponent_For_17_Template_nz_notification_destroyed_0_listener($event){_angular_core__WEBPACK_IMPORTED_MODULE_0__["restoreView"](_r12);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();return _angular_core__WEBPACK_IMPORTED_MODULE_0__["resetView"](ctx_r1.remove($event.id,$event.userAction))})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()}if(2&rf){const instance_r13=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("instance",instance_r13)("placement","bottom")}}class NzNotificationComponent extends ng_zorro_antd_message__WEBPACK_IMPORTED_MODULE_1__.nF{instance;index;placement;destroyed=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter;ngOnDestroy(){super.ngOnDestroy(),this.instance.onClick.complete()}onClick(event){this.instance.onClick.next(event)}close(){this.destroy(!0)}get state(){if("enter"!==this.instance.state)return this.instance.state;switch(this.placement){case"topLeft":case"bottomLeft":return"enterLeft";case"topRight":case"bottomRight":default:return"enterRight";case"top":return"enterTop";case"bottom":return"enterBottom"}}static fac=(()=>{let NzNotificationComponent_BaseFactory;return function NzNotificationComponent_Factory(__ngFactoryType__){return(NzNotificationComponent_BaseFactory||(NzNotificationComponent_BaseFactory=_angular_core__WEBPACK_IMPORTED_MODULE_0__["getInheritedFactory"](NzNotificationComponent)))(__ngFactoryType__||NzNotificationComponent)}})();static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzNotificationComponent,selectors:[["nz-notification"]],inputs:{instance:"instance",index:"index",placement:"placement"},outputs:{destroyed:"destroyed"},exportAs:["nzNotification"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["InheritDefinitionFeature"]],decls:7,vars:7,consts:[[1,"ant-notification-notice","ant-notification-notice-closable",3,"click","mouseenter","mouseleave"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-notification-notice-content"],["tabindex","0",1,"ant-notification-notice-close",3,"click"],[1,"ant-notification-notice-close-x"],["nzType","close",1,"ant-notification-close-icon"],["nzType","check-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-success"],["nzType","info-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-info"],["nzType","exclamation-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-warning"],["nzType","close-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-error"],[1,"ant-notification-notice-message"],[4,"nzStringTemplateOutlet"],[1,"ant-notification-notice-description"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],[1,"ant-notification-notice-btn"],[3,"innerHTML"],[3,"nzType"]],template:function NzNotificationComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("@notificationMotion.done",(function NzNotificationComponent_Template_div_animation_notificationMotion_done_0_listener($event){return ctx.animationStateChanged.next($event)}))("click",(function NzNotificationComponent_Template_div_click_0_listener($event){return ctx.onClick($event)}))("mouseenter",(function NzNotificationComponent_Template_div_mouseenter_0_listener(){return ctx.onEnter()}))("mouseleave",(function NzNotificationComponent_Template_div_mouseleave_0_listener(){return ctx.onLeave()})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzNotificationComponent_Conditional_1_Template,1,5,null,1)(2,NzNotificationComponent_Conditional_2_Template,12,10,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](3,"a",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["listener"]("click",(function NzNotificationComponent_Template_a_click_3_listener(){return ctx.close()})),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](4,"span",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](5,NzNotificationComponent_Conditional_5_Template,1,1,"ng-container")(6,NzNotificationComponent_Conditional_6_Template,1,0,"nz-icon",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleMap"]((null==ctx.instance.options?null:ctx.instance.options.nzStyle)||null),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classMap"]((null==ctx.instance.options?null:ctx.instance.options.nzClass)||""),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("@notificationMotion",ctx.state),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.instance.template?1:2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](null!=ctx.instance.options&&ctx.instance.options.nzCloseIcon?5:6))},dependencies:[ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_2__.Y3,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_2__.Dn,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_3__.C,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_3__.m,_angular_common__WEBPACK_IMPORTED_MODULE_4__.T3],encapsulation:2,data:{animation:[ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_5__.AJ]}})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzNotificationComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,selector:"nz-notification",exportAs:"nzNotification",preserveWhitespaces:!1,animations:[ng_zorro_antd_core_animation__WEBPACK_IMPORTED_MODULE_5__.AJ],template:'\n    <div\n      class="ant-notification-notice ant-notification-notice-closable"\n      [style]="instance.options?.nzStyle || null"\n      [class]="instance.options?.nzClass || \'\'"\n      [@notificationMotion]="state"\n      (@notificationMotion.done)="animationStateChanged.next($event)"\n      (click)="onClick($event)"\n      (mouseenter)="onEnter()"\n      (mouseleave)="onLeave()"\n    >\n      @if (instance.template) {\n        <ng-template\n          [ngTemplateOutlet]="instance.template!"\n          [ngTemplateOutletContext]="{ $implicit: this, data: instance.options?.nzData }"\n        />\n      } @else {\n        <div class="ant-notification-notice-content">\n          <div class="ant-notification-notice-content">\n            <div [class.ant-notification-notice-with-icon]="instance.type !== \'blank\'">\n              @switch (instance.type) {\n                @case (\'success\') {\n                  <nz-icon\n                    nzType="check-circle"\n                    class="ant-notification-notice-icon ant-notification-notice-icon-success"\n                  />\n                }\n                @case (\'info\') {\n                  <nz-icon\n                    nzType="info-circle"\n                    class="ant-notification-notice-icon ant-notification-notice-icon-info"\n                  />\n                }\n                @case (\'warning\') {\n                  <nz-icon\n                    nzType="exclamation-circle"\n                    class="ant-notification-notice-icon ant-notification-notice-icon-warning"\n                  />\n                }\n                @case (\'error\') {\n                  <nz-icon\n                    nzType="close-circle"\n                    class="ant-notification-notice-icon ant-notification-notice-icon-error"\n                  />\n                }\n              }\n              <div class="ant-notification-notice-message">\n                <ng-container *nzStringTemplateOutlet="instance.title">\n                  <div [innerHTML]="instance.title"></div>\n                </ng-container>\n              </div>\n              <div class="ant-notification-notice-description">\n                <ng-container\n                  *nzStringTemplateOutlet="\n                    instance.content;\n                    context: { $implicit: this, data: instance.options?.nzData }\n                  "\n                >\n                  <div [innerHTML]="instance.content"></div>\n                </ng-container>\n              </div>\n              @if (instance.options?.nzButton; as btn) {\n                <span class="ant-notification-notice-btn">\n                  <ng-template [ngTemplateOutlet]="btn" [ngTemplateOutletContext]="{ $implicit: this }" />\n                </span>\n              }\n            </div>\n          </div>\n        </div>\n      }\n      <a tabindex="0" class="ant-notification-notice-close" (click)="close()">\n        <span class="ant-notification-notice-close-x">\n          @if (instance.options?.nzCloseIcon) {\n            <ng-container *nzStringTemplateOutlet="instance.options?.nzCloseIcon; let closeIcon">\n              <nz-icon [nzType]="closeIcon" />\n            </ng-container>\n          } @else {\n            <nz-icon nzType="close" class="ant-notification-close-icon" />\n          }\n        </span>\n      </a>\n    </div>\n  ',imports:[ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_2__.Y3,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_3__.C,_angular_common__WEBPACK_IMPORTED_MODULE_4__.T3]}]}],null,{instance:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],index:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],placement:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],destroyed:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Output}]});const NZ_NOTIFICATION_DEFAULT_CONFIG={nzTop:"24px",nzBottom:"24px",nzPlacement:"topRight",nzDuration:4500,nzMaxStack:8,nzPauseOnHover:!0,nzAnimate:!0,nzDirection:"ltr"};class NzNotificationContainerComponent extends ng_zorro_antd_message__WEBPACK_IMPORTED_MODULE_1__.op{dir=this.nzConfigService.getConfigForComponent("notification")?.nzDirection||"ltr";bottom;top;topLeftInstances=[];topRightInstances=[];bottomLeftInstances=[];bottomRightInstances=[];topInstances=[];bottomInstances=[];constructor(){super(),this.updateConfig()}create(notification){const instance=this.onCreate(notification),key=instance.options.nzKey,notificationWithSameKey=this.instances.find((msg=>msg.options.nzKey===notification.options.nzKey));return key&&notificationWithSameKey?this.replaceNotification(notificationWithSameKey,instance):(this.instances.length>=this.config.nzMaxStack&&(this.instances=this.instances.slice(1)),this.instances=[...this.instances,instance]),this.readyInstances(),instance}onCreate(instance){return instance.options=this.mergeOptions(instance.options),instance.onClose=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,instance.onClick=new rxjs__WEBPACK_IMPORTED_MODULE_6__.B,instance}subscribeConfigChange(){this.nzConfigService.getConfigChangeEventForComponent("notification").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Q)(this.destroy$)).subscribe((()=>{this.updateConfig(),this.dir=this.nzConfigService.getConfigForComponent("notification")?.nzDirection||this.dir}))}updateConfig(){this.config={...NZ_NOTIFICATION_DEFAULT_CONFIG,...this.config,...this.nzConfigService.getConfigForComponent("notification")},this.top=(0,ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_8__.j3)(this.config.nzTop),this.bottom=(0,ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_8__.j3)(this.config.nzBottom),this.cdr.markForCheck()}replaceNotification(old,_new){old.title=_new.title,old.content=_new.content,old.template=_new.template,old.type=_new.type,old.options=_new.options}readyInstances(){const instancesMap={topLeft:[],topRight:[],bottomLeft:[],bottomRight:[],top:[],bottom:[]};this.instances.forEach((m=>{switch(m.options.nzPlacement){case"topLeft":instancesMap.topLeft.unshift(m);break;case"topRight":default:instancesMap.topRight.unshift(m);break;case"bottomLeft":instancesMap.bottomLeft.unshift(m);break;case"bottomRight":instancesMap.bottomRight.unshift(m);break;case"top":instancesMap.top.unshift(m);break;case"bottom":instancesMap.bottom.unshift(m)}})),this.topLeftInstances=instancesMap.topLeft,this.topRightInstances=instancesMap.topRight,this.bottomLeftInstances=instancesMap.bottomLeft,this.bottomRightInstances=instancesMap.bottomRight,this.topInstances=instancesMap.top,this.bottomInstances=instancesMap.bottom,this.cdr.detectChanges()}mergeOptions(options){const{nzDuration,nzAnimate,nzPauseOnHover,nzPlacement}=this.config;return{nzDuration,nzAnimate,nzPauseOnHover,nzPlacement,...options}}static fac=function NzNotificationContainerComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzNotificationContainerComponent)};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzNotificationContainerComponent,selectors:[["nz-notification-container"]],exportAs:["nzNotificationContainer"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["InheritDefinitionFeature"]],decls:18,vars:40,consts:[[1,"ant-notification","ant-notification-topLeft"],[3,"instance","placement"],[1,"ant-notification","ant-notification-topRight"],[1,"ant-notification","ant-notification-bottomLeft"],[1,"ant-notification","ant-notification-bottomRight"],[1,"ant-notification","ant-notification-top"],[1,"ant-notification","ant-notification-bottom"],[3,"destroyed","instance","placement"]],template:function NzNotificationContainerComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterCreate"](1,NzNotificationContainerComponent_For_2_Template,1,2,"nz-notification",1,_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterTrackByIdentity"]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](3,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterCreate"](4,NzNotificationContainerComponent_For_5_Template,1,2,"nz-notification",1,_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterTrackByIdentity"]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](6,"div",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterCreate"](7,NzNotificationContainerComponent_For_8_Template,1,2,"nz-notification",1,_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterTrackByIdentity"]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](9,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterCreate"](10,NzNotificationContainerComponent_For_11_Template,1,2,"nz-notification",1,_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterTrackByIdentity"]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](12,"div",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterCreate"](13,NzNotificationContainerComponent_For_14_Template,1,2,"nz-notification",1,_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterTrackByIdentity"]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](15,"div",6),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterCreate"](16,NzNotificationContainerComponent_For_17_Template,1,2,"nz-notification",1,_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterTrackByIdentity"]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("top",ctx.top)("left","0px"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-notification-rtl","rtl"===ctx.dir),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeater"](ctx.topLeftInstances),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("top",ctx.top)("right","0px"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-notification-rtl","rtl"===ctx.dir),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeater"](ctx.topRightInstances),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("bottom",ctx.bottom)("left","0px"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-notification-rtl","rtl"===ctx.dir),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeater"](ctx.bottomLeftInstances),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("bottom",ctx.bottom)("right","0px"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-notification-rtl","rtl"===ctx.dir),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeater"](ctx.bottomRightInstances),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("top",ctx.top)("left","50%")("transform","translateX(-50%)"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-notification-rtl","rtl"===ctx.dir),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeater"](ctx.topInstances),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("bottom",ctx.bottom)("left","50%")("transform","translateX(-50%)"),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-notification-rtl","rtl"===ctx.dir),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeater"](ctx.bottomInstances))},dependencies:[NzNotificationComponent],encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzNotificationContainerComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,selector:"nz-notification-container",exportAs:"nzNotificationContainer",preserveWhitespaces:!1,template:'\n    <div\n      class="ant-notification ant-notification-topLeft"\n      [class.ant-notification-rtl]="dir === \'rtl\'"\n      [style.top]="top"\n      [style.left]="\'0px\'"\n    >\n      @for (instance of topLeftInstances; track instance) {\n        <nz-notification\n          [instance]="instance"\n          [placement]="\'topLeft\'"\n          (destroyed)="remove($event.id, $event.userAction)"\n        />\n      }\n    </div>\n    <div\n      class="ant-notification ant-notification-topRight"\n      [class.ant-notification-rtl]="dir === \'rtl\'"\n      [style.top]="top"\n      [style.right]="\'0px\'"\n    >\n      @for (instance of topRightInstances; track instance) {\n        <nz-notification\n          [instance]="instance"\n          [placement]="\'topRight\'"\n          (destroyed)="remove($event.id, $event.userAction)"\n        />\n      }\n    </div>\n    <div\n      class="ant-notification ant-notification-bottomLeft"\n      [class.ant-notification-rtl]="dir === \'rtl\'"\n      [style.bottom]="bottom"\n      [style.left]="\'0px\'"\n    >\n      @for (instance of bottomLeftInstances; track instance) {\n        <nz-notification\n          [instance]="instance"\n          [placement]="\'bottomLeft\'"\n          (destroyed)="remove($event.id, $event.userAction)"\n        />\n      }\n    </div>\n    <div\n      class="ant-notification ant-notification-bottomRight"\n      [class.ant-notification-rtl]="dir === \'rtl\'"\n      [style.bottom]="bottom"\n      [style.right]="\'0px\'"\n    >\n      @for (instance of bottomRightInstances; track instance) {\n        <nz-notification\n          [instance]="instance"\n          [placement]="\'bottomRight\'"\n          (destroyed)="remove($event.id, $event.userAction)"\n        />\n      }\n    </div>\n    <div\n      class="ant-notification ant-notification-top"\n      [class.ant-notification-rtl]="dir === \'rtl\'"\n      [style.top]="top"\n      [style.left]="\'50%\'"\n      [style.transform]="\'translateX(-50%)\'"\n    >\n      @for (instance of topInstances; track instance) {\n        <nz-notification [instance]="instance" [placement]="\'top\'" (destroyed)="remove($event.id, $event.userAction)" />\n      }\n    </div>\n    <div\n      class="ant-notification ant-notification-bottom"\n      [class.ant-notification-rtl]="dir === \'rtl\'"\n      [style.bottom]="bottom"\n      [style.left]="\'50%\'"\n      [style.transform]="\'translateX(-50%)\'"\n    >\n      @for (instance of bottomInstances; track instance) {\n        <nz-notification\n          [instance]="instance"\n          [placement]="\'bottom\'"\n          (destroyed)="remove($event.id, $event.userAction)"\n        />\n      }\n    </div>\n  ',imports:[NzNotificationComponent]}]}],(()=>[]),null);class NzNotificationModule{static fac=function NzNotificationModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzNotificationModule)};static mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineNgModule"]({type:NzNotificationModule,imports:[NzNotificationComponent,NzNotificationContainerComponent]});static inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjector"]({imports:[NzNotificationComponent,NzNotificationContainerComponent]})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzNotificationModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,args:[{imports:[NzNotificationComponent,NzNotificationContainerComponent]}]}],null,null);let notificationId=0;class NzNotificationService extends ng_zorro_antd_message__WEBPACK_IMPORTED_MODULE_1__.Pz{componentPrefix="notification-";constructor(overlay,injector){super(overlay,injector)}success(title,content,options){return this.create("success",title,content,options)}error(title,content,options){return this.create("error",title,content,options)}info(title,content,options){return this.create("info",title,content,options)}warning(title,content,options){return this.create("warning",title,content,options)}blank(title,content,options){return this.create("blank",title,content,options)}create(type,title,content,options){return this.createInstance({type,title,content},options)}template(template,options){return this.createInstance({template},options)}generateMessageId(){return`${this.componentPrefix}-${notificationId++}`}createInstance(message,options){return this.container=this.withContainer(NzNotificationContainerComponent),this.container.create({...message,createdAt:new Date,messageId:options?.nzKey||this.generateMessageId(),options})}static fac=function NzNotificationService_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzNotificationService)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["inject"](_angular_cdk_overlay__WEBPACK_IMPORTED_MODULE_9__.a),_angular_core__WEBPACK_IMPORTED_MODULE_0__["inject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injector))};static prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjectable"]({token:NzNotificationService,factory:NzNotificationService.fac,providedIn:"root"})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzNotificationService,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injectable,args:[{providedIn:"root"}]}],(()=>[{type:_angular_cdk_overlay__WEBPACK_IMPORTED_MODULE_9__.a},{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injector}]),null);class NzNotificationServiceModule{static fac=function NzNotificationServiceModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzNotificationServiceModule)};static mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineNgModule"]({type:NzNotificationServiceModule});static inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjector"]({})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzNotificationServiceModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule}],null,null)},"./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-skeleton.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{i3:()=>NzSkeletonModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-util.mjs");const _c0=["nzType","button"],_c1=["nzType","avatar"],_c2=["nzType","input"],_c3=["nzType","image"],_c4=["*"];function NzSkeletonComponent_Conditional_0_Conditional_0_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"nz-skeleton-element",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzSize",ctx_r0.avatar.size||"default")("nzShape",ctx_r0.avatar.shape||"circle")}}function NzSkeletonComponent_Conditional_0_Conditional_2_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"h3",5),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("width",ctx_r0.toCSSUnit(ctx_r0.title.width))}}function NzSkeletonComponent_Conditional_0_Conditional_3_For_2_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"li"),2&rf){const $index_15_r2=ctx.$index,ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](3);_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleProp"]("width",ctx_r0.toCSSUnit(ctx_r0.widthList[$index_15_r2]))}}function NzSkeletonComponent_Conditional_0_Conditional_3_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"ul",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterCreate"](1,NzSkeletonComponent_Conditional_0_Conditional_3_For_2_Template,1,2,"li",6,_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeaterTrackByIdentity"]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["repeater"](ctx_r0.rowsList)}}function NzSkeletonComponent_Conditional_0_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzSkeletonComponent_Conditional_0_Conditional_0_Template,2,2,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](1,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](2,NzSkeletonComponent_Conditional_0_Conditional_2_Template,1,2,"h3",2)(3,NzSkeletonComponent_Conditional_0_Conditional_3_Template,3,0,"ul",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r0.nzAvatar?0:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r0.nzTitle?2:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r0.nzParagraph?3:-1)}}function NzSkeletonComponent_Conditional_1_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["projection"](0)}class NzSkeletonElementDirective{nzActive=!1;nzType;nzBlock=!1;static fac=function NzSkeletonElementDirective_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzSkeletonElementDirective)};static dir=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineDirective"]({type:NzSkeletonElementDirective,selectors:[["nz-skeleton-element"]],hostAttrs:[1,"ant-skeleton","ant-skeleton-element"],hostVars:4,hostBindings:function NzSkeletonElementDirective_HostBindings(rf,ctx){2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-skeleton-active",ctx.nzActive)("ant-skeleton-block",ctx.nzBlock)},inputs:{nzActive:[2,"nzActive","nzActive",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzType:"nzType",nzBlock:[2,"nzBlock","nzBlock",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute]}})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzSkeletonElementDirective,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Directive,args:[{selector:"nz-skeleton-element",host:{class:"ant-skeleton ant-skeleton-element","[class.ant-skeleton-active]":"nzActive","[class.ant-skeleton-block]":"nzBlock"}}]}],null,{nzActive:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzType:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzBlock:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}]});class NzSkeletonElementButtonComponent{nzShape="default";nzSize="default";static fac=function NzSkeletonElementButtonComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzSkeletonElementButtonComponent)};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzSkeletonElementButtonComponent,selectors:[["nz-skeleton-element","nzType","button"]],inputs:{nzShape:"nzShape",nzSize:"nzSize"},attrs:_c0,decls:1,vars:10,consts:[[1,"ant-skeleton-button"]],template:function NzSkeletonElementButtonComponent_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"span",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-skeleton-button-square","square"===ctx.nzShape)("ant-skeleton-button-round","round"===ctx.nzShape)("ant-skeleton-button-circle","circle"===ctx.nzShape)("ant-skeleton-button-lg","large"===ctx.nzSize)("ant-skeleton-button-sm","small"===ctx.nzSize)},encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzSkeletonElementButtonComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,selector:'nz-skeleton-element[nzType="button"]',template:'\n    <span\n      class="ant-skeleton-button"\n      [class.ant-skeleton-button-square]="nzShape === \'square\'"\n      [class.ant-skeleton-button-round]="nzShape === \'round\'"\n      [class.ant-skeleton-button-circle]="nzShape === \'circle\'"\n      [class.ant-skeleton-button-lg]="nzSize === \'large\'"\n      [class.ant-skeleton-button-sm]="nzSize === \'small\'"\n    ></span>\n  '}]}],null,{nzShape:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzSize:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}]});class NzSkeletonElementAvatarComponent{nzShape="circle";nzSize="default";styleMap={};ngOnChanges(changes){if(changes.nzSize&&"number"==typeof this.nzSize){const sideLength=`${this.nzSize}px`;this.styleMap={width:sideLength,height:sideLength,"line-height":sideLength}}else this.styleMap={}}static fac=function NzSkeletonElementAvatarComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzSkeletonElementAvatarComponent)};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzSkeletonElementAvatarComponent,selectors:[["nz-skeleton-element","nzType","avatar"]],inputs:{nzShape:"nzShape",nzSize:"nzSize"},features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["NgOnChangesFeature"]],attrs:_c1,decls:1,vars:10,consts:[[1,"ant-skeleton-avatar"]],template:function NzSkeletonElementAvatarComponent_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"span",0),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["styleMap"](ctx.styleMap),_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-skeleton-avatar-square","square"===ctx.nzShape)("ant-skeleton-avatar-circle","circle"===ctx.nzShape)("ant-skeleton-avatar-lg","large"===ctx.nzSize)("ant-skeleton-avatar-sm","small"===ctx.nzSize))},encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzSkeletonElementAvatarComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,selector:'nz-skeleton-element[nzType="avatar"]',template:'\n    <span\n      class="ant-skeleton-avatar"\n      [class.ant-skeleton-avatar-square]="nzShape === \'square\'"\n      [class.ant-skeleton-avatar-circle]="nzShape === \'circle\'"\n      [class.ant-skeleton-avatar-lg]="nzSize === \'large\'"\n      [class.ant-skeleton-avatar-sm]="nzSize === \'small\'"\n      [style]="styleMap"\n    ></span>\n  '}]}],null,{nzShape:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzSize:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}]});class NzSkeletonElementInputComponent{nzSize="default";static fac=function NzSkeletonElementInputComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzSkeletonElementInputComponent)};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzSkeletonElementInputComponent,selectors:[["nz-skeleton-element","nzType","input"]],inputs:{nzSize:"nzSize"},attrs:_c2,decls:1,vars:4,consts:[[1,"ant-skeleton-input"]],template:function NzSkeletonElementInputComponent_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"span",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-skeleton-input-lg","large"===ctx.nzSize)("ant-skeleton-input-sm","small"===ctx.nzSize)},encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzSkeletonElementInputComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,selector:'nz-skeleton-element[nzType="input"]',template:'\n    <span\n      class="ant-skeleton-input"\n      [class.ant-skeleton-input-lg]="nzSize === \'large\'"\n      [class.ant-skeleton-input-sm]="nzSize === \'small\'"\n    ></span>\n  '}]}],null,{nzSize:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}]});class NzSkeletonElementImageComponent{static fac=function NzSkeletonElementImageComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzSkeletonElementImageComponent)};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzSkeletonElementImageComponent,selectors:[["nz-skeleton-element","nzType","image"]],attrs:_c3,decls:3,vars:0,consts:[[1,"ant-skeleton-image"],["viewBox","0 0 1098 1024","xmlns","http://www.w3.org/2000/svg",1,"ant-skeleton-image-svg"],["d","M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",1,"ant-skeleton-image-path"]],template:function NzSkeletonElementImageComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["namespaceSVG"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](1,"svg",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](2,"path",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()())},encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzSkeletonElementImageComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,selector:'nz-skeleton-element[nzType="image"]',template:'\n    <span class="ant-skeleton-image">\n      <svg class="ant-skeleton-image-svg" viewBox="0 0 1098 1024" xmlns="http://www.w3.org/2000/svg">\n        <path\n          d="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z"\n          class="ant-skeleton-image-path"\n        />\n      </svg>\n    </span>\n  '}]}],null,null);class NzSkeletonComponent{cdr;nzActive=!1;nzLoading=!0;nzRound=!1;nzTitle=!0;nzAvatar=!1;nzParagraph=!0;title;avatar;paragraph;rowsList=[];widthList=[];constructor(cdr){this.cdr=cdr}toCSSUnit(value=""){return(0,ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_1__.j3)(value)}getTitleProps(){const hasAvatar=!!this.nzAvatar,hasParagraph=!!this.nzParagraph;let width="";return!hasAvatar&&hasParagraph?width="38%":hasAvatar&&hasParagraph&&(width="50%"),{width,...this.getProps(this.nzTitle)}}getAvatarProps(){return{shape:this.nzTitle&&!this.nzParagraph?"square":"circle",size:"large",...this.getProps(this.nzAvatar)}}getParagraphProps(){const hasAvatar=!!this.nzAvatar,hasTitle=!!this.nzTitle,basicProps={};return hasAvatar&&hasTitle||(basicProps.width="61%"),basicProps.rows=!hasAvatar&&hasTitle?3:2,{...basicProps,...this.getProps(this.nzParagraph)}}getProps(prop){return prop&&"object"==typeof prop?prop:{}}getWidthList(){const{width,rows}=this.paragraph;let widthList=[];return width&&Array.isArray(width)?widthList=width:width&&!Array.isArray(width)&&(widthList=[],widthList[rows-1]=width),widthList}updateProps(){this.title=this.getTitleProps(),this.avatar=this.getAvatarProps(),this.paragraph=this.getParagraphProps(),this.rowsList=[...Array(this.paragraph.rows)],this.widthList=this.getWidthList(),this.cdr.markForCheck()}ngOnInit(){this.updateProps()}ngOnChanges(changes){(changes.nzTitle||changes.nzAvatar||changes.nzParagraph)&&this.updateProps()}static fac=function NzSkeletonComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzSkeletonComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef))};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzSkeletonComponent,selectors:[["nz-skeleton"]],hostAttrs:[1,"ant-skeleton"],hostVars:6,hostBindings:function NzSkeletonComponent_HostBindings(rf,ctx){2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-skeleton-with-avatar",!!ctx.nzAvatar)("ant-skeleton-active",ctx.nzActive)("ant-skeleton-round",!!ctx.nzRound)},inputs:{nzActive:"nzActive",nzLoading:"nzLoading",nzRound:"nzRound",nzTitle:"nzTitle",nzAvatar:"nzAvatar",nzParagraph:"nzParagraph"},exportAs:["nzSkeleton"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["NgOnChangesFeature"]],ngContentSelectors:_c4,decls:2,vars:1,consts:[[1,"ant-skeleton-header"],[1,"ant-skeleton-content"],[1,"ant-skeleton-title",3,"width"],[1,"ant-skeleton-paragraph"],["nzType","avatar",3,"nzSize","nzShape"],[1,"ant-skeleton-title"],[3,"width"]],template:function NzSkeletonComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["projectionDef"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzSkeletonComponent_Conditional_0_Template,4,3)(1,NzSkeletonComponent_Conditional_1_Template,1,0)),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.nzLoading?0:1)},dependencies:[NzSkeletonElementDirective,NzSkeletonElementAvatarComponent],encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzSkeletonComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,selector:"nz-skeleton",exportAs:"nzSkeleton",host:{class:"ant-skeleton","[class.ant-skeleton-with-avatar]":"!!nzAvatar","[class.ant-skeleton-active]":"nzActive","[class.ant-skeleton-round]":"!!nzRound"},template:'\n    @if (nzLoading) {\n      @if (!!nzAvatar) {\n        <div class="ant-skeleton-header">\n          <nz-skeleton-element\n            nzType="avatar"\n            [nzSize]="avatar.size || \'default\'"\n            [nzShape]="avatar.shape || \'circle\'"\n          ></nz-skeleton-element>\n        </div>\n      }\n      <div class="ant-skeleton-content">\n        @if (!!nzTitle) {\n          <h3 class="ant-skeleton-title" [style.width]="toCSSUnit(title.width)"></h3>\n        }\n        @if (!!nzParagraph) {\n          <ul class="ant-skeleton-paragraph">\n            @for (row of rowsList; track row; let i = $index) {\n              <li [style.width]="toCSSUnit(widthList[i])"></li>\n            }\n          </ul>\n        }\n      </div>\n    } @else {\n      <ng-content></ng-content>\n    }\n  ',imports:[NzSkeletonElementDirective,NzSkeletonElementAvatarComponent]}]}],(()=>[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef}]),{nzActive:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzLoading:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzRound:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzTitle:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzAvatar:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzParagraph:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}]});class NzSkeletonModule{static fac=function NzSkeletonModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzSkeletonModule)};static mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineNgModule"]({type:NzSkeletonModule,imports:[NzSkeletonElementDirective,NzSkeletonComponent,NzSkeletonElementButtonComponent,NzSkeletonElementAvatarComponent,NzSkeletonElementImageComponent,NzSkeletonElementInputComponent],exports:[NzSkeletonElementDirective,NzSkeletonComponent,NzSkeletonElementButtonComponent,NzSkeletonElementAvatarComponent,NzSkeletonElementImageComponent,NzSkeletonElementInputComponent]});static inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjector"]({})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzSkeletonModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,args:[{imports:[NzSkeletonElementDirective,NzSkeletonComponent,NzSkeletonElementButtonComponent,NzSkeletonElementAvatarComponent,NzSkeletonElementImageComponent,NzSkeletonElementInputComponent],exports:[NzSkeletonElementDirective,NzSkeletonComponent,NzSkeletonElementButtonComponent,NzSkeletonElementAvatarComponent,NzSkeletonElementImageComponent,NzSkeletonElementInputComponent]}]}],null,null)},"./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-steps.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Qb:()=>NzStepsModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subscription.js"),rxjs__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/merge.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-services.mjs"),ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-util.mjs"),_angular_common__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-core-outlet.mjs"),ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-icon.mjs"),ng_zorro_antd_progress__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-progress.mjs"),_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/directionality-CBXD4hga.mjs");const _c0=["processDotTemplate"],_c1=["itemContainer"],_c2=(a0,a1,a2)=>({$implicit:a0,status:a1,index:a2});function NzStepComponent_Conditional_2_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"div",3)}function NzStepComponent_Conditional_4_Conditional_0_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",11),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"nz-progress",12),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzPercent",ctx_r0.nzPercentage)("nzWidth","small"===ctx_r0.nzSize?32:40)("nzFormat",ctx_r0.nullProcessFormat)("nzStrokeWidth",4)}}function NzStepComponent_Conditional_4_Conditional_1_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"nz-icon",13),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]())}function NzStepComponent_Conditional_4_Conditional_2_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"nz-icon",14),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]())}function NzStepComponent_Conditional_4_Conditional_3_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate1"](" ",ctx_r0.index+1," ")}}function NzStepComponent_Conditional_4_Conditional_4_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](1,"nz-icon",15),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const icon_r2=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzType",icon_r2)}}function NzStepComponent_Conditional_4_Conditional_4_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzStepComponent_Conditional_4_Conditional_4_ng_container_1_Template,2,1,"ng-container",8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r0.nzIcon)}}function NzStepComponent_Conditional_4_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](0,NzStepComponent_Conditional_4_Conditional_0_Template,2,4,"div",11)(1,NzStepComponent_Conditional_4_Conditional_1_Template,2,0,"span",5)(2,NzStepComponent_Conditional_4_Conditional_2_Template,2,0,"span",5)(3,NzStepComponent_Conditional_4_Conditional_3_Template,2,1,"span",5)(4,NzStepComponent_Conditional_4_Conditional_4_Template,2,1,"span",5),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r0.showProgress?0:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"]("finish"!==ctx_r0.nzStatus||ctx_r0.nzIcon?-1:1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"]("error"===ctx_r0.nzStatus?2:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"]("process"!==ctx_r0.nzStatus&&"wait"!==ctx_r0.nzStatus||ctx_r0.nzIcon?-1:3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx_r0.nzIcon?4:-1)}}function NzStepComponent_Conditional_5_ng_template_1_Template(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["element"](0,"span",17)}function NzStepComponent_Conditional_5_ng_template_3_Template(rf,ctx){}function NzStepComponent_Conditional_5_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzStepComponent_Conditional_5_ng_template_1_Template,1,0,"ng-template",null,1,_angular_core__WEBPACK_IMPORTED_MODULE_0__["templateRefExtractor"])(3,NzStepComponent_Conditional_5_ng_template_3_Template,0,0,"ng-template",16),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const processDotTemplate_r3=_angular_core__WEBPACK_IMPORTED_MODULE_0__["reference"](2),ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("ngTemplateOutlet",ctx_r0.customProcessTemplate||processDotTemplate_r3)("ngTemplateOutletContext",_angular_core__WEBPACK_IMPORTED_MODULE_0__["pureFunction3"](2,_c2,processDotTemplate_r3,ctx_r0.nzStatus,ctx_r0.index))}}function NzStepComponent_ng_container_8_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r0.nzTitle)}}function NzStepComponent_Conditional_9_ng_container_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"](2);_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r0.nzSubtitle)}}function NzStepComponent_Conditional_9_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",9),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](1,NzStepComponent_Conditional_9_ng_container_1_Template,2,1,"ng-container",8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx_r0.nzSubtitle)}}function NzStepComponent_ng_container_11_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerStart"](0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["text"](1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementContainerEnd"]()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__["nextContext"]();_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["textInterpolate"](ctx_r0.nzDescription)}}const _c3=["*"];class NzStepComponent{cdr;destroy$;processDotTemplate;itemContainer;nzTitle;nzSubtitle;nzDescription;nzDisabled=!1;nzPercentage=null;nzSize="default";get nzStatus(){return this._status}set nzStatus(status){this._status=status,this.isCustomStatus=!0}isCustomStatus=!1;_status="wait";get nzIcon(){return this._icon}set nzIcon(value){value instanceof _angular_core__WEBPACK_IMPORTED_MODULE_0__.TemplateRef||(this.oldAPIIcon="string"==typeof value&&value.indexOf("anticon")>-1),this._icon=value}oldAPIIcon=!0;_icon;customProcessTemplate;direction="horizontal";index=0;last=!1;outStatus="process";showProcessDot=!1;clickable=!1;clickOutsideAngular$=new rxjs__WEBPACK_IMPORTED_MODULE_1__.B;nullProcessFormat=()=>null;get showProgress(){return null!==this.nzPercentage&&!this.nzIcon&&"process"===this.nzStatus&&this.nzPercentage>=0&&this.nzPercentage<=100}get currentIndex(){return this._currentIndex}set currentIndex(current){this._currentIndex=current,this.isCustomStatus||(this._status=current>this.index?"finish":current===this.index?this.outStatus||"":"wait")}_currentIndex=0;constructor(cdr,destroy$){this.cdr=cdr,this.destroy$=destroy$}ngOnInit(){(0,ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_2__.wN)(this.itemContainer.nativeElement,"click").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.p)((()=>this.clickable&&this.currentIndex!==this.index&&!this.nzDisabled)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.Q)(this.destroy$)).subscribe((()=>{this.clickOutsideAngular$.next(this.index)}))}enable(){this.nzDisabled=!1,this.cdr.markForCheck()}disable(){this.nzDisabled=!0,this.cdr.markForCheck()}markForCheck(){this.cdr.markForCheck()}static fac=function NzStepComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzStepComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4))};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzStepComponent,selectors:[["nz-step"]],viewQuery:function NzStepComponent_Query(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["viewQuery"](_c0,5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["viewQuery"](_c1,7)),2&rf){let _t;_angular_core__WEBPACK_IMPORTED_MODULE_0__["queryRefresh"](_t=_angular_core__WEBPACK_IMPORTED_MODULE_0__["loadQuery"]())&&(ctx.processDotTemplate=_t.first),_angular_core__WEBPACK_IMPORTED_MODULE_0__["queryRefresh"](_t=_angular_core__WEBPACK_IMPORTED_MODULE_0__["loadQuery"]())&&(ctx.itemContainer=_t.first)}},hostAttrs:[1,"ant-steps-item"],hostVars:16,hostBindings:function NzStepComponent_HostBindings(rf,ctx){2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-steps-item-wait","wait"===ctx.nzStatus)("ant-steps-item-process","process"===ctx.nzStatus)("ant-steps-item-finish","finish"===ctx.nzStatus)("ant-steps-item-error","error"===ctx.nzStatus)("ant-steps-item-active",ctx.currentIndex===ctx.index)("ant-steps-item-disabled",ctx.nzDisabled)("ant-steps-item-custom",!!ctx.nzIcon)("ant-steps-next-error","error"===ctx.outStatus&&ctx.currentIndex===ctx.index+1)},inputs:{nzTitle:"nzTitle",nzSubtitle:"nzSubtitle",nzDescription:"nzDescription",nzDisabled:[2,"nzDisabled","nzDisabled",_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute],nzPercentage:"nzPercentage",nzSize:"nzSize",nzStatus:"nzStatus",nzIcon:"nzIcon"},exportAs:["nzStep"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["ProvidersFeature"]([ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4])],decls:12,vars:8,consts:[["itemContainer",""],["processDotTemplate",""],[1,"ant-steps-item-container",3,"tabindex"],[1,"ant-steps-item-tail"],[1,"ant-steps-item-icon"],[1,"ant-steps-icon"],[1,"ant-steps-item-content"],[1,"ant-steps-item-title"],[4,"nzStringTemplateOutlet"],[1,"ant-steps-item-subtitle"],[1,"ant-steps-item-description"],[1,"ant-steps-progress-icon"],["nzType","circle",3,"nzPercent","nzWidth","nzFormat","nzStrokeWidth"],["nzType","check"],["nzType","close"],[3,"nzType"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-steps-icon-dot"]],template:function NzStepComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](0,"div",2,0),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](2,NzStepComponent_Conditional_2_Template,1,0,"div",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](3,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](4,NzStepComponent_Conditional_4_Template,5,5)(5,NzStepComponent_Conditional_5_Template,4,6,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](6,"div",6)(7,"div",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](8,NzStepComponent_ng_container_8_Template,2,1,"ng-container",8)(9,NzStepComponent_Conditional_9_Template,2,1,"div",9),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementStart"](10,"div",10),_angular_core__WEBPACK_IMPORTED_MODULE_0__["template"](11,NzStepComponent_ng_container_11_Template,2,1,"ng-container",8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["elementEnd"]()()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("tabindex",ctx.clickable&&!ctx.nzDisabled?0:null),_angular_core__WEBPACK_IMPORTED_MODULE_0__["attribute"]("role",ctx.clickable&&!ctx.nzDisabled?"button":null),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.last?-1:2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.showProcessDot?-1:4),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.showProcessDot?5:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](3),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx.nzTitle),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["conditional"](ctx.nzSubtitle?9:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__["advance"](2),_angular_core__WEBPACK_IMPORTED_MODULE_0__["property"]("nzStringTemplateOutlet",ctx.nzDescription))},dependencies:[ng_zorro_antd_progress__WEBPACK_IMPORTED_MODULE_6__.m,ng_zorro_antd_progress__WEBPACK_IMPORTED_MODULE_6__.V,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_7__.Y3,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_7__.Dn,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_8__.C,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_8__.m,_angular_common__WEBPACK_IMPORTED_MODULE_9__.T3],encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzStepComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,selector:"nz-step",exportAs:"nzStep",preserveWhitespaces:!1,template:'\n    <div\n      #itemContainer\n      class="ant-steps-item-container"\n      [attr.role]="clickable && !nzDisabled ? \'button\' : null"\n      [tabindex]="clickable && !nzDisabled ? 0 : null"\n    >\n      @if (!last) {\n        <div class="ant-steps-item-tail"></div>\n      }\n      <div class="ant-steps-item-icon">\n        @if (!showProcessDot) {\n          @if (showProgress) {\n            <div class="ant-steps-progress-icon">\n              <nz-progress\n                [nzPercent]="nzPercentage"\n                nzType="circle"\n                [nzWidth]="nzSize === \'small\' ? 32 : 40"\n                [nzFormat]="nullProcessFormat"\n                [nzStrokeWidth]="4"\n              ></nz-progress>\n            </div>\n          }\n          @if (nzStatus === \'finish\' && !nzIcon) {\n            <span class="ant-steps-icon"><nz-icon nzType="check" /></span>\n          }\n          @if (nzStatus === \'error\') {\n            <span class="ant-steps-icon"><nz-icon nzType="close" /></span>\n          }\n          @if ((nzStatus === \'process\' || nzStatus === \'wait\') && !nzIcon) {\n            <span class="ant-steps-icon">\n              {{ index + 1 }}\n            </span>\n          }\n          @if (nzIcon) {\n            <span class="ant-steps-icon">\n              <ng-container *nzStringTemplateOutlet="nzIcon; let icon">\n                <nz-icon [nzType]="icon" />\n              </ng-container>\n            </span>\n          }\n        }\n        @if (showProcessDot) {\n          <span class="ant-steps-icon">\n            <ng-template #processDotTemplate>\n              <span class="ant-steps-icon-dot"></span>\n            </ng-template>\n            <ng-template\n              [ngTemplateOutlet]="customProcessTemplate || processDotTemplate"\n              [ngTemplateOutletContext]="{\n                $implicit: processDotTemplate,\n                status: nzStatus,\n                index: index\n              }"\n            ></ng-template>\n          </span>\n        }\n      </div>\n      <div class="ant-steps-item-content">\n        <div class="ant-steps-item-title">\n          <ng-container *nzStringTemplateOutlet="nzTitle">{{ nzTitle }}</ng-container>\n          @if (nzSubtitle) {\n            <div class="ant-steps-item-subtitle">\n              <ng-container *nzStringTemplateOutlet="nzSubtitle">{{ nzSubtitle }}</ng-container>\n            </div>\n          }\n        </div>\n        <div class="ant-steps-item-description">\n          <ng-container *nzStringTemplateOutlet="nzDescription">{{ nzDescription }}</ng-container>\n        </div>\n      </div>\n    </div>\n  ',host:{class:"ant-steps-item","[class.ant-steps-item-wait]":'nzStatus === "wait"',"[class.ant-steps-item-process]":'nzStatus === "process"',"[class.ant-steps-item-finish]":'nzStatus === "finish"',"[class.ant-steps-item-error]":'nzStatus === "error"',"[class.ant-steps-item-active]":"currentIndex === index","[class.ant-steps-item-disabled]":"nzDisabled","[class.ant-steps-item-custom]":"!!nzIcon","[class.ant-steps-next-error]":'(outStatus === "error") && (currentIndex === index + 1)'},providers:[ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4],imports:[ng_zorro_antd_progress__WEBPACK_IMPORTED_MODULE_6__.m,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_7__.Y3,ng_zorro_antd_core_outlet__WEBPACK_IMPORTED_MODULE_8__.C,_angular_common__WEBPACK_IMPORTED_MODULE_9__.T3]}]}],(()=>[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef},{type:ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4}]),{processDotTemplate:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewChild,args:["processDotTemplate",{static:!1}]}],itemContainer:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewChild,args:["itemContainer",{static:!0}]}],nzTitle:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzSubtitle:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzDescription:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzDisabled:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input,args:[{transform:_angular_core__WEBPACK_IMPORTED_MODULE_0__.booleanAttribute}]}],nzPercentage:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzSize:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzStatus:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzIcon:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}]});class NzStepsComponent{ngZone;cdr;directionality;destroy$;static ngAcceptInputType_nzProgressDot;steps;nzCurrent=0;nzDirection="horizontal";nzLabelPlacement="horizontal";nzType="default";nzSize="default";nzStartIndex=0;nzStatus="process";set nzProgressDot(value){value instanceof _angular_core__WEBPACK_IMPORTED_MODULE_0__.TemplateRef?(this.showProcessDot=!0,this.customProcessDotTemplate=value):this.showProcessDot=(0,ng_zorro_antd_core_util__WEBPACK_IMPORTED_MODULE_2__.G4)(value),this.updateChildrenSteps()}nzIndexChange=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter;indexChangeSubscription=rxjs__WEBPACK_IMPORTED_MODULE_10__.yU.EMPTY;showProcessDot=!1;showProgress=!1;customProcessDotTemplate;dir="ltr";constructor(ngZone,cdr,directionality,destroy$){this.ngZone=ngZone,this.cdr=cdr,this.directionality=directionality,this.destroy$=destroy$}ngOnChanges(changes){(changes.nzStartIndex||changes.nzDirection||changes.nzStatus||changes.nzCurrent||changes.nzSize)&&this.updateChildrenSteps()}ngOnInit(){this.directionality.change?.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.Q)(this.destroy$)).subscribe((direction=>{this.dir=direction,this.cdr.detectChanges()})),this.dir=this.directionality.value,this.updateChildrenSteps()}ngAfterContentInit(){this.steps&&this.steps.changes.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.Z)(null),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.Q)(this.destroy$)).subscribe((()=>{this.updateHostProgressClass(),this.updateChildrenSteps()}))}updateHostProgressClass(){this.steps&&!this.showProcessDot&&(this.showProgress=!!this.steps.toArray().find((step=>null!==step.nzPercentage)))}updateChildrenSteps(){if(this.steps){const length=this.steps.length;this.steps.toArray().forEach(((step,index)=>{Promise.resolve().then((()=>{step.nzSize=this.nzSize,step.outStatus=this.nzStatus,step.showProcessDot=this.showProcessDot,this.customProcessDotTemplate&&(step.customProcessTemplate=this.customProcessDotTemplate),step.clickable=this.nzIndexChange.observers.length>0,step.direction=this.nzDirection,step.index=index+this.nzStartIndex,step.currentIndex=this.nzCurrent,step.last=length===index+1,step.markForCheck()}))})),this.indexChangeSubscription.unsubscribe(),this.indexChangeSubscription=(0,rxjs__WEBPACK_IMPORTED_MODULE_12__.h)(...this.steps.map((step=>step.clickOutsideAngular$))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.Q)(this.destroy$)).subscribe((index=>{this.nzIndexChange.observers.length&&this.ngZone.run((()=>this.nzIndexChange.emit(index)))}))}}static fac=function NzStepsComponent_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzStepsComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgZone),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_13__.D),_angular_core__WEBPACK_IMPORTED_MODULE_0__["directiveInject"](ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4))};static cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineComponent"]({type:NzStepsComponent,selectors:[["nz-steps"]],contentQueries:function NzStepsComponent_ContentQueries(rf,ctx,dirIndex){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["contentQuery"](dirIndex,NzStepComponent,4),2&rf){let _t;_angular_core__WEBPACK_IMPORTED_MODULE_0__["queryRefresh"](_t=_angular_core__WEBPACK_IMPORTED_MODULE_0__["loadQuery"]())&&(ctx.steps=_t)}},hostAttrs:[1,"ant-steps"],hostVars:18,hostBindings:function NzStepsComponent_HostBindings(rf,ctx){2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["classProp"]("ant-steps-horizontal","horizontal"===ctx.nzDirection)("ant-steps-vertical","vertical"===ctx.nzDirection)("ant-steps-label-horizontal","horizontal"===ctx.nzDirection)("ant-steps-label-vertical",(ctx.showProcessDot||"vertical"===ctx.nzLabelPlacement)&&"horizontal"===ctx.nzDirection)("ant-steps-dot",ctx.showProcessDot)("ant-steps-small","small"===ctx.nzSize)("ant-steps-navigation","navigation"===ctx.nzType)("ant-steps-rtl","rtl"===ctx.dir)("ant-steps-with-progress",ctx.showProgress)},inputs:{nzCurrent:"nzCurrent",nzDirection:"nzDirection",nzLabelPlacement:"nzLabelPlacement",nzType:"nzType",nzSize:"nzSize",nzStartIndex:"nzStartIndex",nzStatus:"nzStatus",nzProgressDot:"nzProgressDot"},outputs:{nzIndexChange:"nzIndexChange"},exportAs:["nzSteps"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["ProvidersFeature"]([ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["NgOnChangesFeature"]],ngContentSelectors:_c3,decls:1,vars:0,template:function NzStepsComponent_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__["projectionDef"](),_angular_core__WEBPACK_IMPORTED_MODULE_0__["projection"](0))},encapsulation:2,changeDetection:0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzStepsComponent,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,args:[{changeDetection:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectionStrategy.OnPush,encapsulation:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ViewEncapsulation.None,preserveWhitespaces:!1,selector:"nz-steps",exportAs:"nzSteps",template:"<ng-content></ng-content>",host:{class:"ant-steps","[class.ant-steps-horizontal]":"nzDirection === 'horizontal'","[class.ant-steps-vertical]":"nzDirection === 'vertical'","[class.ant-steps-label-horizontal]":"nzDirection === 'horizontal'","[class.ant-steps-label-vertical]":"(showProcessDot || nzLabelPlacement === 'vertical') && nzDirection === 'horizontal'","[class.ant-steps-dot]":"showProcessDot","[class.ant-steps-small]":"nzSize === 'small'","[class.ant-steps-navigation]":"nzType === 'navigation'","[class.ant-steps-rtl]":"dir === 'rtl'","[class.ant-steps-with-progress]":"showProgress"},providers:[ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4]}]}],(()=>[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgZone},{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef},{type:_angular_cdk_bidi__WEBPACK_IMPORTED_MODULE_13__.D},{type:ng_zorro_antd_core_services__WEBPACK_IMPORTED_MODULE_5__.y4}]),{steps:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ContentChildren,args:[NzStepComponent]}],nzCurrent:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzDirection:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzLabelPlacement:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzType:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzSize:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzStartIndex:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzStatus:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzProgressDot:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],nzIndexChange:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Output}]});class NzStepsModule{static fac=function NzStepsModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||NzStepsModule)};static mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineNgModule"]({type:NzStepsModule,imports:[NzStepsComponent,NzStepComponent],exports:[NzStepsComponent,NzStepComponent]});static inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["defineInjector"]({imports:[NzStepComponent]})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["setClassMetadata"](NzStepsModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,args:[{imports:[NzStepsComponent,NzStepComponent],exports:[NzStepsComponent,NzStepComponent]}]}],null,null)}}]);