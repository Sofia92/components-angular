(self.webpackChunkcomponents_angular=self.webpackChunkcomponents_angular||[]).push([[8868],{"./library/CRF/capture/capture.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,':host {\n  display: flex;\n  gap: 30px;\n  width: 100%;\n  height: 100vh;\n  overflow: hidden;\n}\n:host > main {\n  overflow: auto;\n}\n:host .page-aside {\n  min-width: 350px;\n}\n:host .page-aside .content {\n  height: calc(100% - 84px);\n}\n\n.components {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.components .component {\n  display: grid;\n  grid-template-columns: 140px minmax(120px, 1fr);\n  gap: 8px;\n  overflow: hidden;\n}\n.components .content {\n  overflow: auto;\n}\n.components .cmp {\n  width: 100%;\n}\n.components [crfType="4"].component,\n.components [crfType="5"].component {\n  grid-template-columns: 100%;\n}\n\n[crfType="4"] > .content {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  grid-template-rows: max-content;\n  gap: 12px;\n}\n\n[crfType="2"] .content,\n[crfType="11"] .content {\n  grid-column: span 2;\n}',""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./library/CRF/editor/editor-cmp.sample.ts.scss?ngResource!=!./node_modules/@ngtools/webpack/src/loaders/inline-resource.js?data=CiAgICAuY21wewogICAgICB3aWR0aDogMjAwcHg7CiAgICB9CiAgICA%3D!./library/CRF/editor/editor-cmp.sample.ts":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".cmp {\n  width: 200px;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./library/CRF/editor/editor.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) 300px;\n  width: 100%;\n  height: 100%;\n  gap: 12px;\n  background-color: #f0f2f5;\n  font-size: 14px;\n}\n:host #page {\n  display: grid;\n  grid-template-columns: 220px minmax(0, 1fr);\n  gap: 12px;\n}\n:host #page #componentFactory {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  grid-template-rows: repeat(auto-fill, 28px);\n  color: #2e3438;\n  gap: 8px;\n}\n:host #page #componentFactory .base-cmp {\n  padding: 4px 8px;\n  background-color: #fff;\n  border-radius: 4px;\n}\n:host #page #crfPage {\n  height: 100%;\n}\n\n.component-row,\n.cmp {\n  padding: 0 12px;\n}\n\n.example-list {\n  min-height: 60px;\n  background: white;\n  border-radius: 4px;\n  overflow: hidden;\n  display: block;\n}\n\n.example-box {\n  padding: 20px 10px;\n  border-bottom: solid 1px #ccc;\n  color: rgba(0, 0, 0, 0.87);\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  box-sizing: border-box;\n  cursor: move;\n  background: white;\n  font-size: 14px;\n}\n\n.cdk-drag-preview {\n  box-sizing: border-box;\n  border-radius: 4px;\n  box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12);\n}\n\n.cdk-drag-placeholder {\n  opacity: 0;\n}\n\n.cdk-drag-animating {\n  transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);\n}\n\n.example-box:last-child {\n  border: none;\n}\n\n.example-list.cdk-drop-list-dragging .example-box:not(.cdk-drag-placeholder) {\n  transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./library/CRF/editor/tab-attr/crf-component.attr.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,':host {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  font-size: 14px;\n}\n:host .form {\n  display: grid;\n  grid-template-columns: 70px 1fr;\n  gap: 8px;\n}\n:host .form .content {\n  flex: 1;\n}\n\n[level="2"] {\n  margin-left: 2em;\n}\n\n[level="3"] {\n  margin-left: 3em;\n}\n\n.label[required] {\n  position: relative;\n}\n.label[required]::before {\n  content: "*";\n  color: red;\n}',""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./library/CRF/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{vu:()=>CRFCaptureComponent,k:()=>CRFEditorComponent,V9:()=>CRFEditorModule});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),Subject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),takeUntil=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js");let CRFEditorService=class CRFEditorService{_subject$=new Subject.B;emit(data){this._subject$.next(data)}subscribe(callback,destroy$){return destroy$?this._subject$.pipe((0,takeUntil.Q)(destroy$)).subscribe(callback):this._subject$.subscribe(callback)}};var CRFEditorBroadcastType;CRFEditorService=(0,tslib_es6.Cg)([(0,core.Injectable)({providedIn:"root"})],CRFEditorService),function(CRFEditorBroadcastType){CRFEditorBroadcastType[CRFEditorBroadcastType.CrfAttributeView=0]="CrfAttributeView",CRFEditorBroadcastType[CRFEditorBroadcastType.RenderAttributes=1]="RenderAttributes"}(CRFEditorBroadcastType||(CRFEditorBroadcastType={}));var common_module_Dx7dWex5=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs");var OperatorType,StateType,ComponentType,_typings_StateType,ConstraintType,StandardExpressionEnum,FillTypeEnum,VariableStatisticalTypeEnum,DateFormatEnum,editor_componentngResource=__webpack_require__("./library/CRF/editor/editor.component.scss?ngResource"),editor_componentngResource_default=__webpack_require__.n(editor_componentngResource);!function(OperatorType){OperatorType[OperatorType.Add=0]="Add",OperatorType[OperatorType.Modify=1]="Modify",OperatorType[OperatorType.Delete=2]="Delete"}(OperatorType||(OperatorType={})),function(StateType){StateType[StateType.Show=0]="Show",StateType[StateType.Hide=1]="Hide",StateType[StateType.Disabled=2]="Disabled"}(StateType||(StateType={}));class CrfConstraint{id;operator;pageId;entryCode;value;state;constructor(attrs={}){this.id=attrs.id,this.operator=attrs.operator,this.pageId=attrs.pageId,this.entryCode=attrs.entryCode,this.value=attrs.value,this.state=attrs.state}compareValue(sourceComponent){return!1}fetchCompareResult(sourceComponentValue){return 0===this.operator?sourceComponentValue.getTime()>new Date(this.value).getTime():1===this.operator?sourceComponentValue.getTime()===new Date(this.value).getTime():2===this.operator?sourceComponentValue.getTime()<new Date(this.value).getTime():3===this.operator?sourceComponentValue.getTime()>=new Date(this.value).getTime():4===this.operator?sourceComponentValue.getTime()<=new Date(this.value).getTime():void 0}fetchValueCompareResult(sourceComponentValue){return sourceComponentValue===this.value}fetchMultiValueCompareResult(sourceComponentValue){return this.value.length===sourceComponentValue.length&&this.value.every((val=>sourceComponentValue.find((sourceValue=>+sourceValue.id==+val))))}fetchSelectValueCompareResult(sourceComponentValue){return this.value.length?this.value.length===sourceComponentValue.length&&this.value.every((val=>sourceComponentValue.includes(val))):sourceComponentValue.find((val=>val===this.value))}}!function(ComponentType){ComponentType[ComponentType.CrfTextInput=1]="CrfTextInput",ComponentType[ComponentType.CrfLabel=2]="CrfLabel",ComponentType[ComponentType.CrfRadio=3]="CrfRadio",ComponentType[ComponentType.CrfContainer=4]="CrfContainer",ComponentType[ComponentType.CrfTable=5]="CrfTable",ComponentType[ComponentType.CrfCheckBox=6]="CrfCheckBox",ComponentType[ComponentType.CrfDateInput=7]="CrfDateInput",ComponentType[ComponentType.CrfNumberInput=8]="CrfNumberInput",ComponentType[ComponentType.CrfSelect=9]="CrfSelect",ComponentType[ComponentType.CrfTextArea=10]="CrfTextArea",ComponentType[ComponentType.CrfLine=11]="CrfLine",ComponentType[ComponentType.CrfMatrix=12]="CrfMatrix",ComponentType[ComponentType.CrfComputable=13]="CrfComputable",ComponentType[ComponentType.CrfUpload=14]="CrfUpload",ComponentType[ComponentType.CrfSignature=15]="CrfSignature",ComponentType[ComponentType.CrfSelectComplex=16]="CrfSelectComplex",ComponentType[ComponentType.CrfAttachment=17]="CrfAttachment",ComponentType[ComponentType.CrfSingleSelect=18]="CrfSingleSelect",ComponentType[ComponentType.CrfGroup=19]="CrfGroup",ComponentType[ComponentType.CrfMutiTable=20]="CrfMutiTable",ComponentType[ComponentType.CrfColumn=21]="CrfColumn",ComponentType[ComponentType.CrfVariableRange=22]="CrfVariableRange",ComponentType[ComponentType.CrfLink=23]="CrfLink"}(ComponentType||(ComponentType={})),function(StateType){StateType[StateType.Show=0]="Show",StateType[StateType.Hide=1]="Hide"}(_typings_StateType||(_typings_StateType={})),function(ConstraintType){ConstraintType[ConstraintType.All=1]="All",ConstraintType[ConstraintType.Any=2]="Any"}(ConstraintType||(ConstraintType={})),function(StandardExpressionEnum){StandardExpressionEnum[StandardExpressionEnum.None=0]="None",StandardExpressionEnum[StandardExpressionEnum.Cf=1]="Cf",StandardExpressionEnum[StandardExpressionEnum.Lab=2]="Lab",StandardExpressionEnum[StandardExpressionEnum.Drg=3]="Drg",StandardExpressionEnum[StandardExpressionEnum.Operation=4]="Operation"}(StandardExpressionEnum||(StandardExpressionEnum={})),function(FillTypeEnum){FillTypeEnum[FillTypeEnum.Auto=1]="Auto",FillTypeEnum[FillTypeEnum.Manual=2]="Manual",FillTypeEnum[FillTypeEnum.ComputeScript=3]="ComputeScript"}(FillTypeEnum||(FillTypeEnum={})),function(VariableStatisticalTypeEnum){VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.NonType=1]="NonType",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.Date=2]="Date",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.Continuity=3]="Continuity",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.OrderClassify=4]="OrderClassify",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.UnOrderClassify=5]="UnOrderClassify",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.TwoClassify=6]="TwoClassify",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.MultiSelect=7]="MultiSelect"}(VariableStatisticalTypeEnum||(VariableStatisticalTypeEnum={})),function(DateFormatEnum){DateFormatEnum[DateFormatEnum.FullDate=0]="FullDate",DateFormatEnum[DateFormatEnum.YearToSecond=1]="YearToSecond",DateFormatEnum[DateFormatEnum.YearToMinute=2]="YearToMinute",DateFormatEnum[DateFormatEnum.YearToMonth=3]="YearToMonth",DateFormatEnum[DateFormatEnum.MonthToDay=4]="MonthToDay",DateFormatEnum[DateFormatEnum.HourToSecond=5]="HourToSecond",DateFormatEnum[DateFormatEnum.HourToMinute=6]="HourToMinute"}(DateFormatEnum||(DateFormatEnum={}));var lodash=__webpack_require__("./node_modules/lodash/lodash.js");class CrfUtil{static randomCode(){let text="";const possible="ABCDEFGHIJKLMNOPQRSTUVWXYz01234Zabcdefghijklmnopqrstuvwxy56789";for(let i=0;i<6;i++)text+=possible.charAt(Math.floor(62*Math.random()));return text}static getCrfName(type){switch(type){case ComponentType.CrfTextInput:default:return"单行文本";case ComponentType.CrfLabel:return"文本标签";case ComponentType.CrfRadio:return"单项选择";case ComponentType.CrfContainer:return"组合";case ComponentType.CrfTable:return"表格";case ComponentType.CrfCheckBox:return"多项选择";case ComponentType.CrfDateInput:return"日期";case ComponentType.CrfNumberInput:return"数值";case ComponentType.CrfSelect:return"下拉选择(多选)";case ComponentType.CrfTextArea:return"多行文本";case ComponentType.CrfLine:return"水平线";case ComponentType.CrfMatrix:return"矩阵";case ComponentType.CrfUpload:return"上传";case ComponentType.CrfSelectComplex:return"级联下拉";case ComponentType.CrfAttachment:return"上传图片";case ComponentType.CrfSingleSelect:return"下拉选择(单选)";case ComponentType.CrfGroup:return"分组";case ComponentType.CrfMutiTable:return"多行多列表格"}}static renderTableRows(column,allOptions){if(allOptions){const rowsCount=Math.ceil(allOptions.length/column),rows=[];for(let i=0;i<rowsCount;i++)rows[i]=[];return rows.map(((row,rowIndex)=>{const startIndex=rowIndex*column,finishIndex=startIndex+column;return allOptions.slice(startIndex,finishIndex)}))}}static diff(child,createCrfItems,deleteCrfItems,updateCrfItems){child.id?child.isDeleted?deleteCrfItems.push(child.toJSON()):(child.isStable()||updateCrfItems.push(child.toJSON()),child.children.forEach((_child=>{CrfUtil.diff(_child,createCrfItems,deleteCrfItems,updateCrfItems)}))):createCrfItems.push(child.toJSON())}}class CrfComponent{id;pId;sort;name;code;desc;type;isVisible=!0;visibleConstraints=[];fillType=FillTypeEnum.Manual;stableKeys=["id","pId","sort","type","name","code","desc","isVisible","visibleConstraints"];SaveKeys=[...this.stableKeys];crfTypeName;prevAttributes={};isDeleted=!1;isCongregation=!1;constructor(attrs){Object.assign(this,(0,lodash.omit)(attrs,"attributes")),this.crfTypeName=CrfUtil.getCrfName(this.type),this.name=this.name||this.crfTypeName,this.prevAttributes=(0,lodash.pick)(this,this.stableKeys),this.isCongregation=[ComponentType.CrfContainer,ComponentType.CrfTable,ComponentType.CrfMatrix].includes(this.type)}get flattenComponents(){return[]}isStable(){const prev=this.prevAttributes,current=(0,lodash.pick)(this,this.stableKeys);return this.isEqualJSON(prev,current)}toJSON(){const json=(0,lodash.pick)(this,this.SaveKeys),temp=Object.assign({},json);return{...json,attributes:(0,lodash.pick)(temp,this.SaveKeys)}}isEqualJSON(v1,v2){if(v1===v2)return!0;if("object"!=typeof v1||"object"!=typeof v2)return!1;if(v1 instanceof Array&&v2 instanceof Array)return v1.length===v2.length&&v1.every(((e,i)=>this.isEqualJSON(e,v2[i])));if(v1&&v2){const v1Keys=Object.keys(v1).filter((key=>void 0!==v1[key])),v2Keys=Object.keys(v2).filter((key=>void 0!==v2[key]));return v1Keys.length===v2Keys.length&&v1Keys.every((key=>this.isEqualJSON(v1[key],v2[key])))}}toTemplateJson(){return{}}copy(){const component=(0,lodash.omit)(this,["id","pId","sort","visibleConstraints"]);return component.name=`${this.name}_复制`,component.code=CrfUtil.randomCode(),component.isVisible=!0,component}createConstraint(newConstraint){const constraint=new CrfConstraint(newConstraint);return this.visibleConstraints=this.visibleConstraints?this.visibleConstraints:[],this.visibleConstraints.push(constraint),constraint}resetConstraint(){this.visibleConstraints=[],this.isVisible=!0}addConstraint(){this.createConstraint(new CrfConstraint)}}class CrfElementDataInput extends CrfComponent{statisticalType;isRequired=!1;bindIndicators;defaultValue;value;isElementDataInput=!0;constructor(attr){super(attr)}}class CrfCongregation extends CrfComponent{children;constructor(attr){super(attr)}get flattenComponents(){let leafs=[];const children=this.children;return leafs=[].concat(children),children.forEach((child=>{leafs=leafs.concat(child.flattenComponents)})),leafs}addComponentToContainer(cmp,currentIndex){const currentCMPCRFName=CrfUtil.getCrfName(this.type),cmpCRFName=CrfUtil.getCrfName(cmp.type);return cmp instanceof CrfCongregation&&[ComponentType.CrfTable,ComponentType.CrfMatrix].includes(this.type)||[ComponentType.CrfLabel,ComponentType.CrfLine].includes(cmp.type)&&[ComponentType.CrfTable,ComponentType.CrfMatrix].includes(this.type)?`CRF设计错误：${currentCMPCRFName}控件内不允许添加${cmpCRFName}控件`:void(currentIndex>0?this.insertChildAfter(cmp,this.children[currentIndex-1]):this.appendChild(cmp))}appendChild(crfNode){crfNode.pId=this.id,crfNode.parent=this,this.children.push(crfNode)}insertChildAfter(crfNode,siblingNode){crfNode.pId=this.id,crfNode.parent=this,crfNode.sort=siblingNode.sort+1,this.children.filter((node=>node.sort>siblingNode.sort)).forEach((node=>node.sort++)),this.children.push(crfNode),this.children.sort(((pre,next)=>pre.sort-next.sort))}removeComponent(crfComponent){return this.removeChild(crfComponent)}findIsOrHasTableComponent(){const result=[],deepFindTable=(component,tableChildren)=>(component.isTable&&tableChildren.push(component),component.children&&component.children.forEach((c=>deepFindTable(c,tableChildren))),tableChildren);return this.type==ComponentType.CrfTable&&result.push(this),this.type==ComponentType.CrfContainer&&this.children.forEach((c=>deepFindTable(c,result))),result.length>0}toJSON(){const json=(0,lodash.pick)(this,this.SaveKeys),temp=Object.assign({},json);return{...json,attributes:(0,lodash.pick)(temp,this.SaveKeys),children:this.children.filter((c=>!c.isDeleted)).map((child=>child.toJSON()))}}removeChildrenTree(){this.children=[]}removeChild(crfNode){crfNode.id?crfNode.isDeleted=!0:this.children=this.children.filter((child=>child!==crfNode)),this.reorderChildren()}reorderChildren(){this.children.forEach(((child,i)=>child.sort=i))}}class CrfInput extends CrfElementDataInput{type=ComponentType.CrfTextInput;minLen=1;maxLen=500;standardExpressionType=null;constructor(attrs){super(attrs),this.stableKeys=[...this.stableKeys,"minLen","maxLen","standardExpressionType"]}}class CrfLabel extends CrfComponent{type=ComponentType.CrfLabel;color;fontStyle;textAlign;linkUrl;format;constructor(attrs){super(attrs)}get hideName(){return!!this.linkUrl?.trim()&&3!==this.format}}class CrfOptionSet extends CrfElementDataInput{options;constructor(attr){super(attr)}appendOption(){this.options=this.options||[],this.options.push(new CrfOption({}))}deleteOptionIndex(index){this.options.splice(index,1)}}class CrfOption{code;label;score;ableNote=!1;children;constructor(attr){Object.assign(this,attr),this.code=this.code||CrfUtil.randomCode(),this.score=this.score||0}appendOption(){this.children=this.children||[],this.children.push(new CrfOption({}))}}class CrfRadio extends CrfOptionSet{type=ComponentType.CrfRadio;columnCount=1;isRadio=!0;constructor(attrs){super(attrs)}}class CrfCascader extends CrfOptionSet{type=ComponentType.CrfSelectComplex;isSelectComplex=!0;isCascader=!0;constructor(attrs){super(attrs)}get optionsTop(){return this.options}}class CrfCheckBox extends CrfOptionSet{type=ComponentType.CrfCheckBox;columnCount=1;isCheckbox=!0;constructor(attrs){super(attrs)}}class CrfDate extends CrfElementDataInput{type=ComponentType.CrfDateInput;format="yyyy-MM-dd";constructor(attrs){super(attrs)}}class CrfImage extends CrfComponent{type=ComponentType.CrfAttachment;file;width;height;widthToHeightRatio;constructor(attrs){super(attrs)}}class CrfInputArea extends CrfElementDataInput{type=ComponentType.CrfTextArea;minLen=20;maxLen=2e3;rows=3;constructor(attrs){super(attrs)}}class CrfInputNumber extends CrfOptionSet{type=ComponentType.CrfNumberInput;precision;isHideUnit=!1;constructor(attrs){super(attrs)}}class CrfLine extends CrfComponent{type=ComponentType.CrfLine;color;format;constructor(attrs){super(attrs)}}class CrfMatrix extends CrfCongregation{type=ComponentType.CrfMatrix;rowLabels;constructor(attr){super(attr)}loadChildrenTree(children=[]){this.removeChildrenTree(),children.sort(((prev,next)=>prev.sort-next.sort)).forEach((child=>{const component=CrfComponentFactory.newCongregationComponent({...child,id:this.id});component&&this.children.push(component)}))}}class CrfSelectMulti extends CrfOptionSet{type=ComponentType.CrfSelect;isSelect=!0;constructor(attrs){super(attrs)}}class CrfSelectSingle extends CrfOptionSet{type=ComponentType.CrfSingleSelect;isSingleSelect=!0;constructor(attrs){super(attrs)}}class CrfTable extends CrfCongregation{type=ComponentType.CrfTable;minRows;maxRows;isTable=!0;constructor(attr){super(attr)}loadChildrenTree(children=[]){this.removeChildrenTree(),children.sort(((prev,next)=>prev.sort-next.sort)).forEach((child=>{const component=CrfComponentFactory.newCongregationComponent({...child,pId:this.id});component&&this.children.push(component)}))}}class CrfUpload extends CrfComponent{type=ComponentType.CrfUpload;value;fillType=FillTypeEnum.Manual;constructor(attrs){super(attrs)}}class CrfComponentFactory{static newComponent(attrs){let component=null;switch(attrs.code=CrfUtil.randomCode(),attrs.type){case ComponentType.CrfTextInput:component=new CrfInput(attrs);break;case ComponentType.CrfLabel:component=new CrfLabel(attrs);break;case ComponentType.CrfRadio:component=new CrfRadio(attrs);break;case ComponentType.CrfContainer:component=new CrfContainer(attrs);break;case ComponentType.CrfTable:component=new CrfTable(attrs);break;case ComponentType.CrfCheckBox:component=new CrfCheckBox(attrs);break;case ComponentType.CrfDateInput:component=new CrfDate(attrs);break;case ComponentType.CrfNumberInput:component=new CrfInputNumber(attrs);break;case ComponentType.CrfSelect:component=new CrfSelectMulti(attrs);break;case ComponentType.CrfTextArea:component=new CrfInputArea(attrs);break;case ComponentType.CrfLine:component=new CrfLine(attrs);break;case ComponentType.CrfMatrix:component=new CrfMatrix(attrs);break;case ComponentType.CrfUpload:component=new CrfUpload(attrs);break;case ComponentType.CrfSelectComplex:component=new CrfCascader(attrs);break;case ComponentType.CrfAttachment:component=new CrfImage(attrs);break;case ComponentType.CrfSingleSelect:component=new CrfSelectSingle(attrs)}return component instanceof CrfContainer&&component.loadChildrenTree(attrs.children),component instanceof CrfTable&&component.loadChildrenTree(attrs.children),component instanceof CrfMatrix&&component.loadChildrenTree(attrs.children),component}static newCongregationComponent(attrs){switch(attrs.type){case ComponentType.CrfTextInput:return new CrfInput(attrs);case ComponentType.CrfLabel:return new CrfLabel(attrs);case ComponentType.CrfRadio:return new CrfRadio(attrs);case ComponentType.CrfCheckBox:return new CrfCheckBox(attrs);case ComponentType.CrfDateInput:return new CrfDate(attrs);case ComponentType.CrfNumberInput:return new CrfInputNumber(attrs);case ComponentType.CrfSelect:return new CrfSelectMulti(attrs);case ComponentType.CrfTextArea:return new CrfInputArea(attrs);case ComponentType.CrfLine:return new CrfLine(attrs);case ComponentType.CrfUpload:return new CrfUpload(attrs);case ComponentType.CrfSelectComplex:return new CrfCascader(attrs);case ComponentType.CrfAttachment:return new CrfImage(attrs);case ComponentType.CrfSingleSelect:return new CrfSelectSingle(attrs)}}}class CrfContainer extends CrfCongregation{type=ComponentType.CrfContainer;columnCount;isContainer=!0;constructor(attr){super(attr)}loadChildrenTree(children=[]){this.removeChildrenTree(),children.sort(((prev,next)=>prev.sort-next.sort)).forEach((child=>{const component=CrfComponentFactory.newComponent({...child,pId:this.id});component&&this.children.push(component)}))}}class CrfPage{id;name;sort;lastModified;children=[];pId;containerDropTargetIds=["crfPage"];constructor(attr){Object.assign(this,attr)}get flattenComponents(){let leafs=[];const children=this.children;return leafs=[].concat(children),children.forEach((child=>{leafs=leafs.concat(child.flattenComponents)})),leafs}verifyAllComponentsAttributes(){return!0}currentComponent;existSameCode(){return!1}appendComponentByCopyComponentTemplate(component,autoCode){const newComponent=component.copy();autoCode?newComponent.code=CrfUtil.randomCode():delete newComponent.code}insertPageComponentsAfterByPageTemplate(tempPage,undefined,boolean){}removePageChild(crfComponent){return this.removeChild(crfComponent)}appendChild(crfNode){crfNode.pId=this.id,crfNode.parent=this,this.children.push(crfNode)}refreshDropIds(){const congregationCodes=[],deepNode=node=>{node.children&&node.children.length&&node.children.forEach((c=>deepNode(c))),node.isCongregation&&congregationCodes.push(node.code)};this.children.forEach((c=>deepNode(c))),this.containerDropTargetIds=congregationCodes.concat("crfPage")}insertChildAfter(crfNode,siblingNode){crfNode.pId=this.id,crfNode.parent=this,crfNode.sort=siblingNode.sort+1,this.children.filter((node=>node.sort>siblingNode.sort)).forEach((node=>node.sort++)),this.children.push(crfNode),this.children.sort(((pre,next)=>pre.sort-next.sort))}reorderBySort(resortChildren){this.children.forEach((child=>{child.sort=resortChildren.findIndex((rc=>rc.code===child.code))})),this.children.sort(((prev,next)=>prev.sort-next.sort))}setCurrentComponent(component){this.currentComponent=component}findComponentByCode(code){return this.flattenComponents.find((component=>component.code===code))}loadChildrenTree(children=[]){this.removeChildrenTree(),children.sort(((prev,next)=>prev.sort-next.sort)).forEach((child=>{const component=CrfComponentFactory.newComponent({...child,pId:0});component&&this.children.push(component)}))}diffPage(){let createCrfItems=[],deleteCrfItems=[],updateCrfItems=[];return this.children.forEach((child=>{CrfUtil.diff(child,createCrfItems,deleteCrfItems,updateCrfItems)})),{createCrfItems,deleteCrfItems,updateCrfItems}}removeChildrenTree(){this.children=[]}removeChild(crfNode){crfNode.id?crfNode.isDeleted=!0:this.children=this.children.filter((child=>child!==crfNode)),this.reorderChildren()}reorderChildren(){this.children.forEach(((child,i)=>child.sort=i))}}var dom_tokens_rA0ACyx7=__webpack_require__("./node_modules/@angular/common/fesm2022/dom_tokens-rA0ACyx7.mjs"),drag_drop=__webpack_require__("./node_modules/@angular/cdk/fesm2022/drag-drop.mjs"),ng_zorro_antd_notification=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-notification.mjs");let CRFEditorComponent=class CRFEditorComponent{document;_CRFEditorService;_nzNotificationService;page;components;currentPage=new CrfPage({});ComponentType=ComponentType;baseCMPs=[{type:ComponentType.CrfTextInput,name:"单行文本",icon:"crf:crf-text"},{type:ComponentType.CrfTextArea,name:"多行文本",icon:"crf:crf-textarea"},{type:ComponentType.CrfRadio,name:"单项选择",icon:"crf:crf-radio"},{type:ComponentType.CrfCheckBox,name:"多项选择",icon:"crf:crf-checkbox"},{type:ComponentType.CrfSingleSelect,name:"下拉单项选择",icon:"crf:crf-select-single"},{type:ComponentType.CrfSelect,name:"下拉多项选择",icon:"crf:crf-select"},{type:ComponentType.CrfSelectComplex,name:"级联下拉",icon:"crf:crf-select-completx"},{type:ComponentType.CrfDateInput,name:"日期",icon:"crf:crf-date"},{type:ComponentType.CrfNumberInput,name:"数值",icon:"crf:crf-number"},{type:ComponentType.CrfUpload,name:"上传",icon:"crf:crf-upload"},{type:ComponentType.CrfContainer,name:"组合",icon:"crf:crf-container"},{type:ComponentType.CrfTable,name:"表格",icon:"crf:crf-table"},{type:ComponentType.CrfMatrix,name:"矩阵",icon:"crf:crf-matrix"},{type:ComponentType.CrfLabel,name:"文本标签",icon:"crf:crf-label"},{type:ComponentType.CrfLine,name:"水平线",icon:"crf:crf-line"},{type:ComponentType.CrfAttachment,name:"附件图片",icon:"crf:crf-link"}];items=["Carrots","Tomatoes","Onions","Apples","Avocados"];basket=["Oranges","Bananas","Cucumbers"];factory;constructor(document,_CRFEditorService,_nzNotificationService){this.document=document,this._CRFEditorService=_CRFEditorService,this._nzNotificationService=_nzNotificationService,this.factory=new CrfComponentFactory}ngOnChanges(changes){this.components?.length&&this.currentPage.loadChildrenTree(this.components)}componentView(pointEvent){const element=this.document.elementFromPoint(pointEvent.x,pointEvent.y);if(!element)return;const crfComponentRef=element.getAttribute("code")?element:element.closest("[code]");if(!crfComponentRef)return;const component=this.currentPage.findComponentByCode(crfComponentRef.getAttribute("code"));component&&(this.currentPage.setCurrentComponent(component),this._CRFEditorService.emit({type:CRFEditorBroadcastType.CrfAttributeView,data:component}))}currentPageResort(event){const resortChildren=this.currentPage.children.filter((child=>!child.isDeleted));(0,drag_drop.HD)(resortChildren,event.previousIndex,event.currentIndex),this.currentPage.reorderBySort(resortChildren),this._updatePageAndTriggerAutoSave()}drop(event){if(event.previousContainer===event.container)(0,drag_drop.HD)(event.container.data,event.previousIndex,event.currentIndex);else{const{type}=event.item.data,cmp=CrfComponentFactory.newComponent({type});try{this.currentPage.appendChild(cmp),this.currentPage.children.length>1&&(0,drag_drop.HD)(this.currentPage.children,this.currentPage.children.length,event.currentIndex),this._resort(this.currentPage.children)}catch(error){console.log(error)}console.log(this.currentPage.children)}}dropContainer(event,component){if(event.previousContainer===event.container)(0,drag_drop.HD)(event.container.data,event.previousIndex,event.currentIndex);else{const{type}=event.item.data,cmp=CrfComponentFactory.newComponent({type});try{component.appendChild(cmp),component.children.length>1&&(0,drag_drop.HD)(component.children,component.children.length,event.currentIndex),this._resort(component.children)}catch(error){console.log(error)}console.log(this.currentPage.children)}}dragDropEnter=(drag,drop)=>{const dropContainer=this.currentPage.findComponentByCode(drop.id);if(!dropContainer)return!0;if(dropContainer instanceof CrfContainer)return!0;if(dropContainer instanceof CrfTable||dropContainer instanceof CrfMatrix){CrfUtil.getCrfName(drag.data.type);return![ComponentType.CrfContainer,ComponentType.CrfTable,ComponentType.CrfMatrix].includes(drag.data.type)}return!0};findHasTable(component){return component instanceof CrfCongregation&&component.findIsOrHasTableComponent()}_updatePageAndTriggerAutoSave(){}_resort(array){array.forEach(((item,i)=>item.sort=i+1)),this.currentPage.refreshDropIds()}static ctorParameters=()=>[{type:Document,decorators:[{type:core.Inject,args:[dom_tokens_rA0ACyx7.q]}]},{type:CRFEditorService},{type:ng_zorro_antd_notification.xY}];static propDecorators={page:[{type:core.Input}],components:[{type:core.Input}]}};CRFEditorComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"CRF-Editor",template:'<article id="page">\n   <aside cdkDropList\n          id="componentFactory"\n          [cdkDropListConnectedTo]="currentPage.containerDropTargetIds"\n          cdkDropListSortingDisabled\n          [cdkDropListData]="baseCMPs"> @for (item of baseCMPs; track item) { <div class="base-cmp"\n           cdkDrag\n           [cdkDragData]="item">{{item.name}}</div> } </aside>\n   <main cdkDropList\n         id="crfPage"\n         [cdkDropListConnectedTo]="[\'componentFactory\']"\n         [cdkDropListData]="currentPage?.children"\n         class="example-list"\n         (cdkDropListDropped)="drop($event)">\n      <ng-container *ngFor="let cmp of currentPage?.children">\n         <section *ngIf="!cmp.isDeleted"\n                  cdkDrag\n                  (click)="componentView($event)"\n                  [id]="cmp.code"\n                  [attr.code]="cmp.code"\n                  class="component-row"\n                  [class.flex-column]="cmp.isCongregation"\n                  [class.active]="currentPage.currentComponent?.code===cmp.code"\n                  [class.congregation]="cmp.isCongregation">\n            <header class="cmp-title flex-1 flex flex-j-b"\n                    [class.hideState]="!cmp.isVisible">\n               <ng-container *ngTemplateOutlet="cmpTitle;context: {$implicit: cmp}"></ng-container>\n            </header>\n            <div class="cmp cell flex flex-a-c flex-j-b gap-base"\n                 [class.sub-congregation]="cmp.isCongregation">\n               <div class="cmp flex-1">\n                  <ng-container *ngTemplateOutlet="crfComponentWrapper;context: {$implicit: cmp}"></ng-container>\n               </div>\n               <div class="action"\n                    [class.editing]="cmp.addNewOption"\n                    *ngIf="!cmp.isContainer&&!cmp.isMatrix&&!cmp.isTable">\n                  <ng-container *ngTemplateOutlet="cmpAction;context: {$implicit: cmp}"></ng-container>\n               </div>\n            </div>\n         </section>\n      </ng-container>\n   </main>\n</article>\n<aside>\n   <crf-component-attr></crf-component-attr>\n</aside>\n<ng-template #cmpTitle\n             let-cmp>\n   <span class="title flex-1 flex gap-mini"\n         [class.text-right]="cmp.isLabel && cmp.rightAlign"\n         [class.text-center]="cmp.isLabel && cmp.centerAlign"\n         [class.default-name]="cmp.isInitialName"\n         [class.required]="cmp.required">\n      <i *ngIf="cmp.isBaselineTime"\n         class="cursor-pointer mark-baseline"\n         nz-icon\n         nzType="star"\n         nzTheme="fill"\n         nz-tooltip\n         nzTooltipTitle="时间标准"></i>\n      <i *ngIf="cmp.hasComputeScript"\n         class="cursor-pointer mark-baseline"\n         nz-icon\n         nzType="images:shared/circle-link"\n         nz-tooltip\n         nzTooltipTitle="存在计算脚本"></i>\n      <i *ngIf="!cmp.isVisible"\n         class="mark-hidden"\n         nz-icon\n         nzType="eye-close"\n         nzTheme="fill"></i>\n      <i *ngIf="cmp.indicatorMeta?.displayName"\n         class="cursor-pointer link-color"\n         nz-icon\n         nzType="paper-clip"\n         nz-tooltip\n         [nzTooltipTitle]="\'绑定变量: \'+cmp.indicatorMeta?.displayName"></i>\n      <span class="flex-1 displayName"\n            nz-tooltip\n            [nzTooltipTitle]="cmp.name||cmp.crfTypeName"\n            nzTooltipPlacement="topLeft"\n            [nzTooltipMouseEnterDelay]="1.2">{{ cmp.name||cmp.crfTypeName }}</span>\n      <i *ngIf="!!cmp.desc"\n         nz-icon\n         nzType="question-circle"\n         nzTheme="fill"\n         class="mark-desc cursor-pointer"\n         nz-tooltip\n         [nzTooltipTitle]="cmp.desc"></i>\n   </span>\n   <div class="action"\n        *ngIf="cmp.isMatrixParent||cmp.isContainer||cmp.isMatrix||cmp.isTable"> 额外 <ng-container\n                    *ngTemplateOutlet="cmpAction;context: {$implicit: cmp}"></ng-container>\n   </div>\n</ng-template>\n<ng-template #cmpAction\n             let-cmp>\n   <ng-container *ngIf="!preview">\n      <ng-container *ngIf="cmp.congregationInnerSort as sortMata">\n         <a *ngIf="sortMata.upSort"\n            class="btn btn-xs"\n            nz-icon\n            nzType="arrow-up"\n            title="上移一位"\n            (click)="$event.stopPropagation();sortToPre(cmp)"></a>\n         <a *ngIf="sortMata.downSort"\n            class="btn btn-xs"\n            nz-icon\n            nzType="arrow-down"\n            title="下移一位"\n            (click)="$event.stopPropagation();sortToNext(cmp)"></a>\n         <a *ngIf="sortMata.leftSort"\n            class="btn btn-xs"\n            nz-icon\n            nzType="arrow-left"\n            title="前移一位"\n            (click)="$event.stopPropagation();sortToPre(cmp)"></a>\n         <a *ngIf="sortMata.rightSort"\n            class="btn btn-xs"\n            nz-icon\n            nzType="arrow-right"\n            title="后移一位"\n            (click)="$event.stopPropagation();sortToNext(cmp)"></a>\n      </ng-container>\n      <a *ngIf="!findHasTable(cmp)"\n         class="btn btn-xs"\n         nz-icon\n         nzType="copy"\n         title="复制"\n         (click)="$event.stopPropagation();componentCopy(cmp)"></a>\n      <a class="btn btn-xs"\n         nz-icon\n         nzType="delete"\n         title="删除"\n         (click)="$event.stopPropagation()"\n         nz-popconfirm\n         nzPopconfirmTitle="是否确认删除该控件?"\n         (nzOnConfirm)="componentDelete(cmp)"></a>\n   </ng-container>\n</ng-template>\n<ng-template #CongregationTpl\n             let-component>\n   <section [id]="component.code"\n            [attr.pid]="component.id"\n            class="full-width full-height congregation congregation-section"\n            cdkDropList\n            [cdkDropListConnectedTo]="[\'componentFactory\']"\n            [cdkDropListData]="component.children"\n            [cdkDropListEnterPredicate]="dragDropEnter"\n            (cdkDropListDropped)="dropContainer($event, component)">\n      <div *ngFor="let subCmp of component.children"\n           #domainaa\n           cdkDrag\n           cdkDragLockAxis="y"\n           class="flex-1"\n           [attr.pCode]="component.code"\n           [attr.code]="subCmp.code"\n           [class.flex]="!subCmp.isCongregation"\n           [class.active]="(subCmp.code === currentPage?.currentComponent?.code)"\n           (click)="$event.stopPropagation();componentView($event)">\n         <div class="example-custom-placeholder"\n              [ngStyle]="{\'min-height.px\':height  }"\n              *cdkDragPlaceholder></div>\n         <header class="cmp-title flex-1 flex flex-j-b"\n                 [class.hideState]="!subCmp.isVisible">\n            <ng-container *ngTemplateOutlet="cmpTitle;context: {$implicit: subCmp}"></ng-container>\n         </header>\n         <div class="cmp cell flex flex-a-c flex-j-b gap-base"\n              [class.sub-congregation]="subCmp.isCongregation">\n            <div class="cmp flex-1">\n               <ng-container *ngTemplateOutlet="crfComponentWrapper;context: {$implicit: subCmp}"></ng-container>\n            </div>\n         </div>\n      </div>\n   </section>\n</ng-template>\n<ng-template #crfComponentWrapper\n             let-component>\n   <ng-container *ngIf="component.isCongregation">\n      <ng-container *ngTemplateOutlet="CongregationTpl;context: {$implicit: component}"></ng-container>\n   </ng-container>\n   <CRF-sample *ngIf="!component.isCongregation"\n               [component]="component"\n               [currentPage]="currentPage"></CRF-sample>\n</ng-template>',standalone:!1,styles:[editor_componentngResource_default()]})],CRFEditorComponent);var editor_cmp_sample=__webpack_require__("./library/CRF/editor/editor-cmp.sample.ts.scss?ngResource!=!./node_modules/@ngtools/webpack/src/loaders/inline-resource.js?data=CiAgICAuY21wewogICAgICB3aWR0aDogMjAwcHg7CiAgICB9CiAgICA%3D!./library/CRF/editor/editor-cmp.sample.ts"),editor_cmp_sample_default=__webpack_require__.n(editor_cmp_sample),directives=__webpack_require__("./src/directives/index.ts");let CrfEditorComponentSample=class CrfEditorComponentSample extends directives.kd{document;_CRFEditorService;component;currentPage;ComponentType=ComponentType;pageImageConfig;cascaderOptions=[];constructor(document,_CRFEditorService){super(),this.document=document,this._CRFEditorService=_CRFEditorService}ngOnInit(){this._CRFEditorService.subscribe((({type,data})=>{type==CRFEditorBroadcastType.RenderAttributes&&data.code===this.component.code&&this.buildComponentCascaderOptions()}),this.destroy$)}get isSelectUI(){return[ComponentType.CrfSelect,ComponentType.CrfSelectComplex,ComponentType.CrfSingleSelect].includes(this.component.type)}get componentType(){return this.component.type}crfAttachmentStyle(component){return this.pageImageConfig&&this.pageImageConfig.image?{maxWidth:this.pageImageConfig.image.width,maxHeight:this.pageImageConfig.image.height}:{width:component.imgWidth+"px"}}componentView(pointEvent){const element=this.document.elementFromPoint(pointEvent.x,pointEvent.y);if(!element)return;const crfComponentRef=element.getAttribute("code")?element:element.closest("[code]");if(!crfComponentRef)return;const component=this.currentPage.findComponentByCode(crfComponentRef.getAttribute("code"));component&&(this.currentPage.setCurrentComponent(component),this._CRFEditorService.emit({type:CRFEditorBroadcastType.CrfAttributeView,data:component}))}buildComponentCascaderOptions(){if(!this.component.isCascader)return;const buildOptions=options=>(options||[]).map((option=>{const newOption={label:option.label,value:option.code,isLeaf:!option.children?.length};return option.children&&option.children.length&&(newOption.children=buildOptions(option.children)),newOption})),component=this.component;this.cascaderOptions=buildOptions(component.options)}static ctorParameters=()=>[{type:Document,decorators:[{type:core.Inject,args:[dom_tokens_rA0ACyx7.q]}]},{type:CRFEditorService}];static propDecorators={component:[{type:core.Input}],currentPage:[{type:core.Input}],componentType:[{type:core.HostBinding,args:["attr.type"]}]}};CrfEditorComponentSample=(0,tslib_es6.Cg)([(0,core.Component)({standalone:!1,selector:"CRF-sample",template:'<ng-container *ngTemplateOutlet="componentTpl;context: {$implicit: component}"></ng-container>\n<ng-template #componentTpl\n             let-cmp>\n  <ng-container [ngSwitch]="component.type">\n    <ng-container *ngSwitchCase="ComponentType.CrfTextInput">\n      <input class="cmp-sample"\n             disabled>\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfNumberInput">\n      <span class="flex cmp">\n        <nz-input-number class="flex-1"\n                         [nzPrecision]="component.precision" /> @if(!component.isHideUnit){ <nz-select\n                   [style.width.px]="80"\n                   nzPlaceHolder="单位">\n          <nz-option *ngFor="let option of component.options"\n                     [nzLabel]="option.label"\n                     [nzValue]="option.code"></nz-option>\n        </nz-select> } </span>\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfDateInput">\n      <nz-date-picker [nzFormat]="component.format"\n                      class="cmp"\n                      [nzShowTime]="component.format.includes(\'HH\')"></nz-date-picker>\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfTextArea">\n      <textarea class="cmp-sample"\n                rows="2"\n                disabled></textarea>\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfUpload">\n      <button class="cmp-sample"\n              nz-button\n              nzType="primary"\n              disabled><i nz-icon\n           nzType="upload"></i><span>点击上传附件</span></button>\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfLine">\n      <hr [style.color]="component.color">\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfLabel">\n      <p class="crf-label pointer-events-none"\n         [attr.align]="component.textAlign">\n        <label *ngIf="!component.link"\n               [style.color]="component.color"\n               [attr.fontStyle]="component.fontStyle">{{component.name||\'文本标签\'}}</label>\n        <ng-container *ngIf="component.link">\n          <a *ngIf="component.linkDisplay === 1"\n             style="text-decoration: underline;">{{component.link}}</a>\n          <span *ngIf="component.linkDisplay === 2">\n            <a style="text-decoration: none;">\n              <i nz-icon\n                 nzType="icons:link2"></i> {{component.link}}</a>\n          </span>\n          <span *ngIf="component.linkDisplay === 3"\n                class="link-card flex-row flex-a-c flex-j-b gap-l">\n            <aside class="flex-row flex-a-c gap-sm">\n              <span class="link-card-icon"\n                    nz-icon\n                    nzType="icons:link2"></span>\n              <span class="flex-column text-left">\n                <i>{{component.name}}</i>\n                <small>{{component.link}}</small>\n              </span>\n            </aside>\n            <button nz-button>查看</button>\n          </span>\n        </ng-container>\n      </p>\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfAttachment">\n      <img class="cursor-pointer"\n           [src]="component.isExistFile?(component.file.src):\'/assets/images/edc/crf/icon-picture.svg\'"\n           [ngStyle]="crfAttachmentStyle(component)">\n    </ng-container>\n    <ng-container *ngSwitchCase="ComponentType.CrfGroup">\n      <input type="radio"\n             disabled>\n    </ng-container>\n    <span *ngIf="component.isSelect||component.isSingleSelect">\n      <nz-select class="cmp"\n                 [nzMode]="component.isSelect?\'multi\':\'default\'">\n        <nz-option *ngFor="let option of component.options"\n                   [nzLabel]="option.label"\n                   [nzValue]="option.code"></nz-option>\n      </nz-select>\n    </span>\n    <nz-cascader *ngIf="component.isCascader"\n                 [nzOptions]="cascaderOptions"></nz-cascader>\n    <ng-container *ngIf="component.isRadio||component.isCheckbox">\n      <ng-template *ngTemplateOutlet="radioCheckboxTpl;context: {$implicit: component}"></ng-template>\n    </ng-container>\n  </ng-container>\n</ng-template>\n<ng-template #select\n             let-width\n             let-placeholder="placeholder">\n  <select class="cmp-sample"\n          [style.width.px]="width"\n          disabled="disabled">\n    <option selected>{{placeholder}}</option>\n  </select>\n</ng-template>\n<ng-template #radioCheckboxTpl\n             let-component>\n  <div class="grid grid-cols-{{component.columnCount}} gap-2"> @for (option of component.options; track $index) { <span>\n      <input *ngIf="component.isRadio"\n             type="radio"\n             disabled>\n      <input *ngIf="!component.isRadio"\n             type="checkbox"\n             disabled>\n      <span>{{option?.label}}</span>\n      <input *ngIf="option?.selectOther"\n             class="option-note"\n             type="text"\n             disabled></span> } </div>\n</ng-template>',styles:[editor_cmp_sample_default()]})],CrfEditorComponentSample);var crf_component_attrngResource=__webpack_require__("./library/CRF/editor/tab-attr/crf-component.attr.scss?ngResource"),crf_component_attrngResource_default=__webpack_require__.n(crf_component_attrngResource),ng_zorro_antd_modal=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-modal.mjs");let CRFComponentAttr=class CRFComponentAttr extends directives.kd{_CRFEditorService;component;ComponentType=ComponentType;isOptionSet=!1;openOptionCodeSet=new Set;standardExpressionList=[{label:"诊断",value:StandardExpressionEnum.Cf},{label:"药品",value:StandardExpressionEnum.Drg},{label:"手术",value:StandardExpressionEnum.Operation}];dateFormats=[{label:"年-月-日",value:"yyyy-MM-dd"},{label:"年-月-日 时:分:秒",value:"yyyy-MM-dd HH:mm:ss"}];marksCount={1:"1",2:"2",3:"3",4:"4",6:"6",8:"8",12:"12"};_nzModalService=(0,core.inject)(ng_zorro_antd_modal.N_);constructor(_CRFEditorService){super(),this._CRFEditorService=_CRFEditorService}ngOnInit(){this._CRFEditorService.subscribe((({type,data})=>{type==CRFEditorBroadcastType.CrfAttributeView&&(this.component=data,this.setComponentAttr())}),this.destroy$)}updateAttributesRender(){this._CRFEditorService.emit({type:CRFEditorBroadcastType.RenderAttributes,data:this.component})}popupOptionsModal(tpl){this._nzModalService.create({nzTitle:"选项编辑",nzContent:tpl,nzWidth:this.component instanceof CrfCascader?1e3:600,nzOnOk:()=>this.updateAttributesRender()}),this.component.options?.length&&this.component.appendOption()}removeOption(index){this.component.deleteOptionIndex(index)}removeCascaderOption(option,parent){if(parent instanceof CrfComponent)parent.deleteOptionIndex(parent.options.findIndex((o=>o.code===option.code)));else{const p=parent;(p.children||[]).splice((p.children||[]).findIndex((o=>o.code===option.code)),1)}}toggleShowOptionSubs(option){this.openOptionCodeSet.has(option.code)?this.openOptionCodeSet.delete(option.code):this.openOptionCodeSet.add(option.code),option.children?.length||this.addSubOption(option)}addSubOption(option){option.appendOption()}setComponentAttr(){this.isOptionSet=[ComponentType.CrfRadio,ComponentType.CrfCheckBox,ComponentType.CrfSelect,ComponentType.CrfSingleSelect,ComponentType.CrfNumberInput,ComponentType.CrfSelectComplex].includes(this.component.type)}static ctorParameters=()=>[{type:CRFEditorService}]};var crf_component_attr_VariableStatisticalTypeEnum;CRFComponentAttr=(0,tslib_es6.Cg)([(0,core.Component)({standalone:!1,selector:"crf-component-attr",template:'<ng-container *ngIf="component">\n  <div class="form">\n    <span class="label"\n          required>名称</span>\n    <div class="content">\n      <input nz-input\n             type="text"\n             name="dataShortName"\n             [placeholder]="component.crfTypeName"\n             [(ngModel)]="component.name"\n             [maxlength]="component.shortNameMaxLength">\n    </div>\n  </div>\n  <div class="form">\n    <span class="label"\n          required>代码</span>\n    <input class="content"\n           nz-input\n           type="text"\n           name="dataCode"\n           [(ngModel)]="component.code"\n           (keyup)="checkCodeValid()">\n  </div>\n  <div class="form">\n    <span class="label">描述</span>\n    <textarea class="content"\n              nz-input\n              name="dataDesc"\n              [(ngModel)]="component.desc"\n              cols="20"\n              rows="3"\n              style="resize: none;"></textarea>\n  </div>\n  <ng-container [ngSwitch]="component.type">\n    @if(component.type==ComponentType.CrfTextInput||component.type==ComponentType.CrfTextArea) { <div class="form">\n      <span class="label">最少字符</span>\n      <nz-input-number class="content"\n                       [(ngModel)]="component.minLen"\n                       [nzMin]="1"\n                       [nzMax]="component.maxLen"\n                       [nzStep]="1"></nz-input-number>\n    </div>\n    <div class="form">\n      <span class="label">最大字符</span>\n      <nz-input-number class="content"\n                       [(ngModel)]="component.maxLen"\n                       [nzMin]="component.minLen"\n                       [nzMax]="255"\n                       [nzStep]="1"></nz-input-number>\n    </div> } @if(component.type==ComponentType.CrfDateInput) { <div class="form">\n      <span class="label">格式</span>\n      <nz-select class="content"\n                 [(ngModel)]="component.format">\n        <nz-option *ngFor="let opt of dateFormats"\n                   [nzValue]="opt.value"\n                   [nzLabel]="opt.label"></nz-option>\n      </nz-select>\n    </div> } @if(component.type==ComponentType.CrfRadio||component.type==ComponentType.CrfCheckBox) { <div class="form">\n      <span class="label">列/每行</span>\n      <nz-slider [nzMarks]="marksCount"\n                 [nzStep]="null"\n                 [nzMin]="1"\n                 [nzMax]="12"\n                 [(ngModel)]="component.columnCount"\n                 (ngModelChange)="updateAttributesRender()"></nz-slider>\n    </div> } @if(component.type==ComponentType.CrfNumberInput){<div class="form">\n      <span class="label">数值精度</span>\n      <nz-input-number class="content"\n                       nzPlaceHolder="设置展示的小数位数"\n                       [nzStep]="1"\n                       [nzMin]="0"\n                       [(ngModel)]="component.precision"></nz-input-number>\n    </div>\n    <div class="form">\n      <span class="label">隐藏单位</span>\n      <nz-switch class="content"\n                 [(ngModel)]="component.isHideUnit"></nz-switch>\n    </div> }\n  </ng-container>\n  <div class="form"\n       *ngIf="component.isElementDataInput">\n    <span class="label">默认值</span>\n    <input type="text"\n           class="content"\n           nz-input\n           [(ngModel)]="component.defaultValue">\n  </div>\n  <div class="form"\n       *ngIf="component.isElementDataInput">\n    <span class="label">此项必填</span>\n    <nz-switch class="content"\n               [(ngModel)]="component.isRequired"></nz-switch>\n  </div>\n  <div class="form"\n       *ngIf="component.isElementDataInput">\n    <span class="label">显示条件</span>\n    <nz-switch class="content"\n               [(ngModel)]="component.isRequired"></nz-switch>\n  </div> @if(isOptionSet){\n  <hr>\n  <p class="flex justify-between align-center">\n    <span>选项</span>\n    <button nz-button\n            nzType="link"\n            (click)="popupOptionsModal(optionsTpl)">编辑</button>\n  </p>\n  <div class="optionSet"> @for (option of component.options; track $index) { <div class="option">\n      <span class="label">{{option.label}}</span>\n      <span class="score">{{option.score}}</span>\n    </div> } </div> }\n</ng-container>\n<ng-template #optionsTpl>\n  <ng-container *ngTemplateOutlet="component.isCascader?CascaderOptionsTpl:BaseOptionsTpl"></ng-container>\n</ng-template>\n<ng-template #BaseOptionsTpl>\n  <p class="flex align-center gap-4">\n    <span class="flex-1">名称</span>\n    <span class="flex-1">分值</span>\n    <span>操作</span>\n  </p>\n  <div> @for (option of component.options; track $index) { <p class="flex align-center gap-4">\n      <input class="flex-1"\n             type="text"\n             nz-input\n             [(ngModel)]="option.label">\n      <nz-input-number class="flex-1"\n                       [(ngModel)]="option.score" />\n      <button nz-button\n              nzType="text"\n              (click)="removeOption($index)">\n        <span nz-icon\n              nzType="minus"></span></button>\n    </p> } </div>\n  <footer>\n    <button nz-button\n            nzType="primary"\n            (click)="component.appendOption()">新增</button>\n  </footer>\n</ng-template>\n<ng-template #CascaderOptionsTpl>\n  <p class="flex align-center gap-4">\n    <span class="flex-1">名称</span>\n    <span class="flex-1">分值</span>\n    <span>操作</span>\n  </p>\n  <p class="gap-4"\n     [attr.level]="level"\n     *ngFor="let option of component.options">\n    <ng-container\n                  *ngTemplateOutlet="cascaderOption;context: { $implicit: option, parent: component, level: 1}"></ng-container>\n  </p>\n  <footer>\n    <button nz-button\n            nzType="primary"\n            (click)="component.appendOption()">新增一级</button>\n  </footer>\n</ng-template>\n<ng-template #cascaderOption\n             let-option\n             let-parent="parent"\n             let-level="level">\n  <header class="flex gap-1"\n          [attr.level]="level">\n    <span *ngIf="level<3"\n          nz-icon\n          [nzType]="openOptionCodeSet.has(option.code)?\'minus-square\':\'plus-square\'"\n          (click)="toggleShowOptionSubs(option)"></span>\n    <input class="flex-1"\n           type="text"\n           nz-input\n           [(ngModel)]="option.label">\n    <nz-input-number class="flex-1"\n                     [(ngModel)]="option.score" />\n    <button nz-button\n            nzType="text"\n            (click)="removeCascaderOption(option, parent)">\n      <span nz-icon\n            nzType="minus"></span></button>\n    <button *ngIf="level<3"\n            (click)="addSubOption(option)">新增下级</button>\n  </header> @if(openOptionCodeSet.has(option.code)){ <div class="flex-column">\n    <p class="flex-column gap-4"\n       [attr.level]="level"\n       *ngFor="let _subOption of option.children">\n      <ng-container *ngTemplateOutlet="cascaderOption;context: {$implicit: _subOption, parent: option, level:level+1}"></ng-container>\n    </p>\n  </div> }\n</ng-template>',styles:[crf_component_attrngResource_default()]})],CRFComponentAttr),function(VariableStatisticalTypeEnum){VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.NonType=1]="NonType",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.Date=2]="Date",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.Continuity=3]="Continuity",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.OrderClassify=4]="OrderClassify",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.UnOrderClassify=5]="UnOrderClassify",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.TwoClassify=6]="TwoClassify",VariableStatisticalTypeEnum[VariableStatisticalTypeEnum.MultiSelect=7]="MultiSelect"}(crf_component_attr_VariableStatisticalTypeEnum||(crf_component_attr_VariableStatisticalTypeEnum={}));var ng_zorro_antd_input=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-input.mjs"),ng_zorro_antd_select=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-select.mjs"),ng_zorro_antd_icon=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-icon.mjs"),ng_zorro_antd_input_number=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-input-number.mjs"),ng_zorro_antd_switch=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-switch.mjs"),ng_zorro_antd_tooltip=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-tooltip.mjs"),ng_zorro_antd_slider=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-slider.mjs"),ng_zorro_antd_date_picker=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-date-picker.mjs"),ng_zorro_antd_button=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-button.mjs"),ng_zorro_antd_cascader=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-cascader.mjs");let CRFEditorModule=class CRFEditorModule{};CRFEditorModule=(0,tslib_es6.Cg)([(0,core.NgModule)({imports:[common_module_Dx7dWex5.MD,fesm2022_forms.YN,drag_drop.RK,drag_drop.O7,drag_drop.T1,ng_zorro_antd_input.j,ng_zorro_antd_select.DH,ng_zorro_antd_icon.Y3,ng_zorro_antd_input_number.G,ng_zorro_antd_switch.$,ng_zorro_antd_tooltip.Qt,ng_zorro_antd_slider.Sk,ng_zorro_antd_date_picker.LE,ng_zorro_antd_button.Zw,ng_zorro_antd_modal.U6,ng_zorro_antd_cascader.x2],declarations:[CRFEditorComponent,CrfEditorComponentSample,CRFComponentAttr],exports:[CRFEditorComponent]})],CRFEditorModule);var capture_componentngResource=__webpack_require__("./library/CRF/capture/capture.component.scss?ngResource"),capture_componentngResource_default=__webpack_require__.n(capture_componentngResource),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js");const MOCK_CRF_ITEMS=[{uniqueCode:"FSFBD_HvyBTz",id:1744,pId:0,name:"单选",type:3,sort:2,code:"HvyBTz",attributes:{code:"HvyBTz",name:"单选",sort:2,type:3,state:0,column:4,fillType:2,required:!1,statType:4,optionSet:{id:448,code:"edc_value_5703f534c62a4210b3cbb3b93a065364",name:"职称",filed:"0",options:[{id:1655,code:"edc_value_8d22c41284014768b2fe847b8325df72",label:"职员",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1656,code:"edc_value_a438ccb65fe04263a73be3e6715fc1f5",label:"研究员",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1657,code:"edc_value_18eb32615216411e9a4c75fdc911d27c",label:"住院医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1658,code:"edc_value_648c2e8edc5d4626893e15a104e418aa",label:"主治医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1659,code:"edc_value_695fd9a9950f4648adc1eeb3a2395110",label:"副主任医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1660,code:"edc_value_e92674ebb61944188ed86ff6de0636c0",label:"主任医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1661,code:"edc_value_cb3c6b15122949c6ad3868eaf537519b",label:"副教授",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"单选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:4,children:[]},{uniqueCode:"FSFBD_02xaEw",id:1742,pId:0,name:"单行",type:1,sort:0,code:"02xaEw",attributes:{id:1742,code:"02xaEw",name:"单行",sort:0,type:1,state:0,fillType:2,required:!1,statType:1,maxLength:500,minLength:1,displayName:"单行",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_qro6UL",id:1743,pId:0,name:"多行",type:10,sort:1,code:"qro6UL",attributes:{id:1743,code:"qro6UL",cols:null,name:"多行",rows:3,sort:1,type:10,state:0,maxLine:2e3,minLine:20,fillType:2,required:!1,statType:1,displayName:"多行",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_R9bWrX",id:1745,pId:0,name:"多选",type:6,sort:3,code:"R9bWrX",attributes:{code:"R9bWrX",name:"多选",sort:3,type:6,state:0,column:2,fillType:2,required:!1,statType:5,optionSet:{id:449,code:"edc_value_75523cc6b2d5413fb4ac5a13ca062b35",name:"医嘱类型（yty_his）",filed:"0",options:[{id:1662,code:"edc_value_524d09f9cc7b4e36bcb3aacd3e277417",label:"长期医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1663,code:"edc_value_01f225d4926d4bbb88633c8c1987add8",label:"临时医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"多选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:5,children:[]},{uniqueCode:"FSFBD_jQAIYg",id:1746,pId:0,name:"下拉单选",type:18,sort:4,code:"jQAIYg",attributes:{code:"jQAIYg",name:"下拉单选",sort:4,type:18,state:0,fillType:2,required:!1,statType:5,optionSet:{id:450,code:"edc_value_644b09d852a04de8af1e8913df810640",name:"报告类型（mdm）",filed:"0",options:[{id:1664,code:"edc_value_e676636a20344b1ba54b77beb7fc0c22",label:"否定诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1665,code:"edc_value_341dbc0d91024e3ca07cd5be606e80f5",label:"最后诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1666,code:"edc_value_48be934e2e13472dbe8ba948491af801",label:"死亡诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1667,code:"edc_value_0d00b2ff93754f9d83a6e2f90c629cb8",label:"补充诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1668,code:"edc_value_50562b0d17434fc6940c523908305da2",label:"修正诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1669,code:"edc_value_d8abab3d26db46bd81be4ec069444972",label:"病理诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1670,code:"edc_value_66b85705421c472095662d2910b6b8c8",label:"损伤和中毒的外部原因",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1671,code:"edc_value_7571d1674d8d4959851511c49645cbf9",label:"院内感染",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1672,code:"edc_value_487c09c515c04248a7e143dc1c2f0e11",label:"并发症",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1673,code:"edc_value_1537a50b9b234f02af23da1d61e245ef",label:"手术并发症",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1674,code:"edc_value_53ea8a08d68249b690b2adc0ed1f987e",label:"术后诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1675,code:"edc_value_d7afc5e7a15e4e7093d8590ac2d485c1",label:"术前诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1676,code:"edc_value_dba4d424f1294d87a62d27e70ec6d98e",label:"医保诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1677,code:"edc_value_c65fd692c48f4bc89929b9136d84501d",label:"出院诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1678,code:"edc_value_74b84a3c588444d6af8274b145603e27",label:"入院诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1679,code:"edc_value_6b1a6507a16b4379b0227f6cae42d854",label:"门诊诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1680,code:"edc_value_73876d857f934e2e882c4b853df37c28",label:"其他诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1681,code:"edc_value_d96c9798730541d59a980028a32bf1d3",label:"次要诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1682,code:"edc_value_9b891eef832246048b07f37f69e2563c",label:"主要诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"下拉单选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:5,children:[]},{uniqueCode:"FSFBD_BJieR9",id:1747,pId:0,name:"下拉多选",type:9,sort:5,code:"BJieR9",attributes:{code:"BJieR9",name:"下拉多选",sort:5,type:9,state:0,fillType:2,required:!1,statType:4,optionSet:{id:451,code:"edc_value_e5cbcfe7bbfc40768ee73c6c6cd1b12c",name:"代码对照关系（mdm）",filed:"0",options:[{id:1683,code:"edc_value_8849df1ab54049ba9f753301a06d640e",label:"完全对照",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1684,code:"edc_value_dbec1e8f36384dad99166c9a5630b567",label:"分类对照",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1685,code:"edc_value_cbe5b79ae27a4e4cb22559e7a9c54c56",label:"同义词",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"下拉多选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:4,children:[]},{uniqueCode:"FSFBD_PnpKmT",id:1751,pId:0,name:"上传",type:14,sort:9,code:"PnpKmT",attributes:{code:"PnpKmT",name:"上传",sort:9,type:14,files:[],state:0,fillType:2,required:!1,displayName:"上传",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_7BH9oE",id:1752,pId:0,name:"文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本",type:2,sort:10,code:"7BH9oE",attributes:{code:"7BH9oE",name:"文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本",sort:10,type:2,color:"#fc0303",state:0,fillType:2,fontStyle:1,textAlign:1,displayName:"label",constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_8DBb2O",id:1753,pId:0,name:"矩阵",type:12,sort:11,code:"8DBb2O",attributes:{code:"8DBb2O",desc:"矩阵是特殊控件",name:"矩阵",sort:11,type:12,filed:1,state:0,fillType:2,rowLabels:[{content:"第一行",serialNumber:1694606419426},{content:"第二行",serialNumber:1694606431219}],displayName:"矩阵",constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[{uniqueCode:"FSFBD_Tb4hI8",id:1754,pId:1753,name:"第一列",type:3,sort:0,code:"Tb4hI8",attributes:{code:"Tb4hI8",name:"第一列",sort:0,type:3,state:0,column:3,fillType:2,required:!1,statType:1,optionSet:{id:453,code:"edc_value_33bc14034bbe40bf8cb0c9ff82260452",name:"报告类型（mdm）",filed:"0",options:[{id:1693,code:"edc_value_4eacb2e3a9dc4ab8bd088499abcd1957",label:"否定诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1694,code:"edc_value_2a1844f637174828976f5aa643415379",label:"最后诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1695,code:"edc_value_56d8363c00e74402850bbc144cbbb600",label:"死亡诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"第一列",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_w01MZF",id:1755,pId:1753,name:"第二列",type:6,sort:1,code:"w01MZF",attributes:{code:"w01MZF",name:"第二列",sort:1,type:6,state:0,column:2,fillType:2,required:!1,statType:1,optionSet:{id:454,code:"edc_value_275e35a88fa74eb994a356ea32335eb7",name:"门诊就诊状态（mdm）",filed:"0",options:[{id:1696,code:"edc_value_c774408036274200a061f079435bfcf7",label:"候诊",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1697,code:"edc_value_957e5c79a6224bc68bda17692eba5878",label:"挂号",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"第二列",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]}]},{uniqueCode:"FSFBD_9kszic",id:1756,pId:0,name:"line",type:11,sort:12,code:"9kszic",attributes:{code:"9kszic",name:"line",sort:12,type:11,state:0,fillType:2,displayName:"水平线",constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_Qidi1K",id:1757,pId:0,name:"组合啊",type:4,sort:13,code:"Qidi1K",attributes:{code:"Qidi1K",name:"组合啊",sort:13,type:4,filed:1,state:0,column:2,fillType:2,displayName:"组合啊",constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[{uniqueCode:"FSFBD_njGK15",id:1760,pId:1757,name:"组合-多选",type:6,sort:2,code:"njGK15",attributes:{code:"njGK15",name:"组合-多选",sort:2,type:6,state:0,column:4,fillType:2,required:!1,statType:1,optionSet:{id:455,code:"edc_value_61b8411f17cf451ebe76c37990519196",name:"报告类型（mdm）",filed:"0",options:[{id:1698,code:"edc_value_fc67e8d7eb1240b682e3ff5dc58874a6",label:"否定诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1699,code:"edc_value_11d72f670a2c47958192070640cfc035",label:"死亡诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1700,code:"edc_value_1078eb9d23d14b7e8249503813fa455f",label:"补充诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1701,code:"edc_value_cab5cbca3a4c4016b2e5dd023d1c31e6",label:"修正诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1702,code:"edc_value_d296f4c5dcec42128872efd23a080c17",label:"病理诊断",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1703,code:"edc_value_385a93533cee476097ec440477dc5a3d",label:"损伤和中毒的外部原因",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1704,code:"edc_value_029e7d46156e42089cbeec25147695ba",label:"院内感染",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1705,code:"edc_value_bc8f83fe6e764b8d910f9638567a5920",label:"并发症",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"组合-多选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_TMHk3b",id:1761,pId:1757,name:"组合-单选",type:3,sort:3,code:"TMHk3b",attributes:{code:"TMHk3b",name:"组合-单选",sort:3,type:3,state:0,column:1,fillType:2,required:!1,optionSet:{id:456,code:"edc_value_0a1e144d924f4009b6235e5191b3bb89",name:"医嘱类型（yty_his）",filed:"0",options:[{id:1706,code:"edc_value_8dd1c10a05cf4ff380b4cabb6fb28ff8",label:"长期医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1707,code:"edc_value_a3391b5f16424ffaa5d4daeb365bb872",label:"临时医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"组合-单选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_6d7Dfs",id:1762,pId:1757,name:"组合-下拉单选",type:18,sort:4,code:"6d7Dfs",attributes:{code:"6d7Dfs",name:"组合-下拉单选",sort:4,type:18,state:0,fillType:2,required:!1,statType:1,optionSet:{id:457,code:"edc_value_48c53a27a3bf414d8c2f90c563da94ad",name:"职称",filed:"0",options:[{id:1708,code:"edc_value_2a6a7f557df444ac993248ed8ed5eed9",label:"职员",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1709,code:"edc_value_f4edece5fefe45ecb47449799250e524",label:"研究员",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1710,code:"edc_value_ccd1b5c8edb8407fa6b8629a96887899",label:"住院医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1711,code:"edc_value_e0250d67b4314bf4a368075db641a0d7",label:"主治医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1712,code:"edc_value_69cd7b3c6d72424d823f8340df14c4bb",label:"副主任医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1713,code:"edc_value_46e8bc92d5a342c38f6bf08f10e1ab06",label:"主任医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1714,code:"edc_value_8139dd0d9f44462c9810788ccab802cc",label:"副教授",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"组合-下拉单选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_1u27Vk",id:1763,pId:1757,name:"组合-下拉多选",type:9,sort:5,code:"1u27Vk",attributes:{code:"1u27Vk",name:"组合-下拉多选",sort:5,type:9,state:0,fillType:2,required:!1,statType:1,optionSet:{id:458,code:"edc_value_fd2ec3668e804d52835f981b2d3accb6",name:"检验异常标志（mdm）",filed:"0",options:[{id:1715,code:"edc_value_2562228fad214f04ae1e94514d85c11b",label:"危急值阳性",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1716,code:"edc_value_41c5d6eb7bbb4468b2cf7f6f2e0d81fc",label:"危急值偏低",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"组合-下拉多选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_BYzW7b",id:1764,pId:1757,name:"组合-级联",type:16,sort:6,code:"BYzW7b",attributes:{code:"BYzW7b",name:"组合-级联",sort:6,type:16,state:0,fillType:2,required:!1,statType:1,optionSet:{id:459,code:"edc_value_a30f626235454169843cb89dc6220ad0",name:"职称",filed:"0",options:[{id:1717,code:"edc_value_ca25972c453a404a9f03f9953758eb91",label:"主治医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1718,code:"edc_value_9a27d3e6bac24ff19a98e3a46d956889",label:"副主任医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1719,code:"edc_value_a880c113a2c94d5193e417ea55580edb",label:"主任医师",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1720,code:"edc_value_caa748572126455f832094b3dfdd02c0",label:"副教授",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"组合-级联",optionFiled:119715,defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_qHMyAs",id:1767,pId:1757,name:"组合-矩阵",type:12,sort:9,code:"qHMyAs",attributes:{code:"qHMyAs",name:"组合-矩阵",sort:9,type:12,filed:1,state:0,fillType:2,rowLabels:[{content:"第1行",serialNumber:1694605861257},{content:"第2行",serialNumber:1694606735703}],displayName:"组合-矩阵",constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[{uniqueCode:"FSFBD_RHyuUm",id:1768,pId:1767,name:"第1列",type:6,sort:0,code:"RHyuUm",attributes:{code:"RHyuUm",name:"第1列",sort:0,type:6,state:0,column:2,fillType:2,required:!1,statType:1,optionSet:{id:460,code:"edc_value_af8462068ca64265814f442bc03cc6cd",name:"门诊就诊状态（mdm）",filed:"0",options:[{id:1721,code:"edc_value_2b2f3fbb4193458eb36afedbd3ef82e8",label:"挂号",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1722,code:"edc_value_a2cabb6948f644f98bb0dff8cd850d20",label:"退号",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1723,code:"edc_value_0b3ef12fd04d4a4d97b2e98355363d9d",label:"就诊结束",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1724,code:"edc_value_240e1427acc64f28bce10db7bef78f0c",label:"叫号未到",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"第1列",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_QlEp09",id:1769,pId:1767,name:"第2列",type:3,sort:1,code:"QlEp09",attributes:{code:"QlEp09",name:"第2列",sort:1,type:3,state:0,column:2,fillType:2,required:!1,statType:1,optionSet:{id:461,code:"edc_value_2301c03b2bdd48eeb39c2f20758ea792",name:"医嘱类型（wn_his）",filed:"0",options:[{id:1725,code:"edc_value_319b48e93877496cbd0646e2b49b520f",label:"出院带药",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1726,code:"edc_value_840f81e14c754b2aa473019abcfee044",label:"临时医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1727,code:"edc_value_f1b2d943b96b4f3aa56b627f50c99b8a",label:"长期医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"第2列",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]}]},{uniqueCode:"FSFBD_SadPYb",id:1770,pId:1757,name:"组合-上传",type:14,sort:10,code:"SadPYb",attributes:{code:"SadPYb",name:"组合-上传",sort:10,type:14,files:[],state:0,fillType:2,required:!1,displayName:"组合-上传",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_4VQvco",id:1758,pId:1757,name:"组合-单行",type:1,sort:0,code:"4VQvco",attributes:{id:1758,code:"4VQvco",name:"组合-单行",sort:0,type:1,state:0,fillType:2,required:!1,statType:1,maxLength:500,minLength:1,displayName:"组合-单行",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_DWvCed",id:1759,pId:1757,name:"组合-多行",type:10,sort:1,code:"DWvCed",attributes:{id:1759,code:"DWvCed",cols:null,name:"组合-多行",rows:3,sort:1,type:10,state:0,maxLine:2e3,minLine:20,fillType:2,required:!1,statType:1,displayName:"组合-多行",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_1sCr1x",id:1765,pId:1757,name:"组合-日期",type:7,sort:7,code:"1sCr1x",attributes:{id:1765,code:"1sCr1x",name:"组合-日期",sort:7,type:7,state:0,dateType:0,fillType:2,required:!1,statType:2,displayName:"组合-日期",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:2,children:[]},{uniqueCode:"FSFBD_np0e6Y",id:1766,pId:1757,name:"组合-数值",type:8,sort:8,code:"np0e6Y",attributes:{id:1766,code:"np0e6Y",name:"组合-数值",sort:8,type:8,state:0,fillType:2,required:!1,optionSet:null,displayName:"组合-数值",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]}]},{uniqueCode:"FSFBD_8OPUMk",id:1771,pId:0,name:"表格啊",type:5,sort:14,code:"8OPUMk",attributes:{max:10,min:0,code:"8OPUMk",name:"表格啊",sort:14,type:5,filed:1,state:0,fillType:2,displayName:"表格啊",constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[{uniqueCode:"FSFBD_t5uxR1",id:1772,pId:1771,name:"表格-单行",type:1,sort:0,code:"t5uxR1",attributes:{id:1772,code:"t5uxR1",name:"表格-单行",sort:0,type:1,state:0,fillType:2,required:!1,statType:1,maxLength:500,minLength:1,displayName:"表格-单行",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_3mIRq0",id:1774,pId:1771,name:"表格-多选",type:6,sort:2,code:"3mIRq0",attributes:{code:"3mIRq0",name:"表格-多选",sort:2,type:6,state:0,column:1,fillType:2,required:!1,statType:1,optionSet:{id:462,code:"edc_value_0f795c6711da42aaa16fb071cd6909de",name:"系统类别(mdm)",filed:"0",options:[{id:1728,code:"edc_value_4490549294cb4f9e8726b5c92e8ff7a1",label:"其他类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1729,code:"edc_value_252b548c4b9a4e2cb65b2bc04a9ffe90",label:"财务管理业务类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1730,code:"edc_value_541af650a2974cd78df27cf4fb804fe3",label:"信息平台类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1731,code:"edc_value_95e98169b91b4ae79bb088457c8eb723",label:"移动及互联网医疗",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"表格-多选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_WUsyPh",id:1773,pId:1771,name:"表格-多行",type:10,sort:1,code:"WUsyPh",attributes:{id:1773,code:"WUsyPh",cols:null,name:"表格-多行",rows:3,sort:1,type:10,state:0,maxLine:2e3,minLine:20,fillType:2,required:!1,statType:1,displayName:"表格-多行",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_DA5IGZ",id:1775,pId:1771,name:"表格-单选",type:3,sort:3,code:"DA5IGZ",attributes:{code:"DA5IGZ",name:"表格-单选",sort:3,type:3,state:0,column:1,fillType:2,required:!1,statType:1,optionSet:{id:463,code:"edc_value_a681faa4362640fdbb1693a42277c7c0",name:"职称",filed:"0",options:[{id:1732,code:"edc_value_06e8f7c8686840a28e92d0a579ad0ec4",label:"职员",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1733,code:"edc_value_7ff55eeb6b0a45eba36a8a8e74900566",label:"研究员",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"表格-单选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_QWPdmO",id:1777,pId:1771,name:"表格-下拉多选",type:9,sort:5,code:"QWPdmO",attributes:{code:"QWPdmO",name:"表格-下拉多选",sort:5,type:9,state:0,fillType:2,required:!1,optionSet:{id:464,code:"edc_value_fb26f3237cb54918920ab9a394a09844",name:"系统类别(mdm)",filed:"0",options:[{id:1734,code:"edc_value_c2240777f86f41df88c1ad9ea08b2cf5",label:"其他类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1735,code:"edc_value_7000277fa5aa4779bc8037e83591f2c1",label:"财务管理业务类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1736,code:"edc_value_6f396afccef04126a4b1c887d336c536",label:"临床业务类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1737,code:"edc_value_b5a4adf6f08f470180084b21e8a8c279",label:"物流管理业务类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1738,code:"edc_value_4b03af746acb4a2fa7d35164714c1190",label:"医疗管理业务类",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"表格-下拉多选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_ngyNFf",id:1778,pId:1771,name:"表格-下拉单选",type:18,sort:6,code:"ngyNFf",attributes:{code:"ngyNFf",name:"表格-下拉单选",sort:6,type:18,state:0,fillType:2,required:!1,statType:1,optionSet:{id:465,code:"edc_value_e6d027adff2e40429f84b38532659b8e",name:"医嘱类型（yty_his）",filed:"0",options:[{id:1739,code:"edc_value_b9f002d6974a429dafa2febbf622f7c6",label:"长期医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:1740,code:"edc_value_369f9096abe345a0a987c6d78963d898",label:"临时医嘱",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"表格-下拉单选",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_5AtXXv",id:1779,pId:1771,name:"表格-上传",type:14,sort:7,code:"5AtXXv",attributes:{code:"5AtXXv",name:"表格-上传",sort:7,type:14,files:[],state:0,fillType:2,required:!1,statType:1,displayName:"表格-上传",defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]},{uniqueCode:"FSFBD_h0NEsX",id:1776,pId:1771,name:"表格-日期",type:7,sort:4,code:"h0NEsX",attributes:{id:1776,code:"h0NEsX",name:"表格-日期",sort:4,type:7,state:0,dateType:2,fillType:2,required:!1,statType:2,displayName:"表格-日期",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:2,children:[]},{uniqueCode:"FSFBD_vwTOgC",id:1780,pId:1771,name:"表格-数值",type:8,sort:8,code:"vwTOgC",attributes:{id:1780,code:"vwTOgC",name:"表格-数值",sort:8,type:8,state:0,fillType:2,required:!1,_hideUnit:!0,optionSet:null,displayName:"表格-数值",defaultValue:null,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]}]},{uniqueCode:"FSFBD_M7rlLk",id:1749,pId:0,name:"日期",type:7,sort:7,code:"M7rlLk",attributes:{code:"M7rlLk",name:"日期",sort:7,type:7,state:0,dateType:2,fillType:2,required:!0,statType:2,displayName:"日期",defaultValue:null,constraintType:1,isBaselineTime:!0},bindCrfScript:null,isTimeStandard:!1,statisticalType:2,children:[]},{uniqueCode:"FSFBD_KevpfI",id:1750,pId:0,name:"数值",type:8,sort:8,code:"KevpfI",attributes:{id:1750,code:"KevpfI",name:"数值",sort:8,type:8,state:0,fillType:2,required:!0,statType:3,optionSet:{id:484,code:"edc_value_f92d278697e541348dfdfeabe9fea872",name:"数值",filed:"0",options:[{id:1827,code:"edc_value_6716ab5974bb4e628cda4dc325e994c1",label:"岁",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},precision:2,displayName:"数值",defaultValue:2.2,verifications:[],constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:3,children:[]},{uniqueCode:"FSFBD_uRKGEb",id:1748,pId:0,name:"级联",type:16,sort:6,code:"uRKGEb",attributes:{code:"uRKGEb",name:"级联",sort:6,type:16,state:0,fillType:2,required:!1,statType:1,optionSet:{id:539,code:"edc_value_0197a5fd18ef7a7f8efcda7352281458",name:"级联",filed:"0",options:[{id:2086,code:"edc_value_0197a5fd19007f17ac80448afe16820f",label:"111",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[{id:2087,code:"edc_value_0197a5fd190b7c3186c3c3c60499e8fb",label:"11",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[{id:2088,code:"edc_value_0197a5fd190f77b9b688629fff17c635",label:"1",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:{id:0,code:null,name:null,filed:"0",options:[]}}]}]},{id:2089,code:"edc_value_0197a5fd19187dae80f9bb3fb66fb2af",label:"333",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]},{id:2090,code:"edc_value_0197a5fd191b7a71a012dca3843a0ee8",label:"222",score:null,imgSrc:null,checked:!1,deleted:!1,ableNote:!1,children:[]}]},displayName:"级联",optionFiled:1,defaultValue:null,constraintType:1},bindCrfScript:null,isTimeStandard:!1,statisticalType:1,children:[]}],MOCK_CRF_DATA=[{crfPageDataId:286397,order:1,data:null,dataLabel:"记录1",fillSource:null,isSubmitted:!1,recordTime:"2025-04-03 16:47:44",lastModificationTime:"1743670064255",saveState:2}];var CRFType;!function(CRFType){CRFType[CRFType.CrfTextInput=1]="CrfTextInput",CRFType[CRFType.CrfLabel=2]="CrfLabel",CRFType[CRFType.CrfRadio=3]="CrfRadio",CRFType[CRFType.CrfContainer=4]="CrfContainer",CRFType[CRFType.CrfTable=5]="CrfTable",CRFType[CRFType.CrfCheckBox=6]="CrfCheckBox",CRFType[CRFType.CrfDateInput=7]="CrfDateInput",CRFType[CRFType.CrfNumberInput=8]="CrfNumberInput",CRFType[CRFType.CrfSelect=9]="CrfSelect",CRFType[CRFType.CrfTextArea=10]="CrfTextArea",CRFType[CRFType.CrfLine=11]="CrfLine",CRFType[CRFType.CrfMatrix=12]="CrfMatrix",CRFType[CRFType.CrfComputable=13]="CrfComputable",CRFType[CRFType.CrfUpload=14]="CrfUpload",CRFType[CRFType.CrfSignature=15]="CrfSignature",CRFType[CRFType.CrfSelectComplex=16]="CrfSelectComplex",CRFType[CRFType.CrfAttachment=17]="CrfAttachment",CRFType[CRFType.CrfSingleSelect=18]="CrfSingleSelect",CRFType[CRFType.CrfGroup=19]="CrfGroup",CRFType[CRFType.CrfMutiTable=20]="CrfMutiTable",CRFType[CRFType.CrfColumn=21]="CrfColumn",CRFType[CRFType.CrfVariableRange=22]="CrfVariableRange",CRFType[CRFType.CrfLink=23]="CrfLink"}(CRFType||(CRFType={}));class CRF{uniqueCode;id;pId;name;type;sort;code;isTimeStandard;statisticalType;hideName=!1;_isElement=!1;_isContainer=!1;constructor(attributes){Object.assign(this,attributes)}get isElement(){return this._isElement}get isContainer(){return this._isContainer}}class Element extends CRF{value;_isElement=!0;_isContainer=!1;constructor(attributes){super(attributes)}setValue(valueMap,index,value){const cacheValue=valueMap.get(this.code)||{};cacheValue[index]=value,valueMap.set(this.code,cacheValue)}}class TextInput extends Element{type=CRFType.CrfTextInput;constructor(attributes){super(attributes)}}class TextArea extends TextInput{type=CRFType.CrfTextArea;constructor(attributes){super(attributes)}}class SelectField extends Element{optionSet;options=(0,core.signal)([]);constructor(attributes){super(attributes),Object.assign(this,attributes),this._buildOptions()}_buildOptions(){const loopSetTitle=option=>(Object.assign(option,{title:option.label,key:option.id}),option.children?.length?option.children=option.children.map((o=>loopSetTitle(o))):(option.children=[],option.isLeaf=!0),option),options=this.optionSet?.options.map((o=>loopSetTitle(o)));this.options.set(options)}}class Radio extends SelectField{type=CRFType.CrfRadio;defaultValue={id:"",label:""};constructor(attributes){super(attributes)}}class Checkbox extends SelectField{type=CRFType.CrfCheckBox;constructor(attributes){super(attributes)}}class SelectSingle extends SelectField{type=CRFType.CrfSingleSelect;constructor(attributes){super(attributes)}}class SelectMulti extends SelectField{type=CRFType.CrfSelect;constructor(attributes){super(attributes)}}class SelectComplex extends SelectField{type=CRFType.CrfSelectComplex;constructor(attributes){super(attributes)}}class DateInput extends Element{type=CRFType.CrfDateInput;constructor(attributes){super(attributes)}}class NumberInput extends Element{type=CRFType.CrfNumberInput;constructor(attributes){super(attributes)}}class Group extends CRF{type=CRFType.CrfGroup;constructor(attributes){super(attributes)}}class Column extends CRF{type=CRFType.CrfColumn;constructor(attributes){super(attributes)}}class Line extends CRF{type=CRFType.CrfLine;hideName=!0;constructor(attributes){super(attributes)}}class Label extends CRF{type=CRFType.CrfLabel;hideName=!0;constructor(attributes){super(attributes)}}class Link extends CRF{type=CRFType.CrfLink;constructor(attributes){super(attributes)}}class Attachment extends CRF{type=CRFType.CrfAttachment;constructor(attributes){super(attributes)}}class Upload extends CRF{type=CRFType.CrfUpload;constructor(attributes){super(attributes)}}class Table extends CRF{type=CRFType.CrfTable;children=[];valueMap=new Map;_isElement=!1;_isContainer=!0;constructor(attributes){super(attributes),this.children=(attributes.children||[]).map((child=>(child.hideName=!0,child)))}get tableRows(){const maxLength=this.valueMap.size?Math.max(...Array.from(this.valueMap.values()).map((row=>Object.keys(row).length))):0;return new Array(maxLength).fill(null)}get tableColumns(){return this.children.map((child=>child.name))}get value(){const result={};return this.valueMap.forEach(((value,key)=>{result[key]=Object.values(value)})),result}addRow(){this.children.forEach((child=>{const cacheValue=this.valueMap.get(child.code)||{},rowIndex=Object.values(cacheValue).length;Object.assign(cacheValue,{[rowIndex]:child.defaultValue}),this.valueMap.set(child.code,cacheValue)})),console.log(this.valueMap)}}class Container extends CRF{type=CRFType.CrfContainer;children=[];constructor(attributes){super(attributes)}}class MultiTable extends CRF{type=CRFType.CrfMutiTable;constructor(attributes){super(attributes)}}class Matrix extends CRF{type=CRFType.CrfMatrix;constructor(attributes){super(attributes)}}let CaptureService=class CaptureService{constructor(){}loadPageItems(){return(0,of.of)(MOCK_CRF_ITEMS.map((item=>normalizeCRF(item))).sort(((a,b)=>a.sort-b.sort)))}loadPageData(){return(0,of.of)(MOCK_CRF_DATA)}static ctorParameters=()=>[]};function normalizeCRF(item){const{id,pId,uniqueCode,name,type,sort,code,isTimeStandard,statisticalType,attributes={},children}=item;switch(Object.assign(attributes,{id,pId,uniqueCode,name,type,sort,code,isTimeStandard,statisticalType}),type){case CRFType.CrfLabel:return new Label(attributes);case CRFType.CrfLine:return new Line(attributes);case CRFType.CrfLink:return new Link(attributes);case CRFType.CrfAttachment:return new Attachment(attributes);case CRFType.CrfTextInput:return new TextInput(attributes);case CRFType.CrfTextArea:return new TextArea(attributes);case CRFType.CrfRadio:return new Radio(attributes);case CRFType.CrfCheckBox:return new Checkbox(attributes);case CRFType.CrfDateInput:return new DateInput(attributes);case CRFType.CrfNumberInput:return new NumberInput(attributes);case CRFType.CrfSelect:return new SelectMulti(attributes);case CRFType.CrfSelectComplex:return new SelectComplex(attributes);case CRFType.CrfSingleSelect:return new SelectSingle(attributes);case CRFType.CrfGroup:return new Group(attributes);case CRFType.CrfUpload:return new Upload(attributes);case CRFType.CrfTable:return function tableNormalize(attributes,children){const table=new Table({...attributes,children:children.map((child=>normalizeCRF(child))).sort(((a,b)=>a.sort-b.sort))});return table}(attributes,children);case CRFType.CrfMatrix:return new Matrix(attributes);case CRFType.CrfContainer:return function containerNormalize(attributes,children){const container=new Container(attributes);return container.children=children.map((child=>{const item=normalizeCRF(child);return child.children.length&&(child.children=child.children.map((_child=>normalizeCRF(_child))).sort(((a,b)=>a.sort-b.sort))),item})).sort(((a,b)=>a.sort-b.sort)),container}(attributes,children);case CRFType.CrfMutiTable:return new MultiTable(attributes);case CRFType.CrfColumn:return new Column(attributes);default:return new TextInput(attributes)}}CaptureService=(0,tslib_es6.Cg)([(0,core.Injectable)({providedIn:"root"})],CaptureService);class Page{id;name;components=[];data;constructor(attributes){Object.assign(this,attributes)}save(){let result={};this.components.filter((component=>component.isElement||component.isContainer)).forEach((component=>{Object.assign(result,{[component.code]:component.value})})),this.data=result}}var ng_zorro_antd_radio=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-radio.mjs"),ng_zorro_antd_checkbox=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-checkbox.mjs"),ng_zorro_antd_upload=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-upload.mjs"),ng_zorro_antd_table=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-table.mjs"),ng_zorro_antd_tabs=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-tabs.mjs"),ng_zorro_antd_code_editor=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-code-editor.mjs");let CRFCaptureComponent=class CRFCaptureComponent{pageItems;pageData;page;CRFType=CRFType;data;structure;tabIndex=0;captureService=(0,core.inject)(CaptureService);ngOnInit(){this.captureService.loadPageItems().subscribe((items=>{console.log(items),this.page=new Page({id:1,name:"Page 1",components:items}),this.pageItems=items})),this.captureService.loadPageData().subscribe((data=>{this.pageData=data}))}setTab(index){this.tabIndex=index,0===index?this.save():this.saveStructure()}save(){this.page.save(),this.data=JSON.stringify(this.page.data)}saveStructure(){this.structure=JSON.stringify(this.page.components)}};CRFCaptureComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"crf-capture",template:'<main>\n  <div *ngIf="page">\n    <h2>{{page.name}}</h2>\n    <div class="components"> @for (component of page.components; track component.id) { <ng-container\n                    *ngTemplateOutlet="componentTemplate; context: { $implicit: component }"></ng-container> }</div>\n  </div>\n</main>\n<aside class="page-aside">\n  <nz-tabset [nzSelectedIndex]="tabIndex"\n             (nzSelectedIndexChange)="setTab($event)">\n    <nz-tab nzTitle="值结构"></nz-tab>\n    <nz-tab nzTitle="表单结构"></nz-tab>\n  </nz-tabset>\n  <div class="content">\n    <nz-code-editor class="editor block h-full"\n                    [ngModel]="tabIndex === 0 ? data : structure"\n                    [nzEditorOption]="{ language: \'json\' ,minimap: { enabled: false }, wordWrap: \'on\',formatOnPaste:true,\n     formatOnType:true,lineNumbersMinChars: 1,lineDecorationsWidth: 1, automaticLayout:true, fixedOverflowWidgets:true }"></nz-code-editor>\n  </div>\n</aside>\n<ng-template #componentTemplate\n             let-component\n             let-valueMap="valueMap"\n             let-index="index">\n  <div class="component"\n       [attr.crfType]="component.type"> @if(!component.hideName) { <span>{{component.name}}</span> } <div\n         class="content"> @if(component.type === CRFType.CrfLabel) { <label class="cmp">{{component.name}}</label> }\n      @if(component.type === CRFType.CrfLine) {\n      <hr class="cmp"> } @if(component.type === CRFType.CrfLink) { <a class="cmp"\n         href="{{component.link}}">{{component.name}}</a> } @if(component.type === CRFType.CrfAttachment) { <a\n         class="cmp"\n         href="{{component.attachment}}">{{component.name}}</a> } @if(component.type === CRFType.CrfTextInput) {\n      @if(valueMap) { <input class="cmp"\n             nz-input\n             [ngModel]="valueMap[index]"\n             (ngModelChange)="component.setValue(valueMap, index, $event)"> }@else{ <input class="cmp"\n             nz-input\n             [(ngModel)]="component.value"> } } @if(component.type === CRFType.CrfTextArea) { @if(valueMap) { <textarea\n                class="cmp"\n                nz-input\n                [ngModel]="valueMap[index]"\n                (ngModelChange)="component.setValue(valueMap, index, $event)"></textarea> }@else{ <textarea class="cmp"\n                nz-input\n                [(ngModel)]="component.value"></textarea> } } @if(component.type === CRFType.CrfDateInput) {\n      @if(valueMap) { <nz-date-picker class="cmp"\n                      [ngModel]="valueMap[index]"\n                      (ngModelChange)="component.setValue(valueMap, index, $event)"></nz-date-picker> }@else{\n      <nz-date-picker class="cmp"\n                      [(ngModel)]="component.value"></nz-date-picker> } } @if(component.type === CRFType.CrfNumberInput)\n      { @if(valueMap) { <nz-input-number class="cmp"\n                       [ngModel]="valueMap[index]"\n                       (ngModelChange)="component.setValue(valueMap, index, $event)" /> }@else{ <nz-input-number\n                       class="cmp"\n                       [ngModel]="component.value" /> } } @if(component.type === CRFType.CrfRadio) { @if(valueMap) {\n      <nz-radio-group class="cmp"\n                      [ngModel]="valueMap[index]"\n                      (ngModelChange)="component.setValue(valueMap, index, $event)">\n        <label nz-radio\n               [nzValue]="option.id"\n               *ngFor="let option of component.options()">{{option.label}}</label>\n      </nz-radio-group> }@else{ <nz-radio-group class="cmp"\n                      [(ngModel)]="component.value">\n        <label nz-radio\n               [nzValue]="option.id"\n               *ngFor="let option of component.options()">{{option.label}}</label>\n      </nz-radio-group> } } @if(component.type === CRFType.CrfCheckBox) { @if(valueMap) { <nz-checkbox-group class="cmp"\n                         [ngModel]="valueMap[index]"\n                         (ngModelChange)="component.setValue(valueMap, index, $event)">\n        <label nz-checkbox\n               [nzValue]="option.id"\n               *ngFor="let option of component.options()">{{option.label}}</label>\n      </nz-checkbox-group> }@else{ <nz-checkbox-group class="cmp"\n                         [(ngModel)]="component.value">\n        <label nz-checkbox\n               [nzValue]="option.id"\n               *ngFor="let option of component.options()">{{option.label}}</label>\n      </nz-checkbox-group> } } @if(component.type === CRFType.CrfSingleSelect) { @if(valueMap) { <nz-select class="cmp"\n                 [ngModel]="valueMap[index]"\n                 (ngModelChange)="component.setValue(valueMap, index, $event)">\n        <nz-option *ngFor="let option of component.options()"\n                   [nzValue]="option.id"\n                   [nzLabel]="option.label"></nz-option>\n      </nz-select> }@else{ <nz-select class="cmp"\n                 [(ngModel)]="component.value">\n        <nz-option *ngFor="let option of component.options()"\n                   [nzValue]="option.id"\n                   [nzLabel]="option.label"></nz-option>\n      </nz-select> } } @if(component.type === CRFType.CrfSelect) { @if(valueMap) { <nz-select class="cmp"\n                 nzMode="multiple"\n                 [ngModel]="valueMap[index]"\n                 (ngModelChange)="component.setValue(valueMap, index, $event)">\n        <nz-option *ngFor="let option of component.options()"\n                   [nzValue]="option.id"\n                   [nzLabel]="option.label"></nz-option>\n      </nz-select> }@else{ <nz-select class="cmp"\n                 nzMode="multiple"\n                 [(ngModel)]="component.value">\n        <nz-option *ngFor="let option of component.options()"\n                   [nzValue]="option.id"\n                   [nzLabel]="option.label"></nz-option>\n      </nz-select> } } @if(component.type === CRFType.CrfSelectComplex) { @if(valueMap) { <nz-cascader class="cmp"\n                   [nzOptions]="component.options()"\n                   [ngModel]="valueMap[index]"\n                   (ngModelChange)="component.setValue(valueMap, index, $event)"></nz-cascader> }@else{ <nz-cascader\n                   class="cmp"\n                   [nzOptions]="component.options()"\n                   [(ngModel)]="component.value"></nz-cascader> } } @if(component.type === CRFType.CrfGroup) { <div\n           class="cmp group"> @for (child of component.children; track child.id) { <ng-container\n                      *ngTemplateOutlet="componentTemplate; context: { $implicit: child }"></ng-container> } </div> }\n      @if(component.type === CRFType.CrfUpload) { <nz-upload class="cmp"\n                 [nzAction]="component.uploadUrl"\n                 [nzListType]="\'text\'"\n                 [nzMultiple]="true"\n                 [nzShowUploadList]="false">\n        <button nz-button\n                nzType="primary">Upload</button>\n      </nz-upload> } @if(component.type === CRFType.CrfTable) { <nz-table class="cmp"\n                nzSize="small"\n                [nzData]="component.tableRows"\n                [nzFooter]="footerTemplate"\n                [nzScroll]="{ x:\'100%\', y: \'400px\' }"\n                [nzFrontPagination]="false"\n                [nzShowPagination]="false">\n        <thead>\n          <tr>\n            <th *ngFor="let column of component.tableColumns">{{column}}</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor="let row of component.tableRows;let i = index"> @for (cmp of component.children; track cmp.id) {\n            <td>\n              <ng-container\n                            *ngTemplateOutlet="componentTemplate; context: { $implicit: cmp, valueMap: component.valueMap, index: i }"></ng-container>\n            </td> } </tr>\n        </tbody>\n        <ng-template #footerTemplate>\n          <button nz-button\n                  nzType="primary"\n                  (click)="component.addRow()">Add</button>\n        </ng-template>\n      </nz-table> } @if(component.type === CRFType.CrfContainer) { @for (child of component.children; track child.id) {\n      <ng-container *ngTemplateOutlet="componentTemplate; context: { $implicit: child }"></ng-container> } }\n      @if(component.type === CRFType.CrfMatrix) { CrfMatrix }\n    </div>\n  </div>\n</ng-template>',imports:[fesm2022_forms.YN,ng_zorro_antd_code_editor.tC,common_module_Dx7dWex5.MD,ng_zorro_antd_input.j,ng_zorro_antd_input_number.G,ng_zorro_antd_select.DH,ng_zorro_antd_cascader.x2,ng_zorro_antd_date_picker.LE,ng_zorro_antd_radio.Sw,ng_zorro_antd_checkbox.IJ,ng_zorro_antd_upload.SE,ng_zorro_antd_table.$G,ng_zorro_antd_button.Zw,ng_zorro_antd_tabs.hM],styles:[capture_componentngResource_default()]})],CRFCaptureComponent)}}]);