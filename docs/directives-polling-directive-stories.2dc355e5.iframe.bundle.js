"use strict";(self.webpackChunkcomponents_angular=self.webpackChunkcomponents_angular||[]).push([[4043],{"./src/utils/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S$:()=>ECmpTypeOperatorMap,O0:()=>EOperator,WU:()=>MyValidators,FU:()=>certificateCodeValidator,r$:()=>decimalNumberValidator,nh:()=>isAllChecked,fZ:()=>isHalfChecked,Bu:()=>landlineAndPhoneValidator,rm:()=>noEmptyValidator,VD:()=>nonNegativeIntegerValidator,_o:()=>onlyChineseValidator,II:()=>operators,U1:()=>phoneNumberValidator,gG:()=>positiveIntegerValidator,IO:()=>streamToJSON,gZ:()=>uuidv4});var fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs");const REGEXP={phoneNumber:/^1[3-9]\d{9}$/,landlineAndPhone:/^((0\d{2,3}-\d{7,8})|(1[3-9]\d{9}))$/,nonNegativeInteger:/^\d+$/,positiveInteger:/^[1-9]\d*$/,decimalNumber:/^[0-9]+(\.[0-9]+)?$/,empty:/^\s+$/,onlyChinese:/^[\u4e00-\u9fa5_a-zA-Z]+$/,certificateCode:/(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2}[0-9Xx]$)/,mailbox:/^([a-zA-Z0-9_.-]+)@([a-zA-Z0-9_.-]+).([a-zA-Z.]{2,6})$/};function noEmptyValidator(){return control=>{const value=control.value,errorTip={noEmpty:{value}};return!value||REGEXP.empty.test(value)?errorTip:null}}function nonNegativeIntegerValidator(){return control=>{const value=control.value,errorTip={nonNegativeInteger:{value}};return value&&REGEXP.nonNegativeInteger.test(value)?null:errorTip}}function onlyChineseValidator(){return control=>{const value=control.value,errorTip={onlyChinese:{value}};return value&&!REGEXP.onlyChinese.test(value)?errorTip:null}}function phoneNumberValidator(){return control=>{const value=control.value,errorTip={phoneNumber:{value}};return value&&!REGEXP.phoneNumber.test(value)?errorTip:null}}function landlineAndPhoneValidator(){return control=>{const value=control.value,errorTip={landlineAndPhone:{value}};return value&&!REGEXP.landlineAndPhone.test(value)?errorTip:null}}function certificateCodeValidator(){return control=>{const value=control.value,errorTip={certificateCode:{value}};return value&&!REGEXP.certificateCode.test(value)?errorTip:null}}function positiveIntegerValidator(){return control=>{const value=control.value,errorTip={positiveInteger:{value}};return value&&REGEXP.positiveInteger.test(value)?null:errorTip}}function decimalNumberValidator(){return control=>{const value=control.value,errorTip={decimalNumber:{value}};return value&&REGEXP.decimalNumber.test(value)?null:errorTip}}class MyValidators extends fesm2022_forms.k0{static minLength(minLength){return control=>null===fesm2022_forms.k0.minLength(minLength)(control)?null:{minlength:{"zh-cn":`最小长度为 ${minLength}`,en:`MinLength is ${minLength}`}}}static maxLength(maxLength){return control=>null===fesm2022_forms.k0.maxLength(maxLength)(control)?null:{maxlength:{"zh-cn":`最大长度为 ${maxLength}`,en:`MaxLength is ${maxLength}`}}}static myName(control){const value=control.value;return/^[ ]*$/g.test(value)?{name:{"zh-cn":"姓名不可为空",en:"usernName Cannot be empty"}}:null}static mobile(control){const value=control.value;return function isEmptyInputValue(value){return null==value||0===value.length}(value)||function isMobile(value){return"string"==typeof value&&/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/.test(value)}(value)?null:{phoneNumber:{"zh-cn":"手机号码格式不正确",en:"Mobile phone number is not valid"}}}static socialUnifiedCode(control){const value=control.value;return/^(([0-9A-Za-z]{15})|([0-9A-Za-z]{18})|([0-9A-Za-z]{20}))$/.test(value)?null:{name:{"zh-cn":"社会信用代码格式错误",en:"invalid socialUnifiedCode"}}}static validateIdCardNo(idCard){let isValidCard=!1;if(/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/.test(idCard)&&18===idCard.length){const idCardWi=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),idCardY=new Array(1,0,10,9,8,7,6,5,4,3,2);let idCardWiSum=0;for(let i=0;i<17;i++)idCardWiSum+=+idCard.substring(i,i+1)*idCardWi[i];const idCardMod=idCardWiSum%11,idCardLast=idCard.substring(17);2==+idCardMod?"X"!==idCardLast&&"x"!==idCardLast||(isValidCard=!0):+idCardLast===idCardY[idCardMod]&&(isValidCard=!0)}return isValidCard?null:{name:{"zh-cn":"您输入的身份证号格式有误",en:"invalid idCardNo"}}}static mailboxValidator(){return control=>{const value=control.value,errorTip={mailbox:{value}};return value&&!REGEXP.mailbox.test(value)?errorTip:null}}}function uuidv4(){var d=(new Date).getTime(),d2="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(c){var r=16*Math.random();return d>0?(r=(d+r)%16|0,d=Math.floor(d/16)):(r=(d2+r)%16|0,d2=Math.floor(d2/16)),("x"===c?r:3&r|8).toString(16)}))}var EOperator,ECmpTypeOperatorMap;!function(EOperator){EOperator[EOperator.GreaterThan=0]="GreaterThan",EOperator[EOperator.LessThan=1]="LessThan",EOperator[EOperator.EqualTo=2]="EqualTo",EOperator[EOperator.NotEqualTo=3]="NotEqualTo",EOperator[EOperator.Between=4]="Between",EOperator[EOperator.Contains=5]="Contains",EOperator[EOperator.NotContains=6]="NotContains"}(EOperator||(EOperator={})),function(ECmpTypeOperatorMap){ECmpTypeOperatorMap[ECmpTypeOperatorMap.number=1]="number",ECmpTypeOperatorMap[ECmpTypeOperatorMap.char=2]="char",ECmpTypeOperatorMap[ECmpTypeOperatorMap.select_single=3]="select_single",ECmpTypeOperatorMap[ECmpTypeOperatorMap.select_multiple=4]="select_multiple",ECmpTypeOperatorMap[ECmpTypeOperatorMap.select_cascader=5]="select_cascader",ECmpTypeOperatorMap[ECmpTypeOperatorMap.date=6]="date"}(ECmpTypeOperatorMap||(ECmpTypeOperatorMap={}));const operators=[{value:EOperator.GreaterThan,label:"大于",dataTypes:[ECmpTypeOperatorMap.number,ECmpTypeOperatorMap.date],isRange:!1},{value:EOperator.LessThan,label:"小于",dataTypes:[ECmpTypeOperatorMap.number,ECmpTypeOperatorMap.date],isRange:!1},{value:EOperator.EqualTo,label:"等于",dataTypes:[ECmpTypeOperatorMap.number,ECmpTypeOperatorMap.char,ECmpTypeOperatorMap.select_single,ECmpTypeOperatorMap.select_cascader],isRange:!1},{value:EOperator.NotEqualTo,label:"不等于",dataTypes:[ECmpTypeOperatorMap.number,ECmpTypeOperatorMap.char,ECmpTypeOperatorMap.select_single,ECmpTypeOperatorMap.select_cascader],isRange:!1},{value:EOperator.Between,label:"范围",dataTypes:[ECmpTypeOperatorMap.number,ECmpTypeOperatorMap.date],isRange:!0},{value:EOperator.Contains,label:"包含",dataTypes:[ECmpTypeOperatorMap.char,ECmpTypeOperatorMap.select_multiple],isRange:!1},{value:EOperator.NotContains,label:"不包含",dataTypes:[ECmpTypeOperatorMap.char,ECmpTypeOperatorMap.select_multiple],isRange:!1}];var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js");function streamToJSON(_x){return _streamToJSON.apply(this,arguments)}function _streamToJSON(){return(_streamToJSON=(0,asyncToGenerator.A)((function*(inputFile){try{const lines=(yield inputFile.text()).split("\n"),events=[];let currentEvent=null,currentData=null;for(let i=0;i<lines.length;i++){const line=lines[i].trim();if(line.startsWith("event:")){if(currentEvent&&currentData)try{const parsedData=JSON.parse(currentData);events.push({event:currentEvent,data:parsedData})}catch(e){events.push({event:currentEvent,data:currentData})}currentEvent=line.substring(6).trim(),currentData=null}else line.startsWith("data:")&&(currentData=line.substring(5).trim())}if(currentEvent&&currentData)try{const parsedData=JSON.parse(currentData);events.push({event:currentEvent,data:parsedData})}catch(e){events.push({event:currentEvent,data:currentData})}let output="export const streamData = [\n";return events.forEach(((eventObj,index)=>{output+="  {\n",output+=`    event: "${eventObj.event}",\n`,"string"==typeof eventObj.data?output+=`    data: "${eventObj.data.replace(/"/g,'\\"')}"\n`:output+=`    data: ${JSON.stringify(eventObj.data,null,6)}\n`,index<events.length-1?output+="  },\n":output+="  }\n"})),output+="];\n",output}catch(error){return console.error("转换过程中出现错误:",error),""}}))).apply(this,arguments)}function getCheckedCount(list,checkedSelector){return list.reduce(((acc,cur)=>function selectBy(item,selector){return"function"==typeof selector?selector(item):Reflect.get(item,selector)}(cur,checkedSelector)?acc+1:acc),0)}function _isAllChecked(checkedCount,totalCount){return!(!checkedCount||!totalCount)&&totalCount===checkedCount}function isAllChecked(list,checkedSelector){return _isAllChecked(getCheckedCount(list,checkedSelector),list.length)}function _isHalfChecked(checkedCount,totalCount){return!(!checkedCount||!totalCount)&&totalCount!==checkedCount}function isHalfChecked(list,checkedSelector){return _isHalfChecked(getCheckedCount(list,checkedSelector),list.length)}},"./stories/directives/polling.directive.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,base:()=>base,default:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_storybook_angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_Directives__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/directives/index.ts"),_Utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils/index.ts"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Observable.js"),_angular_forms__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),date_fns__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/date-fns/esm/format/index.js"),ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-icon.mjs"),_angular_common__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),ng_zorro_antd_button__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/ng-zorro-antd/fesm2022/ng-zorro-antd-button.mjs");let PollingDemoComponent=class PollingDemoComponent extends _Directives__WEBPACK_IMPORTED_MODULE_1__.fd{pollingResults=[];isPolling=!1;loading={success:!1,error:!1};ngOnInit(){this.polling(this._mockApi(),2,(response=>!!this.isPolling&&"pending"==response.status))}startPolling(){this.isPolling=!0,this.pollingResults=[],this.loading={success:!1,error:!1},this.listenPolling()}stopPolling(){this.isPolling=!1,this.loading={success:!1,error:!1}}pollingNext(response){this.pollingResults=[...this.pollingResults,response],this.loading={success:!1,error:!1}}pollingError(err){this.isPolling=!1,this.loading={success:!1,error:!0}}pollingComplete(){this.isPolling=!1,this.loading={success:!0,error:!1}}_mockApi(){return new rxjs__WEBPACK_IMPORTED_MODULE_3__.c((subscriber=>{const data=Math.random().toFixed(2);subscriber.next({id:(0,_Utils__WEBPACK_IMPORTED_MODULE_2__.gZ)(),timestamp:(0,date_fns__WEBPACK_IMPORTED_MODULE_4__.A)(new Date,"yyyy-MM-dd HH:mm:ss"),data,status:+data<.8?"pending":"success"}),subscriber.complete()}))}};PollingDemoComponent=(0,tslib__WEBPACK_IMPORTED_MODULE_5__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.Component)({selector:"polling-demo",standalone:!0,template:'\n        <div>\n            <button nz-button nzType="primary" (click)="startPolling()" [disabled]="isPolling">开始轮询</button>\n            <button nz-button nzType="primary" (click)="stopPolling()" [disabled]="!isPolling">停止轮询</button>\n            <div style="margin-top: 20px;">\n                <h3>轮询结果 {{loading.success ? \'成功\' : loading.error ? \'失败\' : isPolling ? \'轮询中\' : \'未开始\'}}\n                    <span *ngIf="isPolling && !loading.success && !loading.error" nz-icon nzType="loading"></span>\n                  \n                    <span *ngIf="loading.success">\n                        <span nz-icon nzType="check-circle" nzTheme="outline"></span>\n                    </span>\n                    <span *ngIf="loading.error">\n                        <span nz-icon nzType="close-circle" nzTheme="outline"></span>\n                    </span>\n                </h3>  \n                <small>假定随机数>0.8为成功，否则继续查询</small>\n                <p>\n                @for (result of pollingResults; track result.id) {\n                    <div>\n                        {{result.data}}\n                    </div>\n                }\n                </p>\n            </div>\n        </div>\n    ',imports:[_Directives__WEBPACK_IMPORTED_MODULE_1__.fd,_angular_common__WEBPACK_IMPORTED_MODULE_7__.MD,_angular_forms__WEBPACK_IMPORTED_MODULE_8__.YN,ng_zorro_antd_icon__WEBPACK_IMPORTED_MODULE_9__.Y3,ng_zorro_antd_button__WEBPACK_IMPORTED_MODULE_10__.Zw]})],PollingDemoComponent);const __WEBPACK_DEFAULT_EXPORT__={title:"Directives/Polling",component:PollingDemoComponent,decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_0__.moduleMetadata)({imports:[PollingDemoComponent]})]},base={args:{interval:2e3}},__namedExportsOrder=["base"];base.parameters={...base.parameters,docs:{...base.parameters?.docs,source:{originalSource:"{\n  args: {\n    interval: 2000 // 默认2秒轮询一次\n  }\n}",...base.parameters?.docs?.source}}}}}]);